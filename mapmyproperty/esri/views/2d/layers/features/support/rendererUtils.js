define(["require","exports","tslib","../../../../../core/Logger","../../../../../core/screenUtils"],(function(e,r,l,a,i){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.simplifyVisualVariables=r.simplifyVVRenderer=void 0;var s=a.getLogger("esri.renderers.visualVariables.support.utils");function o(e){return("size"===e.type||"color"===e.type||"opacity"===e.type)&&null!=e.stops}function t(e){return e.stops=function(e,r){return r.length<=8?r:(s.warn("Found "+r.length+" Visual Variable stops, but MapView only supports 8. Displayed stops will be simplified."),r.length>16?function(e,r){for(var a=r[0],s=r.slice(1),o=s.pop(),t=s[0].value,n=s[s.length-1].value,p=(n-t)/6,c=[],v=t;v<n;v+=p){for(var f=0;v>=s[f].value;)f++;var b=s[f],y=r[f-1],V=b.value===y.value?1:(v-y.value)/(b.value-y.value);if("color"===e){var g=s[f],d=r[f-1],h=g.color.clone();h.r=u(d.color.r,h.r,V),h.g=u(d.color.g,h.g,V),h.b=u(d.color.b,h.b,V),h.a=u(d.color.a,h.a,V),c.push({value:v,color:h,label:g.label})}else if("size"===e){var m=s[f],_=r[f-1],z=i.toPt(m.size),w=u(i.toPt(_.size),z,V);c.push({value:v,size:w,label:m.label})}else{var M=s[f],P=u(r[f-1].opacity,M.opacity,V);c.push({value:v,opacity:P,label:M.label})}}return l.__spreadArrays([a],c,[o])}(e,r):function(e){for(var r=e[0],a=e.slice(1),i=a.pop();a.length>6;){for(var s=0,o=0,t=1;t<a.length;t++){var u=Math.abs(a[t].value-a[t-1].value);u>o&&(o=u,s=t)}a.splice(s,1)}return l.__spreadArrays([r],a,[i])}(r))}(e.type,e.stops),e}function u(e,r,l){return(1-l)*e+l*r}r.simplifyVVRenderer=function(e){if(!("visualVariables"in e&&e.visualVariables&&e.visualVariables.length))return e;var r=e.clone(),l=r.visualVariables.map((function(e){return o(e)?t(e):e}));return r.visualVariables=l,r},r.simplifyVisualVariables=function(e){return e.map((function(e){return o(e)?t(e.clone()):e}))}}));