!function(){function e(e,t,i,n,r,a,s){try{var o=e[a](s),c=o.value}catch(l){return void i(l)}o.done?t(c):Promise.resolve(c).then(n,r)}function t(t){return function(){var i=this,n=arguments;return new Promise(function(r,a){var s=t.apply(i,n);function o(t){e(s,r,a,o,c,"next",t)}function c(t){e(s,r,a,o,c,"throw",t)}o(void 0)})}}function i(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}function n(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach(function(t){r(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function r(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==i)return;var n,r,a=[],s=!0,o=!1;try{for(i=i.call(e);!(s=(n=i.next()).done)&&(a.push(n.value),!t||a.length!==t);s=!0);}catch(c){o=!0,r=c}finally{try{s||null==i.return||i.return()}finally{if(o)throw r}}return a}(e,t)||o(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=o(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==i.return||i.return()}finally{if(c)throw a}}}}function o(e,t){if(e){if("string"==typeof e)return c(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?c(e,t):void 0}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function l(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var i,n=v(e);if(t){var r=v(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return u(this,i)}}function u(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[55,74],{"6UvW":function(e,t,i){"use strict";i.d(t,"a",function(){return o}),i.d(t,"b",function(){return c});var n=i("srIe"),r=i("OvF4"),a=(i("4GrV"),i("gEht")),s=i("U282");function o(e,t,i){var s,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new r.a;if("2d"===i.type)s=t*i.resolution;else if("3d"===i.type){var c=i.overlayPixelSizeInMapUnits(e),l=i.basemapSpatialReference;s=Object(n.k)(l)&&!l.equals(i.spatialReference)?Object(a.f)(l)/Object(a.f)(i.spatialReference):t*c}var h=e.x-s,p=e.y-s,u=e.x+s,v=e.y+s,d=i.spatialReference;return o.xmin=Math.min(h,u),o.ymin=Math.min(p,v),o.xmax=Math.max(h,u),o.ymax=Math.max(p,v),o.spatialReference=d,o}function c(e,t,i){var r=i.toMap(e);return!Object(n.j)(r)&&o(r,Object(s.a)(),i,l).intersects(t)}var l=new r.a},BTtK:function(e,i,r){"use strict";r.r(i);var o=r("pO5D"),c=(r("wSAH"),r("srIe")),u=(r("6S2I"),r("zqDF"),r("WbKI")),v=r("04ZG"),f=(r("4EHJ"),r("ju1D"),r("9AIY"),r("9MzC")),y=r("SuVq"),m=r("Mu3I"),b=(r("4GrV"),r("zm0L")),_=r("Tcmu"),g=r("jWBI"),x=r("r0DZ"),k=r("N5XI"),w=r("JYnY"),O=r("d3n7"),G=r("E4HC"),S=r("aunz"),j=r("J9+3"),M=r("Hxwb"),H=r("zcE2"),E=r("tl5A"),I=r("JL5j"),R=function e(t,i,n){d(this,e),this.graphic=t,this.mover=i,this.selected=n,this.type="reshape-start"},V=function e(t,i,n){d(this,e),this.graphic=t,this.mover=i,this.selected=n,this.type="reshape"},C=function e(t,i,n){d(this,e),this.graphic=t,this.mover=i,this.selected=n,this.type="reshape-stop"},A=function e(t,i,n){d(this,e),this.mover=t,this.dx=i,this.dy=n,this.type="move-start"},D=function e(t,i,n){d(this,e),this.mover=t,this.dx=i,this.dy=n,this.type="move"},P=function e(t,i,n){d(this,e),this.mover=t,this.dx=i,this.dy=n,this.type="move-stop"},z=function e(t){d(this,e),this.added=t,this.type="vertex-select"},T=function e(t){d(this,e),this.removed=t,this.type="vertex-deselect"},F=function e(t,i,n,r){d(this,e),this.added=t,this.graphic=i,this.oldGraphic=n,this.vertices=r,this.type="vertex-add"},U=function e(t,i,n,r){d(this,e),this.removed=t,this.graphic=i,this.oldGraphic=n,this.vertices=r,this.type="vertex-remove"},q={removeVertex:["Backspace","Delete"]},L=O.b.reshapeGraphics,B={vertices:{default:new _.a({style:"circle",size:L.vertex.size,color:L.vertex.color,outline:{color:L.vertex.outlineColor,width:1}}),hover:new _.a({style:"circle",size:L.vertex.hoverSize,color:L.vertex.hoverColor,outline:{color:L.vertex.hoverOutlineColor,width:1}}),selected:new _.a({style:"circle",size:L.selected.size,color:L.selected.color,outline:{color:L.selected.outlineColor,width:1}})},midpoints:{default:new _.a({style:"circle",size:L.midpoint.size,color:L.midpoint.color,outline:{color:L.midpoint.outlineColor,width:1}}),hover:new _.a({style:"circle",size:L.midpoint.size,color:L.midpoint.color,outline:{color:L.midpoint.outlineColor,width:1}})}},J=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(b,e);var i,r,o,u,v=p(b);function b(e){var t;return d(this,b),(t=v.call(this,e))._handles=new x.a,t._graphicAttributes={esriSketchTool:"box"},t._mover=null,t._snappingTask=null,t._stagedVertex=null,t._totalDx=0,t._totalDy=0,t._viewHandles=new x.a,t.callbacks={onReshapeStart:function(){},onReshape:function(){},onReshapeStop:function(){},onMoveStart:function(){},onMove:function(){},onMoveStop:function(){},onGraphicClick:function(){}},t.enableMidpoints=!0,t.graphic=null,t.handleGraphics=[],t.layer=null,t.midpointGraphics=[],t.midpointSymbol=new _.a({style:"circle",size:6,color:[200,200,200],outline:{color:[100,100,100],width:1}}),t.selectedHandles=[],t.snappingManager=null,t.type="reshape",t.view=null,t}return i=b,(r=[{key:"initialize",value:function(){var e=this;this._setup(),this._handles.add([Object(k.whenOnce)(this,"view.ready",function(){var t=e.layer,i=e.view;Object(E.a)(i,t),e._viewHandles.add([i.on("key-down",function(t){return e._keyDownHandler(t)},w.b.TOOL)])}),Object(k.pausable)(this,"graphic",function(){return e.refresh()}),Object(k.pausable)(this,"layer",function(t,i){i&&(e._clearSelection(),e._resetGraphics(i)),e.refresh()}),Object(k.pausable)(this,"enableMidpoints",function(){e.refresh()})])}},{key:"destroy",value:function(){this._reset(),this._mover&&this._mover.destroy(),this._mover=null,this._handles.removeAll(),this._handles=null,this._viewHandles.removeAll(),this._viewHandles=null}},{key:"state",get:function(){var e=!!this.get("view.ready"),t=!(!this.get("graphic")||!this.get("layer"));return e&&t?"active":e?"ready":"disabled"}},{key:"symbols",set:function(e){var t=e||{},i=t.midpoints,n=void 0===i?B.midpoints:i,r=t.vertices,a=void 0===r?B.vertices:r;this._set("symbols",{midpoints:n,vertices:a})}},{key:"isUIGraphic",value:function(e){var t=[];return this.graphic&&t.push(this.graphic),t.concat(this.handleGraphics,this.midpointGraphics),t.length&&t.includes(e)}},{key:"refresh",value:function(){this._reset(),this._setup()}},{key:"reset",value:function(){this.graphic=null}},{key:"clearSelection",value:function(){this._clearSelection()}},{key:"removeSelectedHandles",value:function(){this.selectedHandles.length&&this._removeVertex(this.selectedHandles)}},{key:"_setup",value:function(){this.graphic&&this.layer&&(this._setupGraphics(),this._setupMover())}},{key:"_setUpGeometryHelper",value:function(){var e=this.graphic.geometry;Object(c.j)(e)||"polygon"!==e.type&&"polyline"!==e.type||(this._geometryHelper=new j.a(S.c.fromGeometry(e,"local"),e.type))}},{key:"_saveSnappingContextForHandle",value:function(e,t){var i;this._snappingContext=new M.a({geometry:this._geometryHelper,elevationInfo:{mode:"on-the-ground",offset:0},pointer:(null==(i=t.viewEvent)?void 0:i.pointerType)||"mouse",excludeFeature:this.graphic,visualizer:new G.a,vertexHandle:this._getVertexFromEditGeometry(e)})}},{key:"_reset",value:function(){this._clearSelection(),this._resetGraphicStateVars(),this._resetGraphics(),this._resetSnappingStateVars(),this._mover&&this._mover.destroy(),this._mover=null,this.view.cursor="default"}},{key:"_resetSnappingStateVars",value:function(){var e;Object(c.k)(this.snappingManager)&&this.snappingManager.doneSnapping(),null==(e=this._geometryHelper)||e.destroy(),this._geometryHelper=null,this._snappingTask=Object(c.a)(this._snappingTask),this._snappingTask=null,this._snappingContext=null,this._stagedVertex=null}},{key:"_resetGraphicStateVars",value:function(){this._totalDx=0,this._totalDy=0}},{key:"_resetGraphics",value:function(e){var t=e||this.layer;t&&(t.removeMany(this.handleGraphics),t.removeMany(this.midpointGraphics)),this.handleGraphics.forEach(function(e){return e.destroy()}),this.midpointGraphics.forEach(function(e){return e.destroy()}),this._set("handleGraphics",[]),this._set("midpointGraphics",[]),this._set("selectedHandles",[])}},{key:"_setupGraphics",value:function(){var e=Object(c.q)(this.graphic.geometry),t=Object(m.b)(e.clone());if("polygon"===e.type){var i,n=s(t);try{for(n.s();!(i=n.n()).done;){var r=i.value,a=r[r.length-1];r[0][0]===a[0]&&r[0][1]===a[1]&&r.length>2&&r.pop()}}catch(o){n.e(o)}finally{n.f()}}this._set("handleGraphics",this._createHandleGraphics(t)),this.enableMidpoints&&this._set("midpointGraphics",this._createMidpointGraphics(t)),this._saveRelatedIndices(this.handleGraphics),this.layer.addMany(this.midpointGraphics),this.layer.addMany(this.handleGraphics)}},{key:"_createHandleGraphics",value:function(e){var t=this._graphicAttributes,i=this.symbols,r=this.view.spatialReference,s=[];return null==e||e.forEach(function(e,o){e.forEach(function(e,c){var l,h=a(e,2),p=h[0],u=h[1];s.push(new g.a({geometry:new y.a({x:p,y:u,spatialReference:r}),symbol:null==i||null==(l=i.vertices)?void 0:l.default,attributes:n(n({},t),{},{pathIndex:o,pointIndex:c})}))})}),s}},{key:"_createMidpointGraphics",value:function(e){var t=this,i=this._graphicAttributes,r=this.symbols,s=this.view.spatialReference,o=[];return null==e||e.forEach(function(e,l){e.forEach(function(h,p){var u=a(h,2),v=u[0],d=u[1],f=e[p+1]?p+1:0;if("polygon"===Object(c.i)(t.graphic.geometry,"type")||0!==f){var b=a(e[f],2),_=b[0],x=b[1],k=a(Object(m.d)([v,d],[_,x]),2),w=k[0],O=k[1];o.push(new g.a({geometry:new y.a({x:w,y:O,spatialReference:s}),symbol:r.midpoints.default,attributes:n(n({},i),{},{pathIndex:l,pointIndexStart:p,pointIndexEnd:f})}))}})}),o}},{key:"_saveRelatedIndices",value:function(e){if(e)for(var t=e.map(function(e){var t=e.geometry;return{x:t.x,y:t.y}}),i=0;i<t.length;i++){for(var n=[],r=0;r<t.length;r++)if(i!==r){var a=t[i],s=t[r];a.x===s.x&&a.y===s.y&&n.push(r)}e[i].attributes.relatedGraphicIndices=n}}},{key:"_setupMover",value:function(){var e=this;this._mover=new I.default({enableMoveAllGraphics:!1,graphics:[].concat(this.handleGraphics,this.midpointGraphics,this.graphic),view:this.view,callbacks:{onGraphicClick:function(t){return e._onGraphicClickCallback(t)},onGraphicMoveStart:function(t){return e._onGraphicMoveStartCallback(t)},onGraphicMove:function(t){return e._onGraphicMoveCallback(t)},onGraphicMoveStop:function(t){return e._onGraphicMoveStopCallback(t)},onGraphicPointerOver:function(t){return e._onGraphicPointerOverCallback(t)},onGraphicPointerOut:function(t){return e._onGraphicPointerOutCallback(t)}}})}},{key:"_onGraphicClickCallback",value:function(e){e.viewEvent.stopPropagation();var t=e.graphic;if(t===this.graphic)this.clearSelection(),this.emit("graphic-click",e),this.callbacks.onGraphicClick&&this.callbacks.onGraphicClick(e);else if(this._isMidpoint(t)){if(2===e.viewEvent.button)return;var i=this.graphic.clone(),n=this._createHandleFromMidpoint(t);this.refresh(),this._emitVertexAddEvent([t],i,n)}else this._isHandle(t)&&(e.viewEvent.stopPropagation(),2===e.viewEvent.button?this._removeVertex(t):(e.viewEvent.native.shiftKey||this._clearSelection(),this.selectedHandles.includes(t)?this._removeFromSelection(t,!0):this._addToSelection(t)))}},{key:"_onGraphicMoveStartCallback",value:function(e){var t=e.graphic,i=e.dx,n=e.dy;if(this._resetGraphicStateVars(),this._resetSnappingStateVars(),t===this.graphic)return this.handleGraphics.forEach(function(e){return e.visible=!1}),this.midpointGraphics.forEach(function(e){return e.visible=!1}),this._clearSelection(),void this._emitMoveStartEvent(i,n);if(this._isMidpoint(t)){this._clearSelection();var r=this.graphic.clone(),a=this._createHandleFromMidpoint(t);this._emitVertexAddEvent([t],r,a),this._addToSelection(t)}else this.selectedHandles.includes(t)||(this._clearSelection(),this._addToSelection(t));this._setUpGeometryHelper(),this._saveSnappingContextForHandle(t,e),this._onHandleMove(t,i,n,e),this._emitReshapeStartEvent(t)}},{key:"_onGraphicMoveCallback",value:function(e){var t=e.graphic,i=e.dx,n=e.dy;this._totalDx+=i,this._totalDy+=n,t===this.graphic?(this._syncGraphicsWithGeometry(),this._emitMoveEvent(i,n)):(this._onHandleMove(t,i,n,e),this._emitReshapeEvent(t))}},{key:"_onGraphicMoveStopCallback",value:function(e){var t=e.graphic,i=e.dx,n=e.dy;if(this._totalDx+=i,this._totalDy+=n,t===this.graphic){this._syncGraphicsWithGeometry();var r,a=s([].concat(this.handleGraphics,this.midpointGraphics));try{for(a.s();!(r=a.n()).done;)r.value.visible=!0}catch(o){a.e(o)}finally{a.f()}this._emitMoveStopEvent(),this._resetGraphicStateVars()}else this._onHandleMove(t,i,n,e),this._resetSnappingStateVars(),this._isMidpoint(t)&&this.refresh(),this._emitReshapeStopEvent(t),this._resetGraphicStateVars()}},{key:"_syncGraphicsWithGeometry",value:function(){var e=this.graphic.geometry,t="polyline"===e.type?e.paths:e.rings;this._updateHandleGraphicLocations(t),this._updateMidpointGraphicLocations(t)}},{key:"_updateHandleGraphicLocations",value:function(e){var t,i=s(this.handleGraphics);try{for(i.s();!(t=i.n()).done;){var n=t.value,r=n.attributes,o=r.pathIndex,c=r.pointIndex,l=a(e[o][c],2),h=l[0],p=l[1];n.set("geometry",new y.a(h,p,this.view.spatialReference))}}catch(u){i.e(u)}finally{i.f()}}},{key:"_updateMidpointGraphicLocations",value:function(e){var t,i=s(this.midpointGraphics);try{for(i.s();!(t=i.n()).done;){var n=t.value,r=n.attributes,o=r.pathIndex,c=r.pointIndexStart,l=r.pointIndexEnd,h=a(e[o][c],2),p=h[0],u=h[1],v=a(e[o][l],2),d=v[0],f=v[1],b=a(Object(m.d)([p,u],[d,f]),2),_=b[0],g=b[1];n.geometry=new y.a({x:_,y:g,spatialReference:this.view.spatialReference})}}catch(x){i.e(x)}finally{i.f()}}},{key:"_getVertexFromEditGeometry",value:function(e){var t,i=e.attributes,n=i.pathIndex,r=i.pointIndex;return null==(t=this._geometryHelper)?void 0:t.editGeometry.components[n].vertices[r]}},{key:"_onHandleMove",value:function(e,i,n,r){var a=this;Object(c.a)(this._snappingTask);var s=e.geometry,o="graphic-move-stop"===r.type;if(Object(c.k)(this.snappingManager)&&1===this.selectedHandles.length&&!o){var l=this.snappingManager;this._stagedVertex=l.update(s,this._snappingContext),this._syncGeometryAfterHandleMove(e,new y.a(this._stagedVertex),i,n,o),this._emitReshapeEvent(e),this._snappingTask=Object(f.h)(function(){var r=t(regeneratorRuntime.mark(function t(r){var c;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l.snap(s,a._snappingContext,r);case 2:(c=t.sent).valid&&(a._stagedVertex=c.apply(),a._syncGeometryAfterHandleMove(e,new y.a(a._stagedVertex),i,n,o),a._emitReshapeEvent(e));case 4:case"end":return t.stop()}},t)}));return function(e){return r.apply(this,arguments)}}())}else{var h=Object(c.k)(this._stagedVertex)?new y.a(this._stagedVertex):s;this._syncGeometryAfterHandleMove(e,h,i,n,o),"graphic-move"===r.type&&this._emitReshapeEvent(e)}}},{key:"_syncGeometryAfterHandleMove",value:(u=t(regeneratorRuntime.mark(function e(t,i,n,r){var a,s,o,c,l,h=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=h.length>4&&void 0!==h[4]&&h[4],s=i.x,o=i.y,c=this._getUpdatedGeometryAfterHandleMove(t,i),l="polyline"===c.type?c.paths:c.rings,this._isHandle(t)&&(l=this._moveRelatedCoordinates(l,t,s,o),l=this._moveSelectedHandleCoordinates(l,t,n,r,"polygon"===c.type),this._updateMidpointGraphicLocations(l)),this.graphic.geometry=c,this._syncEditGeometryAfterHandleMove(t,s,o),a&&(t.geometry=i);case 4:case"end":return e.stop()}},e,this)})),function(e,t,i,n){return u.apply(this,arguments)})},{key:"_getUpdatedGeometryAfterHandleMove",value:function(e,t){var i=t.x,n=t.y,r=Object(c.q)(this.graphic.geometry).clone(),a="polyline"===r.type?r.paths:r.rings,s=e.attributes,o=s.pathIndex,l=s.pointIndex,h=a[o].length-1;return a[o][l]=[i,n],"polygon"===r.type&&(0===l?a[o][h]=[i,n]:l===h&&(a[o][0]=[i,n])),r}},{key:"_moveRelatedCoordinates",value:function(e,t,i,n){var r,a=s(t.attributes.relatedGraphicIndices);try{for(a.s();!(r=a.n()).done;){var o=r.value,c=this.handleGraphics[o],l=c.attributes,h=l.pathIndex,p=l.pointIndex;e[h][p]=[i,n],c.geometry=t.geometry}}catch(u){a.e(u)}finally{a.f()}return e}},{key:"_moveSelectedHandleCoordinates",value:function(e,t,i,n,r){var a,o=s(this.selectedHandles);try{for(o.s();!(a=o.n()).done;){var c=a.value;if(c!==t){var l=c.attributes,h=l.pathIndex,p=l.pointIndex,u=l.relatedGraphicIndices,v=Object(H.a)(c.geometry,i,n,this.view),d=e[h].length-1;e[h][p]=[v.x,v.y],c.geometry=v,r&&(0===p?e[h][d]=[v.x,v.y]:p===d&&(e[h][0]=[v.x,v.y]));var f,y=s(u);try{for(y.s();!(f=y.n()).done;){var m=f.value,b=this.handleGraphics[m],_=b.attributes,g=_.pathIndex,x=_.pointIndex;e[g][x]=[v.x,v.y],b.geometry=v}}catch(k){y.e(k)}finally{y.f()}}}}catch(k){o.e(k)}finally{o.f()}return e}},{key:"_syncEditGeometryAfterHandleMove",value:function(e,t,i){var n=this._getVertexFromEditGeometry(e);this._geometryHelper.moveVertices([n],t-n.pos[0],i-n.pos[1],0)}},{key:"_onGraphicPointerOverCallback",value:function(e){var t=e.graphic;this._isHandle(t)&&!this._isSelected(t)&&(t.symbol=this.symbols.vertices.hover),this._updateHoverCursor(t)}},{key:"_onGraphicPointerOutCallback",value:function(e){var t=e.graphic;this._isHandle(t)&&!this._isSelected(t)&&(t.symbol=this.symbols.vertices.default),this.view.cursor="default"}},{key:"_createHandleFromMidpoint",value:function(e){var t=this._graphicAttributes,i=[],r=Object(c.q)(this.graphic.geometry).clone(),a=e.attributes,s=a.pathIndex,o=a.pointIndexStart,l=a.pointIndexEnd,h=e.geometry,p=h.x,u=h.y,v=0===l?o+1:l,d="polyline"===r.type?r.paths:r.rings;return d[s].splice(v,0,[p,u]),e.attributes=n(n({},t),{},{pathIndex:s,pointIndex:v,relatedGraphicIndices:[]}),i.push({coordinates:d[s][v],componentIndex:s,vertexIndex:v}),this.graphic.geometry=r,i}},{key:"_removeHandles",value:function(e){var t=Object(c.q)(this.graphic.geometry).clone(),i="polygon"===t.type?t.rings:t.paths,n=[];e instanceof g.a&&(e=[e]);var r,o=s(e);try{for(o.s();!(r=o.n()).done;)for(var l=r.value.geometry,h=l.x,p=l.y,u=0;u<i.length;u++)for(var v=i[u],d=0;d<v.length;d++){var f=a(v[d],2),y=f[0],m=f[1];h===y&&p===m&&(n.push({coordinates:i[u][d],componentIndex:u,vertexIndex:d}),i[u].splice(Number(d),1))}}catch(I){o.e(I)}finally{o.f()}if("polygon"===t.type){var b,_=s(i);try{for(_.s();!(b=_.n()).done;){var x=b.value,k=a(x[0],2),w=k[0],O=k[1],G=a(x[x.length-1],2),S=G[0],j=G[1];(1===x.length||x.length<3&&w===S&&O===j)&&i.splice(i.indexOf(x),1),x.length>2&&(w!==S||O!==j)&&x.push(x[0])}}catch(I){_.e(I)}finally{_.f()}}else{var M,H=s(i);try{for(H.s();!(M=H.n()).done;){var E=M.value;1===E.length&&i.splice(i.indexOf(E),1)}}catch(I){H.e(I)}finally{H.f()}}return this.graphic.geometry=t,n}},{key:"_addToSelection",value:function(e){e instanceof g.a&&(e=[e]);var t,i=s(e);try{for(i.s();!(t=i.n()).done;)t.value.symbol=this.symbols.vertices.selected}catch(n){i.e(n)}finally{i.f()}this._set("selectedHandles",this.selectedHandles.concat(e)),this._emitSelectEvent(e)}},{key:"_removeFromSelection",value:function(e,t){var i=this.symbols.vertices,n=t?i.hover:i.default;e instanceof g.a&&(e=[e]);var r,a=s(e);try{for(a.s();!(r=a.n()).done;){var o=r.value;this.selectedHandles.splice(this.selectedHandles.indexOf(o),1),this._set("selectedHandles",this.selectedHandles),o.set("symbol",n)}}catch(c){a.e(c)}finally{a.f()}this._emitDeselectEvent(e)}},{key:"_clearSelection",value:function(){if(this.selectedHandles.length){var e,t=this.selectedHandles,i=s(this.selectedHandles);try{for(i.s();!(e=i.n()).done;)e.value.set("symbol",this.symbols.vertices.default)}catch(n){i.e(n)}finally{i.f()}this._set("selectedHandles",[]),this._emitDeselectEvent(t)}}},{key:"_keyDownHandler",value:function(e){q.removeVertex.includes(e.key)&&!e.repeat&&this.selectedHandles.length&&this._removeVertex(this.selectedHandles)}},{key:"_removeVertex",value:function(e){if(!("polygon"===this.graphic.geometry.type&&this.handleGraphics.length<4||this.handleGraphics.length<3)){var t=this.graphic.clone();e instanceof g.a&&(e=[e]);var i=this._removeHandles(e);this.refresh(),this._emitVertexRemoveEvent(e,t,i)}}},{key:"_isHandle",value:function(e){return this.handleGraphics.includes(e)}},{key:"_isSelected",value:function(e){return this._isHandle(e)&&this.selectedHandles.includes(e)}},{key:"_isMidpoint",value:function(e){return this.midpointGraphics.includes(e)}},{key:"_updateHoverCursor",value:function(e){this.view.cursor=this._isMidpoint(e)?"copy":"move"}},{key:"_emitMoveStartEvent",value:function(e,t){var i=new A(this.graphic,e,t);this.emit("move-start",i),this.callbacks.onMoveStart&&this.callbacks.onMoveStart(i)}},{key:"_emitMoveEvent",value:function(e,t){var i=new D(this.graphic,e,t);this.emit("move",i),this.callbacks.onMove&&this.callbacks.onMove(i)}},{key:"_emitMoveStopEvent",value:function(){var e=new P(this.graphic,this._totalDx,this._totalDy);this.emit("move-stop",e),this.callbacks.onMoveStop&&this.callbacks.onMoveStop(e)}},{key:"_emitReshapeStartEvent",value:function(e){var t=new R(this.graphic,e,this.selectedHandles);this.emit("reshape-start",t),this.callbacks.onReshapeStart&&this.callbacks.onReshapeStart(t)}},{key:"_emitReshapeEvent",value:function(e){var t=new V(this.graphic,e,this.selectedHandles);this.emit("reshape",t),this.callbacks.onReshape&&this.callbacks.onReshape(t)}},{key:"_emitReshapeStopEvent",value:function(e){var t=new C(this.graphic,e,this.selectedHandles);this.emit("reshape-stop",t),this.callbacks.onReshapeStop&&this.callbacks.onReshapeStop(t)}},{key:"_emitSelectEvent",value:function(e){var t=new z(e);this.emit("select",t),this.callbacks.onVertexSelect&&this.callbacks.onVertexSelect(t)}},{key:"_emitDeselectEvent",value:function(e){var t=new T(e);this.emit("deselect",t),this.callbacks.onVertexDeselect&&this.callbacks.onVertexDeselect(t)}},{key:"_emitVertexAddEvent",value:function(e,t,i){var n=new F(e,this.graphic,t,i);this.emit("vertex-add",n),this.callbacks.onVertexAdd&&this.callbacks.onVertexAdd(n)}},{key:"_emitVertexRemoveEvent",value:function(e,t,i){var n=new U(e,this.graphic,t,i);this.emit("vertex-remove",n),this.callbacks.onVertexRemove&&this.callbacks.onVertexRemove(n)}}])&&l(i.prototype,r),o&&l(i,o),b}(b.a.EventedAccessor);Object(o.a)([Object(u.b)()],J.prototype,"callbacks",void 0),Object(o.a)([Object(u.b)()],J.prototype,"enableMidpoints",void 0),Object(o.a)([Object(u.b)()],J.prototype,"graphic",void 0),Object(o.a)([Object(u.b)({readOnly:!0})],J.prototype,"handleGraphics",void 0),Object(o.a)([Object(u.b)()],J.prototype,"layer",void 0),Object(o.a)([Object(u.b)({readOnly:!0})],J.prototype,"midpointGraphics",void 0),Object(o.a)([Object(u.b)()],J.prototype,"midpointSymbol",void 0),Object(o.a)([Object(u.b)({readOnly:!0})],J.prototype,"selectedHandles",void 0),Object(o.a)([Object(u.b)()],J.prototype,"snappingManager",void 0),Object(o.a)([Object(u.b)({readOnly:!0})],J.prototype,"state",null),Object(o.a)([Object(u.b)({value:B})],J.prototype,"symbols",null),Object(o.a)([Object(u.b)({readOnly:!0})],J.prototype,"type",void 0),Object(o.a)([Object(u.b)()],J.prototype,"view",void 0),J=Object(o.a)([Object(v.a)("esri.views.draw.support.Reshape")],J),i.default=J},U282:function(e,t,i){"use strict";function n(e,t){return t?"xoffset"in t&&t.xoffset?Math.max(e,Math.abs(t.xoffset)):"yoffset"in t&&t.yoffset?Math.max(e,Math.abs(t.yoffset||0)):e:e}function r(e,t){return"number"==typeof e?e:e&&e.stops&&e.stops.length?function(e){for(var t=0,i=0,n=0;n<e.length;n++){var r=e[n].size;"number"==typeof r&&(t+=r,i++)}return t/i}(e.stops):t}function a(e,t){if(!t)return e;var i=t.filter(function(e){return"size"===e.type}).map(function(t){var i=t.maxSize,n=t.minSize;return(r(i,e)+r(n,e))/2}),n=0,a=i.length;if(0===a)return e;for(var s=0;s<a;s++)n+=i[s];var o=Math.floor(n/a);return Math.max(o,e)}function s(e){var t=e&&e.renderer,i="touch"===(e&&e.event&&e.event.pointerType)?9:6;if(!t)return i;var r="visualVariables"in t?a(i,t.visualVariables):i;if("simple"===t.type)return n(r,t.symbol);if("unique-value"===t.type){var s=r;return t.uniqueValueInfos.forEach(function(e){s=n(s,e.symbol)}),s}if("class-breaks"===t.type){var o=r;return t.classBreakInfos.forEach(function(e){o=n(o,e.symbol)}),o}return r}i.d(t,"a",function(){return s})}}])}();