(function(){var e={"arcgis-js-api/views/2d/engine/webgl/AttributeStoreView":"+4HP","arcgis-js-api/views/2d/engine/webgl/WGLTile":"AP+j","arcgis-js-api/views/2d/engine/webgl/MemoryRequirements":"AwqN","arcgis-js-api/views/2d/engine/webgl/WGLDisplayList":"Dikz","arcgis-js-api/views/2d/engine/FeatureContainer":"N0+q","arcgis-js-api/views/2d/engine/webgl/TileBufferData":"PwbG","arcgis-js-api/views/2d/engine/webgl/DirtyMap":"SkDs","arcgis-js-api/views/2d/engine/webgl/DisplayRecordStore":"Sq9p","arcgis-js-api/views/2d/engine/webgl/FreeList":"Zry2","arcgis-js-api/views/2d/engine/webgl/TiledDisplayObject":"gi5q","arcgis-js-api/views/2d/engine/webgl/WGLRendererInfo":"oDRR","arcgis-js-api/views/2d/engine/webgl/Fader":"qe2g","arcgis-js-api/views/2d/engine/webgl/TileData":"rYkQ","arcgis-js-api/views/2d/engine/webgl/TileDisplayData":"tTR7","arcgis-js-api/views/2d/engine/webgl/TileContainer":"wUCb","arcgis-js-api/views/2d/engine/webgl/WGLBuffers":"xxo4"},t=this||window,r=t.webpackJsonp=t.webpackJsonp||[];r.registerAbsMids?r.registerAbsMids(e):(r.absMidsWaiting=r.absMidsWaiting||[]).push(e)})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"+4HP":function(e,t,r){var i,a;i=[r.dj.c(e.i),t,r("zOht"),r("ma1f"),r("H1tY"),r("qsST"),r("LxLY"),r("qMld"),r("DJpR"),r("tI6k"),r("apbF"),r("AbdV"),r("/f24")],void 0===(a=(function(e,t,r,i,a,s,n,o,l,u,d,f,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AttributeStoreView=void 0;var c=s.getLogger("esri.views.2d.engine.webgl.AttributeStoreView"),h=f.createDebugLogger(f.DEBUG_ATTR_UPDATES,c),y=function(e){return 2147483647&e},v=!1,g=function(){function e(e,t,r){this._texture=null,this._lastTexture=null,this._fbos={},this.texelSize=4;var i=e.buffer,a=e.pixelType,s=e.textureOnly,o=d.getPixelArrayCtor(a);this.shared=r,this.pixelType=a,this.size=t,this.textureOnly=s,s||(this.data=new o(n.unwrap(i))),this._resetRange()}return e.prototype.destroy=function(){n.andThen(this._texture,(function(e){return e.dispose()}));var e=function(e){n.andThen(t._fbos[e],(function(t){"0"===e&&t.detachColorTexture(),t.dispose()})),t._fbos[e]=null},t=this;for(var r in this._fbos)e(r);this._texture=null},Object.defineProperty(e.prototype,"_textureDesc",{get:function(){return{target:3553,wrapMode:33071,pixelFormat:6408,dataType:this.pixelType,samplingMode:9728,width:this.size,height:this.size}},enumerable:!1,configurable:!0}),e.prototype.setData=function(e,t,r){var s=y(e),o=n.unwrap(this.data),l=s*this.texelSize+t;!o||l>=o.length?a("esri-2d-debug")&&!v&&(c.error(new i("mapview-attributeStore","Attempted to set out of bounds index")),v=!0):(o[l]=r,this.dirtyStart=Math.min(this.dirtyStart,s),this.dirtyEnd=Math.max(this.dirtyEnd,s))},e.prototype.getData=function(e,t){if(n.isNone(this.data))return null;var r=y(e)*this.texelSize+t;return!this.data||r>=this.data.length?(a("esri-2d-debug")&&!v&&(c.error(new i("mapview-attributeStore","Attempted to read out of bounds index")),v=!0),null):this.data[r]},e.prototype.getTexture=function(e){var t=this;return n.unwrapOr(this._texture,(function(){return t._initTexture(e)}))},e.prototype.getFBO=function(e,t){if(void 0===t&&(t=0),n.isNone(this._fbos[t])){var r=0===t?this.getTexture(e):this._textureDesc;this._fbos[t]=new p(e,{colorTarget:0,depthStencilTarget:0},r)}return this._fbos[t]},Object.defineProperty(e.prototype,"locked",{get:function(){return!(5121!==this.pixelType||!this.shared||this.textureOnly||!a("esri-atomics")||!this.data)&&1===Atomics.load(this.data,0)},enumerable:!1,configurable:!0}),e.prototype.updateTexture=function(e){if(!this.locked)try{var t=this.dirtyStart,r=this.dirtyEnd;if(t>r)return;this._resetRange();var a=n.unwrap(this.data).buffer,s=this.getTexture(e),o=(t-t%this.size)/this.size,l=o,u=(r-r%this.size)/this.size,f=o*this.size*4,p=4*(this.size+u*this.size)-f,h=d.getPixelArrayCtor(this.pixelType),y=h.BYTES_PER_ELEMENT;try{new h(a,f*y,p)}catch(e){console.debug(e)}var v=new h(a,f*y,p),g=this.size,m=u-l+1;if(m>this.size)return void c.error(new i("mapview-webgl","Out-of-bounds index when updating AttributeData"));s.updateData(0,0,l,g,m,v)}catch(e){console.debug(e)}},e.prototype.update=function(e){var t=e.data,r=e.start,i=e.end;if(n.isSome(t))for(var a=this.data,s=r*this.texelSize,o=0;o<t.length;o++)e.layout&1<<o%this.texelSize&&(a[s+o]=t[o]);this.dirtyStart=Math.min(this.dirtyStart,r),this.dirtyEnd=Math.max(this.dirtyEnd,i)},e.prototype.resize=function(e,t){var r=this.size;if(this.size=t,this.textureOnly)r!==this.size&&(this._lastTexture=this._texture,this._texture=null);else{var i=d.getPixelArrayCtor(this.pixelType);this.destroy(),this.data=new i(n.unwrap(e.buffer))}},e.prototype._resetRange=function(){this.dirtyStart=2147483647,this.dirtyEnd=0},e.prototype._initTexture=function(e){var t=new l.Texture(e,this._textureDesc,n.unwrapOr(this.data,void 0));if(n.isSome(this._lastTexture)&&this._fbos[0]){var r=this._lastTexture.descriptor.width,i=this._lastTexture.descriptor.height,a=this._lastTexture.descriptor.dataType,s=this._lastTexture.descriptor.pixelFormat,o=this.getFBO(e),u=d.getPixelBytes(a),f=new(d.getPixelArrayCtor(a))(new ArrayBuffer(r*i*u*this.texelSize)),p=e.getBoundFramebufferObject(),c=e.getViewport(),h=c.x,y=c.y,v=c.width,g=c.height;e.bindFramebuffer(o),o.readPixels(0,0,r,i,s,a,f),t.updateData(0,0,0,2*r,i/2,f),e.setViewport(h,y,v,g),e.bindFramebuffer(p)}return this.destroy(),this._texture=t,this._texture},e}(),m=function(){function e(){this._initialized=!1,this._forceNextUpload=!1,this._locked=!1}return e.prototype.initialize=function(e){var t=e.blocks,r=e.shared,i=e.size;if(this.shared=r,this.size=i,h("Initializing AttributeStoreView",e),n.isNone(this._data))this._data=n.mapMany(t,(function(e){return new g(e,i,r)}));else for(var a=0;a<this._data.length;a++){var s=this._data[a],o=t[a];n.isSome(o)&&(n.isNone(s)?this._data[a]=new g(o,i,r):s.resize(o,i))}this._initialized=!0},e.prototype.destroy=function(){n.andThen(this._data,(function(e){return n.mapMany(e,(function(e){return e.destroy()}))})),n.andThen(this._defaultTexture,(function(e){return e.dispose()}))},e.prototype.getBlock=function(e){return n.isNone(this._data)?null:this._data[e]},e.prototype.setLabelMinZoom=function(e,t){this.setData(e,0,1,t)},e.prototype.getLabelMinZoom=function(e){return this.getData(e,0,1,255)},e.prototype.getFilterFlags=function(e){return this.getData(e,0,0,0)},e.prototype.getVVSize=function(e){return this.getData(e,u.ATTRIBUTE_DATA_VV,0,0)},e.prototype.getData=function(e,t,r,i){if(!this._data)return 0;var a=n.unwrap(this._data)[t];if(n.isNone(a))return 0;var s=a.getData(e,r);return n.isSome(s)?s:i},e.prototype.setData=function(e,t,r,i){var a=n.unwrap(this._data)[t];n.unwrap(a).setData(e,r,i)},e.prototype.lockTextureUpload=function(){this._locked=!0},e.prototype.unlockTextureUpload=function(){this._locked=!1},e.prototype.forceTextureUpload=function(){this._forceNextUpload=!0},e.prototype.requestUpdate=function(e){return r.__awaiter(this,void 0,void 0,(function(){var t;return r.__generator(this,(function(r){return this._pendingAttributeUpdate?(c.error(new i("mapview-webgl","Tried to update attribute data with a pending update")),[2]):(t=o.createResolver(),h("AttributeStoreView Update Requested",e),this._pendingAttributeUpdate={data:e,resolver:t},[2,t.promise])}))}))},e.prototype.update=function(){if(this._initialized&&n.isSome(this._pendingAttributeUpdate)){for(var e=this._pendingAttributeUpdate,t=e.data,r=e.resolver,i=n.unwrap(this._data),a=function(e){var r=t.blocks[e];n.andThen(i[e],(function(t){return n.andThen(r,(function(r){h("Updating block "+e,r),t.update(r)}))}))},s=0;s<t.blocks.length;s++)a(s);this._pendingAttributeUpdate=null,r()}},e.prototype.bindTextures=function(e){this.update();var t=this._getDefaultTexture(e);if(!this._initialized)return e.bindTexture(t,u.TEXTURE_BINDING_ATTRIBUTE_DATA_0),e.bindTexture(t,u.TEXTURE_BINDING_ATTRIBUTE_DATA_1),e.bindTexture(t,u.TEXTURE_BINDING_ATTRIBUTE_DATA_2),void e.bindTexture(t,u.TEXTURE_BINDING_ATTRIBUTE_DATA_3);var r=n.unwrap(this._data);this._locked&&!this._forceNextUpload||(n.forEachSome(r,(function(t){return t.updateTexture(e)})),this._forceNextUpload=!1),e.bindTexture(n.mapOr(r[0],t,(function(t){return t.getTexture(e)})),u.TEXTURE_BINDING_ATTRIBUTE_DATA_0),e.bindTexture(n.mapOr(r[1],t,(function(t){return t.getTexture(e)})),u.TEXTURE_BINDING_ATTRIBUTE_DATA_1),e.bindTexture(n.mapOr(r[2],t,(function(t){return t.getTexture(e)})),u.TEXTURE_BINDING_ATTRIBUTE_DATA_2),e.bindTexture(n.mapOr(r[3],t,(function(t){return t.getTexture(e)})),u.TEXTURE_BINDING_ATTRIBUTE_DATA_3)},e.prototype._getDefaultTexture=function(e){return n.isNone(this._defaultTexture)&&(this._defaultTexture=new l.Texture(e,{wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array(4))),this._defaultTexture},e}();t.AttributeStoreView=m}).apply(null,i))||(e.exports=a)},"AP+j":function(e,t,r){var i,a;i=[r.dj.c(e.i),t,r("zOht"),r("zIqJ"),r("H1tY"),r("LxLY"),r("aMdW"),r("Zx0K"),r("W9tT"),r("ab6c"),r("tI6k"),r("SkDs"),r("Sq9p"),r("JNkf"),r("qe2g"),r("gi5q"),r("xxo4")],void 0===(a=(function(e,t,r,i,a,s,n,o,l,u,d,f,p,c,h,y,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WGLTile=void 0;var g=new Set,m=function(e){function t(t,r,a){void 0===a&&(a=!1);var s=e.call(this,t,r,[d.TILE_SIZE,d.TILE_SIZE])||this;return s._data=null,s._displayList=null,s._wglBuffers=null,s._deferPatches=!1,s._dirtyMap=new f.default,s._labelIndex=null,s._lastCommitTime=0,s._patchQueue=new i.default(100),s.fader=new h.default,s._dirty=!0,s._replaceBuffers=!1,s._uploadsLocked=!1,s._hasData=!1,s._invalidated=!1,s.transforms.labelMat2d=o.mat2df32.create(),s._ensureCorrectZOrder=a,s._deferPatches=!a,s}return r.__extends(t,e),t.prototype.destroy=function(){e.prototype.destroy.call(this),this.clear()},Object.defineProperty(t.prototype,"displayObjects",{get:function(){var e;return null!==(e=this._displayObjects)&&void 0!==e?e:[]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isDirty",{get:function(){return this._dirty},set:function(e){this._dirty=e,this.requestRender()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasData",{get:function(){return!!this._hasData},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"labelIndex",{get:function(){return this._labelIndex},enumerable:!1,configurable:!0}),t.prototype.getGeometry=function(e){return this._wglBuffers&&this._wglBuffers.has(e)?this._wglBuffers.get(e):null},t.prototype.getDisplayList=function(){return this._displayList},t.prototype.setTransform=function(t,r){e.prototype.setTransform.call(this,t,r);var i=this.transforms.labelMat2d,a=t.getScreenTransform(i,r),s=u.vec2f32.create();l.vec2.transformMat2d(s,this.coords,a),n.mat2d.identity(i),n.mat2d.translate(i,i,s),n.mat2d.multiply(i,t.viewMat2d,i)},t.prototype.setData=function(e){var t=e.addOrUpdate,r=e.remove;e.clear&&(this.clear(),this._patchQueue.clear(),this._hasData=!1),"replace"===e.type&&(this._replaceBuffers=!0,this._patchQueue.clear(),this._data=null),!this._data&&t&&t.tileDisplayData.displayObjects.length?(t.tileDisplayData.computeDisplayList(this._ensureCorrectZOrder),this._dirtyMap=new f.default,this._dispRecStore=p.default.fromTileData(t,this._dirtyMap),this._data=t,this._dirtyMap.markAllDirty(),this._hasData=!0,e.end&&this.ready()):this._data&&(t&&t.tileDisplayData.displayObjects.length||r.length)?this._deferPatches?this._patchQueue.enqueue(e):this._doPatchData(e):e.end&&this.ready(),e.end&&!this._data&&this.clear(),this.requestRender(),this.emit("change")},t.prototype.lockUploads=function(){this._uploadsLocked=!0},t.prototype.unlockUploads=function(){this._uploadsLocked=!1,this.requestRender()},t.prototype.commitChanges=function(e){if(!e.time||e.time!==this._lastCommitTime){if(this._lastCommitTime=e.time,this.fader.step()||this.requestRender(),this._patchQueue.size){var t=this._patchQueue.dequeue();s.isSome(t)&&(t.end&&this.ready(),this._doPatchData(t),this.requestRender(),this._hasData=!0)}if(this._uploadsLocked)this.requestRender();else if(this.visible&&this._data){if(this._replaceBuffers)for(this._wglBuffers&&this._wglBuffers.dispose(),this._wglBuffers=null,this._replaceBuffers=!1;this._patchQueue.size;)t=this._patchQueue.dequeue(),s.isSome(t)&&(t.end&&this.ready(),this._doPatchData(t),this._hasData=!0);this._wglBuffers||(this._wglBuffers=new v.default(e.context)),(this._dirtyMap.hasDirty()||this._invalidated)&&(this._invalidated=!1,this._wglBuffers.upload(this._data.tileBufferData,this._dirtyMap),this._displayList=this._data.tileDisplayData.displayList.clone(),this._displayObjects=this._data.tileDisplayData.displayObjects.slice(),this._rebuildLabelIndex(),this._dirtyMap.markAllClean())}}},t.prototype.clear=function(){this._data=null,this._displayList=null,this._dispRecStore=null,this._wglBuffers&&(this._wglBuffers.dispose(),this._wglBuffers=null)},t.prototype._doPatchData=function(e){try{if("new"===e.type){if(!e.addOrUpdate)return;this._invalidated=!0;var t=this._bulkAddFeatures(e);t&&(this._dirtyMap.markAllDirty(),this._data.reshuffleV2(e,t.objectIndex,t.recordIndex),this._dispRecStore=p.default.fromTileData(this._data,this._dirtyMap))}else this._invalidated=!0,this._patchData(e)||(this._dirtyMap.markAllDirty(),this._data.reshuffle(),this._dispRecStore=p.default.fromTileData(this._data,this._dirtyMap))}catch(e){a("esri-2d-debug")&&console.debug("Encountered an error while patching:",e)}this.requestRender()},t.prototype._rebuildLabelIndex=function(){var e,t;if(null===(t=null===(e=this._data)||void 0===e?void 0:e.tileBufferData.geometries[c.WGLGeometryType.LABEL])||void 0===t?void 0:t.indexBuffer.length){this.isDirty=!0,this._labelIndex=this._initLabelIndex();for(var r=0,i=this.displayObjects;r<i.length;r++)for(var a=0,s=i[r].metrics;a<s.length;a++)this._insertIntoLabelIndex(s[a])}},t.prototype._insertIntoLabelIndex=function(e){e.xBucket<0||e.yBucket<0||e.yBucket>3||e.xBucket>3||this.labelIndex[e.yBucket][e.xBucket].push(e)},t.prototype._initLabelIndex=function(){for(var e=[],t=0;t<d.TILE_SIZE/d.COLLISION_BUCKET_SIZE;t++){e.push([]);for(var r=0;r<d.TILE_SIZE/d.COLLISION_BUCKET_SIZE;r++)e[t].push([])}return e},t.prototype._bulkAddFeatures=function(e){for(var t=e.addOrUpdate.tileDisplayData.displayObjects,r=this._data.tileDisplayData.displayObjects,i=0;i<t.length;i++){for(var a=t[i],s=0;s<a.displayRecords.length;++s){var n=a.displayRecords[s];if(!this._dispRecStore.tryAddMeshData(n,e.addOrUpdate.tileBufferData.geometries[n.geometryType]))return{objectIndex:i,recordIndex:s}}this._data.tileDisplayData.hasRegistry&&this._data.tileDisplayData.displayObjectRegistry.set(a.id,a),r.push(a)}return null},t.prototype._patchData=function(e){for(var t=!0,r=e.addOrUpdate&&e.addOrUpdate.tileDisplayData&&e.addOrUpdate.tileDisplayData.displayObjects||[],i=(e.remove||[]).slice(),a=0,s=r;a<s.length;a++)null!=(y=s[a]).insertAfter&&i.push(y.id);for(var n=0,o=i;n<o.length;n++){var l=o[n];if(h=this._data.tileDisplayData.displayObjectRegistry.get(l)){this._data.tileDisplayData.displayList.removeFromList(h.displayRecords);for(var u=0,d=h.displayRecords;u<d.length;u++)this._dispRecStore.delete(d[u]);this._data.tileDisplayData.displayObjectRegistry.delete(l);var f=this._data.tileDisplayData.displayObjects.indexOf(h);this._data.tileDisplayData.displayObjects.splice(f,1)}}for(var p=0,c=r;p<c.length;p++){var h,y=c[p],v=void 0;if(h=this._data.tileDisplayData.displayObjectRegistry.get(y.id)){var m=h.displayRecords;h.set(y),h.displayRecords=m;for(var _=h.displayRecords.length,x=0;x<_;++x){var b=h.displayRecords[x],D=y.displayRecords[x];(x>=y.displayRecords.length||b.geometryType!==D.geometryType||b.symbolLevel!==D.symbolLevel||b.zOrder!==D.zOrder||b.materialKey!==D.materialKey)&&(this._dispRecStore.delete(h.displayRecords[x]),x<y.displayRecords.length&&(h.displayRecords[x]=void 0))}h.displayRecords.length=y.displayRecords.length,h.metrics=y.metrics}else{(h=y.copy()).displayRecords=[],this._data.tileDisplayData.displayObjectRegistry.set(y.id,h);var T=void 0,B=this._data.tileDisplayData.displayObjects;if(null!=h.insertAfter)if(v={},h.insertAfter>=0){var L=this._data.tileDisplayData.displayObjectRegistry.get(h.insertAfter);L&&(T=B.indexOf(L)+1)<B.length?B.splice(T,0,h):(B.push(h),T=B.length)}else B.unshift(h),T=0;else B.push(h),T=B.length;if(v){var w=void 0;if(this._data.tileDisplayData.displayList.unified)w=y.displayRecords.length>0?1:0;else{g.clear();for(var R=0,F=y.displayRecords;R<F.length;R++){var O=this._data.tileDisplayData.displayList.getDPInfoType(F[R].geometryType);g.add(O)}w=g.size}var I=0;for(x=T-1;x>=0&&I<w;--x)for(var C=B[x].displayRecords.length-1;C>=0&&I<w;--C){var A=B[x].displayRecords[C];v[O=this._data.tileDisplayData.displayList.getDPInfoType(A.geometryType)]||(v[O]=A,++I)}}}var M=y.displayRecords.length;for(x=0;x<M;++x){D=y.displayRecords[x],(b=h.displayRecords[x])?(b.meshData=D.meshData,b.materialKey=D.materialKey):((b=D.copy()).vertexFrom=void 0,b.indexFrom=void 0,h.displayRecords[x]=b);var j=D.geometryType,z=(O=this._data.tileDisplayData.displayList.getDPInfoType(j),e.addOrUpdate.tileBufferData.geometries[j]),S=z.vertexBuffer,E=z.indexBuffer,P=void 0;v&&(P=v[O]?this._data.tileDisplayData.displayList.splitAfter(v[O]):-1),t=this._dispRecStore.setMeshData(b,D,S,E,P)&&t,v&&null!=b.indexFrom&&null!=b.indexFrom&&(v[O]=b)}}return t},t}(y.TiledDisplayObject);t.WGLTile=m}).apply(null,i))||(e.exports=a)},AwqN:function(e,t,r){var i,a;i=[r.dj.c(e.i),t],void 0===(a=(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._byGeometryType=null}return Object.defineProperty(e.prototype,"satisfied",{get:function(){return!this._byGeometryType},enumerable:!1,configurable:!0}),e.prototype.reset=function(){this._byGeometryType=null},e.prototype.verticesFor=function(e){return this._byGeometryType?this._byGeometryType[e].vertices:0},e.prototype.indicesFor=function(e){return this._byGeometryType?this._byGeometryType[e].indices:0},e.prototype.needMore=function(e,t,r){if(t||r){this._byGeometryType||(this._byGeometryType=[{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0}]);var i=this._byGeometryType[e];i.vertices+=t,i.indices+=r}},e}();t.default=r}).apply(null,i))||(e.exports=a)},Dikz:function(e,t,r){var i,a;i=[r.dj.c(e.i),t,r("zOht"),r("qsST"),r("JNkf")],void 0===(a=(function(e,t,r,i,a){"use strict";var s=i.getLogger("esri.views.2d.engine.webgl.WGLDisplayList");function n(e,t,i){for(var a=[],s=3;s<arguments.length;s++)a[s-3]=arguments[s];t<e.length?e.splice.apply(e,r.__spreadArrays([t,i],a)):e.push.apply(e,a)}var o=new Map;o.set(a.WGLDrawPhase.MAP,[a.WGLGeometryType.FILL,a.WGLGeometryType.LINE,a.WGLGeometryType.MARKER,a.WGLGeometryType.TEXT]),o.set(a.WGLDrawPhase.LABEL,[a.WGLGeometryType.LABEL]),o.set(a.WGLDrawPhase.LABEL_ALPHA,[a.WGLGeometryType.LABEL]);var l=function(){function e(e){void 0===e&&(e=!1),this.symbolLevels=[],this.unified=e}return e.prototype.replay=function(e,t,r){if(this.unified)for(var i=0,a=this.symbolLevels;i<a.length;i++)for(var s=0,n=a[i].zLevels;s<n.length;s++){var o=n[s].geometryDPInfo;for(var l in o)if(o[l])for(var u=0,d=o[l];u<d.length;u++){var f=d[u],p=e.painter.getGeometryBrush(f.geometryType),c=t.getGeometry(f.geometryType);p.prepareState(e,t),p.drawGeometry(e,t,f,c,r)}}},Object.defineProperty(e.prototype,"empty",{get:function(){return!this.symbolLevels||0===this.symbolLevels.length},enumerable:!1,configurable:!0}),e.prototype.clear=function(){this.symbolLevels.length=0},e.prototype.addToList=function(e,t){if(Array.isArray(e))for(var r=0,i=e;r<i.length;r++)this._addToList(i[r],t);else this._addToList(e,t)},e.prototype.removeFromList=function(e){Array.isArray(e)||(e=[e]);for(var t=null,r=0,i=e;r<i.length;r++)t=this._removeFromList(i[r]);return t},e.prototype.byType=function(e,t){for(var r=0,i=this.symbolLevels;r<i.length;r++)for(var a=0,s=i[r].zLevels;a<s.length;a++){var n=s[a].geometryDPInfo,o=this.getDPInfoType(e);if(n[o])for(var l=0,u=n[o];l<u.length;l++)t(u[l])}},e.prototype.clone=function(){for(var t=new e(this.unified),r=0,i=this.symbolLevels;r<i.length;r++)t.symbolLevels.push(i[r].clone());return t},e.prototype.splitAfter=function(e){for(var t=this._getDisplayList(e.symbolLevel,e.zOrder,e.geometryType),r=t.length,i=e.indexFrom+e.indexCount,a=0;a<r;++a){var s=t[a];if(s.geometryType===e.geometryType&&i>s.indexFrom&&i<=s.indexFrom+s.indexCount){if(i<s.indexFrom+s.indexCount){var n=new u;n.geometryType=s.geometryType,n.materialKey=s.materialKey,n.indexFrom=i,n.indexCount=s.indexFrom+s.indexCount-i,t.splice(a+1,0,n),s.indexCount=i-s.indexFrom}return a}}},e.prototype._addToList=function(e,t){var r=this._getDisplayList(e.symbolLevel,e.zOrder,e.geometryType),i=null!=t?t:r.length-1,a=i>=0&&i<r.length?r[i]:null;if(null===a||a.materialKey!==e.materialKey||a.indexFrom+a.indexCount!==e.indexFrom||this.unified&&a.geometryType!==e.geometryType){var s=new u;s.indexFrom=e.indexFrom,s.indexCount=e.indexCount,s.materialKey=e.materialKey,s.geometryType=e.geometryType,n(r,i+1,0,s)}else a.indexCount+=e.indexCount},e.prototype._removeFromList=function(e){for(var t=this._getDisplayList(e.symbolLevel,e.zOrder,e.geometryType),r=t.length,i=void 0,a=0;a<r;++a){var s=t[a];if(e.indexFrom+e.indexCount>s.indexFrom&&e.indexFrom<s.indexFrom+s.indexCount&&(!this.unified||s.geometryType===e.geometryType)){i=a;break}}if(void 0!==i){if(e.indexFrom===(s=t[i]).indexFrom)return s.indexCount-=e.indexCount,s.indexFrom+=e.indexCount,0===s.indexCount&&n(t,i,1),i-1;if(e.indexFrom+e.indexCount===s.indexFrom+s.indexCount)return s.indexCount-=e.indexCount,0===s.indexCount?(n(t,i,1),i-1):i;var o=s.indexFrom,l=e.indexFrom-s.indexFrom,d=e.indexCount,f=s.indexFrom+s.indexCount-(e.indexFrom+e.indexCount);s.indexCount=l;var p=new u;return p.geometryType=s.geometryType,p.materialKey=s.materialKey,p.indexFrom=o+l+d,p.indexCount=f,n(t,i+1,0,p),i}return null},e.prototype._getDisplayList=function(e,t,r){for(var i,s,n=this.symbolLevels.length,o=0;o<n;o++)if(this.symbolLevels[o].symbolLevel===e){i=this.symbolLevels[o];break}i||((i=new p).symbolLevel=e,this.symbolLevels.push(i));for(var l,u=i.zLevels.length,c=0;c<u;c++)if(i.zLevels[c].zLevel===t){s=i.zLevels[c];break}if(s||((s=new f).geometryDPInfo=new d,s.zLevel=t,i.zLevels.push(s)),this.unified)s.geometryDPInfo.unified||(s.geometryDPInfo.unified=[]),l=s.geometryDPInfo.unified;else switch(r){case a.WGLGeometryType.FILL:s.geometryDPInfo.fill||(s.geometryDPInfo.fill=[]),l=s.geometryDPInfo.fill;break;case a.WGLGeometryType.LINE:s.geometryDPInfo.line||(s.geometryDPInfo.line=[]),l=s.geometryDPInfo.line;break;case a.WGLGeometryType.MARKER:s.geometryDPInfo.marker||(s.geometryDPInfo.marker=[]),l=s.geometryDPInfo.marker;break;case a.WGLGeometryType.TEXT:s.geometryDPInfo.text||(s.geometryDPInfo.text=[]),l=s.geometryDPInfo.text;break;case a.WGLGeometryType.LABEL:s.geometryDPInfo.label||(s.geometryDPInfo.label=[]),l=s.geometryDPInfo.label;break;default:console.error("Trying to add a record with geometry type '"+r+"'.")}return l},e.prototype.getDPInfoType=function(e){if(this.unified)return"unified";switch(e){case a.WGLGeometryType.FILL:return"fill";case a.WGLGeometryType.LINE:return"line";case a.WGLGeometryType.MARKER:return"marker";case a.WGLGeometryType.TEXT:return"text";case a.WGLGeometryType.LABEL:return"label";default:return void s.error("DisplayList: Tried to convert unknown geometryType: "+e)}},e}(),u=function(){function e(){this.materialKey=null,this.indexFrom=0,this.indexCount=0}return e.prototype.clone=function(){var t=new e;return t.geometryType=this.geometryType,t.materialKey=this.materialKey,t.indexFrom=this.indexFrom,t.indexCount=this.indexCount,t},e}(),d=function(){function e(){this.fill=null,this.line=null,this.marker=null,this.text=null,this.label=null,this.unified=null}return e.prototype.clone=function(){var t=new e;return t.fill=this.fill&&this.fill.map((function(e){return e.clone()})),t.line=this.line&&this.line.map((function(e){return e.clone()})),t.marker=this.marker&&this.marker.map((function(e){return e.clone()})),t.text=this.text&&this.text.map((function(e){return e.clone()})),t.label=this.label&&this.label.map((function(e){return e.clone()})),t.unified=this.unified&&this.unified.map((function(e){return e.clone()})),t},e}(),f=function(){function e(){this.geometryDPInfo=new d}return e.prototype.clone=function(){var t=new e;return t.zLevel=this.zLevel,t.geometryDPInfo=this.geometryDPInfo.clone(),t},e}(),p=function(){function e(){this.zLevels=[]}return e.prototype.clone=function(){var t=new e;t.symbolLevel=this.symbolLevel;for(var r=0,i=this.zLevels;r<i.length;r++)t.zLevels.push(i[r].clone());return t},e}();return l}).apply(null,i))||(e.exports=a)},"N0+q":function(e,t,r){var i,a;i=[r.dj.c(e.i),t,r("zOht"),r("qMld"),r("qMld"),r("ClbQ"),r("lRq4"),r("+4HP"),r("wUCb"),r("rYkQ"),r("oDRR"),r("AP+j")],void 0===(a=(function(e,t,r,i,a,s,n,o,l,u,d,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FeatureContainer=void 0;var p=function(e){function t(t){var r=e.call(this,t)||this;return r._rendererInfo=new d.WGLRendererInfo,r._materialItemsRequestQueue=new s.default,r.attributeView=new o.AttributeStoreView,r}return r.__extends(t,e),t.prototype.destroy=function(){this.removeAllChildren(),this.children.forEach((function(e){return e.destroy()})),this.attributeView.destroy(),this._materialItemsRequestQueue.clear()},t.prototype.setRendererInfo=function(e,t,r){this._rendererInfo.setInfo(e,t,r),this.requestRender()},t.prototype.getMaterialItems=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var a;return r.__generator(this,(function(r){return e&&0!==e.length?(a=i.createResolver(),this._materialItemsRequestQueue.push({items:e,abortOptions:t,resolver:a}),this.requestRender(),[2,a.promise]):[2,null]}))}))},t.prototype.onTileData=function(e,t){if(t.addOrUpdate&&"tileDisplayData"in t.addOrUpdate)e.setData(t);else{var i=t.addOrUpdate&&u.TileData.decode(t.addOrUpdate),a=r.__assign(r.__assign({},t),{addOrUpdate:i});e.setData(a)}this.contains(e)||this.addChild(e),this.requestRender()},t.prototype.onTileError=function(e){e.clear(),this.contains(e)||this.addChild(e)},t.prototype.doRender=function(t){if(this._materialItemsRequestQueue.length>0)for(var r=this._materialItemsRequestQueue.pop();r;)this._processMaterialItemRequest(t,r),r=this._materialItemsRequestQueue.pop();e.prototype.doRender.call(this,t)},t.prototype.renderChildren=function(t){for(var r=0,i=this.children;r<i.length;r++)i[r].commitChanges(t);this._rendererInfo.update(t.state),this.attributeView.bindTextures(t.context),e.prototype.renderChildren.call(this,t)},t.prototype.createTile=function(e){var t=this._tileInfoView.getTileBounds(n.create(),e);return new f.WGLTile(e,t)},t.prototype.destroyTile=function(e){this.removeChild(e),e.destroy()},t.prototype.createRenderParams=function(t){return r.__assign(r.__assign({},e.prototype.createRenderParams.call(this,t)),{rendererInfo:this._rendererInfo,attributeView:this.attributeView})},t.prototype._processMaterialItemRequest=function(e,t){var r=this,i=t.items,s=t.abortOptions,n=t.resolver,o=e.painter,l=e.pixelRatio,u=i.map((function(e){return o.textureManager.rasterizeItem(e.symbol,l,e.glyphIds,s)}));a.all(u).then((function(e){if(r.stage){var t=e.map((function(e,t){return{id:i[t].id,mosaicItem:e}}));n.resolve(t)}else n.reject()}),n.reject)},t}(l.default);t.FeatureContainer=p}).apply(null,i))||(e.exports=a)},PwbG:function(e,t,r){var i,a;i=[r.dj.c(e.i),t,r("apbF")],void 0===(a=(function(e,t,r){"use strict";return function(){function e(){this.geometries=[{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}}]}return e.prototype.clone=function(){for(var t=new e,r=0;r<this.geometries.length;r++){var i=this.geometries[r],a=t.geometries[r];for(var s in a.indexBuffer=i.indexBuffer.slice(),a.vertexBuffer={},i.vertexBuffer){var n=i.vertexBuffer[s],o=n.stride;a.vertexBuffer[s]={data:n.data.slice(),stride:o}}}return t},e.deserialize=function(t){for(var i=new e,a=0;a<5;++a)for(var s in i.geometries[a].indexBuffer=new Uint32Array(t.geometries[a].indexBuffer),i.geometries[a].vertexBuffer={},t.geometries[a].vertexBuffer)i.geometries[a].vertexBuffer[s]={data:r.allocateTypedArrayBufferwithData(t.geometries[a].vertexBuffer[s].data,t.geometries[a].vertexBuffer[s].stride),stride:t.geometries[a].vertexBuffer[s].stride};return i},e.prototype.serialize=function(){for(var e={geometries:[{indexBuffer:this.geometries[0].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[1].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[2].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[3].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[4].indexBuffer.buffer,vertexBuffer:{}}]},t=0;t<5;++t)for(var r in this.geometries[t].vertexBuffer)e.geometries[t].vertexBuffer[r]={data:this.geometries[t].vertexBuffer[r].data.buffer,stride:this.geometries[t].vertexBuffer[r].stride};return e},e.prototype.getBuffers=function(){for(var e=[],t=0;t<5;++t)for(var r in e.push(this.geometries[t].indexBuffer.buffer),this.geometries[t].vertexBuffer)e.push(this.geometries[t].vertexBuffer[r].data.buffer);return e},e}()}).apply(null,i))||(e.exports=a)},SkDs:function(e,t,r){var i,a;i=[r.dj.c(e.i),t,r("apbF")],void 0===(a=(function(e,t,r){"use strict";function i(e,t,r){if(!e.allDirty)if(null!=e.from&&null!=e.count){var i=Math.min(e.from,t),a=Math.max(e.from+e.count,t+r)-i;e.from=i,e.count=a}else e.from=t,e.count=r}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){this._dirties=r.createGeometryData((function(){return{indices:{from:null,count:null,allDirty:!1}}}),(function(){return{vertices:{from:null,count:null,allDirty:!1}}}))}return e.prototype.hasDirty=function(){for(var e=0,t=this._dirties;e<t.length;e++){var r=t[e];if(null!==r.data.indices.count||r.data.indices.allDirty)return!0}return!1},e.prototype.markAllClean=function(){for(var e=0,t=this._dirties;e<t.length;e++){var r=t[e];for(var i in r.data.indices.from=null,r.data.indices.count=null,r.data.indices.allDirty=!1,r.buffers)r.buffers[i].data.vertices.from=null,r.buffers[i].data.vertices.count=null,r.buffers[i].data.vertices.allDirty=!1}},e.prototype.markAllDirty=function(){for(var e=0,t=this._dirties;e<t.length;e++){var r=t[e];for(var i in r.data.indices.allDirty=!0,r.buffers)r.buffers[i].data.vertices.allDirty=!0}},e.prototype.forEach=function(e){for(var t=0;t<this._dirties.length;++t){var r=this._dirties[t],i={};for(var a in r.buffers){var s=r.buffers[a].data.vertices;(s.allDirty||null!=s.from&&null!=s.count&&s.count>0)&&(i[a]=s)}var n,o=r.data.indices;((n=o.allDirty||null!=o.from&&null!=o.count&&o.count>0?{indices:o,vertices:i}:{indices:null,vertices:i}).indices||Object.keys(n).length>0)&&e(n,t)}},e.prototype.markDirtyIndices=function(e,t,r){i(this._dirties[e].data.indices,t,r)},e.prototype.markDirtyVertices=function(e,t,r,a){i(this._dirties[e].buffers[t].data.vertices,r,a)},e}();t.default=a}).apply(null,i))||(e.exports=a)},Sq9p:function(e,t,r){var i,a;i=[r.dj.c(e.i),t,r("H1tY"),r("Zry2"),r("apbF")],void 0===(a=(function(e,t,r,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=["FILL","LINE","MARKER","TEXT","LABEL"],n=function(){function e(e,t,r,s){for(var n in this._strides=e,this._displayList=t,this._freeListsAndStorage={},this._dirtyMap=null,this._dirtyMap=r,e)for(var o in this._freeListsAndStorage[n]={vtxFreeList:s?new i.FreeList(s):null,idxFreeList:s?new i.FreeList(s):null,vertexBuffers:{},indexBuffer:s?new Uint32Array(s):null},e[n])this._freeListsAndStorage[n].vertexBuffers[o]={data:s?a.allocateTypedArrayBuffer(s,e[n][o]):null,stride:e[n][o]}}return e.fromTileData=function(t,r){for(var n=function(e){for(var t=e.getStrides(),r={},i=0;i<t.length;i++)r[s[i]]=t[i];return r}(t),o=[0,0,0,0,0],l=[0,0,0,0,0],u=0,d=t.tileDisplayData.displayObjects;u<d.length;u++)for(var f=0,p=d[u].displayRecords;f<p.length;f++){var c=p[f];o[c.geometryType]=Math.max(o[c.geometryType],c.vertexFrom+c.vertexCount),l[c.geometryType]=Math.max(l[c.geometryType],c.indexFrom+c.indexCount)}for(var h=new e(n,t.tileDisplayData.displayList,r,null),y=0;y<t.tileBufferData.geometries.length;++y){var v=o[y],g=l[y],m=t.tileBufferData.geometries[y],_=h._storageFor(s[y]),x=t.tileBufferData.geometries[y].indexBuffer;_.indexBuffer=x,_.idxFreeList=new i.FreeList(x.length),_.idxFreeList.allocate(g);var b=void 0;for(var D in m.vertexBuffer){var T=t.tileBufferData.geometries[y].vertexBuffer[D];_.vertexBuffers[D].data=T.data,_.vertexBuffers[D].stride=T.stride;var B=a.strideToPackingFactor(T.stride);b||(b=T.data.length*B/T.stride)}_.vtxFreeList=new i.FreeList(b),_.vtxFreeList.allocate(v)}return h},e.prototype.delete=function(e){var t=s[e.geometryType];this._freeVertices(t,e.vertexFrom,e.vertexCount),this._freeIndices(t,e.indexFrom,e.indexCount),this._displayList.removeFromList(e),e.vertexFrom=void 0,e.indexFrom=void 0},e.prototype.setMeshData=function(e,t,r,i,n){var o=s[e.geometryType];e.meshData=null;var l=void 0,u=void 0;void 0===e.vertexFrom?l=this._allocateVertices(o,u=t.vertexCount):t.vertexCount>e.vertexCount?(this._freeVertices(o,e.vertexFrom,e.vertexCount),l=this._allocateVertices(o,u=t.vertexCount)):t.vertexCount===e.vertexCount?(l=e.vertexFrom,u=e.vertexCount):(this._freeVertices(o,e.vertexFrom+t.vertexCount,e.vertexCount-t.vertexCount),l=e.vertexFrom,u=t.vertexCount);var d=!0,f=void 0,p=void 0,c=void 0;if(void 0===e.indexFrom?(f=n,p=this._allocateIndices(o,c=t.indexCount)):t.indexCount>e.indexCount?(f=this._displayList.removeFromList(e),this._freeIndices(o,e.indexFrom,e.indexCount),p=this._allocateIndices(o,c=t.indexCount)):t.indexCount===e.indexCount?(d=!1,p=e.indexFrom,c=e.indexCount):(f=this._displayList.removeFromList(e),this._freeIndices(o,e.indexFrom+t.indexCount,e.indexCount-t.indexCount),p=e.indexFrom,c=t.indexCount),-1!==l&&-1!==p){var h=this._storageFor(o);if(a.copyMeshData(l,p,h.vertexBuffers,h.indexBuffer,t,r,i),e.vertexFrom=l,e.indexFrom=p,e.vertexCount=t.vertexCount,e.indexCount=t.indexCount,this._dirtyMap)for(var y in this._dirtyMap.markDirtyIndices(e.geometryType,e.indexFrom,e.indexCount),r)this._dirtyMap.markDirtyVertices(e.geometryType,y,e.vertexFrom,e.vertexCount);return d&&this._displayList.addToList(e,f),!0}return-1!==l&&this._freeVertices(o,l,u),-1!==p&&this._freeIndices(o,p,c),e.setMeshDataFromBuffers(t,r,i),e.vertexFrom=void 0,e.vertexCount=0,e.indexFrom=void 0,e.indexCount=0,!1},e.prototype.tryAddMeshData=function(e,t){var r=t.vertexBuffer,i=t.indexBuffer,n=s[e.geometryType],o=this._allocateVertices(n,e.vertexCount);if(-1===o)return this._freeVertices(n,o,e.vertexCount),!1;var l=this._allocateIndices(n,e.indexCount);if(-1===l)return this._freeVertices(n,o,e.vertexCount),this._freeIndices(n,l,e.indexCount),!1;var u=this._storageFor(n);if(a.copyMeshData(o,l,u.vertexBuffers,u.indexBuffer,e,r,i),e.vertexFrom=o,e.indexFrom=l,this._dirtyMap)for(var d in this._dirtyMap.markDirtyIndices(e.geometryType,e.indexFrom,e.indexCount),r)this._dirtyMap.markDirtyVertices(e.geometryType,d,o,e.vertexCount);return this._displayList.addToList(e),!0},e.prototype._allocateVertices=function(e,t){var r=this._storageFor(e),i=r.vtxFreeList.allocate(t);return-1===i||r.vtxFreeList.fragmentation>.5?-1:i},e.prototype._freeVertices=function(e,t,i){var s=this._storageFor(e);if(s.vtxFreeList.free(t,i),r("esri-feature-tiles-debug"))for(var n in s.vertexBuffers)for(var o=s.vertexBuffers[n].data,l=this._stridesFor(e,n),u=a.strideToPackingFactor(l),d=t*l/u,f=i*l/u,p=d;p<d+f;++p)o[p]=0},e.prototype._freeIndices=function(e,t,i){var a=this._storageFor(e);if(a.idxFreeList.free(t,i),r("esri-feature-tiles-debug"))for(var s=a.indexBuffer,n=t;n<t+i;++n)s[n]=0},e.prototype._allocateIndices=function(e,t){var r=this._storageFor(e),i=r.idxFreeList.allocate(t);return-1===i||r.idxFreeList.fragmentation>.5?-1:i},e.prototype._storageFor=function(e){return this._freeListsAndStorage[e]},e.prototype._stridesFor=function(e,t){return this._strides[e][t]},e}();t.default=n}).apply(null,i))||(e.exports=a)},Zry2:function(e,t,r){var i,a;i=[r.dj.c(e.i),t],void 0===(a=(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FreeList=void 0;var r=function(){function e(e){this._largestRange=null,this._parent=e,this._updateLargestRange()}return Object.defineProperty(e.prototype,"largestRange",{get:function(){return this._largestRange},enumerable:!1,configurable:!0}),e.prototype.rangeCreated=function(e){(!this._largestRange||e.count>this._largestRange.count)&&(this._largestRange=e)},e.prototype.rangeResized=function(e,t){e===this._largestRange?e.count<t&&this._updateLargestRange():(!this._largestRange||e.count>this._largestRange.count)&&(this._largestRange=e)},e.prototype.findBestRange=function(e){for(var t=this._parent._freeHead,r=null;null!==t;)t.count>=e&&(!r||t.count-e<r.count-e)&&(r=t),t=t.next;return r},e.prototype.findAdjacentRanges=function(e,t){for(var r=!0,i=!1,a=null,s=this._parent._freeHead;r&&!i;)e>=(null!==a?a.from+a.count:0)&&e+t<=(null!==s?s.from:this._parent._size)?(r=!1,i=!0):null!==s?(a=s,s=s.next):r=!1;return[a,s]},e.prototype._updateLargestRange=function(){for(var e=null,t=this._parent._freeHead;null!==t;)(!e||t.count>e.count)&&(e=t),t=t.next;this._largestRange=e},e}(),i=function(){function e(e,t){this._allocated=0,this._size=e,this._freeHead=e>0?{from:0,count:e,prev:null,next:null}:null,this._bookKeeper=t||new r(this),this._freeHead&&this._bookKeeper.rangeCreated(this._freeHead)}return e.prototype.allocate=function(t){var r=this._bookKeeper.findBestRange(t);if(null===r)return-1;var i=r.from,a=r.count;if(r.from+=t,r.count-=t,this._bookKeeper.rangeResized(r,i,a),this._allocated+=t,0===r.count){var s=null!==r.prev?this._freeHead:r.next;e._removeRange(r),this._freeHead=s}return i},e.prototype.free=function(t,r){var i=this._bookKeeper.findAdjacentRanges(t,r),a=i[0],s=i[1],n={from:t,count:r,prev:a,next:s};if(null!==a&&(a.next=n),null!==s&&(s.prev=n),this._bookKeeper.rangeCreated(n),this._allocated-=r,null!==s&&n.from+n.count===s.from){var o=n.from,l=n.count;e._fuse(n,s),e._removeRange(s),this._bookKeeper.rangeResized(n,o,l),this._bookKeeper.rangeResized(s,void 0,0)}null!==a&&a.from+a.count===n.from&&(o=a.from,l=a.count,e._fuse(a,n),e._removeRange(n),this._bookKeeper.rangeResized(a,o,l),this._bookKeeper.rangeResized(n,void 0,0)),this._freeHead=null!==n.prev?this._freeHead:n},Object.defineProperty(e.prototype,"fragmentation",{get:function(){var e=this._size-this._allocated;return 0===e?0:1-this._bookKeeper.largestRange.count/e},enumerable:!1,configurable:!0}),e._removeRange=function(e){null!==e.prev?null!==e.next?(e.prev.next=e.next,e.next.prev=e.prev):e.prev.next=null:null!==e.next&&(e.next.prev=null)},e._fuse=function(e,t){e.count+=t.count,e.next=t.next,t.from+=t.count,t.count=0,null!==t.next&&(t.next.prev=e)},e}();t.FreeList=i}).apply(null,i))||(e.exports=a)},gi5q:function(e,t,r){var i,a;i=[r.dj.c(e.i),t,r("zOht"),r("H1tY"),r("YX1r"),r("lgZd"),r("Brhx"),r("f3JK")],void 0===(a=(function(e,t,r,i,a,s,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TiledDisplayObject=void 0;var l=function(e){function t(t,r,i,a){void 0===a&&(a=i);var n=e.call(this)||this;return n.triangleCountReportedInDebug=0,n.transforms={dvs:s.mat3f32.create(),tileMat3:s.mat3f32.create()},n.triangleCount=0,n.key=new o(t),n.bounds=r,n.size=i,n.coordRange=a,n}return r.__extends(t,e),t.prototype.destroy=function(){this.texture&&(this.texture.dispose(),this.texture=null)},Object.defineProperty(t.prototype,"coords",{get:function(){return this._coords},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bounds",{get:function(){return this._bounds},set:function(e){this._coords=[e[0],e[3]],this._bounds=e},enumerable:!1,configurable:!0}),t.prototype.setTransform=function(e,t){i("esri-2d-debug")&&null==t&&console.debug("Tried to set tile transform but lod resolution was null");var r=t/(e.resolution*e.pixelRatio),s=this.transforms.tileMat3,n=e.toScreenNoRotation([0,0],this.coords);a.mat3.set(s,this.size[0]/this.coordRange[0]*r,0,0,0,this.size[1]/this.coordRange[1]*r,0,n[0],n[1],1),a.mat3.multiply(this.transforms.dvs,e.displayViewMat3,s)},t}(n.DisplayObject);t.TiledDisplayObject=l}).apply(null,i))||(e.exports=a)},oDRR:function(e,t,r){var i,a;i=[r.dj.c(e.i),t,r("QDcU"),r("H1tY"),r("LxLY"),r("jBNx"),r("8uEs"),r("oZZu"),r("4oaH"),r("tI6k"),r("apbF")],void 0===(a=(function(e,t,r,i,a,s,n,o,l,u,d){"use strict";function f(e,t){var r=t.length;if(e<t[0].value||1===r)return t[0].size;for(var i=1;i<r;i++)if(e<t[i].value)return t[i-1].size+(e-t[i-1].value)/(t[i].value-t[i-1].value)*(t[i].size-t[i-1].size);return t[r-1].size}function p(e,t,r){if(void 0===r&&(r=0),a.isNone(t))return e[r+0]=0,e[r+1]=0,e[r+2]=0,void(e[r+3]=0);var i=t.g,s=t.b,n=t.a;e[r+0]=t.r*n/255,e[r+1]=i*n/255,e[r+2]=s*n/255,e[r+3]=n}Object.defineProperty(t,"__esModule",{value:!0}),t.WGLRendererInfo=void 0;var c=function(e,t,r){for(var i=16*r,a=i,s=0;a<Math.min(i+16,e.length);a++,s++)e[a]=t[s]},h=o.mat4f32.create(),y=function(){function e(){this.symbolLevels=[],this.vvColorValues=new Float32Array(8),this.vvColors=new Float32Array(32),this.vvOpacityValues=new Float32Array(8),this.vvOpacities=new Float32Array(8),this.vvSizeMinMaxValue=new Float32Array(4),this.ddColors=new Float32Array(32),this.ddBackgroundColor=new Float32Array(4),this.ddActiveDots=new Float32Array(8),this.insideEffect=new Float32Array(16*u.MAX_FILTERS),this.insideOpacity=1,this.outsideEffect=new Float32Array(16*u.MAX_FILTERS),this.outsideOpacity=1,this.effectCount=0,this._vvMaterialParameters={vvSizeEnabled:!1,vvColorEnabled:!1,vvRotationEnabled:!1,vvRotationType:"geographic",vvOpacityEnabled:!1},this._buf0=new Float32Array(2),this._buf1=new Float32Array(2),this.symbolLevels.push(0);for(var e=0;e<u.MAX_FILTERS;e++)c(this.insideEffect,h,e),c(this.outsideEffect,h,e)}return Object.defineProperty(e.prototype,"insideOpacities",{get:function(){return this._buf0[0]=1,this._buf0[1]=this.insideOpacity,this._buf0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"outsideOpacities",{get:function(){return this._buf1[0]=0,this._buf1[1]=this.outsideOpacity,this._buf1},enumerable:!1,configurable:!0}),e.prototype.getSizeVVFieldStops=function(e){var t=this._vvSizeFieldStops;switch(t.type){case"static":return t;case"level-dependent":return a.unwrapOr(t.levels[e],(function(){var r=1/0,i=0;for(var s in t.levels){var n=parseFloat(s),o=Math.abs(e-n);o<r&&(r=o,i=n)}if(r===1/0)return{sizes:new Float32Array([0,0,0,0,0,0]),values:new Float32Array([0,0,0,0,0,0])};var l=Math.pow(2,(e-i)/2),u=a.unwrap(t.levels[i]),d=new Float32Array(u.values);return d[2]*=l,d[3]*=l,{sizes:a.unwrap(u.sizes),values:d}}))}},Object.defineProperty(e.prototype,"vvMaterialParameters",{get:function(){return this._vvMaterialParameters},enumerable:!1,configurable:!0}),e.prototype.update=function(e){a.isSome(this._vvInfo)&&this._updateVisualVariables(this._vvInfo.vvRanges,e)},e.prototype.setInfo=function(e,t,r){var i=this;switch(a.isSome(r)?(r.forEach((function(e,t){return i._updateEffects(t,e)})),this.effectCount=r.length):this.effectCount=0,this._vvInfo=t,e.type){case"dot-density":this._updateDotDensityInfo(e)}},e.prototype.getVariation=function(){return{ddDotBlending:this.ddDotBlending,outsideLabelsVisible:this.outsideLabelsVisible,effectCount:this.effectCount,oesTextureFloat:i("esri-webgl-texture-float")}},e.prototype.getVariationHash=function(){return(this.ddDotBlending?1:0)|(this.outsideLabelsVisible?1:0)<<1|this.effectCount<<2},e.prototype._updateEffects=function(e,t){var r=e+1;if(a.isSome(t)&&t.filter&&t.filter.enabled){this.outsideLabelsVisible=t.excludedLabelsVisible;var i=t.parsedIncludedEffect,s=t.parsedExcludedEffect;a.isSome(i)?(c(this.insideEffect,i.getColorMatrix(),r),this.insideOpacity=i.getOpacity()):(c(this.insideEffect,h,r),this.insideOpacity=1),a.isSome(s)?(c(this.outsideEffect,s.getColorMatrix(),r),this.outsideOpacity=s.getOpacity()):(c(this.outsideEffect,h,r),this.outsideOpacity=1)}else c(this.insideEffect,h,r),c(this.outsideEffect,h,r),this.insideOpacity=1,this.outsideOpacity=1},e.prototype._updateVisualVariables=function(e,t){var r=this._vvMaterialParameters;if(r.vvOpacityEnabled=!1,r.vvSizeEnabled=!1,r.vvColorEnabled=!1,r.vvRotationEnabled=!1,e){var i=e.size;if(i){if(r.vvSizeEnabled=!0,i.minMaxValue){var a=i.minMaxValue,o=void 0,u=void 0;if(d.isDefined(a.minSize)&&d.isDefined(a.maxSize))if(d.isNumber(a.minSize)&&d.isNumber(a.maxSize))o=s.pt2px(a.minSize),u=s.pt2px(a.maxSize);else{var p=t.scale;o=s.pt2px(f(p,a.minSize.stops)),u=s.pt2px(f(p,a.maxSize.stops))}this.vvSizeMinMaxValue.set([a.minDataValue,a.maxDataValue,o,u])}if(i.scaleStops&&(this.vvSizeScaleStopsValue=s.pt2px(f(t.scale,i.scaleStops.stops))),i.unitValue){var c=n.getMetersPerUnitForSR(t.spatialReference)/l.meterIn[i.unitValue.unit];this.vvSizeUnitValueToPixelsRatio=c/t.resolution}i.fieldStops&&(this._vvSizeFieldStops=i.fieldStops)}var h=e.color;h&&(r.vvColorEnabled=!0,this.vvColorValues.set(h.values),this.vvColors.set(h.colors));var y=e.opacity;y&&(r.vvOpacityEnabled=!0,this.vvOpacityValues.set(y.values),this.vvOpacities.set(y.opacities));var v=e.rotation;v&&(r.vvRotationEnabled=!0,r.vvRotationType=v.type)}},e.prototype._updateDotDensityInfo=function(e){var t=e.attributes;this.ddDotValue=e.dotValue,this.ddDotScale=e.referenceScale,this.ddDotSize=e.dotSize,this.ddDotBlending=e.dotBlendingEnabled,this.ddSeed=e.seed;for(var i=0;i<u.DOT_DENSITY_MAX_FIELDS;i++){var a=i>=t.length?new r([0,0,0,0]):t[i].color;p(this.ddColors,a,4*i)}for(i=0;i<8;i++)this.ddActiveDots[i]=i<e.attributes.length?1:0;p(this.ddBackgroundColor,e.backgroundColor)},e}();t.WGLRendererInfo=y}).apply(null,i))||(e.exports=a)},qe2g:function(e,t,r){var i,a;i=[r.dj.c(e.i),t],void 0===(a=(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){void 0===e&&(e=400),this.duration=e,this._lastTime=0,this._elapsed=0,this._value=0,this._finished=!1}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!1,configurable:!0}),e.prototype.reset=function(){this._lastTime=0,this._elapsed=0,this._value=0},e.prototype.step=function(){var e=performance.now();return 0===this._lastTime?(this._lastTime=e,this._value=0,!0):this._elapsed>=this.duration||(this._elapsed+=e-this._lastTime,this._lastTime=e,this._value=Math.min(this._elapsed/this.duration,1),!1)},e}();t.default=r}).apply(null,i))||(e.exports=a)},rYkQ:function(e,t,r){var i,a;i=[r.dj.c(e.i),t,r("AwqN"),r("PwbG"),r("tTR7"),r("apbF"),r("apbF"),r("hNI9"),r("cF6f"),r("ph8t"),r("3vQA")],void 0===(a=(function(e,t,r,i,a,s,n,o,l,u,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TileData=void 0;var f=new r.default,p=new r.default;function c(e,t){var r={};for(var i in e){var a={data:n.allocateTypedArrayBuffer(t,e[i]),stride:e[i]};r[i]=a}return r}var h=function(){function e(){this.tileDisplayData=null,this.tileBufferData=null}return e.prototype.reshuffle=function(){f.reset();for(var t=a.groupRecordsByGeometryType(this.tileDisplayData.displayObjects),r=0,o=t;r<o.length;r++)for(var l=0,u=D=o[r];l<u.length;l++)(L=u[l])&&f.needMore(L.geometryType,L.meshData?L.meshData.vertexCount:L.vertexCount,L.meshData?L.meshData.indexData.length:L.indexCount);for(var d=t.length,c=new i,h=0;h<d;++h){c.geometries[h].indexBuffer=new Uint32Array(Math.round(1.5*f.indicesFor(h)));var y=[];for(var v in this.tileBufferData.geometries[h].vertexBuffer)y.push(this.tileBufferData.geometries[h].vertexBuffer[v].stride);var g=e._computeVertexAlignment(y),m=Math.round(1.5*f.verticesFor(h)),_=e._align(m,g);for(var x in this.tileBufferData.geometries[h].vertexBuffer){var b=this.tileBufferData.geometries[h].vertexBuffer[x].stride;c.geometries[h].vertexBuffer[x]={stride:b,data:n.allocateTypedArrayBuffer(_,b)}}}for(p.reset(),this.tileDisplayData.displayList.clear(),h=0;h<d;++h){for(var D,T=0,B=D=t[h];T<B.length;T++){var L;if((L=B[T]).meshData)L.writeMeshDataToBuffers(p.verticesFor(h),c.geometries[h].vertexBuffer,p.indicesFor(h),c.geometries[h].indexBuffer),L.meshData=null;else{var w=this.tileBufferData.geometries[h].vertexBuffer,R=this.tileBufferData.geometries[h].indexBuffer,F=c.geometries[h].vertexBuffer,O=c.geometries[h].indexBuffer,I=p.verticesFor(h),C=p.indicesFor(h);s.copyMeshData(I,C,F,O,L,w,R),L.vertexFrom=I,L.indexFrom=C}p.needMore(h,L.vertexCount,L.indexCount)}this.tileDisplayData.displayList.unified||this.tileDisplayData.displayList.addToList(D)}if(this.tileDisplayData.displayList.unified)for(var A=0,M=this.tileDisplayData.displayObjects;A<M.length;A++)this.tileDisplayData.displayList.addToList(M[A].displayRecords);this.tileBufferData=c},e.prototype.reshuffleV2=function(t,r,a){var o=t.addOrUpdate.tileDisplayData.displayObjects,l=this.tileDisplayData.displayObjects;f.reset();for(var u=0;u<l.length;u++)for(var d=l[u],c=0;c<d.displayRecords.length;c++){var h=d.displayRecords[c];f.needMore(h.geometryType,h.vertexCount,h.indexCount)}for(u=r;u<o.length;u++)for(d=o[u],c=u===r?a:0;c<d.displayRecords.length;c++)f.needMore((h=d.displayRecords[c]).geometryType,h.vertexCount,h.indexCount);var y=new i;for(u=0;u<5;u++){y.geometries[u].indexBuffer=new Uint32Array(Math.round(1.5*f.indicesFor(u)));var v=[],g=this.tileBufferData.geometries[u].vertexBuffer;for(var m in g)v.push(g[m].stride);var _=e._computeVertexAlignment(v),x=Math.round(1.5*f.verticesFor(u)),b=e._align(x,_);for(var D in g){var T=g[D].stride,B=n.allocateTypedArrayBuffer(b,T);y.geometries[u].vertexBuffer[D]={stride:T,data:B}}}for(p.reset(),this.tileDisplayData.displayList.clear(),u=0;u<l.length;u++)for(d=l[u],c=0;c<d.displayRecords.length;c++){var L=(h=d.displayRecords[c]).geometryType,w=(g=this.tileBufferData.geometries[L].vertexBuffer,this.tileBufferData.geometries[L].indexBuffer),R=y.geometries[L].vertexBuffer,F=y.geometries[L].indexBuffer,O=p.verticesFor(L),I=p.indicesFor(L);s.copyMeshData(O,I,R,F,h,g,w),h.vertexFrom=O,h.indexFrom=I,p.needMore(L,h.vertexCount,h.indexCount),this.tileDisplayData.displayList.addToList(h)}if(0!==a)for(d=o[r],c=0;c<a;c++)L=(h=d.displayRecords[c]).geometryType,g=this.tileBufferData.geometries[L].vertexBuffer,w=this.tileBufferData.geometries[L].indexBuffer,R=y.geometries[L].vertexBuffer,F=y.geometries[L].indexBuffer,O=p.verticesFor(L),I=p.indicesFor(L),s.copyMeshData(O,I,R,F,h,g,w),h.vertexFrom=O,h.indexFrom=I,p.needMore(L,h.vertexCount,h.indexCount),this.tileDisplayData.displayList.addToList(h);for(u=r;u<o.length;u++){for(d=o[u],c=u===r?a:0;c<d.displayRecords.length;c++){L=(h=d.displayRecords[c]).geometryType;var C=t.addOrUpdate.tileBufferData.geometries[L];g=C.vertexBuffer,w=C.indexBuffer,R=y.geometries[L].vertexBuffer,F=y.geometries[L].indexBuffer,O=p.verticesFor(L),I=p.indicesFor(L),s.copyMeshData(O,I,R,F,h,g,w),h.vertexFrom=O,h.indexFrom=I,p.needMore(L,h.vertexCount,h.indexCount),this.tileDisplayData.displayList.addToList(h)}this.tileDisplayData.hasRegistry&&this.tileDisplayData.displayObjectRegistry.set(d.id,d),this.tileDisplayData.displayObjects.push(d)}this.tileBufferData=y},e.prototype.getStrides=function(){for(var e=[],t=0;t<this.tileBufferData.geometries.length;++t){var r=this.tileBufferData.geometries[t];for(var i in e[t]={},r.vertexBuffer)e[t][i]=r.vertexBuffer[i].stride}return e},e.prototype.clone=function(){var t=new e;return t.tileBufferData=this.tileBufferData.clone(),t.tileDisplayData=this.tileDisplayData.clone(),t},e.prototype._guessSize=function(){for(var e=this.tileDisplayData.displayObjects,t=Math.min(e.length,4),r=0,i=0;i<t;i++)r=Math.max(r,e[i].displayRecords.length);return 2*(12*e.length+e.length*r*40)},e.prototype.serialize=function(){var e=this.tileBufferData.serialize(),t=this.tileBufferData.getBuffers(),r=this.tileDisplayData.serialize(new d.default(Int32Array,this._guessSize())).buffer();return t.push(r),{result:{displayData:r,bufferData:e},transferList:t}},e.decode=function(t){var r=l.MeshData.deserializeDisplayObjects(t),i={};for(var a in t.vertexBuffersMap)i[a]=u.VertexBuffers.decode(t.vertexBuffersMap[a]);return e.fromMeshData({displayObjects:r,vertexBuffersMap:i})},e.fromMeshData=function(t){var r=new e,s=new a.default,n=new i;for(var o in s.displayObjects=t.displayObjects,t.vertexBuffersMap){var l=t.vertexBuffersMap[o];n.geometries[o].indexBuffer=l.indexBuffer,n.geometries[o].vertexBuffer=l.namedBuffers}return r.tileDisplayData=s,r.tileBufferData=n,r},e.bind=function(t,r){var i=new e;return i.tileDisplayData=t,i.tileBufferData=r,i},e.create=function(t,r){var s=new e;s.tileDisplayData=new a.default,s.tileDisplayData.displayObjects=t;for(var n=[0,0,0,0,0],l=[0,0,0,0,0],u=[[],[],[],[],[]],d=0,f=t;d<f.length;d++)for(var p=0,h=f[d].displayRecords;p<h.length;p++){var y=h[p];u[y.geometryType].push(y),n[y.geometryType]+=y.meshData.vertexCount,l[y.geometryType]+=y.meshData.indexData.length}for(var v=new i,g=function(e){return[e.fill||{},e.line||{},e.icon||{},e.text||{},e.label||{}]}(r),m=0;m<5;m++){var _=new Uint32Array(l[m]),x=c(g[m],n[m]);o.writeAllMeshDataToBuffers(u[m],x,_),v.geometries[m]={indexBuffer:_,vertexBuffer:x}}return s.tileBufferData=v,s},e._align=function(e,t){var r=e%t;return 0===r?e:e+(t-r)},e._computeVertexAlignment=function(e){for(var t=!1,r=!1,i=0,a=e;i<a.length;i++){var s=a[i];s%4==2?t=!0:s%4!=0&&(r=!0)}return r?4:t?2:1},e}();t.TileData=h}).apply(null,i))||(e.exports=a)},tTR7:function(e,t,r){var i,a;i=[r.dj.c(e.i),t,r("Dikz"),r("azm3"),r("flWe")],void 0===(a=(function(e,t,r,i,a){"use strict";function s(e){for(var t=[[],[],[],[],[]],r=0,i=e;r<i.length;r++)for(var a=0,s=i[r].displayRecords;a<s.length;a++){var n=s[a];t[n.geometryType].push(n)}return t}Object.defineProperty(t,"__esModule",{value:!0}),t.groupRecordsByGeometryType=void 0,t.groupRecordsByGeometryType=s;var n=function(){function e(){}return Object.defineProperty(e.prototype,"hasRegistry",{get:function(){return!!this._displayObjectRegistry},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"displayObjectRegistry",{get:function(){if(!this._displayObjectRegistry){this._displayObjectRegistry=new Map;for(var e=0,t=this.displayObjects;e<t.length;e++){var r=t[e];this._displayObjectRegistry.set(r.id,r)}}return this._displayObjectRegistry},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"displayList",{get:function(){return this._displayList},enumerable:!1,configurable:!0}),e.prototype.computeDisplayList=function(e){if(this._displayList=new r(e),e)for(var t=0,i=this.displayObjects;t<i.length;t++)for(var a=0,n=i[t].displayRecords;a<n.length;a++)this._displayList.addToList(n[a]);else for(var o=s(this.displayObjects),l=o.length,u=0;u<l;++u)this._displayList.addToList(o[u])},e.prototype.clone=function(){var t=new e;return this.displayObjects&&(t.displayObjects=this.displayObjects.map((function(e){return e.clone()}))),t},e.prototype.serialize=function(e){return a.serializeList(e,this.displayObjects),e},e.prototype._deserializeObjects=function(e){for(var t=e.readInt32(),r=new Array(t),a=new Map,s=0;s<r.length;++s){var n=i.deserialize(e);r[s]=n,a.set(n.id,n)}this.displayObjects=r,this._displayList=null,this._displayObjectRegistry=a},e.deserialize=function(t){var r=new e;return r._deserializeObjects(t),r},e}();t.default=n}).apply(null,i))||(e.exports=a)},wUCb:function(e,t,r){var i,a;i=[r.dj.c(e.i),t,r("zOht"),r("JNkf"),r("/U66"),r("66cO"),r("p2sx")],void 0===(a=(function(e,t,r,i,a,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sortByLevel=void 0,t.sortByLevel=function(e,t){return e.key.level-t.key.level!=0?e.key.level-t.key.level:e.key.row-t.key.row!=0?e.key.row-t.key.row:e.key.col-t.key.col};var o=function(e){function a(t){var r=e.call(this)||this;return r._tileInfoView=t,r}return r.__extends(a,e),a.prototype.renderChildren=function(r){this.sortChildren(t.sortByLevel),this.setStencilReference(),e.prototype.renderChildren.call(this,r)},a.prototype.createRenderParams=function(t){var i=t.state;return r.__assign(r.__assign({},e.prototype.createRenderParams.call(this,t)),{requiredLevel:this._tileInfoView.getClosestInfoForScale(i.scale).level,displayLevel:this._tileInfoView.tileInfo.scaleToZoom(i.scale)})},a.prototype.prepareRenderPasses=function(t){var a=this,o=t.registerRenderPass({name:"stencil",brushes:[n.default],drawPhase:i.WGLDrawPhase.DEBUG|i.WGLDrawPhase.MAP,target:function(){return a.getStencilTarget()}}),l=t.registerRenderPass({name:"tileInfo",brushes:[s.default],drawPhase:i.WGLDrawPhase.DEBUG,target:function(){return a.children},has:"esri-tiles-debug"});return r.__spreadArrays(e.prototype.prepareRenderPasses.call(this,t),[o,l])},a.prototype.getStencilTarget=function(){return this.children},a.prototype.updateTransforms=function(e){for(var t=0,r=this.children;t<r.length;t++){var i=r[t],a=this._tileInfoView.getTileResolution(i.key);i.setTransform(e,a)}},a.prototype.setStencilReference=function(){for(var e=1,t=0,r=this.children;t<r.length;t++)r[t].stencilRef=e++},a}(a.default);t.default=o}).apply(null,i))||(e.exports=a)},xxo4:function(e,t,r){var i,a;i=[r.dj.c(e.i),t,r("DJpR"),r("apbF")],void 0===(a=(function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e){this.geometryMap=i.createGeometryData((function(){return{indexBuffer:r.BufferObject.createIndex(e,35044),vao:null}}),(function(t,a){return{vertexBuffer:r.BufferObject.createVertex(e,i.C_VBO_INFO[a])}}))}return e.prototype.dispose=function(){for(var e=0;e<5;e++){var t=this.geometryMap[e];if(t)for(var r in t.data.vao&&t.data.vao.dispose(!1),t.data.indexBuffer&&t.data.indexBuffer.dispose(),t.buffers)t.buffers[r]&&t.buffers[r].data.vertexBuffer.dispose()}},e.prototype.get=function(e){var t=this.geometryMap[e],r={};for(var i in t.buffers)r[i]=t.buffers[i].data.vertexBuffer;return{indexBuffer:t.data.indexBuffer,get vao(){return t.data.vao},set vao(e){t.data.vao=e},vertexBufferMap:r}},e.prototype.has=function(e){return null!=this.geometryMap[e]},e.prototype.upload=function(e,t){var r=this;t.forEach((function(t,i){r._upload(t,i,e)}))},e.prototype._upload=function(e,t,r){if(e.indices&&(e.indices.allDirty?this._uploadIndices(r,t):null!=e.indices.from&&null!=e.indices.count&&this._uploadIndices(r,t,e.indices.from,e.indices.count)),e.vertices){var i=e.vertices;for(var a in i){var s=i[a];s.allDirty?this._uploadVertices(r,t,a):null!=s.from&&null!=s.count&&this._uploadVertices(r,t,a,s.from,s.count)}}},e.prototype._uploadVertices=function(e,t,r,i,a){var s=this.geometryMap[t];if(s){var n=e.geometries[t].vertexBuffer[r];if(n){var o=n.stride,l=n.data.buffer;s.buffers[r]&&l.byteLength>0&&(null!=i&&null!=a?s.buffers[r].data.vertexBuffer.setSubData(l,i*o,i*o,(i+a)*o):s.buffers[r].data.vertexBuffer.setData(l))}}},e.prototype._uploadIndices=function(e,t,r,i){var a=this.geometryMap[t];if(a){var s=e.geometries[t].indexBuffer.buffer;a.data.indexBuffer&&s.byteLength>0&&(null!=r&&null!=i?a.data.indexBuffer.setSubData(s,4*r,4*r,4*(r+i)):a.data.indexBuffer.setData(s))}},e}();t.default=a}).apply(null,i))||(e.exports=a)}}]);