(function(){var e={"esri/views/3d/webgl-engine/lib/geometryDataUtils":"+nCE","arcgis-js-api/views/3d/webgl-engine/lib/geometryDataUtils":"+nCE","arcgis-js-api/views/3d/webgl-engine/lib/screenSizePerspectiveUtils":"+wMf","esri/views/3d/webgl-engine/lib/screenSizePerspectiveUtils":"+wMf","esri/views/3d/webgl-engine/lib/glUtil3D":"/Bau","arcgis-js-api/views/3d/webgl-engine/lib/glUtil3D":"/Bau","esri/views/3d/support/geometryUtils/sphere":"/dtL","esri/views/3d/support/geometryUtils/vector":"18xY","arcgis-js-api/views/3d/webgl-engine/lib/doublePrecisionUtils":"1f+t","esri/views/3d/webgl-engine/lib/doublePrecisionUtils":"1f+t","esri/core/libs/gl-matrix-2/mat4f64":"1m5D","arcgis-js-api/core/libs/gl-matrix-2/mat4f64":"1m5D","arcgis-js-api/views/3d/webgl-engine/core/shaderLibrary/util/View.glsl":"2NOe","esri/views/3d/webgl-engine/core/shaderLibrary/util/View.glsl":"2NOe","esri/views/3d/support/geometryUtils/boundedPlane":"2eYJ","arcgis-js-api/views/3d/webgl-engine/core/shaderLibrary/shading/VisualVariables.glsl":"3PFg","esri/views/3d/webgl-engine/core/shaderLibrary/shading/VisualVariables.glsl":"3PFg","arcgis-js-api/views/3d/webgl-engine/lib/BoundingInfo":"3RHn","arcgis-js-api/views/3d/webgl-engine/core/shaderLibrary/Transform.glsl":"3kdR","esri/views/3d/webgl-engine/core/shaderLibrary/Transform.glsl":"3kdR","esri/views/3d/support/geometryUtils/ray":"4p4v","esri/core/libs/gl-matrix-2/mat3f64":"51bw","arcgis-js-api/core/libs/gl-matrix-2/mat3f64":"51bw","arcgis-js-api/views/3d/webgl-engine/lib/Object3DStateSet":"62Ht","esri/views/3d/webgl-engine/lib/Object3DStateSet":"62Ht","arcgis-js-api/views/3d/webgl-engine/core/shaderLibrary/attributes/VertexColor.glsl":"6t3m","esri/views/3d/webgl-engine/core/shaderLibrary/attributes/VertexColor.glsl":"6t3m","arcgis-js-api/views/3d/webgl-engine/core/shaderModules/interfaces":"7Aei","esri/views/3d/webgl-engine/core/shaderModules/interfaces":"7Aei","arcgis-js-api/views/3d/webgl-engine/lib/intersectorUtils":"9DjX","esri/views/3d/webgl-engine/lib/intersectorUtils":"9DjX","esri/views/3d/webgl-engine/lib/GeometryData":"AgDx","arcgis-js-api/views/3d/webgl-engine/lib/GeometryData":"AgDx","arcgis-js-api/views/3d/webgl-engine/lib/Util":"CIy2","esri/views/3d/webgl-engine/lib/Util":"CIy2","arcgis-js-api/core/libs/gl-matrix-2/factories/mat4f64":"CIzB","esri/views/3d/webgl-engine/lib/GeometryRecord":"Cvn+","esri/views/3d/webgl-engine/core/shaderLibrary/util/RgbaFloatEncoding.glsl":"DKwL","arcgis-js-api/views/3d/webgl-engine/core/shaderLibrary/util/RgbaFloatEncoding.glsl":"DKwL","arcgis-js-api/views/3d/webgl-engine/lib/Material":"FNtW","esri/views/3d/webgl-engine/lib/Material":"FNtW","arcgis-js-api/views/3d/webgl-engine/core/shaderTechnique/ShaderTechnique":"FQ4r","esri/views/3d/webgl-engine/core/shaderTechnique/ShaderTechnique":"FQ4r","esri/views/3d/support/geometryUtils/plane":"GG08","esri/views/3d/support/geometryUtils/axisAngle":"GyfB","arcgis-js-api/views/3d/webgl-engine/materials/internal/bufferWriterUtils":"ILj8","esri/views/3d/webgl-engine/materials/internal/bufferWriterUtils":"ILj8","arcgis-js-api/views/3d/webgl-engine/core/shaderLibrary/util/AlphaDiscard.glsl":"IwVr","esri/views/3d/webgl-engine/core/shaderLibrary/util/AlphaDiscard.glsl":"IwVr","arcgis-js-api/views/3d/support/stack":"JjCO","esri/views/3d/support/stack":"JjCO","arcgis-js-api/views/3d/webgl-engine/lib/AutoDisposable":"KRuQ","esri/views/3d/webgl-engine/lib/AutoDisposable":"KRuQ","esri/views/3d/support/geometryUtils/lineSegment":"N5NQ","esri/core/ObjectStack":"PHan","arcgis-js-api/views/3d/webgl-engine/core/shaderLibrary/output/OutputHighlight.glsl":"PaEL","esri/views/3d/webgl-engine/core/shaderLibrary/output/OutputHighlight.glsl":"PaEL","arcgis-js-api/views/3d/webgl-engine/materials/renderers/utils":"PwS/","esri/views/3d/webgl-engine/materials/renderers/utils":"PwS/","arcgis-js-api/views/3d/webgl-engine/core/shaderTechnique/ReloadableShaderModule":"W/V4","esri/views/3d/webgl-engine/core/shaderTechnique/ReloadableShaderModule":"W/V4","arcgis-js-api/views/3d/webgl-engine/lib/IdGen":"W0kZ","esri/views/3d/webgl-engine/lib/IdGen":"W0kZ","arcgis-js-api/views/3d/webgl-engine/lib/Object3D":"ZJC8","esri/views/3d/webgl-engine/lib/Object3D":"ZJC8","esri/views/3d/support/geometryUtils/triangle":"ZjcA","arcgis-js-api/views/3d/webgl-engine/core/shaderModules/ShaderBuilder":"aExC","esri/views/3d/webgl-engine/core/shaderModules/ShaderBuilder":"aExC","arcgis-js-api/views/3d/support/geometryUtils":"aWgr","esri/views/3d/support/geometryUtils":"aWgr","esri/views/3d/support/geometryUtils/frustum":"cpxo","arcgis-js-api/views/3d/support/geometryUtils/clipRay":"fXZm","esri/views/3d/support/geometryUtils/clipRay":"fXZm","arcgis-js-api/views/3d/webgl-engine/core/shaderLibrary/Slice.glsl":"fese","esri/views/3d/webgl-engine/core/shaderLibrary/Slice.glsl":"fese","arcgis-js-api/views/3d/webgl-engine/lib/DefaultVertexAttributeLocations":"ff/U","esri/views/3d/webgl-engine/lib/DefaultVertexAttributeLocations":"ff/U","arcgis-js-api/core/libs/gl-matrix-2/factories/vec3f32":"iHt0","arcgis-js-api/views/3d/webgl-engine/core/shaderTechnique/ShaderTechniqueConfiguration":"lBa0","esri/views/3d/webgl-engine/core/shaderTechnique/ShaderTechniqueConfiguration":"lBa0","arcgis-js-api/views/3d/webgl-engine/lib/StencilUtils":"lfQW","esri/views/3d/webgl-engine/lib/StencilUtils":"lfQW","arcgis-js-api/views/3d/webgl-engine/core/shaderLibrary/shading/PiUtils.glsl":"quQL","esri/views/3d/webgl-engine/core/shaderLibrary/shading/PiUtils.glsl":"quQL","arcgis-js-api/views/3d/webgl-engine/materials/internal/MaterialUtil":"s6rJ","esri/views/3d/webgl-engine/materials/internal/MaterialUtil":"s6rJ","arcgis-js-api/views/3d/webgl-engine/lib/GLMaterial":"tUyH","esri/views/3d/webgl-engine/lib/GLMaterial":"tUyH","esri/core/libs/gl-matrix-2/vec3f32":"vlC2","arcgis-js-api/core/libs/gl-matrix-2/vec3f32":"vlC2","esri/core/VectorStack":"wSO/","esri/views/3d/webgl-engine/lib/Geometry":"ys4y","arcgis-js-api/views/3d/webgl-engine/lib/Geometry":"ys4y","esri/views/3d/webgl-engine/lib/DefaultVertexBufferLayouts":"zZCp"},t=this||window,r=t.webpackJsonp=t.webpackJsonp||[];r.registerAbsMids?r.registerAbsMids(e):(r.absMidsWaiting=r.absMidsWaiting||[]).push(e)})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"+nCE":function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("0LE5"),r("Rdxj"),r("ZjcA")],void 0===(n=(function(e,t,r,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewId=t.computeAttachmentOriginLines=t.computeAttachmentOriginPoints=t.computeAttachmentOriginTriangles=t.generateDefaultIndexArray=void 0;var o=1,a=null,s=new Uint32Array([0]);t.generateDefaultIndexArray=function(e){if(1===e)return s;if(e>o||null==a){for(;e>o;)o*=2;a=new Uint32Array(o);for(var t=0;t<o;t++)a[t]=t}return new Uint32Array(a.buffer,0,e)},t.computeAttachmentOriginTriangles=function(e,t,i){if(!e)return!1;var o=e.strideIdx,a=e.offsetIdx,s=e.data;r.vec3.set(i,0,0,0),r.vec3.set(d,0,0,0);for(var c=0,v=0,p=0;p<t.length-2;p+=3){var h=t[p+0]*o+a,m=t[p+1]*o+a,g=t[p+2]*o+a;r.vec3.set(l,s[h+0],s[h+1],s[h+2]),r.vec3.set(u,s[m+0],s[m+1],s[m+2]),r.vec3.set(f,s[g+0],s[g+1],s[g+2]);var b=n.areaPoints3d(l,u,f);b?(r.vec3.add(l,l,u),r.vec3.add(l,l,f),r.vec3.scale(l,l,1/3*b),r.vec3.add(i,i,l),c+=b):(r.vec3.add(d,d,l),r.vec3.add(d,d,u),r.vec3.add(d,d,f),v+=3)}return!(0===v&&0===c||(0!==c?(r.vec3.scale(i,i,1/c),0):0===v||(r.vec3.scale(i,d,1/v),0)))},t.computeAttachmentOriginPoints=function(e,t,i){if(!e||!t)return!1;var n=e.strideIdx,o=e.offsetIdx,a=e.data;r.vec3.set(i,0,0,0);for(var s=-1,c=0,l=0;l<t.length;l++){var u=t[l]*n+o;s!==u&&(i[0]+=a[u+0],i[1]+=a[u+1],i[2]+=a[u+2],c++),s=u}return c>1&&r.vec3.scale(i,i,1/c),c>0},t.computeAttachmentOriginLines=function(e,t,i,n){if(!e)return!1;var o=e.strideIdx,a=e.offsetIdx,s=e.data;r.vec3.set(n,0,0,0),r.vec3.set(d,0,0,0);for(var c=0,f=0,v=t?t.length-1:s.length/o-1,p=v+(i?2:0),h=0;h<p;h+=2){var m=h<v?h:v,g=h<v?h+1:0,b=(t?t[m]:m)*o+a,y=(t?t[g]:g)*o+a;l[0]=s[b+0],l[1]=s[b+1],l[2]=s[b+2],u[0]=s[y+0],u[1]=s[y+1],u[2]=s[y+2],r.vec3.scale(l,r.vec3.add(l,l,u),.5);var _=r.vec3.dist(l,u);_>0?(r.vec3.add(n,n,r.vec3.scale(l,l,_)),c+=_):(r.vec3.add(d,d,l),f++)}return 0!==c?(r.vec3.scale(n,n,1/c),!0):0!==f&&(r.vec3.scale(n,d,1/f),!0)};var c=0;t.getNewId=function(){return c++};var l=i.vec3f64.create(),u=i.vec3f64.create(),f=i.vec3f64.create(),d=i.vec3f64.create()}).apply(null,i))||(e.exports=n)},"+wMf":function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("xoE+"),r("KDna")],void 0===(n=(function(e,t,r,i){"use strict";function n(e,t,r){var i=r.parameters,n=r.paddingPixelsOverride;return u.scale=Math.min(i.divisor/(t-i.offset),1),u.factor=function(e){return Math.abs(e*e*e)}(e),u.minPixelSize=i.minPixelSize,u.paddingPixels=n,u}function o(e,t){return 0===e?t.minPixelSize:t.minPixelSize*(1+2*t.paddingPixels/e)}function a(e,t){return Math.max(r.lerp(e*t.scale,e,t.factor),o(e,t))}Object.defineProperty(t,"__esModule",{value:!0}),t.scale=t.applyPrecomputedScaleFactor=t.precomputeScaleFactor=t.applyScaleFactorVec2=t.applyScaleFactor=t.getLabelSettings=t.getSettings=void 0,t.getSettings=function(e){return new s(e,c)},t.getLabelSettings=function(e){var t=c.curvatureDependent;return new s(e,{curvatureDependent:{min:{curvature:t.min.curvature,tiltAngle:t.min.tiltAngle,scaleFallOffFactor:l.curvatureDependent.min.scaleFallOffFactor},max:{curvature:t.max.curvature,tiltAngle:t.max.tiltAngle,scaleFallOffFactor:l.curvatureDependent.max.scaleFallOffFactor}},scaleStart:c.scaleStart,scaleFallOffRange:c.scaleFallOffRange,minPixelSize:l.minPixelSize})},t.applyScaleFactor=a,t.applyScaleFactorVec2=function(e,t,i){void 0===i&&(i=[0,0]);var n=Math.min(Math.max(t.scale,o(e[1],t)/e[1]),1);return i[0]=r.lerp(e[0]*n,e[0],t.factor),i[1]=r.lerp(e[1]*n,e[1],t.factor),i},t.precomputeScaleFactor=function(e,t,r,i){i.scale=function(e,t,r){var i=n(e,t,r);return i.minPixelSize=0,i.paddingPixels=0,a(1,i)}(e,t,r),i.factor=0,i.minPixelSize=r.parameters.minPixelSize,i.paddingPixels=r.paddingPixelsOverride},t.applyPrecomputedScaleFactor=function(e,t,r){void 0===r&&(r=[0,0]);var i=Math.min(Math.max(t.scale,o(e[1],t)/e[1]),1);return r[0]=e[0]*i,r[1]=e[1]*i,r},t.scale=function(e,t,r,i){return a(e,n(t,r,i))};var s=function(){function e(e,t,r,i){void 0===r&&(r={camera:{distance:0,fovY:0},divisor:0,offset:0,minPixelSize:0,paddingPixels:0}),this.viewingMode=e,this.description=t,this.parameters=r,this._paddingPixelsOverride=i,2===this.viewingMode?(this.coverageCompensation=this.surfaceCoverageCompensationLocal,this.calculateCurvatureDependentParameters=this.calculateCurvatureDependentParametersLocal):(this.coverageCompensation=this.surfaceCoverageCompensationGlobal,this.calculateCurvatureDependentParameters=this.calculateCurvatureDependentParametersGlobal)}return Object.defineProperty(e.prototype,"paddingPixelsOverride",{get:function(){return this._paddingPixelsOverride||this.parameters.paddingPixels},enumerable:!1,configurable:!0}),e.prototype.update=function(e){return!(this.parameters&&this.parameters.camera.fovY===e.fovY&&this.parameters.camera.distance===e.distance||(this.calculateParameters(e,this.parameters),0))},e.prototype.overridePadding=function(t){return t!==this.paddingPixelsOverride?new e(this.viewingMode,this.description,this.parameters,t):this},e.prototype.calculateParameters=function(e,t){var r=this.description,i=r.scaleStart,n=r.scaleFallOffRange,o=r.minPixelSize,a=e.fovY,s=e.distance,c=this.calculateCurvatureDependentParameters(e),l=this.coverageCompensation(e,c),u=c.tiltAngle,f=c.scaleFallOffFactor,d=Math.sin(u)*s,v=.5*Math.PI-u-a*(.5-i*l),p=d/Math.cos(v),h=(p-f*(d/Math.cos(v+a*n*l)))/(1-f);return t.camera.fovY=e.fovY,t.camera.distance=e.distance,t.offset=h,t.divisor=p-h,t.minPixelSize=o,t},e.prototype.calculateCurvatureDependentParametersLocal=function(e,t){return void 0===t&&(t=f),t.tiltAngle=this.description.curvatureDependent.min.tiltAngle,t.scaleFallOffFactor=this.description.curvatureDependent.min.scaleFallOffFactor,t},e.prototype.calculateCurvatureDependentParametersGlobal=function(e,t){void 0===t&&(t=f);var n=this.description.curvatureDependent,o=1+e.distance/i.earthRadius,a=Math.sqrt(o*o-1),s=[n.min.curvature,n.max.curvature],c=s[0],l=r.clamp((a-c)/(s[1]-c),0,1),u=[n.min,n.max],d=u[0],v=u[1];return t.tiltAngle=r.lerp(d.tiltAngle,v.tiltAngle,l),t.scaleFallOffFactor=r.lerp(d.scaleFallOffFactor,v.scaleFallOffFactor,l),t},e.prototype.surfaceCoverageCompensationLocal=function(e,t){return(e.fovY-t.tiltAngle)/e.fovY},e.prototype.surfaceCoverageCompensationGlobal=function(e,t){var r=i.earthRadius*i.earthRadius,n=t.tiltAngle+.5*Math.PI,o=e.fovY,a=e.distance,s=a*a+r-2*Math.cos(n)*a*i.earthRadius,c=Math.sqrt(s),l=Math.sqrt(s-r);return(Math.acos(l/c)-Math.asin(i.earthRadius/(c/Math.sin(n)))+.5*o)/o},e}(),c={curvatureDependent:{min:{curvature:r.deg2rad(10),tiltAngle:r.deg2rad(12),scaleFallOffFactor:.5},max:{curvature:r.deg2rad(70),tiltAngle:r.deg2rad(40),scaleFallOffFactor:.8}},scaleStart:.3,scaleFallOffRange:.65,minPixelSize:0},l={curvatureDependent:{min:{scaleFallOffFactor:.7},max:{scaleFallOffFactor:.95}},minPixelSize:14},u={scale:0,factor:0,minPixelSize:0,paddingPixels:0},f={tiltAngle:0,scaleFallOffFactor:0}}).apply(null,i))||(e.exports=n)},"/Bau":function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("ff/U"),r("zZCp"),r("QFi0"),r("Zp3t"),r("z2+Q")],void 0===(n=(function(e,t,r,i,n,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createEmptyDepthTexture=t.createColorTexture=t.createEmptyTexture=t.createQuadVAO=void 0,t.createQuadVAO=function(e,t,o){void 0===t&&(t=i.Pos2),void 0===o&&(o=r.Default3D);var s=null;switch(t){case i.Pos2Tex:s=new Float32Array([-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1]);break;case i.Pos2:default:s=new Float32Array([-1,-1,1,-1,-1,1,1,1])}return new a(e,o,{geometry:t},{geometry:n.createVertex(e,35044,s)})},t.createEmptyTexture=function(e,t){return void 0===t&&(t=4),new o(e,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,width:t,height:t})},t.createColorTexture=function(e,t,r){void 0===r&&(r=4);for(var i=new Uint8Array(r*r*4),n=0;n<i.length;n+=4)i[n+0]=255*t[0],i[n+1]=255*t[1],i[n+2]=255*t[2],i[n+3]=255*t[3];return new o(e,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,width:r,height:r},i)},t.createEmptyDepthTexture=function(e){return new o(e,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array([255,255,255,255]))}}).apply(null,i))||(e.exports=n)},"/dtL":function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("pcDC"),r("qsST"),r("xoE+"),r("PHan"),r("FXVB"),r("0LE5"),r("Rdxj"),r("AzkI"),r("JjCO"),r("4p4v"),r("18xY")],void 0===(n=(function(e,t,r,i,n,o,a,s,c,l,u,f,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setAltitudeAt=t.altitudeAt=t.axisAt=t.angleToSilhouette=t.distanceToSilhouette=t.projectPoint=t.closestPoint=t.closestPointOnSilhouette=t.intersectRayClosestSilhouette=t.intersectsRay=t.intersectScreen=t.intersectRay=t.setExtent=t.elevate=t.fromValues=t.copy=t.wrap=t.create=void 0;var v=i.getLogger("esri.views.3d.support.geometryUtils.sphere");function p(e){return e?{radius:e.radius,center:c.vec3f64.clone(e.center)}:{radius:1,center:c.vec3f64.create()}}function h(e,t){return void 0===t&&(t=p()),m(e.radius,e.center,t)}function m(e,t,r){return void 0===r&&(r=p()),s.vec3.copy(r.center,t),r.radius=e,r}function g(e,t,r){var i=s.vec3.subtract(u.sv3d.get(),t.origin,e.center),n=s.vec3.dot(t.direction,t.direction),o=2*s.vec3.dot(t.direction,i),a=o*o-4*n*(s.vec3.dot(i,i)-e.radius*e.radius);if(a<0)return!1;var c=Math.sqrt(a),l=(-o-c)/(2*n),f=(-o+c)/(2*n);return(l<0||f<l&&f>0)&&(l=f),!(l<0||(r&&s.vec3.add(r,t.origin,s.vec3.scale(u.sv3d.get(),t.direction,l)),0))}function b(e,t,r){var i=u.sv3d.get(),n=u.sm4d.get();s.vec3.cross(i,t.origin,t.direction),s.vec3.cross(r,i,t.origin),s.vec3.scale(r,r,1/s.vec3.length(r)*e.radius);var o=_(e,t.origin),c=d.angle(t.origin,r);return a.mat4.identity(n),a.mat4.rotate(n,n,c+o,i),s.vec3.transformMat4(r,r,n),r}function y(e,t,r){var i=s.vec3.subtract(u.sv3d.get(),t,e.center),n=s.vec3.scale(u.sv3d.get(),i,e.radius/s.vec3.length(i));return s.vec3.add(r,n,e.center)}function _(e,t){var r=s.vec3.subtract(u.sv3d.get(),t,e.center),i=s.vec3.length(r),o=e.radius+Math.abs(e.radius-i);return n.acosClamped(e.radius/o)}t.create=p,t.wrap=function(e,t){var r=S.get();return r.radius=e,r.center=t||w,r},t.copy=h,t.fromValues=m,t.elevate=function(e,t,r){return e!==r&&s.vec3.copy(r.center,e.center),r.radius=e.radius+t,r},t.setExtent=function(e,t,r){return v.error("sphere.setExtent is not yet supported"),e===r?r:h(e,r)},t.intersectRay=g,t.intersectScreen=function(e,t,r,i){return g(e,f.fromScreenAtEye(t,r,M),i)},t.intersectsRay=function(e,t){return g(e,t,null)},t.intersectRayClosestSilhouette=function(e,t,r){if(g(e,t,r))return r;var i=b(e,t,u.sv3d.get());return s.vec3.add(r,t.origin,s.vec3.scale(u.sv3d.get(),t.direction,s.vec3.distance(t.origin,i)/s.vec3.length(t.direction))),r},t.closestPointOnSilhouette=b,t.closestPoint=function(e,t,r){return g(e,t,r)?r:(f.closestPoint(t,e.center,r),y(e,r,r))},t.projectPoint=y,t.distanceToSilhouette=function(e,t){var r=s.vec3.subtract(u.sv3d.get(),t,e.center),i=s.vec3.squaredLength(r);return Math.sqrt(Math.abs(i-e.radius*e.radius))},t.angleToSilhouette=_;var x=c.vec3f64.create();function O(e,t,i,n){var o=s.vec3.subtract(x,t,e.center);switch(i){case 0:var a=(c=l.cartesianToSpherical(o,x))[2];return s.vec3.set(n,-Math.sin(a),Math.cos(a),0);case 1:var c,u=(c=l.cartesianToSpherical(o,x))[1],f=(a=c[2],Math.sin(u));return s.vec3.set(n,-f*Math.cos(a),-f*Math.sin(a),Math.cos(u));case 2:return s.vec3.normalize(n,o);default:return void r.neverReached(i)}}function P(e,t){var r=s.vec3.subtract(A,t,e.center);return s.vec3.length(r)-e.radius}t.axisAt=O,t.altitudeAt=P,t.setAltitudeAt=function(e,t,r,i){var n=P(e,t),o=O(e,t,2,A),a=s.vec3.scale(A,o,r-n);return s.vec3.add(i,t,a),i};var S=new o.ObjectStack((function(){return{center:null,radius:0}})),M=f.create(),w=c.vec3f64.create(),A=c.vec3f64.create();Object.freeze(w)}).apply(null,i))||(e.exports=n)},"18xY":function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("xoE+"),r("0LE5"),r("Rdxj")],void 0===(n=(function(e,t,r,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.angleAroundAxis=t.angle=t.projectPointSignedLength=t.projectPoint=void 0,t.projectPoint=function(e,t,r){var n=i.vec3.dot(e,t)/i.vec3.dot(e,e);return i.vec3.scale(r,e,n)},t.projectPointSignedLength=function(e,t){return i.vec3.dot(e,t)/i.vec3.length(e)},t.angle=function(e,t){var n=i.vec3.dot(e,t)/(i.vec3.length(e)*i.vec3.length(t));return-r.acosClamped(n)},t.angleAroundAxis=function(e,t,n){i.vec3.normalize(o,e),i.vec3.normalize(a,t);var s=i.vec3.dot(o,a),c=r.acosClamped(s),l=i.vec3.cross(o,o,a);return i.vec3.dot(l,n)<0?2*Math.PI-c:c};var o=n.vec3f64.create(),a=n.vec3f64.create()}).apply(null,i))||(e.exports=n)},"1f+t":function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=(function(e,t){"use strict";function r(e,t,r){for(var i=0;i<r;++i)t[2*i]=e[i],t[2*i+1]=e[i]-t[2*i]}Object.defineProperty(t,"__esModule",{value:!0}),t.encodeDoubleArraySplit=t.decodeDoubleArray=t.encodeDoubleArray=t.encodeDouble=void 0,t.encodeDouble=function(e,t){n[0]=e,n[1]=e-n[0],t[0]=n[0],t[1]=n[1]},t.encodeDoubleArray=r,t.decodeDoubleArray=function(e,t,r){for(var i=0;i<r;++i)t[i]=e[2*i]+e[2*i+1]},t.encodeDoubleArraySplit=function(e,t,o,a){for(var s=0;s<a;++s)i[0]=e[s],r(i,n,1),t[s]=n[0],o[s]=n[1]};var i=new Float64Array(1),n=new Float32Array(2)}).apply(null,i))||(e.exports=n)},"1m5D":function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("CIzB")],void 0===(n=(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mat4f64=void 0,t.mat4f64=r}).apply(null,i))||(e.exports=n)},"2NOe":function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("FXVB"),r("oZZu")],void 0===(n=(function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.View=void 0,function(e){function t(e,t,i){r.mat4.translate(n,i,t),e.setUniform3fv("localOrigin",t),e.setUniformMatrix4fv("view",n)}e.bindCamPosition=function(e,t,r){e.setUniform3f("camPos",r[3]-t[0],r[7]-t[1],r[11]-t[2])},e.bindProjectionMatrix=function(e,t){e.setUniformMatrix4fv("proj",t)},e.bindNearFar=function(e,t){e.setUniform2fv("nearFar",t)},e.bindViewCustomOrigin=t,e.bindView=function(e,r){t(e,r.origin,r.camera.viewMatrix)},e.bindViewport=function(e,t){e.setUniform4fv("viewport",t.camera.fullViewport)}}(t.View||(t.View={}));var n=i.mat4f32.create()}).apply(null,i))||(e.exports=n)},"2eYJ":function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("pcDC"),r("qsST"),r("xoE+"),r("PHan"),r("FXVB"),r("1m5D"),r("0LE5"),r("Rdxj"),r("AzkI"),r("JjCO"),r("N5NQ"),r("GG08"),r("4p4v"),r("18xY")],void 0===(n=(function(e,t,r,i,n,o,a,s,c,l,u,f,d,v,p,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UP=t.normal=t.rotate=t.transform=t.equals=t.setAltitudeAt=t.altitudeAt=t.axisAt=t.extrusionContainsPoint=t.distanceToSilhouette=t.distance=t.distance2=t.projectPointLocal=t.projectPoint=t.closestPoint=t.closestPointOnSilhouette=t.intersectRayClosestSilhouette=t.intersectRay=t.fromAABoundingRect=t.setExtent=t.elevate=t.updateUnboundedPlane=t.fromValues=t.copy=t.wrap=t.create=t.BoundedPlaneClass=void 0;var m=i.getLogger("esri.views.3d.support.geometryUtils.boundedPlane");function g(e){return void 0===e&&(e=t.UP),{plane:v.create(e.plane),origin:l.vec3f64.clone(e.origin),basis1:l.vec3f64.clone(e.basis1),basis2:l.vec3f64.clone(e.basis2)}}function b(e,t){return void 0===t&&(t=g()),y(e.origin,e.basis1,e.basis2,t)}function y(e,t,r,i){return void 0===i&&(i=g()),c.vec3.copy(i.origin,e),c.vec3.copy(i.basis1,t),c.vec3.copy(i.basis2,r),_(i),function(e,t){Math.abs(c.vec3.dot(e.basis1,e.basis2)/(c.vec3.length(e.basis1)*c.vec3.length(e.basis2)))>1e-6&&m.warn(t,"Provided basis vectors are not perpendicular"),Math.abs(c.vec3.dot(e.basis1,V(e)))>1e-6&&m.warn(t,"Basis vectors and plane normal are not perpendicular"),Math.abs(-c.vec3.dot(V(e),e.origin)-e.plane[3])>1e-6&&m.warn(t,"Plane offset is not consistent with plane origin")}(i,"fromValues()"),i}function _(e){v.fromVectorsAndPoint(e.basis2,e.basis1,e.origin,e.plane)}function x(e,t,r){e!==r&&b(e,r);var i=c.vec3.scale(f.sv3d.get(),V(e),t);return c.vec3.add(r.origin,r.origin,i),r.plane[3]-=t,r}function O(e,t){void 0===t&&(t=g());var r=(e[2]-e[0])/2,i=(e[3]-e[1])/2;return c.vec3.set(t.origin,e[0]+r,e[1]+i,0),c.vec3.set(t.basis1,r,0,0),c.vec3.set(t.basis2,0,i,0),v.fromValues(0,0,1,0,t.plane),t}function P(e,t,r){return!!v.intersectRay(e.plane,t,r)&&T(e,r)}function S(e,t,r){var i=R.get();D(e,t,i,R.get());for(var o=Number.POSITIVE_INFINITY,a=0,s=N;a<s.length;a++){var l=L(e,s[a],B.get()),d=f.sv3d.get();if(v.intersectLineSegment(i,l,d)){var p=u.directionFromTo(f.sv3d.get(),t.origin,d),h=Math.abs(n.acosClamped(c.vec3.dot(t.direction,p)));h<o&&(o=h,c.vec3.copy(r,d))}}return o===Number.POSITIVE_INFINITY?M(e,t,r):r}function M(e,t,r){if(P(e,t,r))return r;var i=R.get(),n=R.get();D(e,t,i,n);for(var o=Number.POSITIVE_INFINITY,a=0,s=N;a<s.length;a++){var l=L(e,s[a],B.get()),u=f.sv3d.get();if(v.intersectLineSegmentClamp(i,l,u)){var d=p.distance2(t,u);if(!v.isPointInside(n,u))continue;d<o&&(o=d,c.vec3.copy(r,u))}}return j(e,t.origin)<o&&w(e,t.origin,r),r}function w(e,t,r){var i=v.projectPoint(e.plane,t,f.sv3d.get()),n=d.projectPointClamp(C(e,e.basis1),i,-1,1,f.sv3d.get()),o=d.projectPointClamp(C(e,e.basis2),i,-1,1,f.sv3d.get());return c.vec3.subtract(r,c.vec3.add(f.sv3d.get(),n,o),e.origin),r}function A(e,t,r){var i=e.origin,n=e.basis1,o=e.basis2,a=c.vec3.subtract(f.sv3d.get(),t,i),s=h.projectPointSignedLength(n,a),l=h.projectPointSignedLength(o,a),u=h.projectPointSignedLength(V(e),a);return c.vec3.set(r,s,l,u)}function j(e,t){var r=A(e,t,f.sv3d.get()),i=e.basis2,n=c.vec3.length(e.basis1),o=c.vec3.length(i),a=Math.max(Math.abs(r[0])-n,0),s=Math.max(Math.abs(r[1])-o,0),l=r[2];return a*a+s*s+l*l}function I(e,t){var r=-e.plane[3];return h.projectPointSignedLength(V(e),t)-r}function V(e){return v.normal(e.plane)}function T(e,t){var r=c.vec3.subtract(f.sv3d.get(),t,e.origin),i=c.vec3.squaredLength(e.basis1),n=c.vec3.squaredLength(e.basis2),o=c.vec3.dot(e.basis1,r),a=c.vec3.dot(e.basis2,r);return-o-i<0&&o-i<0&&-a-n<0&&a-n<0}function C(e,t){var r=B.get();return c.vec3.copy(r.origin,e.origin),c.vec3.copy(r.vector,t),r}function L(e,t,r){var i=e.basis1,n=e.basis2,o=e.origin,a=c.vec3.scale(f.sv3d.get(),i,t.origin[0]),s=c.vec3.scale(f.sv3d.get(),n,t.origin[1]);c.vec3.add(r.origin,a,s),c.vec3.add(r.origin,r.origin,o);var l=c.vec3.scale(f.sv3d.get(),i,t.direction[0]),u=c.vec3.scale(f.sv3d.get(),n,t.direction[1]);return c.vec3.scale(r.vector,c.vec3.add(l,l,u),2),r}function D(e,t,r,i){var n=V(e);v.fromVectorsAndPoint(n,t.direction,t.origin,r),v.fromVectorsAndPoint(v.normal(r),n,t.origin,i)}t.BoundedPlaneClass=function(){this.plane=v.create(),this.origin=l.vec3f64.create(),this.basis1=l.vec3f64.create(),this.basis2=l.vec3f64.create()},t.create=g,t.wrap=function(e,t,r){var i=z.get();return i.origin=e,i.basis1=t,i.basis2=r,i.plane=v.wrap(0,0,0,0),_(i),i},t.copy=b,t.fromValues=y,t.updateUnboundedPlane=_,t.elevate=x,t.setExtent=function(e,t,r){return O(t,r),x(r,I(e,e.origin),r),r},t.fromAABoundingRect=O,t.intersectRay=P,t.intersectRayClosestSilhouette=function(e,t,r){if(P(e,t,r))return r;var i=S(e,t,f.sv3d.get());return c.vec3.add(r,t.origin,c.vec3.scale(f.sv3d.get(),t.direction,c.vec3.distance(t.origin,i)/c.vec3.length(t.direction))),r},t.closestPointOnSilhouette=S,t.closestPoint=M,t.projectPoint=w,t.projectPointLocal=A,t.distance2=j,t.distance=function(e,t){return Math.sqrt(j(e,t))},t.distanceToSilhouette=function(e,t){for(var r=Number.NEGATIVE_INFINITY,i=0,n=N;i<n.length;i++){var o=L(e,n[i],B.get()),a=d.distance2(o,t);a>r&&(r=a)}return Math.sqrt(r)},t.extrusionContainsPoint=function(e,t){return v.isPointInside(e.plane,t)&&T(e,t)},t.axisAt=function(e,t,i,n){return function(e,t,i){switch(t){case 0:c.vec3.copy(i,e.basis1),c.vec3.normalize(i,i);break;case 1:c.vec3.copy(i,e.basis2),c.vec3.normalize(i,i);break;case 2:c.vec3.copy(i,V(e));break;default:r.neverReached(t)}return i}(e,i,n)},t.altitudeAt=I,t.setAltitudeAt=function(e,t,r,i){var n=I(e,t),o=c.vec3.scale(F,V(e),r-n);return c.vec3.add(i,t,o),i},t.equals=function(e,t){return c.vec3.exactEquals(e.basis1,t.basis1)&&c.vec3.exactEquals(e.basis2,t.basis2)&&c.vec3.exactEquals(e.origin,t.origin)},t.transform=function(e,t,r){return e!==r&&b(e,r),a.mat4.invert(U,t),a.mat4.transpose(U,U),c.vec3.transformMat4(r.basis1,e.basis1,U),c.vec3.transformMat4(r.basis2,e.basis2,U),c.vec3.transformMat4(v.normal(r.plane),v.normal(e.plane),U),c.vec3.transformMat4(r.origin,e.origin,t),v.setOffsetFromPoint(r.plane,r.origin,r.plane),r},t.rotate=function(e,t,r,i){return e!==i&&b(e,i),a.mat4.rotate(G,a.mat4.identity(G),t,r),c.vec3.transformMat4(i.basis1,e.basis1,G),c.vec3.transformMat4(i.basis2,e.basis2,G),_(i),i},t.normal=V,t.UP={plane:v.create(),origin:l.vec3f64.fromValues(0,0,0),basis1:l.vec3f64.fromValues(1,0,0),basis2:l.vec3f64.fromValues(0,1,0)};var R=new o.ObjectStack(v.create),B=new o.ObjectStack(d.create),F=l.vec3f64.create(),z=new o.ObjectStack((function(){return{origin:null,basis1:null,basis2:null,plane:null}})),N=[{origin:[-1,-1],direction:[1,0]},{origin:[1,-1],direction:[0,1]},{origin:[1,1],direction:[-1,0]},{origin:[-1,1],direction:[0,-1]}],U=s.mat4f64.create(),G=s.mat4f64.create()}).apply(null,i))||(e.exports=n)},"3PFg":function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("zOht"),r("7Aei")],void 0===(n=(function(e,t,r,i){"use strict";function n(e,t){t.vvInstancingEnabled&&(t.vvSize||t.vvColor)&&e.attributes.add("instanceFeatureAttribute","vec4"),t.vvSize?(e.vertex.uniforms.add("vvSizeMinSize","vec3"),e.vertex.uniforms.add("vvSizeMaxSize","vec3"),e.vertex.uniforms.add("vvSizeOffset","vec3"),e.vertex.uniforms.add("vvSizeFactor","vec3"),e.vertex.uniforms.add("vvSymbolRotationMatrix","mat3"),e.vertex.uniforms.add("vvSymbolAnchor","vec3"),e.vertex.code.add(i.glsl(o||(o=r.__makeTemplateObject(["\n      vec3 vvScale(vec4 _featureAttribute) {\n        return clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize);\n      }\n\n      vec4 vvTransformPosition(vec3 position, vec4 _featureAttribute) {\n        return vec4(vvSymbolRotationMatrix * ( vvScale(_featureAttribute) * (position + vvSymbolAnchor)), 1.0);\n      }\n    "],["\n      vec3 vvScale(vec4 _featureAttribute) {\n        return clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize);\n      }\n\n      vec4 vvTransformPosition(vec3 position, vec4 _featureAttribute) {\n        return vec4(vvSymbolRotationMatrix * ( vvScale(_featureAttribute) * (position + vvSymbolAnchor)), 1.0);\n      }\n    "])))),e.vertex.code.add(i.glsl(s||(s=r.__makeTemplateObject(["\n      const float eps = 1.192092896e-07;\n      vec4 vvTransformNormal(vec3 _normal, vec4 _featureAttribute) {\n        vec3 vvScale = clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize + eps, vvSizeMaxSize);\n        return vec4(vvSymbolRotationMatrix * _normal / vvScale, 1.0);\n      }\n\n      ","\n    "],["\n      const float eps = 1.192092896e-07;\n      vec4 vvTransformNormal(vec3 _normal, vec4 _featureAttribute) {\n        vec3 vvScale = clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize + eps, vvSizeMaxSize);\n        return vec4(vvSymbolRotationMatrix * _normal / vvScale, 1.0);\n      }\n\n      ","\n    "])),t.vvInstancingEnabled?i.glsl(a||(a=r.__makeTemplateObject(["\n      vec4 vvLocalNormal(vec3 _normal) {\n        return vvTransformNormal(_normal, instanceFeatureAttribute);\n      }\n\n      vec4 localPosition() {\n        return vvTransformPosition(position, instanceFeatureAttribute);\n      }"],["\n      vec4 vvLocalNormal(vec3 _normal) {\n        return vvTransformNormal(_normal, instanceFeatureAttribute);\n      }\n\n      vec4 localPosition() {\n        return vvTransformPosition(position, instanceFeatureAttribute);\n      }"]))):""))):e.vertex.code.add(i.glsl(c||(c=r.__makeTemplateObject(["\n      vec4 localPosition() { return vec4(position, 1.0); }\n\n      vec4 vvLocalNormal(vec3 _normal) { return vec4(_normal, 1.0); }\n    "],["\n      vec4 localPosition() { return vec4(position, 1.0); }\n\n      vec4 vvLocalNormal(vec3 _normal) { return vec4(_normal, 1.0); }\n    "])))),t.vvColor?(e.vertex.defines.addInt("VV_COLOR_N",8),e.vertex.code.add(i.glsl(u||(u=r.__makeTemplateObject(["\n      uniform float vvColorValues[VV_COLOR_N];\n      uniform vec4 vvColorColors[VV_COLOR_N];\n\n      vec4 vvGetColor(vec4 featureAttribute, float values[VV_COLOR_N], vec4 colors[VV_COLOR_N]) {\n        float value = featureAttribute.y;\n        if (value <= values[0]) {\n          return colors[0];\n        }\n\n        for (int i = 1; i < VV_COLOR_N; ++i) {\n          if (values[i] >= value) {\n            float f = (value - values[i-1]) / (values[i] - values[i-1]);\n            return mix(colors[i-1], colors[i], f);\n          }\n        }\n        return colors[VV_COLOR_N - 1];\n      }\n\n      ","\n    "],["\n      uniform float vvColorValues[VV_COLOR_N];\n      uniform vec4 vvColorColors[VV_COLOR_N];\n\n      vec4 vvGetColor(vec4 featureAttribute, float values[VV_COLOR_N], vec4 colors[VV_COLOR_N]) {\n        float value = featureAttribute.y;\n        if (value <= values[0]) {\n          return colors[0];\n        }\n\n        for (int i = 1; i < VV_COLOR_N; ++i) {\n          if (values[i] >= value) {\n            float f = (value - values[i-1]) / (values[i] - values[i-1]);\n            return mix(colors[i-1], colors[i], f);\n          }\n        }\n        return colors[VV_COLOR_N - 1];\n      }\n\n      ","\n    "])),t.vvInstancingEnabled?i.glsl(l||(l=r.__makeTemplateObject(["\n      vec4 vvColor() {\n        return vvGetColor(instanceFeatureAttribute, vvColorValues, vvColorColors);\n      }"],["\n      vec4 vvColor() {\n        return vvGetColor(instanceFeatureAttribute, vvColorValues, vvColorColors);\n      }"]))):""))):e.vertex.code.add(i.glsl(f||(f=r.__makeTemplateObject(["\n      vec4 vvColor() { return vec4(1.0); }\n    "],["\n      vec4 vvColor() { return vec4(1.0); }\n    "]))))}var o,a,s,c,l,u,f;Object.defineProperty(t,"__esModule",{value:!0}),t.VisualVariables=void 0,t.VisualVariables=n,function(e){function t(e,t){t.vvSizeEnabled&&(e.setUniform3fv("vvSizeMinSize",t.vvSizeMinSize),e.setUniform3fv("vvSizeMaxSize",t.vvSizeMaxSize),e.setUniform3fv("vvSizeOffset",t.vvSizeOffset),e.setUniform3fv("vvSizeFactor",t.vvSizeFactor)),t.vvColorEnabled&&(e.setUniform1fv("vvColorValues",t.vvColorValues),e.setUniform4fv("vvColorColors",t.vvColorColors))}e.bindUniforms=t,e.bindUniformsWithOpacity=function(e,r){t(e,r),r.vvOpacityEnabled&&(e.setUniform1fv("vvOpacityValues",r.vvOpacityValues),e.setUniform1fv("vvOpacityOpacities",r.vvOpacityOpacities))},e.bindUniformsForSymbols=function(e,r){t(e,r),r.vvSizeEnabled&&(e.setUniform3fv("vvSymbolAnchor",r.vvSymbolAnchor),e.setUniformMatrix3fv("vvSymbolRotationMatrix",r.vvSymbolRotationMatrix))}}(n=t.VisualVariables||(t.VisualVariables={}))}).apply(null,i))||(e.exports=n)},"3RHn":function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("KBgh"),r("0LE5"),r("Rdxj"),r("CIy2")],void 0===(n=(function(e,t,r,i,n,o){"use strict";var a=function(){function e(t,r,a,s){this.primitiveIndices=t,this._numIndexPerPrimitive=r,this.indices=a,this._position=s,this.center=n.vec3f64.create(),o.assert(t.length>=1),o.assert(a.length%this._numIndexPerPrimitive==0),o.assert(a.length>=t.length*this._numIndexPerPrimitive),o.assert(3===this._position.size||4===this._position.size);var c=this._position,l=c.data,u=c.offsetIdx,f=c.strideIdx,d=0,v=t.length,p=u+f*a[this._numIndexPerPrimitive*t[d]];for(e.tmpIndices.clear(),e.tmpIndices.push(p),this.bbMin=n.vec3f64.fromValues(l[p],l[p+1],l[p+2]),this.bbMax=n.vec3f64.clone(this.bbMin);d<v;++d)for(var h=this._numIndexPerPrimitive*t[d],m=0;m<this._numIndexPerPrimitive;++m){e.tmpIndices.push(p=u+f*a[h+m]);var g=l[p];this.bbMin[0]=Math.min(g,this.bbMin[0]),this.bbMax[0]=Math.max(g,this.bbMax[0]),g=l[p+1],this.bbMin[1]=Math.min(g,this.bbMin[1]),this.bbMax[1]=Math.max(g,this.bbMax[1]),g=l[p+2],this.bbMin[2]=Math.min(g,this.bbMin[2]),this.bbMax[2]=Math.max(g,this.bbMax[2])}i.vec3.lerp(this.center,this.bbMin,this.bbMax,.5),this.bsRadius=.5*Math.max(Math.max(this.bbMax[0]-this.bbMin[0],this.bbMax[1]-this.bbMin[1]),this.bbMax[2]-this.bbMin[2]);var b=this.bsRadius*this.bsRadius;for(d=0;d<e.tmpIndices.length;++d){var y=l[p=e.tmpIndices.data[d]]-this.center[0],_=l[p+1]-this.center[1],x=l[p+2]-this.center[2],O=y*y+_*_+x*x;if(!(O<=b)){var P=Math.sqrt(O),S=.5*(P-this.bsRadius);this.bsRadius=this.bsRadius+S,b=this.bsRadius*this.bsRadius;var M=S/P;this.center[0]+=y*M,this.center[1]+=_*M,this.center[2]+=x*M}}e.tmpIndices.clear()}return e.prototype.getCenter=function(){return this.center},e.prototype.getBSRadius=function(){return this.bsRadius},e.prototype.getBBMin=function(){return this.bbMin},e.prototype.getBBMax=function(){return this.bbMax},e.prototype.getPrimitiveIndices=function(){return this.primitiveIndices},e.prototype.getIndices=function(){return this.indices},e.prototype.getPosition=function(){return this._position},e.prototype.getChildren=function(){if(this._children)return this._children;if(i.vec3.squaredDistance(this.bbMin,this.bbMax)>1){for(var t=i.vec3.lerp(n.vec3f64.create(),this.bbMin,this.bbMax,.5),r=this.primitiveIndices.length,o=new Uint8Array(r),a=new Array(8),s=0;s<8;++s)a[s]=0;var c=this._position,l=c.data,u=c.offsetIdx,f=c.strideIdx;for(s=0;s<r;++s){for(var d=0,v=this._numIndexPerPrimitive*this.primitiveIndices[s],p=u+f*this.indices[v],h=l[p],m=l[p+1],g=l[p+2],b=1;b<this._numIndexPerPrimitive;++b){var y=l[p=u+f*this.indices[v+b]],_=l[p+1],x=l[p+2];y<h&&(h=y),_<m&&(m=_),x<g&&(g=x)}h<t[0]&&(d|=1),m<t[1]&&(d|=2),g<t[2]&&(d|=4),o[s]=d,++a[d]}var O=0;for(s=0;s<8;++s)a[s]>0&&++O;if(O<2)return;var P=new Array(8);for(s=0;s<8;++s)P[s]=a[s]>0?new Uint32Array(a[s]):void 0;for(s=0;s<8;++s)a[s]=0;for(s=0;s<r;++s)P[d=o[s]][a[d]++]=this.primitiveIndices[s];for(this._children=new Array(8),s=0;s<8;++s)void 0!==P[s]&&(this._children[s]=new e(P[s],this._numIndexPerPrimitive,this.indices,this._position))}return this._children},e}();return function(e){e.tmpIndices=new r({deallocator:null})}(a||(a={})),a}).apply(null,i))||(e.exports=n)},"3kdR":function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("zOht"),r("7Aei")],void 0===(n=(function(e,t,r,i){"use strict";var n,o;Object.defineProperty(t,"__esModule",{value:!0}),t.Transform=void 0,t.Transform=function(e,t){e.vertex.code.add(i.glsl(t.linearDepth?n||(n=r.__makeTemplateObject(["\n    vec4 transformPositionWithDepth(mat4 proj, mat4 view, vec3 pos, vec2 nearFar, out float depth) {\n      vec4 eye = view * vec4(pos, 1.0);\n      depth = (-eye.z - nearFar[0]) / (nearFar[1] - nearFar[0]) ;\n      return proj * eye;\n    }\n    "],["\n    vec4 transformPositionWithDepth(mat4 proj, mat4 view, vec3 pos, vec2 nearFar, out float depth) {\n      vec4 eye = view * vec4(pos, 1.0);\n      depth = (-eye.z - nearFar[0]) / (nearFar[1] - nearFar[0]) ;\n      return proj * eye;\n    }\n    "])):o||(o=r.__makeTemplateObject(["\n    vec4 transformPosition(mat4 proj, mat4 view, vec3 pos) {\n      // Make sure the order of operations is the same as in transformPositionWithDepth.\n      return proj * (view * vec4(pos, 1.0));\n    }\n    "],["\n    vec4 transformPosition(mat4 proj, mat4 view, vec3 pos) {\n      // Make sure the order of operations is the same as in transformPositionWithDepth.\n      return proj * (view * vec4(pos, 1.0));\n    }\n    "]))))}}).apply(null,i))||(e.exports=n)},"4p4v":function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("PHan"),r("jBNx"),r("W9tT"),r("0LE5"),r("Rdxj"),r("JjCO")],void 0===(n=(function(e,t,r,i,n,o,a,s){"use strict";function c(e){return e?{origin:a.vec3f64.clone(e.origin),direction:a.vec3f64.clone(e.direction)}:{origin:a.vec3f64.create(),direction:a.vec3f64.create()}}function l(e,t,r){return void 0===r&&(r=c()),o.vec3.copy(r.origin,e),o.vec3.copy(r.direction,t),r}function u(e,t,r){void 0===r&&(r=c());var a=i.castRenderScreenPointArray3(n.vec2.copy(s.sv3d.get(),t));a[2]=0,e.unprojectPoint(a,r.origin);var l=i.castRenderScreenPointArray3(n.vec2.copy(s.sv3d.get(),t));l[2]=1;var u=e.unprojectPoint(l,s.sv3d.get());return o.vec3.subtract(r.direction,u,r.origin),r}function f(e,t,r){void 0===r&&(r=c()),o.vec3.copy(r.origin,e.eye);var i=o.vec3.set(s.sv3d.get(),t[0],t[1],1),n=e.unprojectPoint(i,s.sv3d.get());return o.vec3.subtract(r.direction,n,r.origin),r}function d(e,t){var r=o.vec3.cross(s.sv3d.get(),o.vec3.normalize(s.sv3d.get(),e.direction),o.vec3.subtract(s.sv3d.get(),t,e.origin));return o.vec3.dot(r,r)}function v(){return{origin:null,direction:null}}Object.defineProperty(t,"__esModule",{value:!0}),t.createWrapper=t.closestPoint=t.distance=t.distance2=t.fromRenderAtEye=t.fromScreenAtEye=t.fromRender=t.fromScreen=t.fromValues=t.fromPoints=t.copy=t.wrap=t.create=void 0,t.create=c,t.wrap=function(e,t){var r=p.get();return r.origin=e,r.direction=t,r},t.copy=function(e,t){return void 0===t&&(t=c()),l(e.origin,e.direction,t)},t.fromPoints=function(e,t,r){return void 0===r&&(r=c()),o.vec3.copy(r.origin,e),o.vec3.subtract(r.direction,t,e),r},t.fromValues=l,t.fromScreen=function(e,t,r){return void 0===r&&(r=c()),u(e,e.screenToRender(t,i.castRenderScreenPointArray3(s.sv3d.get())),r)},t.fromRender=u,t.fromScreenAtEye=function(e,t,r){return void 0===r&&(r=c()),f(e,e.screenToRender(t,i.castRenderScreenPointArray3(s.sv3d.get())),r)},t.fromRenderAtEye=f,t.distance2=d,t.distance=function(e,t){return Math.sqrt(d(e,t))},t.closestPoint=function(e,t,r){var i=o.vec3.dot(e.direction,o.vec3.subtract(r,t,e.origin));return o.vec3.add(r,e.origin,o.vec3.scale(r,e.direction,i)),r},t.createWrapper=v;var p=new r.ObjectStack(v)}).apply(null,i))||(e.exports=n)},"51bw":function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("xf8T")],void 0===(n=(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mat3f64=void 0,t.mat3f64=r}).apply(null,i))||(e.exports=n)},"62Ht":function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("W0kZ")],void 0===(n=(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Object3DStateSet=t.generateObject3DStateId=void 0;var i=new r.IdGen;t.generateObject3DStateId=function(e){return{id:i.gen(0===e?"highlight":"occludee"),channel:e}};var n=function(){function e(){this.items=[]}return e.prototype.addObject=function(e,t){this.items.push({type:0,objectStateId:t,object:e})},e.prototype.addRenderGeometry=function(e,t,r){this.items.push({type:1,objectStateId:t,renderGeometry:e,owner:r})},e.prototype.addExternal=function(e,t){this.items.push({type:2,objectStateId:t,remove:e})},e.prototype.remove=function(e){for(var t=this.items.length-1;t>=0;--t){var r=this.items[t];r.objectStateId===e&&(this._removeObjectStateItem(r),this.items.splice(t,1))}},e.prototype.removeObject=function(e){for(var t=this.items.length-1;t>=0;--t){var r=this.items[t];0===r.type&&r.object===e&&(this._removeObjectStateItem(r),this.items.splice(t,1))}},e.prototype.removeRenderGeometry=function(e){for(var t=this.items.length-1;t>=0;--t){var r=this.items[t];1===r.type&&r.renderGeometry===e&&(this._removeObjectStateItem(r),this.items.splice(t,1))}},e.prototype.removeAll=function(){var e=this;this.items.forEach((function(t){e._removeObjectStateItem(t)})),this.items=[]},e.prototype._removeObjectStateItem=function(e){switch(e.type){case 0:0===e.objectStateId.channel?e.object.removeHighlight(e.objectStateId):1===e.objectStateId.channel&&e.object.removeOcclude(e.objectStateId);break;case 1:e.owner.removeRenderGeometryObjectState(e.renderGeometry,e.objectStateId);break;case 2:e.remove(e.objectStateId)}},e}();t.Object3DStateSet=n}).apply(null,i))||(e.exports=n)},"6t3m":function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("zOht"),r("7Aei")],void 0===(n=(function(e,t,r,i){"use strict";var n,o,a;Object.defineProperty(t,"__esModule",{value:!0}),t.VertexColor=void 0,t.VertexColor=function(e,t){t.attributeColor?(e.attributes.add("color","vec4"),e.varyings.add("vColor","vec4"),e.vertex.code.add(i.glsl(n||(n=r.__makeTemplateObject(["\n      void forwardVertexColor() { vColor = color; }\n    "],["\n      void forwardVertexColor() { vColor = color; }\n    "])))),e.vertex.code.add(i.glsl(o||(o=r.__makeTemplateObject(["\n      void forwardNormalizedVertexColor() { vColor = color * 0.003921568627451; }\n    "],["\n      void forwardNormalizedVertexColor() { vColor = color * 0.003921568627451; }\n    "]))))):e.vertex.code.add(i.glsl(a||(a=r.__makeTemplateObject(["\n      void forwardVertexColor() {}\n      void forwardNormalizedVertexColor() {}\n    "],["\n      void forwardVertexColor() {}\n      void forwardNormalizedVertexColor() {}\n    "]))))}}).apply(null,i))||(e.exports=n)},"7Aei":function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=(function(e,t){"use strict";function r(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var i="",n=0;n<t.length;n++)i+=e[n]+t[n];return i+e[e.length-1]}Object.defineProperty(t,"__esModule",{value:!0}),t.glsl=void 0,t.glsl=r,function(e){e.int=function(e){return Math.round(e).toString()},e.float=function(e){return e.toPrecision(8)}}(r=t.glsl||(t.glsl={}))}).apply(null,i))||(e.exports=n)},"9DjX":function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("LxLY"),r("YX1r"),r("51bw"),r("FXVB"),r("1m5D"),r("EuvN"),r("lLWD"),r("0LE5"),r("vlC2"),r("Rdxj"),r("2fXB"),r("O7NG"),r("aWgr"),r("2eYJ"),r("/dtL"),r("ZJC8")],void 0===(n=(function(e,t,r,i,n,o,a,s,c,l,u,f,d,v,p,h,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TERRAIN_ID=t.getVerticalOffsetTerrain=t.getVerticalOffsetI3S=t.getVerticalOffsetObject3D=t.Object3DVerticalOffsetGlobalViewingMode=t.I3SVerticalOffsetGlobalViewingMode=t.TerrainVerticalOffsetGlobalViewingMode=t.IntersectorResult=t.IntersectorResults=t.IntersectorTransform=t.IntersectorOptions=t.sliceFilterPredicate=void 0,t.sliceFilterPredicate=function(e){return function(t,r,i){return l.vec3.lerp(V,t,r,i),!h.extrusionContainsPoint(e,V)}},t.IntersectorOptions=function(){this.verticalOffset=0,this.selectionMode=!1,this.hud=!0,this.selectOpaqueTerrainOnly=!0,this.invisibleTerrain=!1,this.backfacesTerrain=!0,this.isFiltered=!1,this.store=2};var b=function(){function e(){this._transform=a.mat4f64.create(),this._transformInverse=new y({value:this._transform},o.mat4.invert,a.mat4f64.create),this._transformInverseTranspose=new y(this._transformInverse,o.mat4.transpose,a.mat4f64.create),this._transformTranspose=new y({value:this._transform},o.mat4.transpose,a.mat4f64.create),this._transformInverseRotation=new y({value:this._transform},i.mat3.normalFromMat4Legacy,n.mat3f64.create)}return e.prototype.invalidateLazyTransforms=function(){this._transformInverse.invalidate(),this._transformInverseTranspose.invalidate(),this._transformTranspose.invalidate(),this._transformInverseRotation.invalidate()},Object.defineProperty(e.prototype,"transform",{get:function(){return this._transform},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"inverse",{get:function(){return this._transformInverse.value},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"inverseTranspose",{get:function(){return this._transformInverseTranspose.value},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"inverseRotation",{get:function(){return this._transformInverseRotation.value},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"transpose",{get:function(){return this._transformTranspose.value},enumerable:!1,configurable:!0}),e.prototype.setTransformMatrix=function(e){o.mat4.copy(this._transform,e)},e.prototype.multiplyTransform=function(e){o.mat4.multiply(this._transform,this._transform,e)},e.prototype.set=function(e){o.mat4.copy(this._transform,e),this.invalidateLazyTransforms()},e.prototype.setAndInvalidateLazyTransforms=function(e,t){this.setTransformMatrix(e),this.multiplyTransform(t),this.invalidateLazyTransforms()},e}();t.IntersectorTransform=b;var y=function(){function e(e,t,r){this.original=e,this.update=t,this.dirty=!0,this.transform=r()}return e.prototype.invalidate=function(){this.dirty=!0},Object.defineProperty(e.prototype,"value",{get:function(){return this.dirty&&(this.update(this.transform,this.original.value),this.dirty=!1),this.transform},enumerable:!1,configurable:!0}),e}(),_=function(){function e(){this.min=new x,this.max=new x,this.hud=new x,this.ground=new x}return e.prototype.init=function(e){this.min.init(e),this.max.init(e),this.hud.init(e),this.ground.init(e),this.all=[]},e}();t.IntersectorResults=_;var x=function(){function e(e){this.normal=f.vec3f64.create(),this.transformation=a.mat4f64.create(),this._ray=p.ray.create(),this.init(e)}return Object.defineProperty(e.prototype,"ray",{get:function(){return this._ray},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasIntersectionPoint",{get:function(){return null!=this.dist},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"distanceInRenderSpace",{get:function(){if(null!=this.dist)return l.vec3.scale(T,this.ray.direction,this.dist),l.vec3.length(T)},enumerable:!1,configurable:!0}),e.prototype.getIntersectionPoint=function(e){return!!this.hasIntersectionPoint&&(l.vec3.scale(T,this.ray.direction,this.dist),l.vec3.add(e,this.ray.origin,T),!0)},e.prototype.getTransformedNormal=function(e){return l.vec3.copy(C,this.normal),C[3]=0,d.vec4.transformMat4(C,C,this.transformation),l.vec3.copy(e,C),l.vec3.normalize(e,e),e},e.prototype.init=function(e){this.dist=void 0,this.target=void 0,this.name=void 0,this.drapedLayerOrder=void 0,this.drapedLayerGraphicOrder=void 0,this.center=null,this.geometryId=null,this.triangleNr=null,this.intersector="Stage",e?p.ray.copy(e,this._ray):this._ray=p.ray.create()},e.prototype.set=function(e,t,r,i,n,a,s,c,u,d){e instanceof g&&(e={type:"stage",obj:e}),this.dist=r,l.vec3.copy(this.normal,i),o.mat4.copy(this.transformation,n),this.target=e,this.name=t,this.drapedLayerOrder=a,this.center=s?f.vec3f64.clone(s):null,this.geometryId=c,this.triangleNr=u,this.drapedLayerGraphicOrder=d},e.prototype.copyFrom=function(e){p.ray.copy(e._ray,this._ray),this.dist=e.dist,this.target=e.target,this.name=e.name,this.drapedLayerOrder=e.drapedLayerOrder,this.center=e.center?f.vec3f64.clone(e.center):null,this.geometryId=e.geometryId,this.triangleNr=e.triangleNr,this.intersector=e.intersector,this.drapedLayerGraphicOrder=e.drapedLayerGraphicOrder,l.vec3.copy(this.normal,e.normal),o.mat4.copy(this.transformation,e.transformation)},e.prototype.toOwner=function(e){if(!this.target)return null;switch(this.target.type){case"stage":return O(this.target.obj.metadata,e);case"external":switch(this.intersector){case"PointRenderer":return function(e,t){var r=e.metadata.layerUid;return null!=r?t.map.findLayerByUid(r):null}(this.target,e);case"I3S":case"IM":case"LodRenderer":case"OverlayRenderer":return O(this.target.metadata,e);case"TerrainRenderer":return e.map&&e.map.ground}}return null},e.prototype.toGraphic=function(e){if(!this.target)return null;switch(this.target.type){case"stage":return P(this.target.obj.metadata,e);case"external":switch(this.intersector){case"PointRenderer":return this.target.metadata.createGraphic();case"I3S":case"IM":case"LodRenderer":case"OverlayRenderer":return P(this.target.metadata,e)}}return null},e}();function O(e,t){return r.isNone(e)||null==e.layerUid?null:r.isSome(t.graphicsView)&&e.layerUid===t.graphicsView.mockLayerId?t.graphics:t.map.findLayerByUid(e.layerUid)}function P(e,t){if(r.isNone(e))return null;var i=O(e,t);if(r.isNone(i))return null;if(i===t.graphics)return r.isSome(t.graphicsView)?r.unwrap(t.graphicsView.getGraphicFromGraphicUid(e.graphicUid)):null;var n=t.allLayerViews.find((function(e){return e.layer===i}));return n?function(e,t){return!e||e.suspended?null:"getGraphicFromIntersectorMetadata"in e&&t?e.getGraphicFromIntersectorMetadata(t):"getGraphicFromGraphicUid"in e&&null!=t.graphicUid?e.getGraphicFromGraphicUid(t.graphicUid):null}(n,e):null}t.IntersectorResult=x;var S=function(){function e(e){void 0===e&&(e=0),this.offset=e,this.tmpVertex=f.vec3f64.create()}return e.prototype.applyToVertex=function(e,t,r){var i=e+this.localOrigin[0],n=t+this.localOrigin[1],o=r+this.localOrigin[2],a=this.offset/Math.sqrt(i*i+n*n+o*o);return this.tmpVertex[0]=e+i*a,this.tmpVertex[1]=t+n*a,this.tmpVertex[2]=r+o*a,this.tmpVertex},e.prototype.applyToAabb=function(e){var t=e[0]+this.localOrigin[0],r=e[1]+this.localOrigin[1],i=e[2]+this.localOrigin[2],n=e[3]+this.localOrigin[0],o=e[4]+this.localOrigin[1],a=e[5]+this.localOrigin[2],s=this.offset/Math.sqrt(t*t+r*r+i*i);e[0]+=t*s,e[1]+=r*s,e[2]+=i*s;var c=this.offset/Math.sqrt(n*n+o*o+a*a);return e[3]+=n*c,e[4]+=o*c,e[5]+=a*c,e},e}();t.TerrainVerticalOffsetGlobalViewingMode=S;var M=function(){function e(e){void 0===e&&(e=0),this.offset=e,this.componentLocalOriginLength=0,this.tmpVertex=f.vec3f64.create(),this.mbs=v.vec4f64.create(),this.obb={center:f.vec3f64.create(),halfSize:u.vec3f32.create(),quaternion:null}}return Object.defineProperty(e.prototype,"localOrigin",{set:function(e){this.componentLocalOriginLength=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2])},enumerable:!1,configurable:!0}),e.prototype.applyToVertex=function(e,t,r){var i=e,n=t,o=r+this.componentLocalOriginLength,a=this.offset/Math.sqrt(i*i+n*n+o*o);return this.tmpVertex[0]=e+i*a,this.tmpVertex[1]=t+n*a,this.tmpVertex[2]=r+o*a,this.tmpVertex},e.prototype.applyToAabb=function(e){var t=e[0],r=e[1],i=e[2]+this.componentLocalOriginLength,n=e[3],o=e[4],a=e[5]+this.componentLocalOriginLength,s=this.offset/Math.sqrt(t*t+r*r+i*i);e[0]+=t*s,e[1]+=r*s,e[2]+=i*s;var c=this.offset/Math.sqrt(n*n+o*o+a*a);return e[3]+=n*c,e[4]+=o*c,e[5]+=a*c,e},e.prototype.applyToMbs=function(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]),r=this.offset/t;return this.mbs[0]=e[0]+e[0]*r,this.mbs[1]=e[1]+e[1]*r,this.mbs[2]=e[2]+e[2]*r,this.mbs[3]=e[3]+e[3]*this.offset/t,this.mbs},e.prototype.applyToObb=function(e){var t=e.center,r=this.offset/Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);this.obb.center[0]=t[0]+t[0]*r,this.obb.center[1]=t[1]+t[1]*r,this.obb.center[2]=t[2]+t[2]*r,l.vec3.transformQuat(this.obb.halfSize,e.halfSize,e.quaternion),l.vec3.add(this.obb.halfSize,this.obb.halfSize,e.center);var i=this.offset/Math.sqrt(this.obb.halfSize[0]*this.obb.halfSize[0]+this.obb.halfSize[1]*this.obb.halfSize[1]+this.obb.halfSize[2]*this.obb.halfSize[2]);return this.obb.halfSize[0]+=this.obb.halfSize[0]*i,this.obb.halfSize[1]+=this.obb.halfSize[1]*i,this.obb.halfSize[2]+=this.obb.halfSize[2]*i,l.vec3.subtract(this.obb.halfSize,this.obb.halfSize,e.center),s.quat.conjugate(L,e.quaternion),l.vec3.transformQuat(this.obb.halfSize,this.obb.halfSize,L),this.obb.halfSize[0]*=this.obb.halfSize[0]<0?-1:1,this.obb.halfSize[1]*=this.obb.halfSize[1]<0?-1:1,this.obb.halfSize[2]*=this.obb.halfSize[2]<0?-1:1,this.obb.quaternion=e.quaternion,this.obb},e}();t.I3SVerticalOffsetGlobalViewingMode=M;var w=function(){function e(e){void 0===e&&(e=0),this.offset=e,this.sphere=m.create(),this.tmpVertex=f.vec3f64.create()}return e.prototype.applyToVertex=function(e,t,r){var i=this.objectTransform.transform,n=i[0]*e+i[4]*t+i[8]*r+i[12],o=i[1]*e+i[5]*t+i[9]*r+i[13],a=i[2]*e+i[6]*t+i[10]*r+i[14],s=this.offset/Math.sqrt(n*n+o*o+a*a),c=this.objectTransform.inverse;return this.tmpVertex[0]=c[0]*(n+=n*s)+c[4]*(o+=o*s)+c[8]*(a+=a*s)+c[12],this.tmpVertex[1]=c[1]*n+c[5]*o+c[9]*a+c[13],this.tmpVertex[2]=c[2]*n+c[6]*o+c[10]*a+c[14],this.tmpVertex},e.prototype.applyToMinMax=function(e,t){var r=this.offset/Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]+=e[0]*r,e[1]+=e[1]*r,e[2]+=e[2]*r;var i=this.offset/Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]+=t[0]*i,t[1]+=t[1]*i,t[2]+=t[2]*i},e.prototype.applyToAabb=function(e){var t=this.offset/Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]+=e[0]*t,e[1]+=e[1]*t,e[2]+=e[2]*t;var r=this.offset/Math.sqrt(e[3]*e[3]+e[4]*e[4]+e[5]*e[5]);return e[3]+=e[3]*r,e[4]+=e[4]*r,e[5]+=e[5]*r,e},e.prototype.applyToBoundingSphere=function(e,t){var r=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]),i=this.offset/r;return this.sphere.center[0]=t[0]+t[0]*i,this.sphere.center[1]=t[1]+t[1]*i,this.sphere.center[2]=t[2]+t[2]*i,this.sphere.radius=e+e*this.offset/r,this.sphere},e}();t.Object3DVerticalOffsetGlobalViewingMode=w;var A=new w;t.getVerticalOffsetObject3D=function(e){return r.isSome(e)?(A.offset=e,A):null};var j=new M;t.getVerticalOffsetI3S=function(e){return r.isSome(e)?(j.offset=e,j):null};var I=new S;t.getVerticalOffsetTerrain=function(e){return r.isSome(e)?(I.offset=e,I):null},t.TERRAIN_ID="terrain";var V=f.vec3f64.create(),T=f.vec3f64.create(),C=v.vec4f64.create(),L=c.quatf64.create()}).apply(null,i))||(e.exports=n)},AgDx:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("+nCE"),r("CIy2")],void 0===(n=(function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GeometryData=void 0;var n=function(){function e(t,r,i){void 0===r&&(r=e.DefaultIndices),void 0===i&&(i="triangle"),this.initialize(t,r,i)}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"vertexAttributes",{get:function(){return this._vertexAttributes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"indices",{get:function(){return this._indices},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"indexCount",{get:function(){var e=i.getFirstObjectValue(this._indices);return null==e?0:e.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"primitiveType",{get:function(){return this._primitiveType},enumerable:!1,configurable:!0}),e.prototype.getVertexAttr=function(){return this.vertexAttributes},e.prototype.initialize=function(t,n,o){void 0===n&&(n=e.DefaultIndices),void 0===o&&(o="triangle");var a={};for(var s in t){var c=t[s],l=c.size;a[s]={data:c.data,size:l,offsetIdx:0,strideIdx:l}}if(n===e.DefaultIndices){var u=function(e){var t=i.getFirstObjectValue(e);return null==t?0:t.data.length/t.size}(a),f=r.generateDefaultIndexArray(u);for(var d in n={},a)n[d]=f}this._id=r.getNewId(),this._vertexAttributes=a,this._indices=n,this._primitiveType=o},e.prototype.toRenderData=function(){return{id:this._id.toString(),indices:this._indices,vertexAttr:this._vertexAttributes}},e.prototype.getIndices=function(e){return this._indices[e]},e.prototype.getAttribute=function(e){return this._vertexAttributes[e]},e.prototype.estimateGpuMemoryUsage=function(){var e=0;if(this._indices[i.VertexAttrConstants.POSITION]){var t=3;e+=this._indices[i.VertexAttrConstants.POSITION].length*t*4}return this._indices[i.VertexAttrConstants.NORMAL]&&(e+=this._indices[i.VertexAttrConstants.NORMAL].length*(t=3)*4),this._indices[i.VertexAttrConstants.UV0]&&(e+=this._indices[i.VertexAttrConstants.UV0].length*(t=2)*4),this._indices[i.VertexAttrConstants.COLOR]&&(e+=this._indices[i.VertexAttrConstants.COLOR].length*(t=1)*4),e},e.DefaultIndices={},e}();t.GeometryData=n}).apply(null,i))||(e.exports=n)},CIy2:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("xoE+"),r("FXVB"),r("W9tT"),r("DIqE"),r("Rdxj"),r("2fXB"),r("O7NG")],void 0===(n=(function(e,t,r,i,n,o,a,s,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.inverseProjectionInfo=t.unpackFloatRGBA=t.packFloatRGBA=t.fovd2fovy=t.fovd2fovx=t.fovy2fovd=t.fovx2fovd=t.fovy2fovx=t.fovx2fovy=t.isTranslationMatrix=t.createTranslationMatrix=t.getMatrixTranslation=t.setMatrixTranslation3=t.setMatrixTranslation=t.logWithBase=t.objectEmpty=t.getFirstObjectValue=t.getFirstObjectKey=t.project=t.rayRay2D=t.rayBoxTest=t.rayTriangle3D=t.dec2hex=t.rgb2hex=t.hex2rgb=t.fallbackIfUndefined=t.encodeNormal=t.encodeInt16=t.verify=t.assert=t.VertexAttrConstants=t.AssertException=void 0;var l=c.vec4f64.create(),u=function(){function e(e){this.message=e}return e.prototype.toString=function(){return"AssertException: "+this.message},e}();function f(e,t){if(!e){t=t||"assert";var r=new Error(t);throw r.stack&&console.log(r.stack),new u(t)}}function d(e){for(var t in e)return t}function v(e,t){e[12]=t[0],e[13]=t[1],e[14]=t[2]}function p(e,t){void 0===t&&(t=0);for(var r=0,i=0;i<4;i++)r+=e[t+i]*m[i];return r}t.AssertException=u,t.VertexAttrConstants={POSITION:"position",NORMAL:"normal",UV0:"uv0",UVMAPSPACE:"uvMapSpace",MEANVERTEXPOSITION:"meanVertexPosition",AUXPOS1:"auxpos1",AUXPOS2:"auxpos2",BOUND1:"bound1",BOUND2:"bound2",BOUND3:"bound3",COLOR:"color",SYMBOLCOLOR:"symbolColor",SIZE:"size",TANGENT:"tangent"},t.assert=f,t.verify=function(e,t){e||(t=t||"",console.warn("Verify failed: "+t+"\n"+new Error("verify").stack))},t.encodeInt16=function(e){return r.clamp(Math.round(32767*e),-32767,32767)},t.encodeNormal=function(e,t){var r=Math.abs(e[0]),i=Math.abs(e[1]),n=1/(r+i+Math.abs(e[2])),o=r*n,a=i*n,s=Math.min(e[2]*n,0);t[0]=(e[0]<0?-1:1)*(o-s),t[1]=(e[1]<0?-1:1)*(a-s)},t.fallbackIfUndefined=function(e,t){return void 0===e?t:e},t.hex2rgb=function(e){return[((e=Math.floor(e))>>16&255)/255,(e>>8&255)/255,(255&e)/255]},t.rgb2hex=function(e){return"0x"+((r.clamp(Math.round(255*e[0]),0,255)<<16)+(r.clamp(Math.round(255*e[1]),0,255)<<8)+r.clamp(Math.round(255*e[2]),0,255)).toString(16)},t.dec2hex=function(e){var t=e.toString(16);return"00000000".substr(0,8-t.length)+t},t.rayTriangle3D=function(e,t,r,i,n,o,s,c,l){void 0===l&&(l=a.vec3f64.create());var u=i[s]-r[o],f=i[s+1]-r[o+1],d=i[s+2]-r[o+2],v=n[c]-r[o],p=n[c+1]-r[o+1],h=n[c+2]-r[o+2],m=t[1]*h-p*t[2],g=t[2]*v-h*t[0],b=t[0]*p-v*t[1],y=u*m+f*g+d*b;if(y>-1e-5&&y<1e-5)return!1;var _=1/y,x=e[0]-r[o],O=e[1]-r[o+1],P=e[2]-r[o+2];if(l[1]=_*(x*m+O*g+P*b),l[1]<0||l[1]>1)return!1;var S=O*d-f*P,M=P*u-d*x,w=x*f-u*O;return l[2]=_*(t[0]*S+t[1]*M+t[2]*w),!(l[2]<0||l[1]+l[2]>1||(l[0]=_*(v*S+p*M+h*w),0))},t.rayBoxTest=function(e,t,r,i){var n,o=(r[0]-e[0])/t[0],a=(i[0]-e[0])/t[0];o>a&&(n=o,o=a,a=n);var s=(r[1]-e[1])/t[1],c=(i[1]-e[1])/t[1];if(s>c&&(n=s,s=c,c=n),o>c||s>a)return!1;s>o&&(o=s),c<a&&(a=c);var l=(r[2]-e[2])/t[2],u=(i[2]-e[2])/t[2];return l>u&&(n=l,l=u,u=n),!(o>u||l>a||(u<a&&(a=u),a<0))},t.rayRay2D=function(e,t,r,i,n,a){void 0===a&&(a=o.vec2f64.create());var s=(i[n]-r[n])*(t[0]-e[0])-(i[0]-r[0])*(t[n]-e[n]);if(0===s)return!1;var c=((i[0]-r[0])*(e[n]-r[n])-(i[n]-r[n])*(e[0]-r[0]))/s;return a[0]=e[0]+c*(t[0]-e[0]),a[1]=e[n]+c*(t[n]-e[n]),!0},t.project=function(e,t,r,i,n){n||(n=e),l[0]=e[0],l[1]=e[1],l[2]=e[2],l[3]=1,s.vec4.transformMat4(l,l,t),n.length>2&&(n[2]=-l[2]),s.vec4.transformMat4(l,l,r),f(0!==l[3]),n[0]=l[0]/l[3],n[1]=l[1]/l[3],n[2]=l[2]/l[3],n[0]=(.5*n[0]+.5)*i[2]+i[0],n[1]=(.5*n[1]+.5)*i[3]+i[1]},t.getFirstObjectKey=d,t.getFirstObjectValue=function(e){return e[d(e)]},t.objectEmpty=function(e){for(var t in e)return!1;return!0},t.logWithBase=function(e,t){return Math.log(e)/Math.log(t)},t.setMatrixTranslation=v,t.setMatrixTranslation3=function(e,t,r,i){e[12]=t,e[13]=r,e[14]=i},t.getMatrixTranslation=function(e,t){return void 0===t&&(t=a.vec3f64.create()),t[0]=e[12],t[1]=e[13],t[2]=e[14],t},t.createTranslationMatrix=function(e,t){return v(e=i.mat4.identity(e),t),e},t.isTranslationMatrix=function(e){return 1===e[0]&&0===e[1]&&0===e[2]&&0===e[3]&&0===e[4]&&1===e[5]&&0===e[6]&&0===e[7]&&0===e[8]&&0===e[9]&&1===e[10]&&0===e[11]&&1===e[15]},t.fovx2fovy=function(e,t,r){return 2*Math.atan(r*Math.tan(.5*e)/t)},t.fovy2fovx=function(e,t,r){return 2*Math.atan(t*Math.tan(.5*e)/r)},t.fovx2fovd=function(e,t,r){return 2*Math.atan(Math.sqrt(t*t+r*r)*Math.tan(.5*e)/t)},t.fovy2fovd=function(e,t,r){return 2*Math.atan(Math.sqrt(t*t+r*r)*Math.tan(.5*e)/r)},t.fovd2fovx=function(e,t,r){return 2*Math.atan(t*Math.tan(.5*e)/Math.sqrt(t*t+r*r))},t.fovd2fovy=function(e,t,r){return 2*Math.atan(r*Math.tan(.5*e)/Math.sqrt(t*t+r*r))},t.packFloatRGBA=function(e,t,i){void 0===i&&(i=0);for(var n,o=r.clamp(e,0,g),a=0;a<4;a++)t[i+a]=Math.floor(256*((n=o*h[a])-Math.floor(n)))},t.unpackFloatRGBA=p;var h=[1,256,65536,16777216],m=[1/256,1/65536,1/16777216,1/4294967296],g=p(new Uint8ClampedArray([255,255,255,255]));t.inverseProjectionInfo=function(e,t,r,i,o){var a=e;0===e[11]?(i[0]=2/(t*a[0]),i[1]=2/(r*a[5]),i[2]=(1+a[12])/a[0],i[3]=(1+a[13])/a[5],n.vec2.set(o,0,1)):(i[0]=-2/(t*a[0]),i[1]=-2/(r*a[5]),i[2]=(1-a[8])/a[0],i[3]=(1-a[9])/a[5],n.vec2.set(o,1,0))}}).apply(null,i))||(e.exports=n)},CIzB:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IDENTITY=t.createView=t.fromValues=t.clone=t.create=void 0,t.create=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},t.clone=function(e){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]},t.fromValues=function(e,t,r,i,n,o,a,s,c,l,u,f,d,v,p,h){return[e,t,r,i,n,o,a,s,c,l,u,f,d,v,p,h]},t.createView=function(e,t){return new Float64Array(e,t,16)},t.IDENTITY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}).apply(null,i))||(e.exports=n)},"Cvn+":function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("SyoC"),r("0LE5"),r("W0kZ")],void 0===(n=(function(e,t,r,i,n){"use strict";return function(){function e(){}return e.prototype.acquire=function(t,r,i,n,o,a){this.id=e._idGen.gen(t&&t.id),this.geometry=t,this.material=r,this.transformation=i,this.instanceParameters=n,this.origin=o,this.shaderTransformation=a},e.prototype.getStaticTransformation=function(){return this.transformation},e.prototype.getShaderTransformation=function(){return this.shaderTransformation?this.shaderTransformation(this.transformation):this.transformation},e.prototype.computeAttachmentOrigin=function(e){return!!(this.material.computeAttachmentOrigin?this.material.computeAttachmentOrigin(this.geometry,e):this.geometry.computeAttachmentOrigin(e))&&(i.vec3.transformMat4(e,e,this.getStaticTransformation()),!0)},e._idGen=new n.IdGen,e.pool=new r(e),e}()}).apply(null,i))||(e.exports=n)},DKwL:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("zOht"),r("7Aei")],void 0===(n=(function(e,t,r,i){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.RgbaFloatEncoding=void 0,t.RgbaFloatEncoding=function(e){e.code.add(i.glsl(n||(n=r.__makeTemplateObject(["\n    // This is the maximum float value representable as 32bit fixed point,\n    // it is rgba2float(vec4(1)) inlined.\n    const float MAX_RGBA_FLOAT =\n      255.0 / 256.0 +\n      255.0 / 256.0 / 256.0 +\n      255.0 / 256.0 / 256.0 / 256.0 +\n      255.0 / 256.0 / 256.0 / 256.0 / 256.0;\n\n    // Factors to convert to fixed point, i.e. factors (256^0, 256^1, 256^2, 256^3)\n    const vec4 FIXED_POINT_FACTORS = vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);\n\n    vec4 float2rgba(const float value) {\n      // Make sure value is in the domain we can represent\n      float valueInValidDomain = clamp(value, 0.0, MAX_RGBA_FLOAT);\n\n      // Decompose value in 32bit fixed point parts represented as\n      // uint8 rgba components. Decomposition uses the fractional part after multiplying\n      // by a power of 256 (this removes the bits that are represented in the previous\n      // component) and then converts the fractional part to 8bits.\n      vec4 fixedPointU8 = floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);\n\n      // Convert uint8 values (from 0 to 255) to floating point representation for\n      // the shader\n      const float toU8AsFloat = 1.0 / 255.0;\n\n      return fixedPointU8 * toU8AsFloat;\n    }\n\n    // Factors to convert rgba back to float\n    const vec4 RGBA_2_FLOAT_FACTORS = vec4(\n      255.0 / (256.0),\n      255.0 / (256.0 * 256.0),\n      255.0 / (256.0 * 256.0 * 256.0),\n      255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n    );\n\n    float rgba2float(vec4 rgba) {\n      // Convert components from 0->1 back to 0->255 and then\n      // add the components together with their corresponding\n      // fixed point factors, i.e. (256^1, 256^2, 256^3, 256^4)\n      return dot(rgba, RGBA_2_FLOAT_FACTORS);\n    }\n  "],["\n    // This is the maximum float value representable as 32bit fixed point,\n    // it is rgba2float(vec4(1)) inlined.\n    const float MAX_RGBA_FLOAT =\n      255.0 / 256.0 +\n      255.0 / 256.0 / 256.0 +\n      255.0 / 256.0 / 256.0 / 256.0 +\n      255.0 / 256.0 / 256.0 / 256.0 / 256.0;\n\n    // Factors to convert to fixed point, i.e. factors (256^0, 256^1, 256^2, 256^3)\n    const vec4 FIXED_POINT_FACTORS = vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);\n\n    vec4 float2rgba(const float value) {\n      // Make sure value is in the domain we can represent\n      float valueInValidDomain = clamp(value, 0.0, MAX_RGBA_FLOAT);\n\n      // Decompose value in 32bit fixed point parts represented as\n      // uint8 rgba components. Decomposition uses the fractional part after multiplying\n      // by a power of 256 (this removes the bits that are represented in the previous\n      // component) and then converts the fractional part to 8bits.\n      vec4 fixedPointU8 = floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);\n\n      // Convert uint8 values (from 0 to 255) to floating point representation for\n      // the shader\n      const float toU8AsFloat = 1.0 / 255.0;\n\n      return fixedPointU8 * toU8AsFloat;\n    }\n\n    // Factors to convert rgba back to float\n    const vec4 RGBA_2_FLOAT_FACTORS = vec4(\n      255.0 / (256.0),\n      255.0 / (256.0 * 256.0),\n      255.0 / (256.0 * 256.0 * 256.0),\n      255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n    );\n\n    float rgba2float(vec4 rgba) {\n      // Convert components from 0->1 back to 0->255 and then\n      // add the components together with their corresponding\n      // fixed point factors, i.e. (256^1, 256^2, 256^3, 256^4)\n      return dot(rgba, RGBA_2_FLOAT_FACTORS);\n    }\n  "]))))}}).apply(null,i))||(e.exports=n)},FNtW:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("LxLY"),r("ff/U"),r("W0kZ")],void 0===(n=(function(e,t,r,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.materialPredicate=t.Material=void 0;var o=function(){function e(t){this.supportsEdges=!1,this._visible=!0,this._renderOccluded=1,this._renderPriority=0,this._insertOrder=0,this._vertexAttributeLocations=i.Default3D,this.id=e._idGen.gen(t)}return e.prototype.dispose=function(){},e.prototype.update=function(e){return!1},Object.defineProperty(e.prototype,"visible",{get:function(){return this._visible},set:function(e){e!==this._visible&&(this._visible=e,this.parametersChanged())},enumerable:!1,configurable:!0}),e.prototype.isVisibleInPass=function(e){return!0},Object.defineProperty(e.prototype,"renderOccluded",{get:function(){return this._renderOccluded},set:function(e){e!==this._renderOccluded&&(this._renderOccluded=e,this.parametersChanged())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"renderPriority",{get:function(){return this._renderPriority},set:function(e){e!==this._renderPriority&&(this._renderPriority=e,this.parametersChanged())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"insertOrder",{get:function(){return this._insertOrder},set:function(e){e!==this._insertOrder&&(this._insertOrder=e,this.parametersChanged())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"vertexAttributeLocations",{get:function(){return this._vertexAttributeLocations},enumerable:!1,configurable:!0}),e.prototype.isVisible=function(){return this._visible},e.prototype.parametersChanged=function(){r.isSome(this.materialRepository)&&this.materialRepository.materialChanged(this)},e._idGen=new n.IdGen,e}();t.Material=o,t.materialPredicate=function(e,t){return e.isVisible()&&e.isVisibleInPass(t.pass)&&0!=(e.renderOccluded&t.renderOccludedMask)}}).apply(null,i))||(e.exports=n)},FQ4r:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShaderTechnique=void 0;var r=function(){function e(e,t){t&&(this._config=t.snapshot()),this._program=this.initializeProgram(e),e.commonUniformStore&&(this._commonUniformStore=e.commonUniformStore,this._commonUniformStore.subscribeProgram(this._program)),this._pipeline=this.initializePipeline(e)}return e.prototype.dispose=function(){this._program&&(this._commonUniformStore&&this._commonUniformStore.unsubscribeProgram(this._program),this._program.dispose(),this._program=null)},e.prototype.reload=function(e){this._program&&(this._commonUniformStore&&this._commonUniformStore.unsubscribeProgram(this._program),this._program.dispose()),this._program=this.initializeProgram(e),this._commonUniformStore&&this._commonUniformStore.subscribeProgram(this._program)},Object.defineProperty(e.prototype,"program",{get:function(){return this._program},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pipeline",{get:function(){return this._pipeline},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this._config.key},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"configuration",{get:function(){return this._config},enumerable:!1,configurable:!0}),e.prototype.bindPass=function(e,t,r){},e.prototype.bindMaterial=function(e,t,r){},e.prototype.bindDraw=function(e,t,r){},e.prototype.bindPipelineState=function(e){e.setPipelineState(this.pipeline)},e.prototype.ensureAttributeLocations=function(e){this.program.assertCompatibleVertexAttributeLocations(e)},Object.defineProperty(e.prototype,"primitiveType",{get:function(){return 4},enumerable:!1,configurable:!0}),e}();t.ShaderTechnique=r}).apply(null,i))||(e.exports=n)},GG08:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("xoE+"),r("0LE5"),r("Rdxj"),r("JjCO")],void 0===(n=(function(e,t,r,i,n,o){"use strict";function a(e){return void 0===e&&(e=t.UP),[e[0],e[1],e[2],e[3]]}function s(e,t){return void 0===t&&(t=a()),c(e[0],e[1],e[2],e[3],t)}function c(e,t,r,i,n){return void 0===n&&(n=a()),n[0]=e,n[1]=t,n[2]=r,n[3]=i,n}function l(e,t,r){void 0===r&&(r=a()),i.vec3.copy(r,t);var n=i.vec3.dot(t,t);return Math.abs(n-1)>1e-5&&n>1e-12&&i.vec3.scale(r,r,1/Math.sqrt(n)),b(r,e,r),r}function u(e,t,r,n){return void 0===n&&(n=a()),y(i.vec3.subtract(o.sv3d.get(),e,t),i.vec3.subtract(o.sv3d.get(),r,t),e,n)}function f(e,t,r,n,o){if(e.count<3)return!1;e.getVec(r,v);for(var a=n,s=!1;a<e.count-1&&!s;)e.getVec(a,p),a++,s=!i.vec3.exactEquals(v,p);if(!s)return!1;for(a=Math.max(a,o),s=!1;a<e.count&&!s;)e.getVec(a,h),a++,i.vec3.subtract(m,v,p),i.vec3.normalize(m,m),i.vec3.subtract(g,p,h),i.vec3.normalize(g,g),s=!i.vec3.exactEquals(v,h)&&!i.vec3.exactEquals(p,h)&&Math.abs(i.vec3.dot(m,g))<d;return s?(u(v,p,h,t),!0):(0!==r||1!==n||2!==o)&&f(e,t,0,1,2)}Object.defineProperty(t,"__esModule",{value:!0}),t.UP=t.normal=t.signedDistance=t.distance=t.projectVector=t.projectPoint=t.clipInfinite=t.clip=t.isAABBFullyInside=t.isPointOutside=t.isPointInside=t.isSphereFullyOutside=t.isSphereFullyInside=t.intersectLineSegmentClamp=t.intersectLineSegment=t.intersectRay=t.fromVectorsAndPoint=t.negate=t.setOffsetFromPoint=t.fromManyPointsSampleAt=t.fromManyPoints=t.fromPoints=t.fromPositionAndNormal=t.fromNormalAndOffset=t.fromValues=t.copy=t.wrap=t.create=void 0,t.create=a,t.wrap=function(e,t,r,i){return c(e,t,r,i,o.sv4d.get())},t.copy=s,t.fromValues=c,t.fromNormalAndOffset=function(e,t,r){return void 0===r&&(r=a()),i.vec3.copy(r,e),r[3]=t,r},t.fromPositionAndNormal=l,t.fromPoints=u,t.fromManyPoints=function(e,t){return f(e,t,0,1,2)},t.fromManyPointsSampleAt=f;var d=.99619469809,v=n.vec3f64.create(),p=n.vec3f64.create(),h=n.vec3f64.create(),m=n.vec3f64.create(),g=n.vec3f64.create();function b(e,t,r){return e!==r&&s(e,r),r[3]=-i.vec3.dot(r,t),r}function y(e,t,r,n){return void 0===n&&(n=a()),l(r,i.vec3.cross(o.sv3d.get(),t,e),n)}function _(e,t,r){var n=i.vec3.scale(o.sv3d.get(),e,i.vec3.dot(e,t));return i.vec3.subtract(r,t,n),r}function x(e,t){return i.vec3.dot(e,t)+e[3]}function O(e,t,n,o,a,s){var c=i.vec3.dot(e,n);if(0===c)return!1;var l=-(i.vec3.dot(e,t)+e[3])/c;return a&&(l=o?Math.max(0,l):r.clamp(l,0,1)),!(l<0||!o&&l>1||(i.vec3.add(s,t,i.vec3.scale(s,n,l)),0))}t.setOffsetFromPoint=b,t.negate=function(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},t.fromVectorsAndPoint=y,t.intersectRay=function(e,t,r){return O(e,t.origin,t.direction,!0,!1,r)},t.intersectLineSegment=function(e,t,r){return O(e,t.origin,t.vector,!1,!1,r)},t.intersectLineSegmentClamp=function(e,t,r){return O(e,t.origin,t.vector,!1,!0,r)},t.isSphereFullyInside=function(e,t){var r=t.radius;return x(e,t.center)-r>=0},t.isSphereFullyOutside=function(e,t){var r=t.radius;return x(e,t.center)+r<0},t.isPointInside=function(e,t){return x(e,t)>=0},t.isPointOutside=function(e,t){return x(e,t)<0},t.isAABBFullyInside=function(e,t){return e[0]*(e[0]>0?t[0]:t[3])+e[1]*(e[1]>0?t[1]:t[4])+e[2]*(e[2]>0?t[2]:t[5])+e[3]>=0},t.clip=function(e,t){var r=i.vec3.dot(e,t.ray.direction),n=-x(e,t.ray.origin);if(n<0&&r>=0)return!1;if(r>-1e-6&&r<1e-6)return n>0;if((n<0||r<0)&&!(n<0&&r<0))return!0;var o=n/r;return r>0?o<t.c1&&(t.c1=o):o>t.c0&&(t.c0=o),t.c0<=t.c1},t.clipInfinite=function(e,t){var r=i.vec3.dot(e,t.ray.direction),n=-x(e,t.ray.origin);if(r>-1e-6&&r<1e-6)return n>0;var o=n/r;return r>0?o<t.c1&&(t.c1=o):o>t.c0&&(t.c0=o),t.c0<=t.c1},t.projectPoint=function(e,t,r){var n=i.vec3.scale(o.sv3d.get(),e,-e[3]),a=_(e,i.vec3.subtract(o.sv3d.get(),t,n),o.sv3d.get());return i.vec3.add(r,a,n),r},t.projectVector=_,t.distance=function(e,t){return Math.abs(x(e,t))},t.signedDistance=x,t.normal=function(e){return e},t.UP=[0,0,1,0]}).apply(null,i))||(e.exports=n)},GyfB:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("0LE5"),r("JjCO"),r("18xY")],void 0===(n=(function(e,t,r,i,n){"use strict";function o(e){return void 0===e&&(e=t.UP),[e[0],e[1],e[2],e[3]]}function a(e,t,r,i,n){return void 0===n&&(n=o()),n[0]=e,n[1]=t,n[2]=r,n[3]=i,n}Object.defineProperty(t,"__esModule",{value:!0}),t.UP=t.axis=t.fromPoints=t.fromAxisAndAngle=t.fromValues=t.copy=t.wrapAxisAngle=t.wrap=t.create=void 0,t.create=o,t.wrap=function(e,t,r,n){return a(e,t,r,n,i.sv4d.get())},t.wrapAxisAngle=function(e,t){return a(e[0],e[1],e[2],t,i.sv4d.get())},t.copy=function(e,t){return void 0===t&&(t=o()),a(e[0],e[1],e[2],e[3],t)},t.fromValues=a,t.fromAxisAndAngle=function(e,t,i){return void 0===i&&(i=o()),r.vec3.copy(i,e),i[3]=t,i},t.fromPoints=function(e,t,i){return void 0===i&&(i=o()),r.vec3.cross(i,e,t),r.vec3.normalize(i,i),i[3]=n.angle(e,t),i},t.axis=function(e){return e},t.UP=[0,0,1,0]}).apply(null,i))||(e.exports=n)},ILj8:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("VfPl"),r("CIy2")],void 0===(n=(function(e,t,r,i){"use strict";function n(e,t,r,i,n){var o=r.typedBuffer,a=r.typedBufferStride,s=e.length;if(i*=a,null==n||1===n)for(var c=0;c<s;++c){var l=2*e[c];o[i]=t[l],o[i+1]=t[l+1],i+=a}else for(c=0;c<s;++c){l=2*e[c];for(var u=0;u<n;++u)o[i]=t[l],o[i+1]=t[l+1],i+=a}}function o(e,t,r,i,n){var o=r.typedBuffer,a=r.typedBufferStride,s=e.length;if(i*=a,null==n||1===n)for(var c=0;c<s;++c){var l=3*e[c];o[i]=t[l],o[i+1]=t[l+1],o[i+2]=t[l+2],i+=a}else for(c=0;c<s;++c){l=3*e[c];for(var u=0;u<n;++u)o[i]=t[l],o[i+1]=t[l+1],o[i+2]=t[l+2],i+=a}}function a(e,t,r,i,n){var o=r.typedBuffer,a=r.typedBufferStride,s=e.length;if(i*=a,null==n||1===n)for(var c=0;c<s;++c){var l=4*e[c];o[i]=t[l],o[i+1]=t[l+1],o[i+2]=t[l+2],o[i+3]=t[l+3],i+=a}else for(c=0;c<s;++c){l=4*e[c];for(var u=0;u<n;++u)o[i]=t[l],o[i+1]=t[l+1],o[i+2]=t[l+2],o[i+3]=t[l+3],i+=a}}function s(e,t,r,i,n,a){if(r){var s=r,c=i.typedBuffer,l=i.typedBufferStride,u=e.length;if(n*=l,null==a||1===a)for(var f=0;f<u;++f){var d=t[h=3*e[f]],v=t[h+1],p=t[h+2];c[n]=s[0]*d+s[4]*v+s[8]*p+s[12],c[n+1]=s[1]*d+s[5]*v+s[9]*p+s[13],c[n+2]=s[2]*d+s[6]*v+s[10]*p+s[14],n+=l}else for(f=0;f<u;++f){d=t[h=3*e[f]];for(var h,m=s[0]*d+s[4]*(v=t[h+1])+s[8]*(p=t[h+2])+s[12],g=s[1]*d+s[5]*v+s[9]*p+s[13],b=s[2]*d+s[6]*v+s[10]*p+s[14],y=0;y<a;++y)c[n]=m,c[n+1]=g,c[n+2]=b,n+=l}}else o(e,t,i,n,a)}function c(e,t,r,i,n,a){if(r){var s=i.typedBuffer,c=i.typedBufferStride,l=e.length,u=r[0],f=r[1],d=r[2],v=r[4],p=r[5],h=r[6],m=r[8],g=r[9],b=r[10],y=Math.abs(1-u*u+v*v+m*m)>1e-5||Math.abs(1-f*f+p*p+g*g)>1e-5||Math.abs(1-d*d+h*h+b*b)>1e-5;if(n*=c,null==a||1===a)for(var _=0;_<l;++_){var x=u*(M=t[S=3*e[_]])+v*(w=t[S+1])+m*(A=t[S+2]),O=f*M+p*w+g*A,P=d*M+h*w+b*A;y&&(j=x*x+O*O+P*P)<.999999&&j>1e-6&&(x/=I=Math.sqrt(j),O/=I,P/=I),s[n+0]=x,s[n+1]=O,s[n+2]=P,n+=c}else for(_=0;_<l;++_){var S,M,w,A,j,I,V=u*(M=t[S=3*e[_]])+v*(w=t[S+1])+m*(A=t[S+2]),T=f*M+p*w+g*A,C=d*M+h*w+b*A;y&&(j=V*V+T*T+C*C)<.999999&&j>1e-6&&(V/=I=Math.sqrt(j),T/=I,C/=I);for(var L=0;L<a;++L)s[n+0]=V,s[n+1]=T,s[n+2]=C,n+=c}}else o(e,t,i,n,a)}function l(e,t,r,i,n,o){var a=i.typedBuffer,s=i.typedBufferStride,c=e.length;if(n*=s,null==o||1===o){if(4===r)for(var l=0;l<c;++l){var u=4*e[l];a[n]=t[u],a[n+1]=t[u+1],a[n+2]=t[u+2],a[n+3]=t[u+3],n+=s}else if(3===r)for(l=0;l<c;++l)a[n]=t[u=3*e[l]],a[n+1]=t[u+1],a[n+2]=t[u+2],a[n+3]=255,n+=s}else if(4===r)for(l=0;l<c;++l){u=4*e[l];for(var f=0;f<o;++f)a[n]=t[u],a[n+1]=t[u+1],a[n+2]=t[u+2],a[n+3]=t[u+3],n+=s}else if(3===r)for(l=0;l<c;++l)for(u=3*e[l],f=0;f<o;++f)a[n]=t[u],a[n+1]=t[u+1],a[n+2]=t[u+2],a[n+3]=255,n+=s}Object.defineProperty(t,"__esModule",{value:!0}),t.writeDefaultAttributes=t.writeMultipliedColor=t.writeColor=t.writeNormal=t.writePosition=t.writeBufferMat4f=t.writeBufferMat3f=t.writeBufferVec4=t.writeBufferVec3=t.writeBufferVec2=void 0,t.writeBufferVec2=n,t.writeBufferVec3=o,t.writeBufferVec4=a,t.writeBufferMat3f=function(e,t,r,i){var n=r.typedBuffer,o=r.typedBufferStride,a=e.length;i*=o;for(var s=0;s<a;++s){for(var c=9*e[s],l=0;l<9;++l)n[i+l]=t[c+l];i+=o}},t.writeBufferMat4f=function(e,t,r,i){var n=r.typedBuffer,o=r.typedBufferStride,a=e.length;i*=o;for(var s=0;s<a;++s){for(var c=16*e[s],l=0;l<16;++l)n[i+l]=t[c+l];i+=o}},t.writePosition=s,t.writeNormal=c,t.writeColor=l,t.writeMultipliedColor=function(e,t,r,i,n,o,a){var s=n.typedBuffer,c=n.typedBufferStride,l=e.length;if(o*=c,null==a||1===a){if(4===r)for(var u=0;u<l;++u){var f=4*e[u];s[o]=t[f]*i[0],s[o+1]=t[f+1]*i[1],s[o+2]=t[f+2]*i[2],s[o+3]=t[f+3]*i[3],o+=c}else if(3===r){var d=255*i[3];for(u=0;u<l;++u)s[o]=t[f=3*e[u]]*i[0],s[o+1]=t[f+1]*i[1],s[o+2]=t[f+2]*i[2],s[o+3]=d,o+=c}}else if(4===r)for(u=0;u<l;++u){f=4*e[u];for(var v=0;v<a;++v)s[o]=t[f]*i[0],s[o+1]=t[f+1]*i[1],s[o+2]=t[f+2]*i[2],s[o+3]=t[f+3]*i[3],o+=c}else if(3===r)for(d=255*i[3],u=0;u<l;++u)for(f=3*e[u],v=0;v<a;++v)s[o]=t[f]*i[0],s[o+1]=t[f+1]*i[1],s[o+2]=t[f+2]*i[2],s[o+3]=d,o+=c},t.writeDefaultAttributes=function(e,t,o,u,f,d){for(var v=0,p=t.fieldNames;v<p.length;v++){var h=p[v],m=e.vertexAttr[h],g=e.indices[h];if(m&&g)switch(h){case i.VertexAttrConstants.POSITION:i.assert(3===m.size);var b=f.getField(h,r.BufferViewVec3f);b&&s(g,m.data,o,b,d);break;case i.VertexAttrConstants.NORMAL:i.assert(3===m.size);var y=f.getField(h,r.BufferViewVec3f);y&&c(g,m.data,u,y,d);break;case i.VertexAttrConstants.UV0:i.assert(2===m.size);var _=f.getField(h,r.BufferViewVec2f);_&&n(g,m.data,_,d);break;case i.VertexAttrConstants.UVMAPSPACE:i.assert(4===m.size);var x=f.getField(h,r.BufferViewVec4f);x&&a(g,m.data,x,d);break;case i.VertexAttrConstants.MEANVERTEXPOSITION:i.assert(3===m.size);var O=f.getField(h,r.BufferViewVec3f);O&&s(g,m.data,o,O,d);break;case i.VertexAttrConstants.BOUND1:case i.VertexAttrConstants.BOUND2:case i.VertexAttrConstants.BOUND3:i.assert(3===m.size);var P=f.getField(h,r.BufferViewVec3f);P&&s(g,m.data,o,P,d);break;case i.VertexAttrConstants.COLOR:i.assert(3===m.size||4===m.size);var S=f.getField(h,r.BufferViewVec4u8);S&&l(g,m.data,m.size,S,d);break;case i.VertexAttrConstants.SYMBOLCOLOR:i.assert(3===m.size||4===m.size);var M=f.getField(h,r.BufferViewVec4u8);M&&l(g,m.data,m.size,M,d);break;case i.VertexAttrConstants.TANGENT:i.assert(4===m.size);var w=f.getField(h,r.BufferViewVec4f);w&&a(g,m.data,w,d)}}}}).apply(null,i))||(e.exports=n)},IwVr:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("zOht"),r("7Aei")],void 0===(n=(function(e,t,r,i){"use strict";var n,o,a,s;Object.defineProperty(t,"__esModule",{value:!0}),t.DiscardOrAdjustAlpha=t.symbolAlphaCutoff=t.defaultMaskAlphaCutoff=void 0,t.defaultMaskAlphaCutoff=.1,t.symbolAlphaCutoff=.001,t.DiscardOrAdjustAlpha=function(e,t){var c=e.fragment;switch(t.alphaDiscardMode){case 0:c.code.add(i.glsl(n||(n=r.__makeTemplateObject(["\n        void discardOrAdjustAlpha(inout vec4 color) {}\n      "],["\n        void discardOrAdjustAlpha(inout vec4 color) {}\n      "]))));break;case 1:c.code.add(i.glsl(o||(o=r.__makeTemplateObject(["\n        void discardOrAdjustAlpha(inout vec4 color) {\n          color.a = 1.0;\n        }\n      "],["\n        void discardOrAdjustAlpha(inout vec4 color) {\n          color.a = 1.0;\n        }\n      "]))));break;case 2:c.uniforms.add("textureAlphaCutoff","float"),c.code.add(i.glsl(a||(a=r.__makeTemplateObject(["\n        #define discardOrAdjustAlpha(color) { if (color.a < textureAlphaCutoff) { discard; } else { color.a = 1.0; } }\n      "],["\n        #define discardOrAdjustAlpha(color) { if (color.a < textureAlphaCutoff) { discard; } else { color.a = 1.0; } }\n      "]))));break;case 3:e.fragment.uniforms.add("textureAlphaCutoff","float"),e.fragment.code.add(i.glsl(s||(s=r.__makeTemplateObject(["\n        #define discardOrAdjustAlpha(color) { if (color.a < textureAlphaCutoff) { discard; } }\n      "],["\n        #define discardOrAdjustAlpha(color) { if (color.a < textureAlphaCutoff) { discard; } }\n      "]))))}}}).apply(null,i))||(e.exports=n)},JjCO:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("wSO/")],void 0===(n=(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sq4d=t.sm4d=t.sm3d=t.sv4d=t.sv3d=t.sv2d=void 0,t.sv2d=r.VectorStack.createVec2f64(),t.sv3d=r.VectorStack.createVec3f64(),t.sv4d=r.VectorStack.createVec4f64(),t.sm3d=r.VectorStack.createMat3f64(),t.sm4d=r.VectorStack.createMat4f64(),t.sq4d=r.VectorStack.createQuatf64()}).apply(null,i))||(e.exports=n)},KRuQ:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("zOht")],void 0===(n=(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autoDispose=t.AutoDisposable=t.AutoDisposableMixin=void 0,t.AutoDisposableMixin=function(e){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._isDisposed=!1,t}return r.__extends(t,e),t.prototype.dispose=function(){for(var e,t=0,r=null!==(e=this._managedDisposables)&&void 0!==e?e:[];t<r.length;t++){var i=r[t],n=this[i];this[i]=null,n&&"function"==typeof n.dispose&&n.dispose()}this._isDisposed=!0},Object.defineProperty(t.prototype,"isDisposed",{get:function(){return this._isDisposed},enumerable:!1,configurable:!0}),t}(e)};var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t}(t.AutoDisposableMixin((function(){})));t.AutoDisposable=i,t.autoDispose=function(){return function(e,t){var r,i;e.hasOwnProperty("_managedDisposables")||(e._managedDisposables=null!==(i=null===(r=e._managedDisposables)||void 0===r?void 0:r.slice())&&void 0!==i?i:[]),e._managedDisposables.unshift(t)}}}).apply(null,i))||(e.exports=n)},N5NQ:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("xoE+"),r("PHan"),r("0LE5"),r("Rdxj"),r("JjCO")],void 0===(n=(function(e,t,r,i,n,o,a){"use strict";function s(e){return e?{origin:o.vec3f64.clone(e.origin),vector:o.vec3f64.clone(e.vector)}:{origin:o.vec3f64.create(),vector:o.vec3f64.create()}}function c(e,t){var r=p.get();return r.origin=e,r.vector=t,r}function l(e,t,r){return void 0===r&&(r=s()),n.vec3.copy(r.origin,e),n.vec3.copy(r.vector,t),r}function u(e,t){var i=n.vec3.subtract(a.sv3d.get(),t,e.origin),o=n.vec3.dot(e.vector,i),s=n.vec3.dot(e.vector,e.vector),c=r.clamp(o/s,0,1),l=n.vec3.subtract(a.sv3d.get(),n.vec3.scale(a.sv3d.get(),e.vector,c),i);return n.vec3.dot(l,l)}function f(e,t,i,o,s){var c=e.vector,l=e.origin,u=n.vec3.subtract(a.sv3d.get(),t,l),f=n.vec3.length(c),d=n.vec3.dot(c,u)/f;return n.vec3.scale(s,c,r.clamp(d,i,o)),n.vec3.add(s,s,e.origin)}function d(e,t,i,o){var s=e.origin,c=n.vec3.add(a.sv3d.get(),s,e.vector),l=t.origin,u=n.vec3.add(a.sv3d.get(),l,t.vector),f=a.sv3d.get(),d=a.sv3d.get();if(f[0]=s[0]-l[0],f[1]=s[1]-l[1],f[2]=s[2]-l[2],d[0]=u[0]-l[0],d[1]=u[1]-l[1],d[2]=u[2]-l[2],Math.abs(d[0])<1e-6&&Math.abs(d[1])<1e-6&&Math.abs(d[2])<1e-6)return!1;var v=a.sv3d.get();if(v[0]=c[0]-s[0],v[1]=c[1]-s[1],v[2]=c[2]-s[2],Math.abs(v[0])<1e-6&&Math.abs(v[1])<1e-6&&Math.abs(v[2])<1e-6)return!1;var p=f[0]*d[0]+f[1]*d[1]+f[2]*d[2],h=d[0]*v[0]+d[1]*v[1]+d[2]*v[2],m=f[0]*v[0]+f[1]*v[1]+f[2]*v[2],g=d[0]*d[0]+d[1]*d[1]+d[2]*d[2],b=(v[0]*v[0]+v[1]*v[1]+v[2]*v[2])*g-h*h;if(Math.abs(b)<1e-6)return!1;var y=(p*h-m*g)/b,_=(p+h*y)/g;i&&(y=r.clamp(y,0,1),_=r.clamp(_,0,1));var x=a.sv3d.get(),O=a.sv3d.get();return x[0]=s[0]+y*v[0],x[1]=s[1]+y*v[1],x[2]=s[2]+y*v[2],O[0]=l[0]+_*d[0],O[1]=l[1]+_*d[1],O[2]=l[2]+_*d[2],o.tA=y,o.tB=_,o.pA=x,o.pB=O,o.distance2=n.vec3.squaredDistance(x,O),!0}Object.defineProperty(t,"__esModule",{value:!0}),t.closestLineSegmentDistance2=t.closestLineSegmentPoint=t.closestRayDistance2=t.projectPointClamp=t.pointAt=t.projectPoint=t.distance=t.distance2=t.fromPoints=t.fromValues=t.copy=t.wrap=t.create=void 0,t.create=s,t.wrap=c,t.copy=function(e,t){return void 0===t&&(t=s()),l(e.origin,e.vector,t)},t.fromValues=l,t.fromPoints=function(e,t,r){return void 0===r&&(r=s()),n.vec3.copy(r.origin,e),n.vec3.subtract(r.vector,t,e),r},t.distance2=u,t.distance=function(e,t){return Math.sqrt(u(e,t))},t.projectPoint=function(e,t,r){return f(e,t,0,1,r)},t.pointAt=function(e,t,r){return n.vec3.add(r,e.origin,n.vec3.scale(r,e.vector,t))},t.projectPointClamp=f,t.closestRayDistance2=function(e,t){if(d(e,c(t.origin,t.direction),!1,v)){var r=v.tA,i=v.pB;if(r>=0&&r<=1)return v.distance2;if(r<0)return n.vec3.squaredDistance(e.origin,i);if(r>1)return n.vec3.squaredDistance(n.vec3.add(a.sv3d.get(),e.origin,e.vector),i)}return null},t.closestLineSegmentPoint=function(e,t,r){return!!d(e,t,!0,v)&&(n.vec3.copy(r,v.pA),!0)},t.closestLineSegmentDistance2=function(e,t){return d(e,t,!0,v)?v.distance2:null};var v={tA:0,tB:0,pA:o.vec3f64.create(),pB:o.vec3f64.create(),distance2:0},p=new i.ObjectStack((function(){return{origin:null,vector:null}}))}).apply(null,i))||(e.exports=n)},PHan:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("LxLY"),r("6DRN")],void 0===(n=(function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectStack=void 0;var n=function(){function e(e){var t=this;this.allocator=e,this.items=[],this.itemsPtr=0,this.tickHandle=i.before((function(){return t.reset()})),this.grow()}return e.prototype.destroy=function(){this.tickHandle&&(this.tickHandle.remove(),this.tickHandle=r.nullifyNonnullableForDispose(this.tickHandle)),this.items=r.nullifyNonnullableForDispose(this.items)},e.prototype.get=function(){return 0===this.itemsPtr&&i((function(){})),this.itemsPtr===this.items.length&&this.grow(),this.items[this.itemsPtr++]},e.prototype.reset=function(){var e=Math.min(3*Math.max(8,this.itemsPtr),this.itemsPtr+3*o);this.items.length=Math.min(e,this.items.length),this.itemsPtr=0},e.prototype.grow=function(){for(var e=0;e<Math.max(8,Math.min(this.items.length,o));e++)this.items.push(this.allocator())},e}();t.ObjectStack=n;var o=1024;t.default=n}).apply(null,i))||(e.exports=n)},PaEL:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("zOht"),r("7Aei")],void 0===(n=(function(e,t,r,i){"use strict";function n(e){e.fragment.uniforms.add("depthTex","sampler2D"),e.fragment.uniforms.add("highlightViewportPixelSz","vec4"),e.fragment.code.add(i.glsl(o||(o=r.__makeTemplateObject(["\n    void outputHighlight() {\n      vec4 fragCoord = gl_FragCoord;\n\n      float sceneDepth = texture2D(depthTex, (fragCoord.xy - highlightViewportPixelSz.xy) * highlightViewportPixelSz.zw).r;\n      if (fragCoord.z > sceneDepth + 5e-7) {\n        gl_FragColor = vec4(1.0, 1.0, 0.0, 1.0);\n      }\n      else {\n        gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);\n      }\n    }\n  "],["\n    void outputHighlight() {\n      vec4 fragCoord = gl_FragCoord;\n\n      float sceneDepth = texture2D(depthTex, (fragCoord.xy - highlightViewportPixelSz.xy) * highlightViewportPixelSz.zw).r;\n      if (fragCoord.z > sceneDepth + 5e-7) {\n        gl_FragColor = vec4(1.0, 1.0, 0.0, 1.0);\n      }\n      else {\n        gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);\n      }\n    }\n  "]))))}var o;Object.defineProperty(t,"__esModule",{value:!0}),t.OutputHighlight=void 0,t.OutputHighlight=n,function(e){e.bindOutputHighlight=function(e,t,r){e.bindTexture(r.highlightDepthTexture,5),t.setUniform1i("depthTex",5),t.setUniform4f("highlightViewportPixelSz",0,0,r.inverseViewport[0],r.inverseViewport[1])}}(n=t.OutputHighlight||(t.OutputHighlight={}))}).apply(null,i))||(e.exports=n)},"PwS/":function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("LxLY"),r("LxLY"),r("FXVB"),r("1m5D"),r("1f+t"),r("CIy2")],void 0===(n=(function(e,t,r,i,n,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.encodeDoubleVec3=t.calculateTransformRelToOrigin=t.releaseMaterials=t.acquireMaterials=t.isInstanceHidden=t.removeObject3DStateID=t.addObject3DStateID=void 0,t.addObject3DStateID=function(e,t){return r.isNone(e)&&(e=[]),e.push(t),e},t.removeObject3DStateID=function(e,t){if(r.isNone(e))return e;var i=e.filter((function(e){return e!==t}));return 0===i.length?null:i},t.isInstanceHidden=function(e){return!!i.isSome(e)&&!e.visible},t.acquireMaterials=function(e,t){var r=new Map;return r.set(0,t.acquire(e,0)),r.set(3,t.acquire(e,3)),r.set(2,t.acquire(e,2)),r.set(1,t.acquire(e,1)),r.set(4,t.acquire(e,4)),r},t.releaseMaterials=function(e,t){t.release(e,0),t.release(e,3),t.release(e,2),t.release(e,1),t.release(e,4)},t.calculateTransformRelToOrigin=function(e,t,r){var o=e.origin.vec3;s.setMatrixTranslation3(u,-o[0],-o[1],-o[2]),i.isSome(e.transformation)?n.mat4.multiply(t,u,e.transformation):n.mat4.copy(t,u),r&&(n.mat4.invert(r,t),n.mat4.transpose(r,r))},t.encodeDoubleVec3=function(e,t,r,i,n){c[0]=e.get(t,0),c[1]=e.get(t,1),c[2]=e.get(t,2),a.encodeDoubleArray(c,l,3),r.set(n,0,l[0]),i.set(n,0,l[1]),r.set(n,1,l[2]),i.set(n,1,l[3]),r.set(n,2,l[4]),i.set(n,2,l[5])};var c=new Float64Array(3),l=new Float32Array(6),u=o.mat4f64.create()}).apply(null,i))||(e.exports=n)},"W/V4":function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("zOht")],void 0===(n=(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReloadableShaderModule=void 0;var i=function(){function e(e,t){this._module=e,this._loadModule=t}return e.prototype.get=function(){return this._module},e.prototype.reload=function(){return r.__awaiter(this,void 0,void 0,(function(){var e;return r.__generator(this,(function(t){switch(t.label){case 0:return e=this,[4,this._loadModule()];case 1:return e._module=t.sent(),[2,this._module]}}))}))},e}();t.ReloadableShaderModule=i}).apply(null,i))||(e.exports=n)},W0kZ:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IdGen=void 0;var r=function(){function e(){this._count=0}return e.prototype.gen=function(e){return null==e&&(e="a"),e+"_"+this._count++},e}();t.IdGen=r}).apply(null,i))||(e.exports=n)},ZJC8:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("zOht"),r("LxLY"),r("FXVB"),r("1m5D"),r("0LE5"),r("Rdxj"),r("AzkI"),r("Cvn+"),r("W0kZ"),r("62Ht"),r("CIy2"),r("PwS/")],void 0===(n=(function(e,t,r,i,n,o,a,s,c,l,u,f,d,v){"use strict";var p=function(){function e(t){void 0===t&&(t={}),this._objectTransformation=o.mat4f64.create(),this._bvObjectSpace=new m,this._bvWorldSpace=new m,this._bvDirty=!0,this._hasVolatileTransformation=!1,this._visible=!0,this.id=e._idGen.gen(t.idHint),this.castShadow=null==t.castShadow||t.castShadow,this.metadata=t.metadata,this.metadata&&this.metadata.isElevationSource&&(this.metadata.lastValidElevationBB=new h),this.objectTransformation=o.mat4f64.create(),this._initializeGeometryRecords(t.geometries,t.materials,t.transformations,t.origins)}return Object.defineProperty(e.prototype,"geometryRecords",{get:function(){return this._geometryRecords},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"geometries",{get:function(){return this._geometries},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"objectTransformation",{get:function(){return this._objectTransformation},set:function(e){n.mat4.copy(this._objectTransformation,e),this._invalidateBoundingVolume(),this._notifyDirty("objTransformation")},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){for(var e=0,t=this._geometryRecords;e<t.length;e++)l.pool.release(t[e]);this._geometryRecords=null,this._geometries=null},e.prototype._initializeGeometryRecords=function(e,t,r,i){if(!Array.isArray(e))return this._geometryRecords=[],void(this._geometries=[]);d.assert(t.length===e.length,"Object3D: materials don't match geometries"),d.assert(r.length===e.length,"Object3D: transformations don't match geometries"),this._geometryRecords=new Array(e.length),this._geometries=e.slice();for(var n=0;n<e.length;n++)this._geometryRecords[n]=l.pool.acquire(e[n],t[n],o.mat4f64.clone(r[n]),{highlights:null,occludees:null,visible:!0},i&&i[n]);this._hasVolatileTransformation=!1},Object.defineProperty(e.prototype,"parentLayer",{get:function(){return this._parentLayer},set:function(e){d.assert(null==this._parentLayer||null==e,"Object3D can only be added to a single Layer"),this._parentLayer=e},enumerable:!1,configurable:!0}),e.prototype.getNumGeometryRecords=function(){return this._geometryRecords.length},e.prototype.getGeometryRecord=function(e){return d.assert(e>=0&&e<this._geometryRecords.length,"Object3d.getGeometryDataByIndex: index out of range"),this._geometryRecords[e]},e.prototype.addGeometry=function(e,t,r,i,n,a){r=r||o.mat4f64.IDENTITY,this._geometries.push(e);var s=l.pool.acquire(e,t,r,i||{highlights:null,occludees:null,visible:!0},n,a);return this._geometryRecords.push(s),this._hasVolatileTransformation=this._geometryRecords.some((function(e){return!!e.shaderTransformation})),this._notifyDirty("objGeometryAdded",s),this._invalidateBoundingVolume(),s},e.prototype.removeGeometry=function(e){var t=this._geometryRecords.splice(e,1)[0];return l.pool.release(t),this._hasVolatileTransformation=this._geometryRecords.some((function(e){return!!e.shaderTransformation})),this._geometries.splice(e,1),this._notifyDirty("objGeometryRemoved",t),this._invalidateBoundingVolume(),t},e.prototype.removeAllGeometries=function(){for(;this.getNumGeometryRecords()>0;)this.removeGeometry(0)},e.prototype.geometryVertexAttrsUpdated=function(e){this._notifyDirty("vertexAttrsUpdated",this._geometryRecords[e]),this._invalidateBoundingVolume()},Object.defineProperty(e.prototype,"isVisible",{get:function(){return this._visible},enumerable:!1,configurable:!0}),e.prototype.setVisible=function(e){this._visible=e;for(var t=0,r=this._geometryRecords;t<r.length;t++)r[t].instanceParameters.visible=this._visible;this._notifyDirty("visibilityChanged")},e.prototype.occlude=function(){for(var e=f.generateObject3DStateId(1),t=0,r=this._geometryRecords;t<r.length;t++){var i=r[t];i.instanceParameters.occludees=v.addObject3DStateID(i.instanceParameters.occludees,e)}return this._notifyDirty("occlusionChanged"),e},e.prototype.removeOcclude=function(e){for(var t=0,r=this._geometryRecords;t<r.length;t++){var i=r[t];i.instanceParameters.occludees=v.removeObject3DStateID(i.instanceParameters.occludees,e)}this._notifyDirty("occlusionChanged")},e.prototype.highlight=function(){for(var e=f.generateObject3DStateId(0),t=0,r=this._geometryRecords;t<r.length;t++){var i=r[t];i.instanceParameters.highlights=v.addObject3DStateID(i.instanceParameters.highlights,e)}return this._notifyDirty("highlightChanged"),e},e.prototype.removeHighlight=function(e){for(var t=0,r=this._geometryRecords;t<r.length;t++){var i=r[t];i.instanceParameters.highlights=v.removeObject3DStateID(i.instanceParameters.highlights,e)}this._notifyDirty("highlightChanged")},e.prototype.getCombinedStaticTransformation=function(e,t){return n.mat4.multiply(i.unwrapOr(t,o.mat4f64.create()),this.objectTransformation,e.getStaticTransformation())},e.prototype.getCombinedShaderTransformation=function(e,t){return t=t||o.mat4f64.create(),n.mat4.multiply(t,this.objectTransformation,e.getShaderTransformation()),t},e.prototype.hasVolativeTransformation=function(){return this._hasVolatileTransformation},e.prototype.getBBMin=function(e){return this._validateBoundingVolume(),e?this._bvObjectSpace.bbMin:this._bvWorldSpace.bbMin},e.prototype.getBBMax=function(e){return this._validateBoundingVolume(),e?this._bvObjectSpace.bbMax:this._bvWorldSpace.bbMax},e.prototype.getCenter=function(e){return this._validateBoundingVolume(),e?this._bvObjectSpace.center:this._bvWorldSpace.center},e.prototype.getBSRadius=function(e){return this._validateBoundingVolume(),e?this._bvObjectSpace.bsRadius:this._bvWorldSpace.bsRadius},e.prototype._validateBoundingVolume=function(){if(this._bvDirty||this._hasVolatileTransformation){this._bvObjectSpace.init(),this._bvWorldSpace.init();for(var e=0;e<this._geometryRecords.length;++e){var t=this._geometries[e],r=this._geometryRecords[e],i=t.boundingInfo;this._calculateTransformedBoundingVolume(i,this._bvObjectSpace,r.getShaderTransformation()),this._calculateTransformedBoundingVolume(i,this._bvWorldSpace,this.getCombinedShaderTransformation(r))}a.vec3.lerp(this._bvObjectSpace.center,this._bvObjectSpace.bbMin,this._bvObjectSpace.bbMax,.5),a.vec3.lerp(this._bvWorldSpace.center,this._bvWorldSpace.bbMin,this._bvWorldSpace.bbMax,.5);var n=s.vec3f64.create(),o=s.vec3f64.create(),l=c.maxScale(this.objectTransformation);for(e=0;e<this._geometryRecords.length;++e){t=this._geometries[e];var u=this._geometryRecords[e].getShaderTransformation(),f=c.maxScale(u);a.vec3.transformMat4(n,(i=t.boundingInfo).getCenter(),u);var d=a.vec3.distance(n,this._bvObjectSpace.center),v=i.getBSRadius()*f;this._bvObjectSpace.bsRadius=Math.max(this._bvObjectSpace.bsRadius,d+v),a.vec3.transformMat4(o,n,this.objectTransformation);var p=a.vec3.distance(o,this._bvWorldSpace.center);this._bvWorldSpace.bsRadius=Math.max(this._bvWorldSpace.bsRadius,p+v*l)}this._bvDirty=!1}},e.prototype._calculateTransformedBoundingVolume=function(e,t,r){var i=e.getBBMin(),n=e.getBBMax(),o=s.vec3f64.clone(i),c=s.vec3f64.clone(n);a.vec3.transformMat4(o,o,r),a.vec3.transformMat4(c,c,r);for(var l=0;l<3;++l)t.bbMin[l]=Math.min(t.bbMin[l],o[l],c[l]),t.bbMax[l]=Math.max(t.bbMax[l],o[l],c[l]);for(l=0;l<3;++l){a.vec3.copy(o,i),a.vec3.copy(c,n),o[l]=n[l],c[l]=i[l],a.vec3.transformMat4(o,o,r),a.vec3.transformMat4(c,c,r);for(var u=0;u<3;++u)t.bbMin[u]=Math.min(t.bbMin[u],o[u],c[u]),t.bbMax[u]=Math.max(t.bbMax[u],o[u],c[u])}},e.prototype._invalidateBoundingVolume=function(){this._bvDirty=!0,this._parentLayer&&this._parentLayer.notifyObjectBBChanged(this,{center:this._bvWorldSpace.center,radius:this._bvWorldSpace.bsRadius})},e.prototype._notifyDirty=function(e,t,r,i){this._parentLayer&&this._parentLayer.notifyDirty(e,t,r=r||1,i||this)},Object.defineProperty(e.prototype,"test",{get:function(){var e=this;return{hasGeometry:function(t){return e._geometries.indexOf(t)>-1},getGeometryIndex:function(t){return e._geometries.indexOf(t)}}},enumerable:!1,configurable:!0}),e._idGen=new u.IdGen,e}(),h=function(){function e(){this.bbMin=s.vec3f64.fromValues(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this.bbMax=s.vec3f64.fromValues(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE)}return e.prototype.isEmpty=function(){return this.bbMax[0]<this.bbMin[0]&&this.bbMax[1]<this.bbMin[1]&&this.bbMax[2]<this.bbMin[2]},e}(),m=function(e){function t(){var t=e.call(this)||this;return t.center=s.vec3f64.create(),t.bsRadius=0,t}return r.__extends(t,e),t.prototype.init=function(){a.vec3.set(this.bbMin,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),a.vec3.set(this.bbMax,-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),a.vec3.set(this.center,0,0,0),this.bsRadius=0},t.prototype.getCenter=function(){return this.center},t.prototype.getBSRadius=function(){return this.bsRadius},t}(h);return p}).apply(null,i))||(e.exports=n)},ZjcA:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("PHan"),r("W9tT"),r("0LE5"),r("Rdxj"),r("JjCO"),r("N5NQ")],void 0===(n=(function(e,t,r,i,n,o,a,s){"use strict";function c(e){return e?{p0:o.vec3f64.clone(e.p0),p1:o.vec3f64.clone(e.p1),p2:o.vec3f64.clone(e.p2)}:{p0:o.vec3f64.create(),p1:o.vec3f64.create(),p2:o.vec3f64.create()}}function l(e,t,r,i){return void 0===i&&(i=c()),n.vec3.copy(i.p0,e),n.vec3.copy(i.p1,t),n.vec3.copy(i.p2,r),i}function u(e,t,r){var n=i.vec2.distance(e,t),o=i.vec2.distance(t,r),a=i.vec2.distance(r,e),s=(n+o+a)/2,c=s*(s-n)*(s-o)*(s-a);return c<=0?0:Math.sqrt(c)}Object.defineProperty(t,"__esModule",{value:!0}),t.areaPoints3d=t.area2d=t.areaPoints2d=t.intersectRay=t.distance2=t.fromValues=t.copy=t.wrap=t.create=void 0,t.create=c,t.wrap=function(e,t,r){var i=d.get();return i.p0=e,i.p1=t,i.p2=r,i},t.copy=function(e,t){return void 0===t&&(t=c()),l(e.p0,e.p1,e.p2,t)},t.fromValues=l,t.distance2=function(e,t){var r=e.p0,i=e.p1,o=e.p2,c=n.vec3.subtract(a.sv3d.get(),i,r),l=n.vec3.subtract(a.sv3d.get(),o,i),u=n.vec3.subtract(a.sv3d.get(),r,o),d=n.vec3.subtract(a.sv3d.get(),t,r),v=n.vec3.subtract(a.sv3d.get(),t,i),p=n.vec3.subtract(a.sv3d.get(),t,o),h=n.vec3.cross(c,c,u),m=n.vec3.dot(n.vec3.cross(a.sv3d.get(),c,h),d),g=n.vec3.dot(n.vec3.cross(a.sv3d.get(),l,h),v),b=n.vec3.dot(n.vec3.cross(a.sv3d.get(),u,h),p);if(m>0&&g>0&&b>0){var y=n.vec3.dot(h,d);return y*y/n.vec3.dot(h,h)}var _=s.distance2(s.fromValues(r,c,f.get()),t),x=s.distance2(s.fromValues(i,l,f.get()),t),O=s.distance2(s.fromValues(o,u,f.get()),t);return Math.min(_,x,O)},t.intersectRay=function(e,t,r){var i=t.direction,o=t.origin,a=e.p0,s=e.p1,c=e.p2,l=s[0]-a[0],u=s[1]-a[1],f=s[2]-a[2],d=c[0]-a[0],v=c[1]-a[1],p=c[2]-a[2],h=i[1]*p-v*i[2],m=i[2]*d-p*i[0],g=i[0]*v-d*i[1],b=l*h+u*m+f*g;if(b>-1e-5&&b<1e-5)return!1;var y=1/b,_=o[0]-a[0],x=o[1]-a[1],O=o[2]-a[2],P=y*(_*h+x*m+O*g);if(P<0||P>1)return!1;var S=x*f-u*O,M=O*l-f*_,w=_*u-l*x,A=y*(i[0]*S+i[1]*M+i[2]*w);return!(A<0||P+A>1||(r&&(n.vec3.scale(r,i,y*(d*S+v*M+p*w)),n.vec3.add(r,o,r)),0))},t.areaPoints2d=u,t.area2d=function(e){return u(e.p0,e.p1,e.p2)},t.areaPoints3d=function(e,t,r){return n.vec3.subtract(v,t,e),n.vec3.subtract(p,r,e),n.vec3.length(n.vec3.cross(v,v,p))/2};var f=new r.ObjectStack(s.create),d=new r.ObjectStack((function(){return{p0:null,p1:null,p2:null}})),v=o.vec3f64.create(),p=o.vec3f64.create()}).apply(null,i))||(e.exports=n)},aExC:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("zOht"),r("qsST"),r("R2Zq"),r("ULaq")],void 0===(n=(function(e,t,r,i,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Stage=t.Code=t.ShaderBuilder=t.Includes=void 0;var a=i.getLogger("esri.views.3d.webgl-engine.core.shaderModules.shaderBuilder"),s=function(){function e(){this.includedModules=new Map}return e.prototype.include=function(e,t){this.includedModules.has(e)?this.includedModules.get(e)!==t&&a.error("Trying to include shader module multiple times with different sets of options."):(this.includedModules.set(e,t),e(this.builder,t))},e}();t.Includes=s;var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.vertex=new f,t.fragment=new f,t.attributes=new d,t.varyings=new v,t.extensions=new p,t.defines=new h,t}return r.__extends(t,e),Object.defineProperty(t.prototype,"builder",{get:function(){return this},enumerable:!1,configurable:!0}),t.prototype.generateSource=function(e){var t=this.extensions.generateSource(e),r=this.attributes.generateSource(e),i=this.varyings.generateSource(),n="vertex"===e?this.vertex:this.fragment,o=n.uniforms.generateSource(),a=n.code.generateSource(),s="vertex"===e?g:m,c=this.defines.generateSource().concat(n.defines.generateSource());return"\n"+t.join("\n")+"\n\n"+c.join("\n")+"\n\n"+s+"\n\n"+o.join("\n")+"\n\n"+r.join("\n")+"\n\n"+i.join("\n")+"\n\n"+a.join("\n")},t}(s);t.ShaderBuilder=c;var l=function(){function e(){this._entries=new Array,this._set=new Set}return e.prototype.add=function(e,t,r){var i=e+"_"+t+"_"+r;return this._set.has(i)||(this._entries.push([e,t,r]),this._set.add(i)),this},e.prototype.generateSource=function(){return this._entries.map((function(e){return"uniform "+e[1]+" "+e[0]+((t=e[2])?"["+t+"]":"")+";";var t}))},e}(),u=function(){function e(){this._entries=new Array}return e.prototype.add=function(e){this._entries.push(e)},e.prototype.generateSource=function(){return this._entries},e}();t.Code=u;var f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.uniforms=new l,t.code=new u,t.defines=new h,t}return r.__extends(t,e),Object.defineProperty(t.prototype,"builder",{get:function(){return this},enumerable:!1,configurable:!0}),t}(s);t.Stage=f;var d=function(){function e(){this._entries=new Array}return e.prototype.add=function(e,t){this._entries.push([e,t])},e.prototype.generateSource=function(e){return"fragment"===e?[]:this._entries.map((function(e){return"attribute "+e[1]+" "+e[0]+";"}))},e}(),v=function(){function e(){this._entries=new Array}return e.prototype.add=function(e,t){this._entries.push([e,t])},e.prototype.generateSource=function(){return this._entries.map((function(e){return"varying "+e[1]+" "+e[0]+";"}))},e}(),p=function(){function e(){this._entries=new Set}return e.prototype.add=function(e){this._entries.add(e)},e.prototype.generateSource=function(t){var r="vertex"===t?e.ALLOWLIST_VERTEX:e.ALLOWLIST_FRAGMENT;return o.valuesOfSet(this._entries).filter((function(e){return r.indexOf(e)>=0})).map((function(e){return"#extension "+e+" : enable"}))},e.ALLOWLIST_FRAGMENT=["GL_EXT_shader_texture_lod","GL_OES_standard_derivatives"],e.ALLOWLIST_VERTEX=[],e}(),h=function(){function e(){this._entries=new Map}return e.prototype.addInt=function(e,t){var r=t%1==0?t.toFixed(0):t.toString();this._entries.set(e,r)},e.prototype.addFloat=function(e,t){var r=t%1==0?t.toFixed(1):t.toString();this._entries.set(e,r)},e.prototype.generateSource=function(){return n.pairsOfMap(this._entries).map((function(e){return"#define "+e[0]+" "+e[1]}))},e}(),m="#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n  precision highp sampler2D;\n#else\n  precision mediump float;\n  precision mediump sampler2D;\n#endif",g="precision highp float;\nprecision highp sampler2D;"}).apply(null,i))||(e.exports=n)},aWgr:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("GyfB"),r("2eYJ"),r("fXZm"),r("cpxo"),r("N5NQ"),r("GG08"),r("4p4v"),r("/dtL"),r("ZjcA"),r("18xY")],void 0===(n=(function(e,t,r,i,n,o,a,s,c,l,u,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.axisAngle=t.vector=t.frustum=t.sphere=t.clipRay=t.ray=t.lineSegment=t.triangle=t.boundedPlane=t.plane=void 0,t.plane=s,t.boundedPlane=i,t.triangle=u,t.lineSegment=a,t.ray=c,t.clipRay=n,t.sphere=l,t.frustum=o,t.vector=f,t.axisAngle=r}).apply(null,i))||(e.exports=n)},cpxo:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("PHan"),r("FXVB"),r("0LE5"),r("Rdxj"),r("2fXB"),r("O7NG"),r("JjCO"),r("fXZm"),r("GG08")],void 0===(n=(function(e,t,r,i,n,o,a,s,c,l,u){"use strict";function f(e){if(e){var t=e.planes,r=e.points;return{planes:[u.create(t[0]),u.create(t[1]),u.create(t[2]),u.create(t[3]),u.create(t[4]),u.create(t[5])],points:[o.vec3f64.clone(r[0]),o.vec3f64.clone(r[1]),o.vec3f64.clone(r[2]),o.vec3f64.clone(r[3]),o.vec3f64.clone(r[4]),o.vec3f64.clone(r[5]),o.vec3f64.clone(r[6]),o.vec3f64.clone(r[7])]}}return{planes:[u.create(),u.create(),u.create(),u.create(),u.create(),u.create()],points:[o.vec3f64.create(),o.vec3f64.create(),o.vec3f64.create(),o.vec3f64.create(),o.vec3f64.create(),o.vec3f64.create(),o.vec3f64.create(),o.vec3f64.create()]}}function d(e,t,r){void 0===r&&(r=f());for(var i=0;i<6;i++)u.copy(e[i],r.planes[i]);for(i=0;i<8;i++)n.vec3.copy(r.points[i],t[i]);return r}function v(e){var t=e.planes,r=e.points;u.fromPoints(r[4],r[0],r[3],t[0]),u.fromPoints(r[1],r[5],r[6],t[1]),u.fromPoints(r[4],r[5],r[1],t[2]),u.fromPoints(r[3],r[2],r[6],t[3]),u.fromPoints(r[0],r[1],r[2],t[4]),u.fromPoints(r[5],r[4],r[7],t[5])}function p(e,t){for(var r=0;r<6;r++)if(!u.clip(e[r],t))return!1;return!0}Object.defineProperty(t,"__esModule",{value:!0}),t.planePointIndices=t.intersectsAABB=t.intersectsPoint=t.intersectsLineSegment=t.intersectClipRay=t.intersectsRay=t.intersectsSphere=t.recomputePlanes=t.fromMatrix=t.fromValues=t.copy=t.create=void 0,t.create=f,t.copy=function(e,t){return void 0===t&&(t=f()),d(e.planes,e.points,t)},t.fromValues=d,t.fromMatrix=function(e,t,r){void 0===r&&(r=f());var o=r.points,s=i.mat4.multiply(c.sm4d.get(),t,e);i.mat4.invert(s,s);for(var l=0;l<8;++l){var u=a.vec4.transformMat4(c.sv4d.get(),h[l],s);n.vec3.set(o[l],u[0]/u[3],u[1]/u[3],u[2]/u[3])}return v(r),r},t.recomputePlanes=v,t.intersectsSphere=function(e,t){for(var r=0;r<6;r++)if(u.isSphereFullyInside(e[r],t))return!1;return!0},t.intersectsRay=function(e,t){return p(e,l.fromRay(t,m.get()))},t.intersectClipRay=function(e,t){for(var r=0;r<6;r++)if(!u.clipInfinite(e[r],t))return!1;return!0},t.intersectsLineSegment=function(e,t,r){return p(e,l.fromLineSegmentAndDirection(t,r,m.get()))},t.intersectsPoint=function(e,t){for(var r=0;r<6;r++)if(u.signedDistance(e[r],t)>0)return!1;return!0},t.intersectsAABB=function(e,t){for(var r=0;r<6;r++)if(u.isAABBFullyInside(e[r],t))return!1;return!0},t.planePointIndices={bottom:[5,1,0,4],near:[0,1,2,3],far:[5,4,7,6],right:[1,5,6,2],left:[4,0,3,7],top:[7,3,2,6]};var h=[s.vec4f64.fromValues(-1,-1,-1,1),s.vec4f64.fromValues(1,-1,-1,1),s.vec4f64.fromValues(1,1,-1,1),s.vec4f64.fromValues(-1,1,-1,1),s.vec4f64.fromValues(-1,-1,1,1),s.vec4f64.fromValues(1,-1,1,1),s.vec4f64.fromValues(1,1,1,1),s.vec4f64.fromValues(-1,1,1,1)],m=new r.ObjectStack(l.create)}).apply(null,i))||(e.exports=n)},fXZm:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("PHan"),r("0LE5"),r("JjCO"),r("4p4v")],void 0===(n=(function(e,t,r,i,n,o){"use strict";function a(e){return e?{ray:o.create(e.ray),c0:e.c0,c1:e.c1}:{ray:o.create(),c0:0,c1:Number.MAX_VALUE}}function s(e,t,r,i){return void 0===i&&(i=a()),o.copy(e,i.ray),i.c0=t,i.c1=r,i}function c(e,t,r){void 0===r&&(r=a());var n=i.vec3.length(e.vector);return o.fromValues(e.origin,t,r.ray),r.c0=0,r.c1=n,r}function l(e,t,r){return i.vec3.add(r,e.ray.origin,i.vec3.scale(r,e.ray.direction,t))}Object.defineProperty(t,"__esModule",{value:!0}),t.getAt=t.getEnd=t.getStart=t.fromLineSegmentAndDirection=t.fromLineSegment=t.fromRay=t.fromValues=t.copy=t.wrap=t.create=void 0,t.create=a,t.wrap=function(e,t,r){var i=u.get();return i.ray=e,i.c0=t,i.c1=r,i},t.copy=function(e,t){return void 0===t&&(t=a()),s(e.ray,e.c0,e.c1,t)},t.fromValues=s,t.fromRay=function(e,t){return void 0===t&&(t=a()),o.copy(e,t.ray),t.c0=0,t.c1=Number.MAX_VALUE,t},t.fromLineSegment=function(e,t){return void 0===t&&(t=a()),c(e,i.vec3.normalize(n.sv3d.get(),e.vector),t)},t.fromLineSegmentAndDirection=c,t.getStart=function(e,t){return l(e,e.c0,t)},t.getEnd=function(e,t){return l(e,e.c1,t)},t.getAt=l;var u=new r.ObjectStack((function(){return{c0:0,c1:0,ray:null}}))}).apply(null,i))||(e.exports=n)},fese:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("zOht"),r("LxLY"),r("0LE5"),r("Rdxj"),r("7Aei")],void 0===(n=(function(e,t,r,i,n,o,a){"use strict";function s(e,t){if(t.slicePlaneEnabled){e.extensions.add("GL_OES_standard_derivatives"),t.sliceEnabledForVertexPrograms&&(e.vertex.uniforms.add("slicePlaneOrigin","vec3"),e.vertex.uniforms.add("slicePlaneBasis1","vec3"),e.vertex.uniforms.add("slicePlaneBasis2","vec3")),e.fragment.uniforms.add("slicePlaneOrigin","vec3"),e.fragment.uniforms.add("slicePlaneBasis1","vec3"),e.fragment.uniforms.add("slicePlaneBasis2","vec3");var i=a.glsl(c||(c=r.__makeTemplateObject(["\n      struct SliceFactors {\n        float front;\n        float side0;\n        float side1;\n        float side2;\n        float side3;\n      };\n\n      SliceFactors calculateSliceFactors(vec3 pos) {\n        vec3 rel = pos - slicePlaneOrigin;\n\n        vec3 slicePlaneNormal = -cross(slicePlaneBasis1, slicePlaneBasis2);\n        float slicePlaneW = -dot(slicePlaneNormal, slicePlaneOrigin);\n\n        float basis1Len2 = dot(slicePlaneBasis1, slicePlaneBasis1);\n        float basis2Len2 = dot(slicePlaneBasis2, slicePlaneBasis2);\n\n        float basis1Dot = dot(slicePlaneBasis1, rel);\n        float basis2Dot = dot(slicePlaneBasis2, rel);\n\n        return SliceFactors(\n          dot(slicePlaneNormal, pos) + slicePlaneW,\n          -basis1Dot - basis1Len2,\n          basis1Dot - basis1Len2,\n          -basis2Dot - basis2Len2,\n          basis2Dot - basis2Len2\n        );\n      }\n\n      bool sliceByFactors(SliceFactors factors) {\n        return factors.front < 0.0\n          && factors.side0 < 0.0\n          && factors.side1 < 0.0\n          && factors.side2 < 0.0\n          && factors.side3 < 0.0;\n      }\n\n      bool sliceEnabled() {\n        // a slicePlaneBasis1 vector of zero length is used to disable slicing in the shader during draped rendering.\n        return dot(slicePlaneBasis1, slicePlaneBasis1) != 0.0;\n      }\n\n      bool sliceByPlane(vec3 pos) {\n        return sliceEnabled() && sliceByFactors(calculateSliceFactors(pos));\n      }\n\n      #define rejectBySlice(_pos_) sliceByPlane(_pos_)\n      #define discardBySlice(_pos_) { if (sliceByPlane(_pos_)) discard; }\n    "],["\n      struct SliceFactors {\n        float front;\n        float side0;\n        float side1;\n        float side2;\n        float side3;\n      };\n\n      SliceFactors calculateSliceFactors(vec3 pos) {\n        vec3 rel = pos - slicePlaneOrigin;\n\n        vec3 slicePlaneNormal = -cross(slicePlaneBasis1, slicePlaneBasis2);\n        float slicePlaneW = -dot(slicePlaneNormal, slicePlaneOrigin);\n\n        float basis1Len2 = dot(slicePlaneBasis1, slicePlaneBasis1);\n        float basis2Len2 = dot(slicePlaneBasis2, slicePlaneBasis2);\n\n        float basis1Dot = dot(slicePlaneBasis1, rel);\n        float basis2Dot = dot(slicePlaneBasis2, rel);\n\n        return SliceFactors(\n          dot(slicePlaneNormal, pos) + slicePlaneW,\n          -basis1Dot - basis1Len2,\n          basis1Dot - basis1Len2,\n          -basis2Dot - basis2Len2,\n          basis2Dot - basis2Len2\n        );\n      }\n\n      bool sliceByFactors(SliceFactors factors) {\n        return factors.front < 0.0\n          && factors.side0 < 0.0\n          && factors.side1 < 0.0\n          && factors.side2 < 0.0\n          && factors.side3 < 0.0;\n      }\n\n      bool sliceEnabled() {\n        // a slicePlaneBasis1 vector of zero length is used to disable slicing in the shader during draped rendering.\n        return dot(slicePlaneBasis1, slicePlaneBasis1) != 0.0;\n      }\n\n      bool sliceByPlane(vec3 pos) {\n        return sliceEnabled() && sliceByFactors(calculateSliceFactors(pos));\n      }\n\n      #define rejectBySlice(_pos_) sliceByPlane(_pos_)\n      #define discardBySlice(_pos_) { if (sliceByPlane(_pos_)) discard; }\n    "]))),n=a.glsl(l||(l=r.__makeTemplateObject(["\n      vec4 applySliceHighlight(vec4 color, vec3 pos) {\n        SliceFactors factors = calculateSliceFactors(pos);\n\n        if (sliceByFactors(factors)) {\n          return color;\n        }\n\n        const float HIGHLIGHT_WIDTH = 1.0;\n        const vec4 HIGHLIGHT_COLOR = vec4(0.0, 0.0, 0.0, 0.3);\n\n        factors.front /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.front);\n        factors.side0 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side0);\n        factors.side1 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side1);\n        factors.side2 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side2);\n        factors.side3 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side3);\n\n        float highlightFactor = (1.0 - step(0.5, factors.front))\n          * (1.0 - step(0.5, factors.side0))\n          * (1.0 - step(0.5, factors.side1))\n          * (1.0 - step(0.5, factors.side2))\n          * (1.0 - step(0.5, factors.side3));\n\n        return mix(color, vec4(HIGHLIGHT_COLOR.rgb, color.a), highlightFactor * HIGHLIGHT_COLOR.a);\n      }\n    "],["\n      vec4 applySliceHighlight(vec4 color, vec3 pos) {\n        SliceFactors factors = calculateSliceFactors(pos);\n\n        if (sliceByFactors(factors)) {\n          return color;\n        }\n\n        const float HIGHLIGHT_WIDTH = 1.0;\n        const vec4 HIGHLIGHT_COLOR = vec4(0.0, 0.0, 0.0, 0.3);\n\n        factors.front /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.front);\n        factors.side0 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side0);\n        factors.side1 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side1);\n        factors.side2 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side2);\n        factors.side3 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side3);\n\n        float highlightFactor = (1.0 - step(0.5, factors.front))\n          * (1.0 - step(0.5, factors.side0))\n          * (1.0 - step(0.5, factors.side1))\n          * (1.0 - step(0.5, factors.side2))\n          * (1.0 - step(0.5, factors.side3));\n\n        return mix(color, vec4(HIGHLIGHT_COLOR.rgb, color.a), highlightFactor * HIGHLIGHT_COLOR.a);\n      }\n    "]))),o=t.sliceHighlightDisabled?a.glsl(u||(u=r.__makeTemplateObject(["#define highlightSlice(_color_, _pos_) (_color_)"],["#define highlightSlice(_color_, _pos_) (_color_)"]))):a.glsl(f||(f=r.__makeTemplateObject(["\n        ","\n        #define highlightSlice(_color_, _pos_) (sliceEnabled() ? applySliceHighlight(_color_, _pos_) : (_color_))\n      "],["\n        ","\n        #define highlightSlice(_color_, _pos_) (sliceEnabled() ? applySliceHighlight(_color_, _pos_) : (_color_))\n      "])),n);t.sliceEnabledForVertexPrograms&&e.vertex.code.add(i),e.fragment.code.add(i),e.fragment.code.add(o)}else{var s=a.glsl(d||(d=r.__makeTemplateObject(["\n      #define rejectBySlice(_pos_) false\n      #define discardBySlice(_pos_) {}\n      #define highlightSlice(_color_, _pos_) (_color_)\n    "],["\n      #define rejectBySlice(_pos_) false\n      #define discardBySlice(_pos_) {}\n      #define highlightSlice(_color_, _pos_) (_color_)\n    "])));t.sliceEnabledForVertexPrograms&&e.vertex.code.add(s),e.fragment.code.add(s)}}Object.defineProperty(t,"__esModule",{value:!0}),t.Slice=void 0,t.Slice=s,function(e){e.bindUniformsWithOrigin=function(t,r,i){e.bindUniforms(t,r,i.slicePlane,i.origin)},e.bindUniforms=function(e,t,r,a){t.slicePlaneEnabled&&(i.isSome(r)?(a?(n.vec3.subtract(v,r.origin,a),e.setUniform3fv("slicePlaneOrigin",v)):e.setUniform3fv("slicePlaneOrigin",r.origin),e.setUniform3fv("slicePlaneBasis1",r.basis1),e.setUniform3fv("slicePlaneBasis2",r.basis2)):(e.setUniform3fv("slicePlaneBasis1",o.vec3f64.ZEROS),e.setUniform3fv("slicePlaneBasis2",o.vec3f64.ZEROS),e.setUniform3fv("slicePlaneOrigin",o.vec3f64.ZEROS)))}}(s=t.Slice||(t.Slice={}));var c,l,u,f,d,v=o.vec3f64.create()}).apply(null,i))||(e.exports=n)},"ff/U":function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Default3D=void 0,t.Default3D={position:0,normal:1,uv0:2,color:3,size:4,tangent:4,uvMapSpace:4,auxpos1:5,symbolColor:5,auxpos2:6,featureAttribute:6,instanceFeatureAttribute:6,instanceColor:7,bound1:5,bound2:6,bound3:7,model:8,modelNormal:12,modelOriginHi:11,modelOriginLo:15}}).apply(null,i))||(e.exports=n)},iHt0:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=(function(e,t){"use strict";function r(){return new Float32Array(3)}function i(e,t,r){var i=new Float32Array(3);return i[0]=e,i[1]=t,i[2]=r,i}function n(){return r()}function o(){return i(1,1,1)}function a(){return i(1,0,0)}function s(){return i(0,1,0)}function c(){return i(0,0,1)}Object.defineProperty(t,"__esModule",{value:!0}),t.UNIT_Z=t.UNIT_Y=t.UNIT_X=t.ONES=t.ZEROS=t.unitZ=t.unitY=t.unitX=t.ones=t.zeros=t.createView=t.fromValues=t.clone=t.create=void 0,t.create=r,t.clone=function(e){var t=new Float32Array(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},t.fromValues=i,t.createView=function(e,t){return new Float32Array(e,t,3)},t.zeros=n,t.ones=o,t.unitX=a,t.unitY=s,t.unitZ=c,t.ZEROS=n(),t.ONES=o(),t.UNIT_X=a(),t.UNIT_Y=s(),t.UNIT_Z=c()}).apply(null,i))||(e.exports=n)},lBa0:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("xoE+")],void 0===(n=(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parameter=t.ShaderTechniqueConfiguration=void 0;var i=function(){function e(){this._key="",this._keyDirty=!1,this._parameterBits=this._parameterBits.map((function(){return 0}))}return Object.defineProperty(e.prototype,"key",{get:function(){return this._keyDirty&&(this._keyDirty=!1,this._key=String.fromCharCode.apply(String,this._parameterBits)),this._key},enumerable:!1,configurable:!0}),e.prototype.snapshot=function(){for(var e={key:this.key},t=0,r=this._parameterNames;t<r.length;t++){var i=r[t];e[i]=this[i]}return e},e}();t.ShaderTechniqueConfiguration=i,t.parameter=function(e){return void 0===e&&(e={}),function(t,i){var n,o;t._parameterNames=null!==(n=t._parameterNames)&&void 0!==n?n:[],t._parameterNames.push(i);for(var a=t._parameterNames.length-1,s=Math.ceil(r.log2(e.count||2)),c=null!==(o=t._parameterBits)&&void 0!==o?o:[0],l=0;c[l]+s>16;)++l>=c.length&&c.push(0);t._parameterBits=c;var u=c[l],f=(1<<s)-1<<u;c[l]+=s,Object.defineProperty(t,i,{get:function(){return this[a]},set:function(e){if(this[a]!==e&&(this[a]=e,this._keyDirty=!0,this._parameterBits[l]=this._parameterBits[l]&~f|+e<<u&f,"number"!=typeof e&&"boolean"!=typeof e))throw"Configuration values must be booleans or numbers!"}})}}}).apply(null,i))||(e.exports=n)},lfQW:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stencilToolTransparentOccluderParams=t.stencilToolMaskOccluderParams=t.stencilToolMaskBaseParams=t.stencilBaseAllZerosParams=t.replaceBitWhenDepthTestPasses=t.renderWhenBitIsNotSet=t.stencilWriteMaskOff=t.stencilWriteMaskOn=t.depthCompareAlways=t.depthCompareLess=void 0,t.depthCompareLess={func:513},t.depthCompareAlways={func:519},t.stencilWriteMaskOn={mask:255},t.stencilWriteMaskOff={mask:0},t.renderWhenBitIsNotSet=function(e){return{function:{func:517,ref:e,mask:e},operation:{fail:7680,zFail:7680,zPass:7680}}},t.replaceBitWhenDepthTestPasses=function(e){return{function:{func:519,ref:e,mask:e},operation:{fail:7680,zFail:7680,zPass:7681}}},t.stencilBaseAllZerosParams={function:{func:519,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:0}},t.stencilToolMaskBaseParams={function:{func:519,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7681}},t.stencilToolMaskOccluderParams={function:{func:514,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7680}},t.stencilToolTransparentOccluderParams={function:{func:517,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7680}}}).apply(null,i))||(e.exports=n)},quQL:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("zOht"),r("7Aei")],void 0===(n=(function(e,t,r,i){"use strict";var n,o;Object.defineProperty(t,"__esModule",{value:!0}),t.PiUtils=void 0,t.PiUtils=function(e){e.vertex.code.add(i.glsl(n||(n=r.__makeTemplateObject(["\n    const float PI = 3.141592653589793;\n  "],["\n    const float PI = 3.141592653589793;\n  "])))),e.fragment.code.add(i.glsl(o||(o=r.__makeTemplateObject(["\n    const float PI = 3.141592653589793;\n    const float LIGHT_NORMALIZATION = 1.0 / PI;\n    const float INV_PI = 0.3183098861837907;\n    const float HALF_PI = 1.570796326794897;\n    "],["\n    const float PI = 3.141592653589793;\n    const float LIGHT_NORMALIZATION = 1.0 / PI;\n    const float INV_PI = 0.3183098861837907;\n    const float HALF_PI = 1.570796326794897;\n    "]))))}}).apply(null,i))||(e.exports=n)},s6rJ:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("xoE+"),r("LxLY"),r("0LE5"),r("Rdxj"),r("WRgd"),r("+wMf"),r("CIy2"),r("PwS/")],void 0===(n=(function(e,t,r,i,n,o,a,s,c,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.colorMixModes=t.intersectDrapedRenderLineGeometry=t.updateParameters=t.copyParameters=t.bindScreenSizePerspective=t.verticalOffsetAtDistance=t.intersectAabbInvDirBefore=t.intersectAabbInvDir=t.computeInvDir=t.computeNormal=t.intersectTriangles=t.intersectTriangleGeometry=void 0;var u=a.create(),f=c.VertexAttrConstants;t.intersectTriangleGeometry=function(e,t,r,n,o,s,v){var p=l.isInstanceHidden(t),m=r.tolerance;if(!p)if(e.boundingInfo)c.assert("triangle"===e.data.primitiveType),function e(t,r,n,o,s,c){var l=y(r,n,d);if(a.setMin(u,t.getBBMin()),a.setMax(u,t.getBBMax()),i.isSome(s)&&s.applyToAabb(u),_(u,r,l,o)){var f=t.getPrimitiveIndices(),v=t.getIndices(),p=t.getPosition(),m=f?f.length:v.length/3;if(m>P){var g=t.getChildren();if(void 0!==g){for(var b=0;b<8;++b)void 0!==g[b]&&e(g[b],r,n,o,s,c);return}}h(r,n,0,m,v,p,f,s,c)}}(e.boundingInfo,n,o,m,s,v);else{var g=e.getIndices(f.POSITION),b=e.getAttribute(f.POSITION);h(n,o,0,g.length/3,g,b,void 0,s,v)}};var d=o.vec3f64.create(),v=Math.pow(2,-52),p=o.vec3f64.create();function h(e,t,r,n,o,a,s,c,l){var u,f,d;if(s)return function(e,t,r,n,o,a,s,c,l){for(var u,f,d,h=a.data,m=a.offsetIdx,g=a.strideIdx,y=e[0],_=e[1],x=e[2],O=t[0]-y,P=t[1]-_,S=t[2]-x,M=r;M<n;++M){var w=s[M],A=3*w,j=m+g*o[A++],I=h[j++],V=h[j++],T=h[j];j=m+g*o[A++];var C=h[j++],L=h[j++],D=h[j];j=m+g*o[A];var R=h[j++],B=h[j++],F=h[j];i.isSome(c)&&(I=(u=c.applyToVertex(I,V,T))[0],V=u[1],T=u[2],C=(f=c.applyToVertex(C,L,D))[0],L=f[1],D=f[2],R=(d=c.applyToVertex(R,B,F))[0],B=d[1],F=d[2]);var z=C-I,N=L-V,U=D-T,G=R-I,E=B-V,k=F-T,H=P*k-E*S,q=S*G-k*O,W=O*E-G*P,X=z*H+N*q+U*W;if(!(Math.abs(X)<=v)){var Y=y-I,Z=_-V,J=x-T,Q=Y*H+Z*q+J*W;if(X>0){if(Q<0||Q>X)continue}else if(Q>0||Q<X)continue;var K=Z*U-N*J,$=J*z-U*Y,ee=Y*N-z*Z,te=O*K+P*$+S*ee;if(X>0){if(te<0||Q+te>X)continue}else if(te>0||Q+te<X)continue;var re=(G*K+E*$+k*ee)/X;re>=0&&l(re,b(z,N,U,G,E,k,p),w)}}}(e,t,r,n,o,a,s,c,l);for(var h=a.data,m=a.offsetIdx,g=a.strideIdx,y=e[0],_=e[1],x=e[2],O=t[0]-y,P=t[1]-_,S=t[2]-x,M=r,w=3*r;M<n;++M){var A=m+g*o[w++],j=h[A++],I=h[A++],V=h[A];A=m+g*o[w++];var T=h[A++],C=h[A++],L=h[A];A=m+g*o[w++];var D=h[A++],R=h[A++],B=h[A];i.isSome(c)&&(j=(u=c.applyToVertex(j,I,V))[0],I=u[1],V=u[2],T=(f=c.applyToVertex(T,C,L))[0],C=f[1],L=f[2],D=(d=c.applyToVertex(D,R,B))[0],R=d[1],B=d[2]);var F=T-j,z=C-I,N=L-V,U=D-j,G=R-I,E=B-V,k=P*E-G*S,H=S*U-E*O,q=O*G-U*P,W=F*k+z*H+N*q;if(!(Math.abs(W)<=v)){var X=y-j,Y=_-I,Z=x-V,J=X*k+Y*H+Z*q;if(W>0){if(J<0||J>W)continue}else if(J>0||J<W)continue;var Q=Y*N-z*Z,K=Z*F-N*X,$=X*z-F*Y,ee=O*Q+P*K+S*$;if(W>0){if(ee<0||J+ee>W)continue}else if(ee>0||J+ee<W)continue;var te=(U*Q+G*K+E*$)/W;te>=0&&l(te,b(F,z,N,U,G,E,p),M)}}}t.intersectTriangles=h;var m=o.vec3f64.create(),g=o.vec3f64.create();function b(e,t,r,i,o,a,s){return n.vec3.set(m,e,t,r),n.vec3.set(g,i,o,a),n.vec3.cross(s,m,g),n.vec3.normalize(s,s),s}function y(e,t,r){return n.vec3.set(r,1/(t[0]-e[0]),1/(t[1]-e[1]),1/(t[2]-e[2]))}function _(e,t,r,i){return x(e,t,r,i,1/0)}function x(e,t,r,i,n){var o=(e[0]-i-t[0])*r[0],a=(e[3]+i-t[0])*r[0],s=Math.min(o,a),c=Math.max(o,a),l=(e[1]-i-t[1])*r[1],u=(e[4]+i-t[1])*r[1];if((c=Math.min(c,Math.max(l,u)))<0)return!1;if((s=Math.max(s,Math.min(l,u)))>c)return!1;var f=(e[2]-i-t[2])*r[2],d=(e[5]+i-t[2])*r[2];return!((c=Math.min(c,Math.max(f,d)))<0)&&!((s=Math.max(s,Math.min(f,d)))>c)&&s<n}function O(e){var t=[];return e.forEach((function(e){return t.push(e)})),t}t.computeNormal=b,t.computeInvDir=y,t.intersectAabbInvDir=_,t.intersectAabbInvDirBefore=x,t.verticalOffsetAtDistance=function(e,t,i,n,o){var a=(i.screenLength||0)*e.pixelRatio;o&&(a=s.scale(a,n,t,o));var c=a*Math.tan(.5*e.fovY)/(.5*e.fullHeight);return r.glClamp(c*t,i.minWorldLength||0,null!=i.maxWorldLength?i.maxWorldLength:1/0)},t.bindScreenSizePerspective=function(e,t,r){if(e){var i=e.parameters;t.setUniform4f(r,i.divisor,i.offset,i.minPixelSize,e.paddingPixelsOverride)}},t.copyParameters=function e(t,r){var i=r?e(r):{};for(var n in t){var o=t[n];o&&o.forEach&&(o=O(o)),null==o&&n in i||(i[n]=o)}return i},t.updateParameters=function(e,t){var r=!1;for(var i in t){var n=t[i];void 0!==n&&(r=!0,e[i]=Array.isArray(n)?n.slice():n)}return r},t.intersectDrapedRenderLineGeometry=function(e,t,i,n,o){if(t.options.selectionMode){for(var a=e.getAttribute(f.POSITION).data,s=e.getAttribute(f.SIZE),c=i[0],l=i[1],u=(((s&&s.data[0])+n)/2+4)*e.screenToWorldRatio,d=Number.MAX_VALUE,v=0;v<a.length-5;v+=3){var p=a[v],h=a[v+1],m=c-p,g=l-h,b=a[v+3]-p,y=a[v+4]-h,_=r.clamp((b*m+y*g)/(b*b+y*y),0,1),x=b*_-m,O=y*_-g,P=x*x+O*O;P<d&&(d=P)}d<u*u&&o()}},t.colorMixModes={multiply:1,ignore:2,replace:3,tint:4};var P=1e3}).apply(null,i))||(e.exports=n)},tUyH:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("zOht"),r("KRuQ")],void 0===(n=(function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GLMaterial=void 0;var n=function(e){function t(t){var r=e.call(this)||this;return r.material=t.material,r.techniqueRep=t.techniqueRep,r.output=t.output,r}return r.__extends(t,e),t.prototype.getTechnique=function(){return this.technique},t.prototype.getPipelineState=function(e,t){return this.getTechnique().pipeline},t.prototype.ensureResources=function(e){return 2},t.prototype.ensureParameters=function(e){},t}(i.AutoDisposable);t.GLMaterial=n}).apply(null,i))||(e.exports=n)},vlC2:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("iHt0")],void 0===(n=(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec3f32=void 0,t.vec3f32=r}).apply(null,i))||(e.exports=n)},"wSO/":function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("LxLY"),r("6DRN"),r("51bw"),r("1m5D"),r("lLWD"),r("DIqE"),r("Rdxj"),r("O7NG")],void 0===(n=(function(e,t,r,i,n,o,a,s,c,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VectorStack=void 0;var u=function(){function e(e,t,r){var n=this;this.itemByteSize=e,this.itemCreate=t,this.buffers=[],this.items=[],this.itemsPerBuffer=0,this.itemsPtr=0,this.itemsPerBuffer=Math.ceil(r/this.itemByteSize),this.tickHandle=i.before((function(){return n.reset()}))}return e.prototype.destroy=function(){this.tickHandle&&(this.tickHandle.remove(),this.tickHandle=r.nullifyNonnullableForDispose(this.tickHandle)),this.itemsPtr=0,this.items=r.nullifyNonnullableForDispose(this.items),this.buffers=r.nullifyNonnullableForDispose(this.buffers)},e.prototype.get=function(){0===this.itemsPtr&&i((function(){}));for(var e=Math.floor(this.itemsPtr/this.itemsPerBuffer);this.buffers.length<=e;){for(var t=new ArrayBuffer(this.itemsPerBuffer*this.itemByteSize),r=0;r<this.itemsPerBuffer;++r)this.items.push(this.itemCreate(t,r*this.itemByteSize));this.buffers.push(t)}return this.items[this.itemsPtr++]},e.prototype.reset=function(){for(var e=2*(Math.floor(this.itemsPtr/this.itemsPerBuffer)+1);this.buffers.length>e;)this.buffers.pop(),this.items.length=this.buffers.length*this.itemsPerBuffer;this.itemsPtr=0},e.createVec2f64=function(t){return void 0===t&&(t=f),new e(16,s.vec2f64.createView,t)},e.createVec3f64=function(t){return void 0===t&&(t=f),new e(24,c.vec3f64.createView,t)},e.createVec4f64=function(t){return void 0===t&&(t=f),new e(32,l.vec4f64.createView,t)},e.createMat3f64=function(t){return void 0===t&&(t=f),new e(72,n.mat3f64.createView,t)},e.createMat4f64=function(t){return void 0===t&&(t=f),new e(128,o.mat4f64.createView,t)},e.createQuatf64=function(t){return void 0===t&&(t=f),new e(32,a.quatf64.createView,t)},Object.defineProperty(e.prototype,"test",{get:function(){return{size:this.buffers.length*this.itemsPerBuffer*this.itemByteSize}},enumerable:!1,configurable:!0}),e}();t.VectorStack=u;var f=4096}).apply(null,i))||(e.exports=n)},ys4y:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("3RHn"),r("+nCE"),r("W0kZ"),r("CIy2"),r("CIy2")],void 0===(n=(function(e,t,r,i,n,o,a){"use strict";return function(){function e(t,r,i){this._boundingInfo=null,this._id=e.__idGen.gen(r),this._data=t,this._boundingInfo=i}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!1,configurable:!0}),e.prototype.getIndices=function(e){return this.data.getIndices(e)},Object.defineProperty(e.prototype,"indexCount",{get:function(){return this.data.indexCount},enumerable:!1,configurable:!0}),e.prototype.getAttribute=function(e){return this.data.getAttribute(e)},Object.defineProperty(e.prototype,"vertexCount",{get:function(){return this.data.indexCount},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"faceCount",{get:function(){return this.data.indexCount/3},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"boundingInfo",{get:function(){return null==this._boundingInfo&&(this._boundingInfo=this._calculateBoundingInfo()),this._boundingInfo},enumerable:!1,configurable:!0}),e.prototype.computeAttachmentOrigin=function(e){return"triangle"===this.data.primitiveType?this.computeAttachmentOriginTriangles(e):this.computeAttachmentOriginPoints(e)},e.prototype.computeAttachmentOriginTriangles=function(e){var t=this.getIndices(a.VertexAttrConstants.POSITION),r=this.getAttribute(a.VertexAttrConstants.POSITION);return i.computeAttachmentOriginTriangles(r,t,e)},e.prototype.computeAttachmentOriginPoints=function(e){var t=this.getIndices(a.VertexAttrConstants.POSITION),r=this.getAttribute(a.VertexAttrConstants.POSITION);return i.computeAttachmentOriginPoints(r,t,e)},e.prototype.invalidateBoundingInfo=function(){this._boundingInfo=null},e.prototype._calculateBoundingInfo=function(){var e=this.data.getIndices(a.VertexAttrConstants.POSITION),t=this.data.getAttribute(a.VertexAttrConstants.POSITION),n="triangle"===this.data.primitiveType?3:1;if(0===e.length){e=new Uint32Array(n);for(var s=0;s<n;++s)e[s]=s}var c=e.length;o.assert(c%n==0,"Indexing error: "+c.toFixed(0)+" not divisible by "+n.toFixed(0));var l=i.generateDefaultIndexArray(c/n);return new r(l,n,e,t)},e.__idGen=new n.IdGen,e}()}).apply(null,i))||(e.exports=n)},zZCp:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pos2Tex=t.Pos2=t.Pos3Col=t.Pos3NormalTex=t.Pos3Tex=t.Pos3=void 0,t.Pos3=[{name:"position",count:3,type:5126,offset:0,stride:12,normalized:!1}],t.Pos3Tex=[{name:"position",count:3,type:5126,offset:0,stride:20,normalized:!1},{name:"uv0",count:2,type:5126,offset:12,stride:20,normalized:!1}],t.Pos3NormalTex=[{name:"position",count:3,type:5126,offset:0,stride:32,normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:32,normalized:!1},{name:"uv0",count:2,type:5126,offset:24,stride:32,normalized:!1}],t.Pos3Col=[{name:"position",count:3,type:5126,offset:0,stride:16,normalized:!1},{name:"color",count:4,type:5121,offset:12,stride:16,normalized:!1}],t.Pos2=[{name:"position",count:2,type:5126,offset:0,stride:8,normalized:!1}],t.Pos2Tex=[{name:"position",count:2,type:5126,offset:0,stride:16,normalized:!1},{name:"uv0",count:2,type:5126,offset:8,stride:16,normalized:!1}]}).apply(null,i))||(e.exports=n)}}]);