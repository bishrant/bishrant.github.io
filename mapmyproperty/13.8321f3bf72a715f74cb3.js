(function(){var t={"arcgis-js-api/views/2d/layers/features/support/displayIdUtils":"2ESQ","arcgis-js-api/views/2d/layers/features/support/TileStore":"6kSU","arcgis-js-api/core/libs/quickselect/quickselect":"FT4I","arcgis-js-api/layers/graphics/centroid":"Fzzg","arcgis-js-api/views/2d/engine/webgl/visualVariablesUtils":"G59t","arcgis-js-api/geometry/geometryAdapters/json":"H9Hv","arcgis-js-api/views/2d/layers/features/support/ComputedAttributeStorage":"OgqW","arcgis-js-api/layers/graphics/data/projectionSupport":"Q2Em","arcgis-js-api/views/2d/layers/features/support/FeatureSetReaderJSON":"ZB9i","arcgis-js-api/views/2d/layers/features/support/Tile":"fUL3","arcgis-js-api/core/libs/rbush/rbush":"jEml","arcgis-js-api/views/2d/layers/features/support/AttributeStore":"lvbU","arcgis-js-api/views/2d/layers/features/support/StaticBitSet":"oz1K","esri/views/2d/layers/features/support/FeatureSetReader":"vwon","arcgis-js-api/views/2d/layers/features/support/FeatureSetReader":"vwon"},e=this||window,r=e.webpackJsonp=e.webpackJsonp||[];r.registerAbsMids?r.registerAbsMids(t):(r.absMidsWaiting=r.absMidsWaiting||[]).push(t)})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"2ESQ":function(t,e,r){var i,n;i=[r.dj.c(t.i),e],void 0===(n=(function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DisplayIdGenerator=e.getDisplayIdIndex=e.getDisplayIdType=e.DISPLAY_ID_TYPE_AGGREGATE=e.DISPLAY_ID_TYPE_FEATURE=void 0,e.DISPLAY_ID_TYPE_FEATURE=0,e.DISPLAY_ID_TYPE_AGGREGATE=1,e.getDisplayIdType=function(t){return(2147483648&t)>>>31},e.getDisplayIdIndex=function(t){return 2147483647&t};var r=function(){function t(){this._freeIds=[],this._idCounter=1}return t.prototype.createId=function(t){return void 0===t&&(t=!1),function(t,e){return((e?2147483648:0)|t)>>>0}(this._getFreeId(),t)},t.prototype.releaseId=function(t){this._freeIds.push(t)},t.prototype._getFreeId=function(){return this._freeIds.length?this._freeIds.pop():this._idCounter++},t}();e.DisplayIdGenerator=r}).apply(null,i))||(t.exports=n)},"6kSU":function(t,e,r){var i,n;i=[r.dj.c(t.i),e,r("zOht"),r("BcWh"),r("H1tY"),r("jEml"),r("fUL3"),r("7Lgj"),r("f3JK")],void 0===(n=(function(t,e,r,i,n,o,s,a,u){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var h={added:[],removed:[]},l=new Set,c=new u(0,0,0,0),p=function(t){function e(e){var r=t.call(this)||this;return r._tiles=new Map,r._index=o(9,n("csp-restrictions")?function(t){return{minX:t.bounds[0],minY:t.bounds[1],maxX:t.bounds[2],maxY:t.bounds[3]}}:[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),r.tiles=[],r.tileScheme=e,r}return r.__extends(e,t),e.prototype.destroy=function(){this.clear()},e.prototype.clear=function(){this.tiles.length=0,this._tiles.clear(),this._index.clear()},e.prototype.has=function(t){return this._tiles.has(t)},e.prototype.get=function(t){return this._tiles.get(t)},e.prototype.findByKey=function(t){return this._tiles.get(t.id)},e.prototype.intersections=function(t,e){var r="string"==typeof t?this.get(t):t;if(!r)return[];for(var i=e*r.resolution,n=r.bounds[0]-i,o=r.bounds[1]-i,s=r.bounds[2]+i,a=r.bounds[3]+i,u=[],h=0,l=this._index.search({minX:n,minY:o,maxX:s,maxY:a});h<l.length;h++){var c=l[h],p=c.bounds.slice();p[0]=Math.max(p[0],n),p[1]=Math.max(p[1],o),p[2]=Math.min(p[2],s),p[3]=Math.min(p[3],a),p[2]-p[0]>0&&p[3]-p[1]>0&&u.push({bounds:p,tile:c})}return u},e.prototype.boundsIntersections=function(t){return this._index.search({minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]})},e.prototype.updateTiles=function(t){for(var e=this,r={added:[],removed:[]},i=0,n=t.added;i<n.length;i++){var o=n[i];if(!this.has(o)){var a=new s.default(this.tileScheme,o);this._tiles.set(o,a),this._index.insert(a),r.added.push(a)}}for(var u=0,h=t.removed;u<h.length;u++)this.has(o=h[u])&&(a=this.get(o),this._tiles.delete(o),this._index.remove(a),r.removed.push(a));this.tiles.length=0,this._tiles.forEach((function(t){return e.tiles.push(t)})),(r.added.length||r.removed.length)&&this.emit("update",r)},e.prototype.setViewState=function(t){var e=this.tileScheme.getTileCoverage(t,0);if(e){var r=e.spans,i=e.lodInfo,n=i.level;if(r.length>0)for(var o=0,u=r;o<u.length;o++)for(var p=u[o],d=p.row,f=p.colTo,_=p.colFrom;_<=f;_++){var m=c.set(n,d,i.normalizeCol(_),i.getWorldForColumn(_)).id;if(l.add(m),!this.has(m)){var y=new s.default(this.tileScheme,m);this._tiles.set(m,y),this._index.insert(y),this.tiles.push(y),h.added.push(y)}}for(var g=this.tiles.length-1;g>=0;g--)l.has((y=this.tiles[g]).id)||(this._tiles.delete(y.id),this.tiles.splice(g,1),this._index.remove(y),h.removed.push(y));(h.added.length||h.removed.length)&&this.emit("update",h),a.pool.release(e),l.clear(),h.added.length=0,h.removed.length=0}},e}(i);e.default=p}).apply(null,i))||(t.exports=n)},FT4I:function(t,e,r){var i;void 0===(i=(function(){"use strict";function t(t,e,r){var i=t[e];t[e]=t[r],t[r]=i}function e(t,e){return t<e?-1:t>e?1:0}return function(r,i,n,o,s){!function e(r,i,n,o,s){for(;o>n;){if(o-n>600){var a=o-n+1,u=i-n+1,h=Math.log(a),l=.5*Math.exp(2*h/3),c=.5*Math.sqrt(h*l*(a-l)/a)*(u-a/2<0?-1:1);e(r,i,Math.max(n,Math.floor(i-u*l/a+c)),Math.min(o,Math.floor(i+(a-u)*l/a+c)),s)}var p=r[i],d=n,f=o;for(t(r,n,i),s(r[o],p)>0&&t(r,n,o);d<f;){for(t(r,d,f),d++,f--;s(r[d],p)<0;)d++;for(;s(r[f],p)>0;)f--}0===s(r[n],p)?t(r,n,f):t(r,++f,o),f<=i&&(n=f+1),i<=f&&(o=f-1)}}(r,i,n||0,o||r.length-1,s||e)}}).apply(null,[]))||(t.exports=i)},Fzzg:function(t,e,r){var i,n;i=[r.dj.c(t.i),e],void 0===(n=(function(t,e){"use strict";function r(t,e){return t?e?4:3:e?3:2}function i(t,e,i,n,o,s,a){void 0===a&&(a=1);for(var u=r(o,s),h=i,l=i+u,c=0,p=0,d=0,f=0,_=0,m=0,y=n-1;m<y;m++,h+=u,l+=u){var g=e[h],v=e[h+1],x=e[h+2],b=e[l],I=e[l+1],S=e[l+2],T=g*I-b*v;f+=T,c+=(g+b)*T,p+=(v+I)*T,o&&(d+=(x+S)*(T=g*S-b*x),_+=T),g<t[0]&&(t[0]=g),g>t[1]&&(t[1]=g),v<t[2]&&(t[2]=v),v>t[3]&&(t[3]=v),o&&(x<t[4]&&(t[4]=x),x>t[5]&&(t[5]=x))}if(f*a>0&&(f*=-1),_*a>0&&(_*=-1),!f)return null;var A=[c,p,.5*f];return o&&(A[3]=d,A[4]=.5*_),A}function n(t,e,i,n,h){for(var l=r(n,h),c=e,p=e+l,d=0,f=0,_=0,m=0,y=0,g=i-1;y<g;y++,c+=l,p+=l){var v,x=t[c],b=t[c+1],I=t[c+2],S=t[p],T=t[p+1],A=t[p+2],M=n?s(x,b,I,S,T,A):o(x,b,S,T);M&&(d+=M,n?(f+=M*(v=u(x,b,I,S,T,A))[0],_+=M*v[1],m+=M*v[2]):(f+=M*(v=a(x,b,S,T))[0],_+=M*v[1]))}return d>0?n?[f/d,_/d,m/d]:[f/d,_/d]:i>0?n?[t[e],t[e+1],t[e+2]]:[t[e],t[e+1]]:null}function o(t,e,r,i){var n=r-t,o=i-e;return Math.sqrt(n*n+o*o)}function s(t,e,r,i,n,o){var s=i-t,a=n-e,u=o-r;return Math.sqrt(s*s+a*a+u*u)}function a(t,e,r,i){return[t+.5*(r-t),e+.5*(i-e)]}function u(t,e,r,i,n,o){return[t+.5*(i-t),e+.5*(n-e),r+.5*(o-r)]}Object.defineProperty(e,"__esModule",{value:!0}),e.lineCentroid=e.getCentroidOptimizedGeometry=void 0,e.getCentroidOptimizedGeometry=function(t,e,o,s,a){if(!e||!e.lengths.length)return null;var u="upperLeft"===(null==a?void 0:a.originPosition)?-1:1;t.lengths.length&&(t.lengths.length=0),t.coords.length&&(t.coords.length=0);for(var h=t.coords,l=[],c=o?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],p=e.lengths,d=e.coords,f=r(o,s),_=0,m=0,y=p;m<y.length;m++){var g=y[m],v=i(c,d,_,g,o,s,u);v&&l.push(v),_+=g*f}if(l.sort((function(t,e){var r=u*t[2]-u*e[2];return 0===r&&o&&(r=t[4]-e[4]),r})),l.length){var x=6*l[0][2];h[0]=l[0][0]/x,h[1]=l[0][1]/x,o&&(h[2]=0!=(x=6*l[0][4])?l[0][3]/x:0),(h[0]<c[0]||h[0]>c[1]||h[1]<c[2]||h[1]>c[3]||o&&(h[2]<c[4]||h[2]>c[5]))&&(h.length=0)}if(!h.length){var b=e.lengths[0]?n(d,0,p[0],o,s):null;if(!b)return null;h[0]=b[0],h[1]=b[1],o&&b.length>2&&(h[2]=b[2])}return t},e.lineCentroid=n}).apply(null,i))||(t.exports=n)},G59t:function(t,e,r){var i,n;i=[r.dj.c(t.i),e,r("ma1f"),r("qsST"),r("JNkf"),r("apbF")],void 0===(n=(function(t,e,r,i,n,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getTypeOfSizeVisualVariable=void 0;var s=i.getLogger("esri.views.2d.engine.webgl");e.getTypeOfSizeVisualVariable=function(t){return o.isNumber(t.minDataValue)&&o.isNumber(t.maxDataValue)&&null!=t.minSize&&null!=t.maxSize?n.WGLVVFlag.SIZE_MINMAX_VALUE:(t.expression&&"view.scale"===t.expression||t.valueExpression&&"$view.scale"===t.valueExpression)&&Array.isArray(t.stops)?n.WGLVVFlag.SIZE_SCALE_STOPS:(null!=t.field||t.expression&&"view.scale"!==t.expression||t.valueExpression&&"$view.scale"!==t.valueExpression)&&(Array.isArray(t.stops)||"levels"in t&&t.levels)?n.WGLVVFlag.SIZE_FIELD_STOPS:(null!=t.field||t.expression&&"view.scale"!==t.expression||t.valueExpression&&"$view.scale"!==t.valueExpression)&&null!=t.valueUnit?n.WGLVVFlag.SIZE_UNIT_VALUE:(s.error(new r("mapview-bad-type","Found invalid size VisualVariable",t)),n.WGLVVFlag.NONE)}}).apply(null,i))||(t.exports=n)},H9Hv:function(t,e,r){var i,n;i=[r.dj.c(t.i),e],void 0===(n=(function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.jsonAdapter=void 0,e.jsonAdapter={convertToGEGeometry:function(t,e){return null==e?null:t.convertJSONToGeometry(e)},exportPoint:function(t,e,i){var n=new r(t.getPointX(e),t.getPointY(e),i),o=t.hasZ(e),s=t.hasM(e);return o&&(n.z=t.getPointZ(e)),s&&(n.m=t.getPointM(e)),n},exportPolygon:function(t,e,r){return new i(t.exportPaths(e),r,t.hasZ(e),t.hasM(e))},exportPolyline:function(t,e,r){return new n(t.exportPaths(e),r,t.hasZ(e),t.hasM(e))},exportMultipoint:function(t,e,r){return new o(t.exportPoints(e),r,t.hasZ(e),t.hasM(e))},exportExtent:function(t,e,r){var i=t.hasZ(e),n=t.hasM(e),o=new s(t.getXMin(e),t.getYMin(e),t.getXMax(e),t.getYMax(e),r);if(i){var a=t.getZExtent(e);o.zmin=a.vmin,o.zmax=a.vmax}if(n){var u=t.getMExtent(e);o.mmin=u.vmin,o.mmax=u.vmax}return o}};var r=function(t,e,r){this.x=t,this.y=e,this.spatialReference=r,this.z=void 0,this.m=void 0},i=function(t,e,r,i){this.rings=t,this.spatialReference=e,this.hasZ=void 0,this.hasM=void 0,r&&(this.hasZ=r),i&&(this.hasM=i)},n=function(t,e,r,i){this.paths=t,this.spatialReference=e,this.hasZ=void 0,this.hasM=void 0,r&&(this.hasZ=r),i&&(this.hasM=i)},o=function(t,e,r,i){this.points=t,this.spatialReference=e,this.hasZ=void 0,this.hasM=void 0,r&&(this.hasZ=r),i&&(this.hasM=i)},s=function(t,e,r,i,n){this.xmin=t,this.ymin=e,this.xmax=r,this.ymax=i,this.spatialReference=n,this.zmin=void 0,this.zmax=void 0,this.mmin=void 0,this.mmax=void 0}}).apply(null,i))||(t.exports=n)},OgqW:function(t,e,r){var i,n;i=[r.dj.c(t.i),e,r("2ESQ"),r("oz1K")],void 0===(n=(function(t,e,r,i){"use strict";function n(t,e,r){if(!(t.length>e))for(;t.length<=e;)t.push(r)}Object.defineProperty(e,"__esModule",{value:!0}),e.ComputedAttributeStorage=void 0;var o=function(){function t(){this._numerics=[],this._strings=[],this._idGenerator=new r.DisplayIdGenerator,this._allocatedSize=256,this._bitsets=[],this._instanceIds=[],this._bounds=[]}return t.prototype.createBitset=function(){var t=this._bitsets.length;return this._bitsets.push(i.StaticBitSet.create(this._allocatedSize,2147483647)),t+1},t.prototype.getBitset=function(t){return this._bitsets[t-1]},t.prototype._expand=function(){this._allocatedSize<<=1;for(var t=0,e=this._bitsets;t<e.length;t++)e[t].resize(this._allocatedSize)},t.prototype._ensureNumeric=function(t,e){this._numerics[t]||(this._numerics[t]=[]),n(this._numerics[t],e,0)},t.prototype._ensureInstanceId=function(t){n(this._instanceIds,t,0)},t.prototype._ensureString=function(t,e){this._strings[t]||(this._strings[t]=[]),n(this._strings[t],e,null)},t.prototype.createDisplayId=function(t){void 0===t&&(t=!1);var e=this._idGenerator.createId();return e>this._allocatedSize&&this._expand(),function(t,e){return((e?2147483648:0)|t)>>>0}(e,t)},t.prototype.releaseDisplayId=function(t){for(var e=0,r=this._bitsets;e<r.length;e++)r[e].unset(t);return this._idGenerator.releaseId(2147483647&t)},t.prototype.getComputedNumeric=function(t,e){return this.getComputedNumericAtIndex(2147483647&t,0)},t.prototype.setComputedNumeric=function(t,e,r){return this.setComputedNumericAtIndex(2147483647&t,r,0)},t.prototype.getComputedString=function(t,e){return this.getComputedStringAtIndex(2147483647&t,0)},t.prototype.setComputedString=function(t,e,r){return this.setComputedStringAtIndex(2147483647&t,0,r)},t.prototype.getComputedNumericAtIndex=function(t,e){var r=2147483647&t;return this._ensureNumeric(e,r),this._numerics[e][r]},t.prototype.setComputedNumericAtIndex=function(t,e,r){var i=2147483647&t;this._ensureNumeric(e,i),this._numerics[e][i]=r},t.prototype.getInstanceId=function(t){var e=2147483647&t;return this._ensureInstanceId(e),this._instanceIds[e]},t.prototype.setInstanceId=function(t,e){var r=2147483647&t;this._ensureInstanceId(r),this._instanceIds[r]=e},t.prototype.getComputedStringAtIndex=function(t,e){var r=2147483647&t;return this._ensureString(e,r),this._strings[e][r]},t.prototype.setComputedStringAtIndex=function(t,e,r){var i=2147483647&t;this._ensureString(e,i),this._strings[e][i]=r},t.prototype.getXMin=function(t){return this._bounds[4*(2147483647&t)]},t.prototype.getYMin=function(t){return this._bounds[4*(2147483647&t)+1]},t.prototype.getXMax=function(t){return this._bounds[4*(2147483647&t)+2]},t.prototype.getYMax=function(t){return this._bounds[4*(2147483647&t)+3]},t.prototype.setBounds=function(t,e){var r=e.readHydratedGeometry();if(!r||!r.coords.length)return!1;var i=1/0,o=1/0,s=-1/0,a=-1/0;r.forEachVertex((function(t,e){i=Math.min(i,t),o=Math.min(o,e),s=Math.max(s,t),a=Math.max(a,e)}));var u=2147483647&t;return n(this._bounds,4*u+4,0),this._bounds[4*u]=i,this._bounds[4*u+1]=o,this._bounds[4*u+2]=s,this._bounds[4*u+3]=a,!0},t}();e.ComputedAttributeStorage=o}).apply(null,i))||(t.exports=n)},Q2Em:function(t,e,r){var i,n;i=[r.dj.c(t.i),e,r("zOht"),r("ma1f"),r("qMld"),r("wIC5"),r("H9Hv"),r("nrlZ"),r("vtMp")],void 0===(n=(function(t,e,r,i,n,o,s,a,u){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.projectMany=e.project=e.checkProjectionSupport=e.doesBrowserSupportProjection=void 0;var h=[0,0];function l(t,e){var r,i,n;if(!e)return null;if("x"in e){var o={x:0,y:0};return r=t(e.x,e.y,h),o.x=r[0],o.y=r[1],null!=e.z&&(o.z=e.z),null!=e.m&&(o.m=e.m),o}return"xmin"in e?(o={xmin:0,ymin:0,xmax:0,ymax:0},i=t(e.xmin,e.ymin,h),o.xmin=i[0],o.ymin=i[1],n=t(e.xmax,e.ymax,h),o.xmax=n[0],o.ymax=n[1],e.hasZ&&(o.zmin=e.zmin,o.zmax=e.zmax,o.hasZ=!0),e.hasM&&(o.mmin=e.mmin,o.mmax=e.mmax,o.hasM=!0),o):"rings"in e?{rings:c(e.rings,t),hasM:e.hasM,hasZ:e.hasZ}:"paths"in e?{paths:c(e.paths,t),hasM:e.hasM,hasZ:e.hasZ}:"points"in e?{points:p(e.points,t),hasM:e.hasM,hasZ:e.hasZ}:void 0}function c(t,e){for(var r=[],i=0,n=t;i<n.length;i++)r.push(p(n[i],e));return r}function p(t,e){for(var r=[],i=0,n=t;i<n.length;i++){var o=n[i],s=e(o[0],o[1],[0,0]);r.push(s),o.length>2&&s.push(o[2]),o.length>3&&s.push(o[3])}return r}function d(t,e){return!(!a.isValid(t)||!a.isValid(e)||a.equals(t,e)||u.canProject(t,e))}e.doesBrowserSupportProjection=function(t,e){return!d(t,e)||o.isSupported()},e.checkProjectionSupport=function(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,s,a;return r.__generator(this,(function(r){if(!e)return[2];if(Array.isArray(t)){for(n=0,s=t;n<s.length;n++)if(d((a=s[n]).geometry&&a.geometry.spatialReference,e)){if(o.isSupported())return[2,o.load()];throw new i("feature-store:unsupported-query","projection not supported",{inSpatialReference:t,outSpatialReference:e})}return[2]}if(!d(t,e))return[2];if(o.isSupported())return[2,o.load()];throw new i("feature-store:unsupported-query","projection not supported",{inSpatialReference:t,outSpatialReference:e})}))}))};var f=l.bind(null,u.lngLatToXY),_=l.bind(null,u.xyToLngLat);e.project=function(t,e,r){return t?(r||(r=e,e=t.spatialReference),a.isValid(e)&&a.isValid(r)&&!a.equals(e,r)?u.canProject(e,r)?a.isWebMercator(r)?f(t):_(t):o.projectMany(s.jsonAdapter,[t],e,r,null)[0]:t):t};var m=new(function(){function t(){this._jobs=[],this._timer=null,this._process=this._process.bind(this)}return t.prototype.push=function(t,e,i){return r.__awaiter(this,void 0,void 0,(function(){var o,s=this;return r.__generator(this,(function(r){return t&&t.length&&e&&i&&!a.equals(e,i)||n.resolve(t),this._jobs.push(o={geometries:t,inSpatialReference:e,outSpatialReference:i,resolve:null}),[2,n.create((function(t){o.resolve=t,null===s._timer&&(s._timer=setTimeout(s._process,10))}))]}))}))},t.prototype._process=function(){this._timer=null;var t=this._jobs.shift();if(t){var e=t.geometries,r=t.inSpatialReference,i=t.outSpatialReference,n=t.resolve;u.canProject(r,i)?a.isWebMercator(i)?n(e.map(f)):n(e.map(_)):n(o.projectMany(s.jsonAdapter,e,r,i,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}},t}());e.projectMany=function(t,e,i){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(r){return[2,m.push(t,e,i)]}))}))}}).apply(null,i))||(t.exports=n)},ZB9i:function(t,e,r){var i,n;i=[r.dj.c(t.i),e,r("zOht"),r("+6sX"),r("+6sX"),r("vwon")],void 0===(n=(function(t,e,r,i,n,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FeatureSetReaderJSON=void 0;var s=function(t){function e(e,r,i){var n=t.call(this,e)||this;return n._featureIndex=-1,n._dateFields=new Set,n._geometryType=i,n._features=r,n}return r.__extends(e,t),e.fromFeatures=function(t,r,i){for(var o=n.convertFromFeatures([],t,r,!1,!1,i),s=0;s<o.length;s++)o[s].displayId=t[s].displayId;return e.fromOptimizedFeatures(o,r)},e.fromFeatureSet=function(t,r){var n=i.convertFromFeatureSet(t,r);return e.fromOptimizedFeatureSet(n)},e.fromOptimizedFeatureSet=function(t){var r=e.fromOptimizedFeatures(t.features,t.geometryType);r._exceededTransferLimit=t.exceededTransferLimit,r._transform=t.transform;for(var i=0,n=t.fields;i<n.length;i++){var o=n[i];"esriFieldTypeDate"===o.type&&r._dateFields.add(o.name)}return r},e.fromOptimizedFeatures=function(t,r,i){var n=new e(o.FeatureSetReader.createInstance(),t,r);return n._transform=i,n},Object.defineProperty(e.prototype,"_current",{get:function(){return this._features[this._featureIndex]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"geometryType",{get:function(){return this._geometryType},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasFeatures",{get:function(){return!!this._features.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasNext",{get:function(){return this._featureIndex+1<this._features.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exceededTransferLimit",{get:function(){return this._exceededTransferLimit},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasZ",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasM",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.getApproximateSize=function(){return this._features.length},e.prototype.getCursor=function(){return this.copy()},e.prototype.getQuantizationTransform=function(){return this._transform},e.prototype.getAttributeHash=function(){var t="";for(var e in this._current.attributes)t+=this._current.attributes[e];return t},e.prototype.getIndex=function(){return this._featureIndex},e.prototype.setIndex=function(t){this._featureIndex=t},e.prototype.getObjectId=function(){return this._current.objectId},e.prototype.getDisplayId=function(){return this._current.displayId},e.prototype.setDisplayId=function(t){this._current.displayId=t},e.prototype.getGroupId=function(){return this._current.groupId},e.prototype.setGroupId=function(t){this._current.groupId=t},e.prototype.copy=function(){var t=new e(this.instance,this._features,this.geometryType);return this.copyInto(t),t},e.prototype.next=function(){if(!this._hasFilter)return++this._featureIndex<this._features.length;for(;++this._featureIndex<this._features.length&&!this._passesFilter(););return this._featureIndex<this._features.length},e.prototype.readLegacyFeature=function(){return i.convertToFeature(this._current,this.geometryType,this.hasZ,this.hasM)},e.prototype.readOptimizedFeature=function(){return this._current},e.prototype.readLegacyPointGeometry=function(){var t=this.readGeometry();return t?{x:t.coords[0],y:t.coords[1]}:null},e.prototype.readLegacyGeometry=function(){var t=this.readGeometry();return i.convertToGeometry(t,this.geometryType,this.hasZ,this.hasM)},e.prototype.readLegacyCentroid=function(){var t=this.readCentroid();return t?{x:t.coords[0],y:t.coords[1]}:null},e.prototype.readGeometryArea=function(){return i.getQuantizedArea(this._current.geometry,2)},e.prototype.readUnquantizedGeometry=function(){var t=this.readGeometry();if("esriGeometryPoint"===this.geometryType||!t)return t;var e=t.clone();return function(t){for(var e=t.coords,r=0,i=0,n=t.lengths;i<n.length;i++){for(var o=n[i],s=1;s<o;s++)e[2*(r+s)]+=e[2*(r+s)-2],e[2*(r+s)+1]+=e[2*(r+s)-1];r+=o}}(e),e},e.prototype.readHydratedGeometry=function(){var t=this._current.geometry;if(!t)return null;var e=t.clone();return i.unquantizeOptimizedGeometry(e,e,this.hasZ,this.hasM,this._transform),e},e.prototype.getXHydrate=function(){var t=this._current.geometry.coords[0]+this._tx,e=this.getQuantizationTransform();return t*e.scale[0]+e.translate[0]},e.prototype.getYHydrate=function(){var t=this._current.geometry.coords[1]+this._ty,e=this.getQuantizationTransform();return e.translate[1]-t*e.scale[1]},e.prototype.readGeometry=function(){if(!this._current.hasGeometry)return null;var t=this._current.geometry.clone();if(t.isPoint)return t.coords[0]+=this._tx,t.coords[1]+=this._ty,t;for(var e=0,r=0,i=t.lengths;r<i.length;r++){var n=i[r];t.coords[2*e]+=this._tx,t.coords[2*e+1]+=this._ty,e+=n}return t},e.prototype.readCentroid=function(){if(!this._current.hasGeometry)return null;if(!this._current.centroid){var t=this._computeCentroid();if(!t)return null;t.coords[0]-=this._tx,t.coords[1]-=this._ty,this._current.centroid=t}var e=this._current.centroid.clone();return e.coords[0]+=this._tx,e.coords[1]+=this._ty,e},e.prototype._readAttribute=function(t,e){var r=this._current.attributes[t];if(void 0!==r)return e&&this._dateFields.has(t)?new Date(r):r;var i=this.readAttributes(),n=t.toLocaleLowerCase().trim();for(var o in i)if(o.toLocaleLowerCase().trim()===n){var s=this._current.attributes[o];return this._dateFields.has(o)?new Date(s):s}},e.prototype.copyInto=function(e){t.prototype.copyInto.call(this,e),e._featureIndex=this._featureIndex,e._transform=this._transform,e._dateFields=this._dateFields},e.prototype._readAttributes=function(){return this._current.attributes},e.prototype._passesFilter=function(){var t,e;if(!this._hasFilter)return!0;var r=0,i=0;switch(this.geometryType){case"esriGeometryPoint":var n=this._current.geometry;if(!n)return!1;r=(t=n.coords)[0],i=t[1];break;case"esriGeometryPolygon":var o=this.readCentroid();if(!o)return!1;r=(e=o.coords)[0],i=e[1],r-=this._tx,i-=this._ty;break;default:return!1}return r>=this._xmin&&r<=this._xmax&&i>=this._ymin&&i<=this._ymax},e}(o.FeatureSetReader);e.FeatureSetReaderJSON=s}).apply(null,i))||(t.exports=n)},fUL3:function(t,e,r){var i,n;i=[r.dj.c(t.i),e,r("QVms"),r("N7S/"),r("lRq4"),r("lAK8"),r("f3JK")],void 0===(n=(function(t,e,r,i,n,o,s){"use strict";function a(t,e){var r=t.bounds,i=e.bounds;return t.key.id!==e.key.id&&t.key.world===e.key.world&&r[0]<=i[0]&&r[1]<=i[1]&&r[2]>=i[2]&&r[3]>=i[3]}Object.defineProperty(e,"__esModule",{value:!0}),e.Tile=e.isChildOf=e.isParentOf=void 0,e.isParentOf=a,e.isChildOf=function(t,e){return a(e,t)};var u=function(){function t(t,e){this.key=new s(0,0,0,0),this.bounds=n.create(),this.objectIds=new Set,this.key.set(e);var r=t.getLODInfoAt(this.key);this.tileInfoView=t,this.tileInfoView.getTileBounds(this.bounds,this.key,!0),this.resolution=r.resolution,this.scale=r.scale,this.level=r.level,this.needsClear=!0}return Object.defineProperty(t.prototype,"id",{get:function(){return this.key.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"extent",{get:function(){return i.fromBounds(this.bounds,this.tileInfoView.tileInfo.spatialReference)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transform",{get:function(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],translate:[this.bounds[0],this.bounds[3]]}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bbox",{get:function(){var t=this.bounds;return{minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]}},enumerable:!1,configurable:!0}),t.prototype.clone=function(){return new t(this.tileInfoView,this.key)},t.prototype.neighbor=function(e,r){var i=this.key.clone(),n=1<<i.level,o=i.col+e,s=i.row+r;return o<0?(i.col=o+n,i.world-=1):o>=n?(i.col=o-n,i.world+=1):i.col=o,i.row=s,new t(this.tileInfoView,i)},t.prototype.createChildTiles=function(){for(var e=this.key.getChildKeys(),i=r.acquire(),n=0;n<e.length;n++)i[n]=new t(this.tileInfoView,e[n]);return i},t.prototype.getQuantizationParameters=function(){return o.default.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})},t}();e.Tile=u,e.default=u}).apply(null,i))||(t.exports=n)},jEml:function(t,e,r){var i,n;i=[r("FT4I")],void 0===(n=(function(t){"use strict";function e(t,r){if(!(this instanceof e))return new e(t,r);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),r&&("function"==typeof r?this.toBBox=r:this._initFormat(r)),this.clear()}function r(t,e,r){if(!r)return e.indexOf(t);for(var i=0;i<e.length;i++)if(r(t,e[i]))return i;return-1}function i(t,e){n(t,0,t.children.length,e,t)}function n(t,e,r,i,n){n||(n=p(null)),n.minX=1/0,n.minY=1/0,n.maxX=-1/0,n.maxY=-1/0;for(var s,a=e;a<r;a++)s=t.children[a],o(n,t.leaf?i(s):s);return n}function o(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function s(t,e){return t.minX-e.minX}function a(t,e){return t.minY-e.minY}function u(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function h(t){return t.maxX-t.minX+(t.maxY-t.minY)}function l(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function c(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function p(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function d(e,r,i,n,o){for(var s,a=[r,i];a.length;)(i=a.pop())-(r=a.pop())<=n||(s=r+Math.ceil((i-r)/n/2)*n,t(e,s,r,i,o),a.push(r,s,s,i))}return e.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,r=[],i=this.toBBox;if(!c(t,e))return r;for(var n,o,s,a,u=[];e;){for(n=0,o=e.children.length;n<o;n++)s=e.children[n],c(t,a=e.leaf?i(s):s)&&(e.leaf?r.push(s):l(t,a)?this._all(s,r):u.push(s));e=u.pop()}return r},collides:function(t){var e=this.data,r=this.toBBox;if(!c(t,e))return!1;for(var i,n,o,s,a=[];e;){for(i=0,n=e.children.length;i<n;i++)if(o=e.children[i],c(t,s=e.leaf?r(o):o)){if(e.leaf||l(t,s))return!0;a.push(o)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,r=t.length;e<r;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var n=this.data;this.data=i,i=n}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=p([]),this},remove:function(t,e){if(!t)return this;for(var i,n,o,s,a=this.data,u=this.toBBox(t),h=[],c=[];a||h.length;){if(a||(a=h.pop(),n=h[h.length-1],i=c.pop(),s=!0),a.leaf&&-1!==(o=r(t,a.children,e)))return a.children.splice(o,1),h.push(a),this._condense(h),this;s||a.leaf||!l(a,u)?n?(i++,a=n.children[i],s=!1):a=null:(h.push(a),c.push(i),i=0,n=a,a=a.children[0])}return this},toBBox:function(t){return t},compareMinX:s,compareMinY:a,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var r=[];t;)t.leaf?e.push.apply(e,t.children):r.push.apply(r,t.children),t=r.pop();return e},_build:function(t,e,r,n){var o,s=r-e+1,a=this._maxEntries;if(s<=a)return i(o=p(t.slice(e,r+1)),this.toBBox),o;n||(n=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,n-1))),(o=p([])).leaf=!1,o.height=n;var u,h,l,c,f=Math.ceil(s/a),_=f*Math.ceil(Math.sqrt(a));for(d(t,e,r,_,this.compareMinX),u=e;u<=r;u+=_)for(d(t,u,l=Math.min(u+_-1,r),f,this.compareMinY),h=u;h<=l;h+=f)c=Math.min(h+f-1,l),o.children.push(this._build(t,h,c,n-1));return i(o,this.toBBox),o},_chooseSubtree:function(t,e,r,i){for(var n,o,s,a,h,l,c,p,d,f;i.push(e),!e.leaf&&i.length-1!==r;){for(c=p=1/0,n=0,o=e.children.length;n<o;n++)h=u(s=e.children[n]),d=t,f=s,(l=(Math.max(f.maxX,d.maxX)-Math.min(f.minX,d.minX))*(Math.max(f.maxY,d.maxY)-Math.min(f.minY,d.minY))-h)<p?(p=l,c=h<c?h:c,a=s):l===p&&h<c&&(c=h,a=s);e=a||e.children[0]}return e},_insert:function(t,e,r){var i=r?t:(0,this.toBBox)(t),n=[],s=this._chooseSubtree(i,this.data,e,n);for(s.children.push(t),o(s,i);e>=0&&n[e].children.length>this._maxEntries;)this._split(n,e),e--;this._adjustParentBBoxes(i,n,e)},_split:function(t,e){var r=t[e],n=r.children.length,o=this._minEntries;this._chooseSplitAxis(r,o,n);var s=this._chooseSplitIndex(r,o,n),a=p(r.children.splice(s,r.children.length-s));a.height=r.height,a.leaf=r.leaf,i(r,this.toBBox),i(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(r,a)},_splitRoot:function(t,e){this.data=p([t,e]),this.data.height=t.height+1,this.data.leaf=!1,i(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,r){var i,o,s,a,h,l,c,p,d,f,_,m,y,g;for(l=c=1/0,i=e;i<=r-e;i++)d=o=n(t,0,i,this.toBBox),f=s=n(t,i,r,this.toBBox),_=Math.max(d.minX,f.minX),m=Math.max(d.minY,f.minY),y=Math.min(d.maxX,f.maxX),g=Math.min(d.maxY,f.maxY),a=Math.max(0,y-_)*Math.max(0,g-m),h=u(o)+u(s),a<l?(l=a,p=i,c=h<c?h:c):a===l&&h<c&&(c=h,p=i);return p},_chooseSplitAxis:function(t,e,r){var i=t.leaf?this.compareMinX:s,n=t.leaf?this.compareMinY:a;this._allDistMargin(t,e,r,i)<this._allDistMargin(t,e,r,n)&&t.children.sort(i)},_allDistMargin:function(t,e,r,i){t.children.sort(i);var s,a,u=this.toBBox,l=n(t,0,e,u),c=n(t,r-e,r,u),p=h(l)+h(c);for(s=e;s<r-e;s++)a=t.children[s],o(l,t.leaf?u(a):a),p+=h(l);for(s=r-e-1;s>=e;s--)a=t.children[s],o(c,t.leaf?u(a):a),p+=h(c);return p},_adjustParentBBoxes:function(t,e,r){for(var i=r;i>=0;i--)o(e[i],t)},_condense:function(t){for(var e,r=t.length-1;r>=0;r--)0===t[r].children.length?r>0?(e=t[r-1].children).splice(e.indexOf(t[r]),1):this.clear():i(t[r],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}},e}).apply(null,i))||(t.exports=n)},lvbU:function(t,e,r){var i,n;i=[r.dj.c(t.i),e,r("zOht"),r("ma1f"),r("H1tY"),r("qsST"),r("xoE+"),r("LxLY"),r("qMld"),r("CYRa"),r("I90O"),r("tI6k"),r("apbF"),r("AbdV"),r("iHXi"),r("2Kdy")],void 0===(n=(function(t,e,i,n,o,s,a,u,h,l,c,p,d,f,_){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isAggregateId=e.DISPLAY_ID_TYPE_AGGREGATE=e.DISPLAY_ID_TYPE_FEATURE=void 0;var m=s.getLogger("esri.views.layers.2d.features.support.AttributeStore"),y=f.createDebugLogger(f.DEBUG_ATTR_UPDATES,m);e.DISPLAY_ID_TYPE_FEATURE=0,e.DISPLAY_ID_TYPE_AGGREGATE=1;var g=function(t){return(2147483648&t)>>>31},v=function(t){return 2147483647&t};e.isAggregateId=function(t){return g(t)===e.DISPLAY_ID_TYPE_AGGREGATE};var x={sharedArrayBuffer:o("esri-shared-array-buffer"),oesTextureFloat:o("esri-webgl-texture-float"),maxTextureSize:o("esri-webgl-max-texture-size"),atomics:o("esri-atomics")};function b(t,e){return function(r){return e(t(r))}}var I=function(){function t(t,e,r,i){this.size=0,this.texelSize=4;var n=i.pixelType,o=i.layout,s=i.textureOnly;this.textureOnly=s||!1,this.pixelType=n,this._ctype=e,this.layout=o,this._resetRange(),this._shared=t,this.size=r,s||(this.data=this._initData(n,r,t,e))}return Object.defineProperty(t.prototype,"buffer",{get:function(){return u.andThen(this.data,(function(t){return t.buffer}))},enumerable:!1,configurable:!0}),t.prototype.unsetComponentAllTexels=function(t,e){for(var r=u.unwrap(this.data),i=0;i<this.size*this.size;i++)r[i*this.texelSize+t]&=~e;this.dirtyStart=0,this.dirtyEnd=this.size*this.size-1},t.prototype.setComponentAllTexels=function(t,e){for(var r=u.unwrap(this.data),i=0;i<this.size*this.size;i++)r[i*this.texelSize+t]|=255&e;this.dirtyStart=0,this.dirtyEnd=this.size*this.size-1},t.prototype.setComponent=function(t,e,r){for(var i=u.unwrap(this.data),n=0,o=r;n<o.length;n++){var s=o[n];i[s*this.texelSize+t]|=e,this.dirtyStart=Math.min(this.dirtyStart,s),this.dirtyEnd=Math.max(this.dirtyEnd,s)}},t.prototype.setComponentTexel=function(t,e,r){u.unwrap(this.data)[r*this.texelSize+t]|=e,this.dirtyStart=Math.min(this.dirtyStart,r),this.dirtyEnd=Math.max(this.dirtyEnd,r)},t.prototype.unsetComponentTexel=function(t,e,r){u.unwrap(this.data)[r*this.texelSize+t]&=~e,this.dirtyStart=Math.min(this.dirtyStart,r),this.dirtyEnd=Math.max(this.dirtyEnd,r)},t.prototype.getData=function(t,e){var r=v(t);return u.unwrap(this.data)[r*this.texelSize+e]},t.prototype.setData=function(t,e,r){var i=v(t);0!=(this.layout&1<<e)?(this.data[i*this.texelSize+e]=r,this.dirtyStart=Math.min(this.dirtyStart,i),this.dirtyEnd=Math.max(this.dirtyEnd,i)):m.error("mapview-attributes-store","Tried to set a value for a texel's readonly component")},t.prototype.lock=function(){5121===this.pixelType?this._shared&&x.atomics&&"local"!==this._ctype&&Atomics.store(this.data,0,1):o("esri-2d-debug")&&m.error("AttributeStore-Bad-Type","Tried to unlock non integer array type with float array")},t.prototype.unlock=function(){5121===this.pixelType?this._shared&&x.atomics&&"local"!==this._ctype&&Atomics.store(this.data,0,0):o("esri-2d-debug")&&m.error("AttributeStore-Bad-Type","Tried to unlock non integer array type with float array")},t.prototype.expand=function(t){if(this.size=t,!this.textureOnly){var e=this._initData(this.pixelType,t,this._shared,this._ctype),r=u.unwrap(this.data);e.set(r),this.data=e}},t.prototype.toMessage=function(){var t=this.dirtyStart,e=this.dirtyEnd,r=this.texelSize;if(t>e)return null;this._resetRange();var i=!(this._shared||"local"===this._ctype),n=this.pixelType,o=this.layout,s=u.unwrap(this.data);return s.slice?{start:t,end:e,data:i&&s.slice(t*r,(e+1)*r)||null,pixelType:n,layout:o}:i?{start:t,end:e,data:new(d.getPixelArrayCtor(this.pixelType))(Array.prototype.slice.call(this.data,t*r,(e+1)*r)),pixelType:n,layout:o}:{start:t,end:e,data:null,pixelType:n,layout:o}},t.prototype._initData=function(t,e,r,i){for(var n=r&&"local"!==i?SharedArrayBuffer:ArrayBuffer,o=d.getPixelArrayCtor(t),s=new o(new n(e*e*4*o.BYTES_PER_ELEMENT)),a=0;a<s.length;a+=4)s[a+1]=255;return s},t.prototype._resetRange=function(){this.dirtyStart=2147483647,this.dirtyEnd=0},t}(),S=function(){function t(t){this._attributeComputeMap=new Map,this._blocks=new Array,this._filters=new Array(p.MAX_FILTERS),this._targetType=0,this._abortController=h.createAbortController(),this._hasScaleExpr=!1,this._size=32,this._idsToHighlight=new Set;var e=x.oesTextureFloat?5126:5121;y("Creating AttributeStore "+(x.sharedArrayBuffer?"with":"without")+" shared memory"),o("esri-2d-debug")&&x.sharedArrayBuffer&&!x.atomics&&m.warn("Browser supports SharedArrayBuffer but not Atomics. Rendering may be impacted"),this._client=t,this._blockDescriptors=[{pixelType:5121,layout:1},{pixelType:5121,layout:15,textureOnly:!0},{pixelType:e,layout:15},{pixelType:e,layout:15}],this._blocks=this._blockDescriptors.map((function(){return null}))}return t.prototype.destroy=function(){this._abortController.abort()},Object.defineProperty(t.prototype,"hasScaleExpr",{get:function(){return this._hasScaleExpr},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_signal",{get:function(){return this._abortController.signal},enumerable:!1,configurable:!0}),t.prototype.update=function(t,r){var i=l.diff(this._schema,r);if(i&&(o("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:",i),t.storage.data=!0,this._schema=r,this._attributeComputeMap.clear(),!u.isNone(r))){switch(r.target){case"feature":this._targetType=e.DISPLAY_ID_TYPE_FEATURE;break;case"aggregate":this._targetType=e.DISPLAY_ID_TYPE_AGGREGATE}for(var n=0,s=r.mapping;n<s.length;n++)this._bindAttribute(s[n])}},t.prototype.onTileData=function(t,e){if(!u.isNone(e.addOrUpdate))for(var r=e.addOrUpdate.getCursor();r.next();){var i=r.getDisplayId();this.setAttributeData(i,r)}},t.prototype.invalidateResources=function(){this._createResourcesPromise=null,this._abortController.abort(),this._abortController=h.createAbortController()},t.prototype.setHighlight=function(t,e){return i.__awaiter(this,void 0,void 0,(function(){var r,n,o,s;return i.__generator(this,(function(i){switch(i.label){case 0:for(r=this._getBlock(0),n=e.map((function(t){return v(t)})),r.lock(),r.unsetComponentAllTexels(0,1),r.setComponent(0,1,n),r.unlock(),this._idsToHighlight.clear(),o=0,s=t;o<s.length;o++)this._idsToHighlight.add(s[o]);return[4,this.sendUpdates()];case 1:return i.sent(),[2]}}))}))},t.prototype.updateFilters=function(t,e){return i.__awaiter(this,void 0,void 0,(function(){var r,n,s,a=this;return i.__generator(this,(function(i){switch(i.label){case 0:return r=e.service,n=e.spatialReference,s=e.config.filters.map((function(t,e){return a._updateFilter(t,e,r,n)})),[4,h.all(s)];case 1:return i.sent().some((function(t){return t}))&&(t.storage.filters=!0,o("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:","Filters changed")),[2]}}))}))},t.prototype.setData=function(t,e,r,i){var n=v(t);this._ensureSizeForTexel(n),this._getBlock(e).setData(t,r,i)},t.prototype.getData=function(t,e,r){return this._getBlock(e).getData(t,r)},t.prototype.getHighlightFlag=function(t){return this._idsToHighlight.has(t)?p.HIGHLIGHT_FLAG:0},t.prototype.setAttributeData=function(t,e){var r=this,i=v(t);if(this._ensureSizeForTexel(i),this._getBlock(0).setData(i,0,this.getFilterFlags(e)),this._targetType===g(t)){var n=this._attributeComputeMap,o=x.oesTextureFloat?1:2;n.size&&n.forEach((function(t,n){var s=n*o%4,u=Math.floor(n*o/4),h=r._getBlock(u+p.ATTRIBUTE_DATA_VV),l=t(e);if(x.oesTextureFloat)h.setData(i,s,l);else if(l===p.NAN_MAGIC_NUMBER)h.setData(i,s,255),h.setData(i,s+1,255);else{var c=a.clamp(Math.round(l),-32767,32766)+32768,d=(65280&c)>>8;h.setData(i,s,255&c),h.setData(i,s+1,d)}}))}},t.prototype.sendUpdates=function(){var t=this;if(this._nextUpdate)return this._nextUpdate.promise;if(this._currUpdate)return this._nextUpdate=h.createResolver(),this._nextUpdate.promise;var e={blocks:this._blocks.map((function(t){return u.isSome(t)?t.toMessage():null}))};return this._currUpdate=this._createResources().then((function(){var r=function(){if(t._currUpdate=null,t._nextUpdate){var e=t._nextUpdate;t._nextUpdate=null,t.sendUpdates().then((function(){return e.resolve()}))}},i=t._client.update(e,t._signal).then(r).catch(r);return t._client.render(t._signal),i})).catch((function(e){return h.isAbortError(e)?(t._createResourcesPromise=null,t._createResources()):(m.error(new n("mapview-attribute-store","Encountered an error during client update",e)),h.resolve())})),this._currUpdate},t.prototype._ensureSizeForTexel=function(t){for(;t>=this._size*this._size;)if(this._expand())return},t.prototype._bindAttribute=function(t){var e;if(null!=t.fieldIndex)t.normalizationField&&m.warn("mapview-arcade","Ignoring normalizationField specified with an arcade expression which is not supported."),e=function(e){return e.getComputedNumericAtIndex(t.fieldIndex)};else{if(!t.field)return void(o("esri-2d-debug")&&console.error("Unable to create evaluator. Found neither a field nor fieldIndex in",t));e=t.normalizationField?function(e){var r=e.readAttribute(t.normalizationField);return r?e.readAttribute(t.field)/r:null}:function(e){return e.readAttribute(t.field)}}t.valueRepresentation&&(e=b(e,(function(e){return _.getVisualVariableSizeValueRepresentationRatio(e,t.valueRepresentation)}))),this._attributeComputeMap.set(t.binding,b(e,(function(t){return null===t||isNaN(t)||t===1/0?p.NAN_MAGIC_NUMBER:t})))},t.prototype._createResources=function(){var t=this;if(u.isSome(this._createResourcesPromise))return this._createResourcesPromise;this._getBlock(p.ATTRIBUTE_DATA_ANIMATION),y("Initializing AttributeStore");var e={shared:x.sharedArrayBuffer&&!("local"===this._client.type),size:this._size,blocks:u.mapMany(this._blocks,(function(t){return{textureOnly:t.textureOnly,buffer:t.buffer,pixelType:t.pixelType}}))},r=this._client.initialize(e,this._signal).catch((function(e){h.isAbortError(e)?t._createResourcesPromise=null:m.error(new n("mapview-attribute-store","Encountered an error during client initialization",e))}));return this._createResourcesPromise=r,r.then((function(){return u.isNone(t._createResourcesPromise)?t._createResources():void 0})),r},t.prototype._getBlock=function(t){var e=this._blocks[t];if(u.isSome(e))return e;y("Initializing AttributeBlock at index "+t);var r=new I(x.sharedArrayBuffer,this._client.type,this._size,this._blockDescriptors[t]);return this._blocks[t]=r,this._createResourcesPromise=null,r},t.prototype._expand=function(){if(this._size<x.maxTextureSize){var t=this._size<<=1;return y("Expanding block size to",t,this._blocks),u.forEachSome(this._blocks,(function(e){return e.expand(t)})),this._createResourcesPromise=null,this._size=t,0}return m.error(new n("mapview-limitations","Maximum number of onscreen features exceeded.")),-1},t.prototype._updateFilter=function(t,e,r,n){return i.__awaiter(this,void 0,void 0,(function(){var o,s,a,h;return i.__generator(this,(function(i){switch(i.label){case 0:return s=u.isSome(o=this._filters[e])&&o.hash,o||t?s===JSON.stringify(t)?[2,!1]:u.isNone(t)?(a=1<<e+1,h=this._getBlock(0),this._filters[e]=null,h.setComponentAllTexels(0,a),this.sendUpdates(),[2,!0]):[4,this._getFilter(e,r)]:[2,!1];case 1:return[4,i.sent().update(t,n)];case 2:return i.sent(),[2,!0]}}))}))},t.prototype._getFilter=function(t,e){return i.__awaiter(this,void 0,void 0,(function(){var n,o,s;return i.__generator(this,(function(i){switch(i.label){case 0:return u.isSome(n=this._filters[t])?[2,n]:[4,new Promise((function(t,e){Promise.all([r.e(1),r.e(63)]).then((function(){var e=[r("Z0JH")];t.apply(null,e)}).bind(this)).catch(e.bind(this))}))];case 1:return o=i.sent().default,s=new o({geometryType:e.geometryType,hasM:!1,hasZ:!1,timeInfo:e.timeInfo,fieldsIndex:new c(e.fields)}),this._filters[t]=s,[2,s]}}))}))},t.prototype.isVisible=function(t){return!!(2&this._getBlock(0).getData(t,0))},t.prototype.getFilterFlags=function(t){for(var r,i=0,n=(r=t.getDisplayId(),g(r)===e.DISPLAY_ID_TYPE_AGGREGATE?254:255),o=0;o<this._filters.length;o++){var s=this._filters[o];i|=(n&1<<o&&!u.isNone(s)&&!s.check(t)?0:1)<<o}var a=0;if(this._idsToHighlight.size){var h=t.getObjectId();a=this.getHighlightFlag(h)}return i<<1|a},t}();e.default=S}).apply(null,i))||(t.exports=n)},oz1K:function(t,e,r){var i,n;i=[r.dj.c(t.i),e],void 0===(n=(function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.StaticBitSet=void 0;var r=function(){function t(t,e){this._mask=0,this._buf=t,this._mask=e}return t.fromBuffer=function(e,r){return new t(e,r)},t.create=function(e,r){return void 0===r&&(r=4294967295),new t(new Uint32Array(Math.ceil(e/32)),r)},t.prototype._getIndex=function(t){return Math.floor(t/32)},t.prototype.has=function(t){var e=this._mask&t;return!!(this._buf[this._getIndex(e)]&1<<e%32)},t.prototype.set=function(t){var e=this._mask&t,r=this._getIndex(e);this._buf[r]|=1<<e%32},t.prototype.unset=function(t){var e=this._mask&t,r=this._getIndex(e);this._buf[r]&=4294967295^1<<e%32},t.prototype.resize=function(t){var e=this._buf,r=new Uint32Array(Math.ceil(t/32));r.set(e),this._buf=r},t.prototype.or=function(t){for(var e=0;e<this._buf.length;e++)this._buf[e]|=t._buf[e];return this},t.prototype.and=function(t){for(var e=0;e<this._buf.length;e++)this._buf[e]&=t._buf[e];return this},t.prototype.xor=function(t){for(var e=0;e<this._buf.length;e++)this._buf[e]^=t._buf[e];return this},t.prototype.ior=function(t){for(var e=0;e<this._buf.length;e++)this._buf[e]|=~t._buf[e];return this},t.prototype.iand=function(t){for(var e=0;e<this._buf.length;e++)this._buf[e]&=~t._buf[e];return this},t.prototype.ixor=function(t){for(var e=0;e<this._buf.length;e++)this._buf[e]^=~t._buf[e];return this},t.prototype.any=function(){for(var t=0;t<this._buf.length;t++)if(this._buf[t])return!0;return!1},t.prototype.copy=function(t){for(var e=0;e<this._buf.length;e++)this._buf[e]=t._buf[e];return this},t.prototype.clone=function(){return new t(this._buf.slice(),this._mask)},t.prototype.clear=function(){for(var t=0;t<this._buf.length;t++)this._buf[t]=0},t.prototype.forEachSet=function(t){for(var e=0;e<this._buf.length;e++){var r=this._buf[e],i=32*e;if(r)for(;r;)1&r&&t(i),r>>>=1,i++}},t.prototype.countSet=function(){var t=0;return this.forEachSet((function(e){t++})),t},t}();e.StaticBitSet=r}).apply(null,i))||(t.exports=n)},vwon:function(t,e,r){var i,n;i=[r.dj.c(t.i),e,r("TMur"),r("Fzzg"),r("+6sX"),r("Jvs9")],void 0===(n=(function(t,e,r,i,n,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FeatureSetReader=void 0;var s=0,a=function(){function t(t){this.type="FeatureSetReader",this.instance=0,this._tx=0,this._ty=0,this._xmin=-1,this._xmax=0,this._ymin=0,this._ymax=0,this._joined=[],this.instance=t}return t.createInstance=function(){return s=++s>65535?0:s},Object.defineProperty(t.prototype,"_hasFilter",{get:function(){return-1!==this._xmin},enumerable:!1,configurable:!0}),t.prototype.getQuantizationTransform=function(){throw new Error("Unable to find transform for featureSet")},t.prototype.getStorage=function(){return this._storage},t.prototype.getComputedNumeric=function(t){return this.getComputedNumericAtIndex(0)},t.prototype.setComputedNumeric=function(t,e){return this.setComputedNumericAtIndex(e,0)},t.prototype.getComputedString=function(t){return this.getComputedStringAtIndex(0)},t.prototype.setComputedString=function(t,e){return this.setComputedStringAtIndex(0,e)},t.prototype.getComputedNumericAtIndex=function(t){return this._storage.getComputedNumericAtIndex(this.getDisplayId(),t)},t.prototype.setComputedNumericAtIndex=function(t,e){this._storage.setComputedNumericAtIndex(this.getDisplayId(),t,e)},t.prototype.getComputedStringAtIndex=function(t){return this._storage.getComputedStringAtIndex(this.getDisplayId(),t)},t.prototype.setComputedStringAtIndex=function(t,e){return this._storage.setComputedStringAtIndex(this.getDisplayId(),t,e)},t.prototype.transform=function(t,e){var r=this.copy();return r._tx=t,r._ty=e,r},t.prototype.extent=function(t,e,r,i){var n=this.copy();return n._xmin=t,n._xmax=r,n._ymin=e,n._ymax=i,n},t.prototype.hasFilter=function(){return this._hasFilter},t.prototype.readAttribute=function(t,e){void 0===e&&(e=!1);var r=this._readAttribute(t,e);if(void 0!==r)return r;for(var i=0,n=this._joined;i<n.length;i++){var o=n[i];o.setIndex(this.getIndex());var s=o._readAttribute(t,e);if(void 0!==s)return s}},t.prototype.readAttributes=function(){return this._readAttributes()},t.prototype.joinAttributes=function(t){this._joined.push(t)},t.prototype.readArcadeFeature=function(){return this},t.prototype.geometry=function(){var t=this.readHydratedGeometry(),e=n.convertToGeometry(t,this.geometryType,this.hasZ,this.hasM),i=r.fromJSON(e);return i.spatialReference=this._arcadeSpatialReference,i},t.prototype.field=function(t){return this.readAttribute(t,!0)},t.prototype.hasField=function(t){return!0},t.prototype.setField=function(t,e){},t.prototype.keys=function(){return[]},t.prototype.castToText=function(){return""},t.prototype._computeCentroid=function(){if("esriGeometryPolygon"!==this.geometryType)return null;var t=this.readUnquantizedGeometry();if(!t||t.hasIndeterminateRingOrder)return null;var e=this.getQuantizationTransform();return i.getCentroidOptimizedGeometry(new o.default,t,this.hasM,this.hasZ,e)},t.prototype.copyInto=function(t){t._storage=this._storage,t._arcadeSpatialReference=this._arcadeSpatialReference,t._joined=this._joined,t._tx=this._tx,t._ty=this._ty,t._xmin=this._xmin,t._xmax=this._xmax,t._ymin=this._ymin,t._ymax=this._ymax},t}();e.FeatureSetReader=a}).apply(null,i))||(t.exports=n)}}]);