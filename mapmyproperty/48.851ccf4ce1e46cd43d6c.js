(function(){var e={"arcgis-js-api/views/layers/support/Path":"20TT","arcgis-js-api/views/2d/engine/vectorTiles/decluttering/util":"2JW5","arcgis-js-api/views/2d/engine/vectorTiles/decluttering/SymbolDeclutterer":"4LVV","esri/views/2d/engine/webgl/Rect":"6cAc","arcgis-js-api/views/2d/engine/webgl/Rect":"6cAc","arcgis-js-api/views/2d/layers/LayerView2D":"6i4F","arcgis-js-api/views/2d/engine/vectorTiles/GlyphMosaic":"7wYu","arcgis-js-api/views/2d/engine/vectorTiles/TileHandler":"BEij","arcgis-js-api/views/2d/engine/vectorTiles/RenderBucket":"KyfE","arcgis-js-api/views/2d/engine/vectorTiles/decluttering/SymbolFader":"PQCn","arcgis-js-api/views/2d/engine/vectorTiles/RectangleBinPack":"VIUv","arcgis-js-api/views/2d/engine/vectorTiles/VectorTile":"VjU6","arcgis-js-api/views/layers/LayerView":"WsO6","arcgis-js-api/views/2d/engine/vectorTiles/decluttering/jobs":"XQQU","arcgis-js-api/views/2d/tiling/TileInfoViewPOT":"YOjP","arcgis-js-api/views/2d/engine/vectorTiles/decluttering/debugging":"dLO5","arcgis-js-api/views/2d/engine/vectorTiles/TileManager":"fCqw","arcgis-js-api/views/2d/engine/vectorTiles/decluttering/core":"fdgu","arcgis-js-api/views/2d/engine/webgl/TiledDisplayObject":"gi5q","arcgis-js-api/views/2d/engine/vectorTiles/SpriteMosaic":"mFzi","arcgis-js-api/views/2d/engine/vectorTiles/decluttering/SymbolRepository":"ooFS","arcgis-js-api/views/2d/engine/vectorTiles/GlyphSource":"suOV","arcgis-js-api/views/layers/support/Geometry":"ts8o","arcgis-js-api/views/2d/engine/vectorTiles/VectorTileContainer":"uf/D","arcgis-js-api/views/2d/engine/webgl/TileContainer":"wUCb","arcgis-js-api/views/2d/layers/VectorTileLayerView2D":"xkJJ"},t=this||window,i=t.webpackJsonp=t.webpackJsonp||[];i.registerAbsMids?i.registerAbsMids(e):(i.absMidsWaiting=i.absMidsWaiting||[]).push(e)})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{"20TT":function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("zOht"),i("Vx27"),i("ZMIQ")],void 0===(n=(function(e,t,i,r,n){"use strict";return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="path",t.path=[],t}return i.__extends(t,e),Object.defineProperty(t.prototype,"version",{get:function(){return(this._get("version")||0)+1},enumerable:!1,configurable:!0}),i.__decorate([r.property({type:[[[Number]]],json:{write:!0}})],t.prototype,"path",void 0),i.__decorate([r.property({readOnly:!0,dependsOn:["path"]})],t.prototype,"version",null),i.__decorate([r.subclass("esri.views.layers.support.Path")],t)}(n)}).apply(null,r))||(e.exports=n)},"2JW5":function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("LxLY"),i("fdgu")],void 0===(n=(function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.writeOpacityToBuffers=t.deserializeSymbols=t.GridIndex=t.tileCoordChange=t.TileForest=t.TileGraph=t.TileNode=void 0;var n=function(e){this.tile=e,this.parent=null,this.children=new Set};t.TileNode=n;var o=function(){function e(){this.nodes=new Map,this.roots=new Set}return e.prototype.create=function(e){var t,i=this,r=new n(e),o=[];if(this.nodes.forEach((function(e){i._canConnectDirectly(r,e)&&o.push(e),!t&&i._canConnectDirectly(e,r)&&(t=e)})),t){for(var s=0,a=o;s<a.length;s++){var l=a[s];t.children.delete(l),r.children.add(l),l.parent=r}t.children.add(r),r.parent=t}else{this.roots.add(r);for(var u=0,c=o;u<c.length;u++)r.children.add(l=c[u]),l.parent=r,this.roots.delete(l)}return this.nodes.set(e.key.id,r),r},e.prototype.destroy=function(e){var t=this;i.isSome(e.parent)?(e.parent.children.delete(e),e.children.forEach((function(t){i.isSome(e.parent)&&e.parent.children.add(t)}))):this.roots.delete(e),e.children.forEach((function(i){i.parent=e.parent,e.parent||t.roots.add(i)})),this.nodes.delete(e.tile.key.id)},e.prototype.clear=function(){this.roots.clear(),this.nodes.clear()},e.prototype._canConnectDirectly=function(e,t){for(var i=t.tile.key,r=i.level,n=i.row,o=i.col,s=t.tile.key.world;r>0;){if(r--,n>>=1,o>>=1,e.tile.key.level===r&&e.tile.key.row===n&&e.tile.key.col===o&&e.tile.key.world===s)return!0;if(this.nodes.has(r+"/"+n+"/"+o+"/"+s))return!1}return!1},e}();t.TileGraph=o;var s=function(){function e(){this._tileGraph=new o,this._tileArray=null}return e.prototype.has=function(e){return this.hasKey(e.key.id)},e.prototype.getAll=function(){var e=this;return this._tileArray||(this._tileArray=[],this._tileGraph.nodes.forEach((function(t){e._tileArray.push(t.tile)}))),this._tileArray},e.prototype.getRoots=function(){var e=[];return this._tileGraph.roots.forEach((function(t){e.push(t.tile)})),e},e.prototype.getParent=function(e){var t=this._tileGraph.nodes.get(e.key.id);return i.isSome(t.parent)&&t.parent.tile},e.prototype.getChildren=function(e){var t=[];return this._tileGraph.nodes.get(e.key.id).children.forEach((function(e){t.push(e.tile)})),t},e.prototype.get=function(e){return this._tileGraph.nodes.get(e).tile},e.prototype.hasKey=function(e){return this._tileGraph.nodes.has(e)},e.prototype.removeKey=function(e){var t=this._tileGraph.nodes.get(e);this._tileGraph.destroy(t),this._tileArray=null},e.prototype.forEach=function(e){this._tileGraph.nodes.forEach((function(t,i){return e(t.tile,i)}))},e.prototype.add=function(e){this._tileGraph.create(e),this._tileArray=null},e.prototype.remove=function(e){var t=this._tileGraph.nodes.get(e.key.id);this._tileGraph.destroy(t),this._tileArray=null},e.prototype.clear=function(){this._tileGraph.clear(),this._tileArray=[]},e}();t.TileForest=s,t.tileCoordChange=function(e,t,i,r,n,o){var s=i-n;if(s>=0)return(t>>s)+(r-(o<<s))*(e>>s);var a=-s;return t-(o-(r<<a))*(e>>a)<<a};var a=function(){function e(e,t,i){this._rows=Math.ceil(t/i),this._columns=Math.ceil(e/i),this._cellSize=i,this.cells=new Array(this._rows);for(var r=0;r<this._rows;r++){this.cells[r]=new Array(this._columns);for(var n=0;n<this._columns;n++)this.cells[r][n]=[]}}return e.prototype.getCell=function(e,t){var i=Math.min(Math.max(Math.floor(t/this._cellSize),0),this._rows-1),r=Math.min(Math.max(Math.floor(e/this._cellSize),0),this._columns-1);return this.cells[i]&&this.cells[i][r]||null},e.prototype.getCellSpan=function(e,t,i,r){return[Math.min(Math.max(Math.floor(e/this._cellSize),0),this.columns-1),Math.min(Math.max(Math.floor(t/this._cellSize),0),this.rows-1),Math.min(Math.max(Math.floor(i/this._cellSize),0),this.columns-1),Math.min(Math.max(Math.floor(r/this._cellSize),0),this.rows-1)]},Object.defineProperty(e.prototype,"cellSize",{get:function(){return this._cellSize},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columns",{get:function(){return this._columns},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rows",{get:function(){return this._rows},enumerable:!1,configurable:!0}),e}();t.GridIndex=a,t.deserializeSymbols=function(e,t,i,n,o){for(var s=t[n++],a=0;a<s;a++){var l=new r.VTLSymbol;l.xTile=t[n++],l.yTile=t[n++],l.hash=t[n++],l.priority=t[n++];for(var u=t[n++],c=0;c<u;c++){var h=t[n++],d=t[n++],p=t[n++],f=t[n++],y=!!t[n++],_=t[n++],v=i[n++],g=i[n++],m=t[n++],b=t[n++];l.colliders.push({xTile:h,yTile:d,dxPixels:p,dyPixels:f,hard:y,partIndex:_,width:m,height:b,minLod:v,maxLod:g})}for(var w=e[n++],x=0;x<w;x++)l.textVertexRanges.push([e[n++],e[n++]]);for(var S=e[n++],T=0;T<S;T++)l.iconVertexRanges.push([e[n++],e[n++]]);o.push(l)}return n},t.writeOpacityToBuffers=function(e,t,i){e.symbols.forEach((function(r,n){return function(e,t,i,r,n){var o=e.layerData[n];if(3===o.type){for(var s=0,a=r;s<a.length;s++){var l=a[s],u=l.unique,c=void 0;if(l.selectedForRendering){var h=u.parts[0],d=h.startOpacity,p=h.targetOpacity;e.allSymbolsFadingOut=e.allSymbolsFadingOut&&0===p;var f=i?Math.floor(127*d)|p<<7:p?255:0;c=f<<24|f<<16|f<<8|f}else c=0;for(var y=0,_=l.iconVertexRanges;y<_.length;y++)for(var v=_[y],g=v[0],m=v[1],b=g;b<g+m;b+=4)o.iconOpacity[b/4]=c;if(l.selectedForRendering){var w=u.parts[1];d=w.startOpacity,p=w.targetOpacity,e.allSymbolsFadingOut=e.allSymbolsFadingOut&&0===p,c=(f=i?Math.floor(127*d)|p<<7:p?255:0)<<24|f<<16|f<<8|f}else c=0;for(var x=0,S=l.textVertexRanges;x<S.length;x++){var T=S[x],I=T[0],O=T[1];for(b=I;b<I+O;b+=4)o.textOpacity[b/4]=c}}o.lastOpacityUpdate=t,o.opacityChanged=!0}}(e,t,i,r,n)}))}}).apply(null,r))||(e.exports=n)},"4LVV":function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("2eQy")],void 0===(n=(function(e,t,i){"use strict";function r(e,t){return e.priority-t.priority}Object.defineProperty(t,"__esModule",{value:!0}),t.SymbolDeclutterer=void 0;var n=function(){function e(e,t,i,r){this._tileForest=e,this._symbolRepository=t,this._createCollisionJob=i,this._assignTileSymbolsOpacity=r,this._selectionJob=null,this._selectionJobCompleted=!1,this._collisionJob=null,this._collisionJobCompleted=!1,this._opacityJob=null,this._opacityJobCompleted=!1,this._running=!0}return Object.defineProperty(e.prototype,"running",{get:function(){return this._running},enumerable:!1,configurable:!0}),e.prototype.setScreenSize=function(e,t){this._screenWidth===e&&this._screenHeight===t||this.restart(),this._screenWidth=e,this._screenHeight=t},e.prototype.restart=function(){this._selectionJob=null,this._selectionJobCompleted=!1,this._collisionJob=null,this._collisionJobCompleted=!1,this._opacityJob=null,this._opacityJobCompleted=!1,this._running=!0},e.prototype.continue=function(e){if(this._selectionJob||(this._selectionJob=this._createSelectionJob()),!this._selectionJobCompleted){var t=performance.now();if(!this._selectionJob.work(e))return!1;if(this._selectionJobCompleted=!0,0===(e=Math.max(0,e-(performance.now()-t))))return!1}if(this._collisionJob||(this._collisionJob=this._createCollisionJob(this._selectionJob.sortedSymbols,this._screenWidth,this._screenHeight)),!this._collisionJobCompleted){var i=performance.now();if(!this._collisionJob.work(e))return!1;if(this._collisionJobCompleted=!0,0===(e=Math.max(0,e-(performance.now()-i))))return!1}if(this._opacityJob||(this._opacityJob=this._createOpacityJob()),!this._opacityJobCompleted){if(i=performance.now(),!this._opacityJob.work(e))return!1;if(this._opacityJobCompleted=!0,0===(e=Math.max(0,e-(performance.now()-i))))return!1}return this._running=!1,!0},e.prototype._createSelectionJob=function(){var e,t,i,n=this._symbolRepository.uniqueSymbols,o=[],s=0,a=0,l=function(r){if(r.selectedForRendering=!1,!i||!t){var n=r.tile;r.unique.visible&&(!e||n.isCoverage||n.neededForCoverage&&!t)&&(e=r,(n.neededForCoverage||n.isCoverage)&&(i=!0),n.isCoverage&&(t=!0))}};return{work:function(u){for(var c,h=performance.now();a<n.length;a++,s=0){var d=n[a];o[a]=o[a]||{layerIndex:d.layerIndex,symbols:[]};for(var p=o[a];s<d.uniqueSymbols.length;s++){if(c=d.uniqueSymbols[s],s%100==99&&performance.now()-h>u)return!1;if(e=null,t=!1,i=!1,c.tileSymbols.forEach(l),e.selectedForRendering=!0,i){p.symbols.push(e),c.show=!0;for(var f=0,y=c.parts;f<y.length;f++)y[f].show=!0}else c.show=!1}}for(var _=0,v=o;_<v.length;_++)(p=v[_]).symbols.sort(r);return!0},get sortedSymbols(){return o.sort((function(e,t){return t.layerIndex-e.layerIndex}))}}},e.prototype._createOpacityJob=function(){var e=this._assignTileSymbolsOpacity,t=this._tileForest,r=t.getRoots(),n=0;function o(r,n){r.symbols.forEach((function(e){return function(e,t){for(var r=0,n=e;r<n.length;r++)for(var o=n[r].unique,s=0,a=o.parts;s<a.length;s++){var l=a[s];l.startOpacity+=(t-l.startTime)/i.FADE_DURATION*(l.targetOpacity>.5?1:-1),l.startOpacity=Math.min(Math.max(l.startOpacity,0),1),l.startTime=t,l.targetOpacity=o.show&&l.show?1:0}}(e,n)})),e(r,n);for(var s=0,a=t.getChildren(r);s<a.length;s++)o(a[s],n)}return{work:function(e){for(var t=performance.now();n<r.length;n++){if(performance.now()-t>e)return!1;o(r[n],performance.now())}return!0}}},e}();t.SymbolDeclutterer=n}).apply(null,r))||(e.exports=n)},"6cAc":function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,i,r){void 0===e&&(e=0),void 0===t&&(t=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=e,this.y=t,this.width=i,this.height=r}return Object.defineProperty(e.prototype,"isEmpty",{get:function(){return this.width<=0||this.height<=0},enumerable:!1,configurable:!0}),e.prototype.union=function(e){this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.width=Math.max(this.width,e.width),this.height=Math.max(this.height,e.height)},e}();t.default=i}).apply(null,r))||(e.exports=n)},"6i4F":function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("zOht"),i("y4WC"),i("K2Kz"),i("8MXS"),i("Vx27"),i("1Mg+"),i("ZMIQ"),i("7MXx"),i("ts8o"),i("20TT")],void 0===(n=(function(e,t,i,r,n,o,s,a,l,u,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LayerView2DMixin=void 0;var d=r.ofType({key:"type",base:l,typeMap:{rect:u,path:h,geometry:c}});t.LayerView2DMixin=function(e){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.clips=new d,t.moving=!1,t.attached=!1,t.lastUpdateId=-1,t.updateRequested=!1,t}return i.__extends(t,e),t.prototype.initialize=function(){var e,t=this;this.container||(this.container=new a.Container),this.container.fadeTransitionEnabled=!0,this.container.opacity=0,this.container.clips=this.clips,this.handles.add([o.init(this,"suspended",(function(e){t.container&&(t.container.visible=!e),t.view&&!e&&t.updateRequested&&t.view.requestUpdate()}),!0),o.init(this,["layer.opacity","container"],(function(){var e,i;t.container&&(t.container.opacity=null!==(i=null===(e=t.layer)||void 0===e?void 0:e.opacity)&&void 0!==i?i:1)}),!0),o.init(this,["layer.blendMode"],(function(e){t.container&&(t.container.blendMode=e)}),!0),o.init(this,["layer.effect"],(function(e){t.container&&(t.container.effect=e)}),!0),this.clips.on("change",(function(){t.container.clips=t.clips,t.notifyChange("clips")}))]),(null===(e=this.view)||void 0===e?void 0:e.whenLayerView)?this.view.whenLayerView(this.layer).then((function(e){e!==t||t.attached||t.destroyed||(t.attach(),t.requestUpdate(),t.attached=!0)}),(function(){})):this.when().then((function(){t.attached||t.destroyed||(t.attach(),t.requestUpdate(),t.attached=!0)}),(function(){}))},t.prototype.destroy=function(){this.attached&&(this.detach(),this.attached=!1),this.handles.remove("initialize"),this.updateRequested=!1},Object.defineProperty(t.prototype,"updating",{get:function(){return!this.attached||!this.suspended&&(this.updateRequested||this.isUpdating())},enumerable:!1,configurable:!0}),t.prototype.isVisibleAtScale=function(e){var t=!0,i=this.layer,r=i.minScale,n=i.maxScale;if(null!=r&&null!=n){var o=!r,s=!n;!o&&e<=r&&(o=!0),!s&&e>=n&&(s=!0),t=o&&s}return t},t.prototype.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.suspended||this.view.requestUpdate())},t.prototype.processUpdate=function(e){!this.isFulfilled()||this.isResolved()?(this._set("updateParameters",e),this.updateRequested&&!this.suspended&&(this.updateRequested=!1,this.update(e))):this.updateRequested=!1},t.prototype.isUpdating=function(){return!1},t.prototype.isRendering=function(){return!1},t.prototype.canResume=function(){return!!e.prototype.canResume.call(this)&&this.isVisibleAtScale(this.view.scale)},i.__decorate([s.property({type:d,set:function(e){var t=n.referenceSetter(e,this._get("clips"),d);this._set("clips",t)}})],t.prototype,"clips",void 0),i.__decorate([s.property()],t.prototype,"moving",void 0),i.__decorate([s.property()],t.prototype,"attached",void 0),i.__decorate([s.property()],t.prototype,"container",void 0),i.__decorate([s.property({dependsOn:["view.scale","layer.minScale","layer.maxScale"]})],t.prototype,"suspended",void 0),i.__decorate([s.property({readOnly:!0})],t.prototype,"updateParameters",void 0),i.__decorate([s.property()],t.prototype,"updateRequested",void 0),i.__decorate([s.property({dependsOn:["attached","updateRequested","suspended"]})],t.prototype,"updating",null),i.__decorate([s.property()],t.prototype,"view",void 0),i.__decorate([s.subclass("esri.views.2d.layers.LayerView2D")],t)}(e)}}).apply(null,r))||(e.exports=n)},"7wYu":function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("H1tY"),i("qMld"),i("DJpR"),i("VIUv"),i("6cAc")],void 0===(n=(function(e,t,i,r,n,o,s){"use strict";var a;return function(){function e(e,t,r){this.width=0,this.height=0,this._dirties=[],this._glyphData=[],this._currentPage=0,this._glyphIndex={},this._textures=[],this._rangePromises=new Map,!a&&i("stable-symbol-rendering")&&(a=new Set),this.width=e,this.height=t,this._glyphSource=r,this._binPack=new o(e-4,t-4),this._glyphData.push(new Uint8Array(e*t)),this._dirties.push(!0),this._textures.push(void 0)}return e.prototype.getGlyphItems=function(e,t){for(var n=this,l=[],u=this._glyphSource,c=new Set,h=0,d=t;h<d.length;h++){var p=Math.floor(d[h]*(1/256));c.add(p)}var f=[];return c.forEach((function(t){if(t<=256){var i=e+t;if(n._rangePromises.has(i))f.push(n._rangePromises.get(i));else{var r=u.getRange(e,t).then((function(){n._rangePromises.delete(i)}),(function(){n._rangePromises.delete(i)}));n._rangePromises.set(i,r),f.push(r)}}})),r.all(f).then((function(){var r,h=n._glyphIndex[e];if(h||(n._glyphIndex[e]=h={}),i("stable-symbol-rendering")){a.clear();for(var d=0,p=t;d<p.length;d++){var f=p[d];a.add(f)}var y=[];c.forEach((function(e){y.push(e)})),y.sort(),r=[];for(var _=0,v=y;_<v.length;_++)for(var g=v[_],m=0;m<256;++m)r.push(256*g+m)}else r=t;for(var b=0,w=r;b<w.length;b++){var x=h[f=w[b]];if(x)i("stable-symbol-rendering")&&!a.has(f)||(l[f]={sdf:!0,rect:x.rect,metrics:x.metrics,page:x.page,code:f});else{var S=u.getGlyph(e,f);if(S&&S.metrics){var T=S.metrics,I=void 0;if(0===T.width)I=new s.default(0,0,0,0);else{var O=T.width+6,R=T.height+6,C=O%4?4-O%4:4,D=R%4?4-R%4:4;1===C&&(C=5),1===D&&(D=5),(I=n._binPack.allocate(O+C,R+D)).isEmpty&&(n._dirties[n._currentPage]||(n._glyphData[n._currentPage]=null),n._currentPage=n._glyphData.length,n._glyphData.push(new Uint8Array(n.width*n.height)),n._dirties.push(!0),n._textures.push(void 0),n._binPack=new o(n.width-4,n.height-4),I=n._binPack.allocate(O+C,R+D));var P=n._glyphData[n._currentPage],M=S.bitmap,A=void 0,V=void 0;if(M)for(var k=0;k<R;k++){A=O*k,V=n.width*(I.y+k+1)+I.x;for(var L=0;L<O;L++)P[V+L+1]=M[A+L]}}h[f]={rect:I,metrics:T,tileIDs:null,page:n._currentPage},i("stable-symbol-rendering")&&!a.has(f)||(l[f]={sdf:!0,rect:I,metrics:T,page:n._currentPage,code:f}),n._dirties[n._currentPage]=!0}}}return l}))},e.prototype.removeGlyphs=function(e){for(var t in this._glyphIndex){var i=this._glyphIndex[t];if(i){var r=void 0;for(var n in i)if((r=i[n]).tileIDs.delete(e),0===r.tileIDs.size){for(var o=this._glyphData[r.page],s=r.rect,a=void 0,l=void 0,u=0;u<s.height;u++)for(a=this.width*(s.y+u)+s.x,l=0;l<s.width;l++)o[a+l]=0;delete i[n],this._dirties[r.page]=!0}}}},e.prototype.bind=function(e,t,i,r){void 0===r&&(r=0),this._textures[i]||(this._textures[i]=new n.Texture(e,{pixelFormat:6406,dataType:5121,width:this.width,height:this.height},new Uint8Array(this.width*this.height)));var o=this._textures[i];o.setSamplingMode(t),this._dirties[i]&&o.setData(this._glyphData[i]),e.bindTexture(o,r),this._dirties[i]=!1},e.prototype.dispose=function(){this._binPack=null;for(var e=0,t=this._textures;e<t.length;e++){var i=t[e];i&&i.dispose()}this._textures.length=0},e}()}).apply(null,r))||(e.exports=n)},BEij:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("zOht"),i("zp6E"),i("H1tY"),i("ZHL0"),i("LxLY"),i("r7jh"),i("qMld"),i("8V7H"),i("lRq4"),i("VjU6"),i("7wYu"),i("suOV"),i("mFzi"),i("soIt"),i("dLO5"),i("f3JK")],void 0===(n=(function(e,t,i,r,n,o,s,a,l,u,c,h,d,p,f,y,_,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TileHandler=void 0;var g=new o(10),m=new Map,b=function(){function e(e,t,i){this._vectorTileLayer=e,this.devicePixelRatio=t,this._memCache=i,this._spriteMosaic=null,this._glyphMosaic=null,this._connection=null,this._ongoingTileRequests=new Map,this._ongoingRequestToController=new Map}return e.prototype.destroy=function(){this._ongoingTileRequests&&this.abortAll(),this._connection&&(this._connection.close(),this._connection=null),this._vectorTileLayer=null,this._spriteMosaic&&(this._spriteMosaic.dispose(),this._spriteMosaic=null),this._glyphMosaic&&(this._glyphMosaic.dispose(),this._glyphMosaic=null)},Object.defineProperty(e.prototype,"spriteMosaic",{get:function(){var e=this;return this._spriteSourcePromise.then((function(){return e._spriteMosaic}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"glyphMosaic",{get:function(){return this._glyphMosaic},enumerable:!1,configurable:!0}),e.prototype.start=function(e){return i.__awaiter(this,void 0,void 0,(function(){var t,r,o,s,a,c=this;return i.__generator(this,(function(i){for(o in r=[],t=this._vectorTileLayer.sourceNameToSource)r.push(this._fetchTileMap(t[o],e));return this._spriteSourcePromise=this._vectorTileLayer.loadSpriteSource(this.devicePixelRatio,e),this._spriteSourcePromise.then((function(e){c._spriteMosaic=new f(1024,1024,250),c._spriteMosaic.setSpriteSource(e),n("stable-symbol-rendering")&&c._spriteMosaic.preloadSpriteItems()})),a=new p((s=this._vectorTileLayer.styleRepository).glyphs),this._glyphMosaic=new d(1024,1024,a),this._broadcastPromise=u.open("WorkerTileHandler",{client:this,scheduler:e.scheduler,signal:e.signal}).then((function(t){return c._connection=t,l.all(c._connection.broadcast("setLayers",{style:s.styleJSON},e))})),[2,l.all(r)]}))}))},e.prototype.updateStyle=function(){return i.__awaiter(this,void 0,void 0,(function(){var e,t=this;return i.__generator(this,(function(i){switch(i.label){case 0:return[4,this._broadcastPromise];case 1:return i.sent(),e=this._vectorTileLayer.styleRepository,this._broadcastPromise=l.create((function(i,r){l.all(t._connection.broadcast("updateStyle",e.styleJSON)).then(i,r)})),[2,this._broadcastPromise]}}))}))},e.prototype.getVectorTile=function(e,t,i,r){var n=this,o=new v(e,t,i,0);if(s.isSome(this._memCache)){var u=this._memCache.get(o.id);if(s.isSome(u))return u.reference(),l.resolve(u)}return this._getVectorTileData(o).then((function(e){if(l.throwIfAborted(r),s.isSome(n._memCache)){var t=n._memCache.get(o.id);if(s.isSome(t))return t.reference(),t}if(!n._vectorTileLayer)return null;var i=n._vectorTileLayer.tileInfo.getTileBounds(c.create(),o),u=new h.VectorTile(o,n._vectorTileLayer.styleRepository,i,[512,512]);if(e&&e.tileData){if(u.setData(e.tileData),s.isSome(n._memCache)){u.reference();var d=u.getMemoryUsage();d>0&&n._memCache.put(u.key.id,u,d*u.referenced,a.MIN_PRIORITY)}}else u.setData(null);return u}))},e.prototype.releaseVectorTile=function(e){s.isNone(this._memCache)||e.release()||this._memCache.updateSize(e.key.id,e,e.getMemoryUsage()*e.referenced)},e.prototype.fetchTileData=function(e,t){var i=this;return this._getRefKeys(e,t).then((function(e){var r=i._vectorTileLayer.sourceNameToSource,n=[];for(var o in r)n.push(o);return i._getSourcesData(n,e,t)}))},e.prototype.parseTileData=function(e,t){var r=this,o=e&&e.data;if(!o)return l.resolve(null);var s=o.sourceName2DataAndRefKey,a=o.transferList;return 0===Object.keys(s).length?l.resolve(null):this._broadcastPromise.then((function(){return r._connection.getAvailableClient().then((function(r){return r.invoke("createTileAndParse",{key:e.key.id,sourceName2DataAndRefKey:s},i.__assign(i.__assign({},t),{transferList:a})).then((function(e){if(n("esri-vector-tiles-debug")){var t={};for(var i in s)t[i]=s[i].refKey;return{tileData:e,refKeys:t}}return{tileData:e}}))}))}))},Object.defineProperty(e.prototype,"updating",{get:function(){return this._ongoingTileRequests.size>0},enumerable:!1,configurable:!0}),e.prototype.abortAll=function(){this._ongoingRequestToController.forEach((function(e){return e.abort()})),this._ongoingRequestToController.clear(),this._ongoingTileRequests.clear()},e.prototype.getSprites=function(e){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(t){switch(t.label){case 0:return[4,this._spriteSourcePromise];case 1:return t.sent(),[2,this._spriteMosaic.getSpriteItems(e)]}}))}))},e.prototype.getGlyphs=function(e){return this._glyphMosaic.getGlyphItems(e.font,e.codePoints)},e.prototype.perfReport=function(e){_.perfAdd(e.key,e.milliseconds,"ms")},e.prototype.getStyleRepository=function(){return this._vectorTileLayer.styleRepository},e.prototype._getTilePayload=function(e,t,n){return i.__awaiter(this,void 0,void 0,(function(){var o,s;return i.__generator(this,(function(a){switch(a.label){case 0:return o=v.pool.acquire(e.id),s=this._vectorTileLayer.sourceNameToSource[t].getSourceTileUrl(o.level,o.row,o.col),v.pool.release(o),[4,r(s,i.__assign({responseType:"array-buffer"},n))];case 1:return[2,{protobuff:a.sent().data,sourceName:t}]}}))}))},e.prototype._fetchTileMap=function(e,t){if(e.capabilities.operations.supportsTileMap&&e.tileIndex)return l.resolve();if(!e.tileMapURL)return l.resolve();var i=g.get(e.tileMapURL);if(i)return e.tileIndex=i,l.resolve();if(m.has(e.tileMapURL))return m.get(e.tileMapURL).then((function(t){e.tileIndex=new y(t.data)}));var n=r(e.tileMapURL,t);return n.then((function(t){e.tileIndex=new y(t.data),m.delete(e.tileMapURL),g.put(e.tileMapURL,e.tileIndex)})),m.set(e.tileMapURL,n),n},e.prototype._getRefKeys=function(e,t){var i=this._vectorTileLayer.sourceNameToSource,r=new Array;for(var n in i){var o=i[n].getRefKey(e,t);r.push(o)}return l.eachAlways(r)},e.prototype._getSourcesData=function(e,t,i){for(var r=[],n=0;n<t.length;n++)if(null==t[n].value||null==e[n])r.push(null);else{var o=this._getTilePayload(t[n].value,e[n],i);r.push(o)}return l.eachAlways(r).then((function(e){for(var i={},r=[],n=0;n<e.length;n++)e[n].value&&e[n].value&&e[n].value.protobuff&&e[n].value.protobuff.byteLength>0&&(i[e[n].value.sourceName]={refKey:t[n].value.id,protobuff:e[n].value.protobuff},r.push(e[n].value.protobuff));return{sourceName2DataAndRefKey:i,transferList:r}}))},e.prototype._getVectorTileData=function(e){var t=this,i=e.id;if(this._ongoingTileRequests.has(i))return this._ongoingTileRequests.get(i);var r=new AbortController,n=this._getParsedVectorTileData(e,{signal:r.signal}).then((function(e){return t._ongoingTileRequests.delete(i),t._ongoingRequestToController.delete(i),e})).catch((function(){return t._ongoingTileRequests.delete(i),t._ongoingRequestToController.delete(i),null}));return this._ongoingTileRequests.set(i,n),this._ongoingRequestToController.set(i,r),n},e.prototype._getParsedVectorTileData=function(e,t){var i=this;return this.fetchTileData(e,t).then((function(r){return i.parseTileData({key:e,data:r},t)}))},e}();t.TileHandler=b}).apply(null,r))||(e.exports=n)},KyfE:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("zOht"),i("LxLY"),i("DJpR"),i("2eQy"),i("2JW5")],void 0===(n=(function(e,t,i,r,n,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CircleRenderBucket=t.SymbolRenderBucket=t.FillRenderBucket=t.LineRenderBucket=t.RenderBucketBase=void 0;var a=function(){function e(e){this.layerIndices=[],this.isDestroyed=!1,this.data=e,this.memoryUsed=e.byteLength;var t=1,i=new Uint32Array(e);this.layerIndices=[];for(var r=i[t++],n=0;n<r;n++)this.layerIndices[n]=i[t++];this.bufferDataOffset=t}return Object.defineProperty(e.prototype,"isPreparedForRendering",{get:function(){return r.isNone(this.data)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"offset",{get:function(){return this.bufferDataOffset},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){this.isDestroyed||(this.doDestroy(),this.isDestroyed=!0)},e.prototype.prepareForRendering=function(e,t){r.isNone(this.data)||(this.doPrepareForRendering(e,t,this.data,this.bufferDataOffset),this.data=null)},e}();t.RenderBucketBase=a;var l=function(e){function t(t){var i=e.call(this,t)||this;i.type=2,i.lineIndexStart=0,i.lineIndexCount=0;var r=i.bufferDataOffset,n=new Uint32Array(t);return i.lineIndexStart=n[r++],i.lineIndexCount=n[r++],i.isLineDataDriven=!!n[r++],i.bufferDataOffset=r,i}return i.__extends(t,e),t.prototype.hasData=function(){return this.lineIndexCount>0},t.prototype.triangleCount=function(){return this.lineIndexCount/3},t.prototype.doDestroy=function(){r.isSome(this.lineVertexArrayObject)&&this.lineVertexArrayObject.dispose(),r.isSome(this.lineVertexBuffer)&&this.lineVertexBuffer.dispose(),r.isSome(this.lineIndexBuffer)&&this.lineIndexBuffer.dispose(),this.lineVertexArrayObject=null,this.lineVertexBuffer=null,this.lineIndexBuffer=null,this.memoryUsed=0},t.prototype.doPrepareForRendering=function(e,i,r,o){var s=new Uint32Array(r),a=new Int32Array(s.buffer),l=s[o++];this.lineVertexBuffer=n.BufferObject.createVertex(e,35044,new Int32Array(a.buffer,4*o,l)),o+=l;var u=s[o++];this.lineIndexBuffer=n.BufferObject.createIndex(e,35044,new Uint32Array(s.buffer,4*o,u)),o+=u,this.lineVertexArrayObject=new n.VertexArrayObject(e,i.getProgramAttributes(3),this.isLineDataDriven?t.lineVertexAttributesDD:t.lineVertexAttributes,{geometry:this.lineVertexBuffer},this.lineIndexBuffer)},t.lineVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:12,normalized:!1,divisor:0},{name:"a_offsetAndNormal",count:4,type:5120,offset:4,stride:12,normalized:!1,divisor:0},{name:"a_accumulatedDistance",count:2,type:5123,offset:8,stride:12,normalized:!1,divisor:0}]},t.lineVertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:20,normalized:!1,divisor:0},{name:"a_offsetAndNormal",count:4,type:5120,offset:4,stride:20,normalized:!1,divisor:0},{name:"a_accumulatedDistance",count:2,type:5122,offset:8,stride:20,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:12,stride:20,normalized:!0,divisor:0},{name:"a_width",count:1,type:5126,offset:16,stride:20,normalized:!1,divisor:0}]},t}(a);t.LineRenderBucket=l;var u=function(e){function t(t){var i=e.call(this,t)||this;i.type=1,i.fillIndexStart=0,i.fillIndexCount=0,i.outlineIndexStart=0,i.outlineIndexCount=0;var r=i.bufferDataOffset,n=new Uint32Array(t);return i.fillIndexStart=n[r++],i.fillIndexCount=n[r++],i.outlineIndexStart=n[r++],i.outlineIndexCount=n[r++],i.isFillDataDriven=!!n[r++],i.isOutlineDataDriven=!!n[r++],i.bufferDataOffset=r,i}return i.__extends(t,e),t.prototype.hasData=function(){return this.fillIndexCount>0||this.outlineIndexCount>0},t.prototype.triangleCount=function(){return(this.fillIndexCount+this.outlineIndexCount)/3},t.prototype.doDestroy=function(){r.isSome(this.fillVertexArrayObject)&&this.fillVertexArrayObject.dispose(),r.isSome(this.fillVertexBuffer)&&this.fillVertexBuffer.dispose(),r.isSome(this.fillIndexBuffer)&&this.fillIndexBuffer.dispose(),this.fillVertexArrayObject=null,this.fillVertexBuffer=null,this.fillIndexBuffer=null,r.isSome(this.outlineVertexArrayObject)&&this.outlineVertexArrayObject.dispose(),r.isSome(this.outlineVertexBuffer)&&this.outlineVertexBuffer.dispose(),r.isSome(this.outlineIndexBuffer)&&this.outlineIndexBuffer.dispose(),this.outlineVertexArrayObject=null,this.outlineVertexBuffer=null,this.outlineIndexBuffer=null,this.memoryUsed=0},t.prototype.doPrepareForRendering=function(e,i,r,o){var s=new Uint32Array(r),a=new Int32Array(s.buffer),l=s[o++];this.fillVertexBuffer=n.BufferObject.createVertex(e,35044,new Int32Array(a.buffer,4*o,l)),o+=l;var u=s[o++];this.fillIndexBuffer=n.BufferObject.createIndex(e,35044,new Uint32Array(s.buffer,4*o,u)),o+=u;var c=s[o++];this.outlineVertexBuffer=n.BufferObject.createVertex(e,35044,new Int32Array(a.buffer,4*o,c)),o+=c;var h=s[o++];this.outlineIndexBuffer=n.BufferObject.createIndex(e,35044,new Uint32Array(s.buffer,4*o,h)),o+=h,this.fillVertexArrayObject=new n.VertexArrayObject(e,i.getProgramAttributes(1),this.isFillDataDriven?t.fillVertexAttributesDD:t.fillVertexAttributes,{geometry:this.fillVertexBuffer},this.fillIndexBuffer),this.outlineVertexArrayObject=new n.VertexArrayObject(e,i.getProgramAttributes(2),this.isOutlineDataDriven?t.outlineVertexAttributesDD:t.outlineVertexAttributes,{geometry:this.outlineVertexBuffer},this.outlineIndexBuffer)},t.fillVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}]},t.fillVertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:8,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:4,stride:8,normalized:!0,divisor:0}]},t.outlineVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:8,normalized:!1,divisor:0},{name:"a_offset",count:2,type:5120,offset:4,stride:8,normalized:!1,divisor:0},{name:"a_xnormal",count:2,type:5120,offset:6,stride:8,normalized:!1,divisor:0}]},t.outlineVertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:12,normalized:!1,divisor:0},{name:"a_offset",count:2,type:5120,offset:4,stride:12,normalized:!1,divisor:0},{name:"a_xnormal",count:2,type:5120,offset:6,stride:12,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:12,normalized:!0,divisor:0}]},t}(a);t.FillRenderBucket=u;var c=function(e){function t(t){var i=e.call(this,t)||this;i.type=3,i.iconPerPageElementsMap=new Map,i.glyphPerPageElementsMap=new Map,i.symbolInstances=[],i.isIconSDF=!1,i.opacityChanged=!1,i.lastOpacityUpdate=0,i.symbols=[];var r=i.bufferDataOffset,n=new Uint32Array(t),a=new Int32Array(t),l=new Float32Array(t);i.isIconSDF=!!n[r++],i.isIconDataDriven=!!n[r++],i.isTextDataDriven=!!n[r++];for(var u=n[r++],c=0;c<u;c++){var h=n[r++],d=n[r++],p=n[r++];i.iconPerPageElementsMap.set(h,[d,p])}var f=n[r++];for(c=0;c<f;c++)h=n[r++],d=n[r++],p=n[r++],i.glyphPerPageElementsMap.set(h,[d,p]);var y=n[r++],_=n[r++];if(i.iconOpacity=new Int32Array(y),i.textOpacity=new Int32Array(_),!o.DECLUTTER_TILES){for(c=0;c<y;c++)i.iconOpacity[c]=-1;for(c=0;c<_;c++)i.textOpacity[c]=-1;i.opacityChanged=!0}return r=s.deserializeSymbols(n,a,l,r,i.symbols),i.bufferDataOffset=r,i}return i.__extends(t,e),t.prototype.hasData=function(){return this.iconPerPageElementsMap.size>0||this.glyphPerPageElementsMap.size>0},t.prototype.triangleCount=function(){var e=0;return this.iconPerPageElementsMap.forEach((function(t){e+=t[1]})),this.glyphPerPageElementsMap.forEach((function(t){e+=t[1]})),e/3},t.prototype.doDestroy=function(){r.isSome(this.iconVertexArrayObject)&&this.iconVertexArrayObject.dispose(),r.isSome(this.iconVertexBuffer)&&this.iconVertexBuffer.dispose(),r.isSome(this.iconOpacityBuffer)&&this.iconOpacityBuffer.dispose(),r.isSome(this.iconIndexBuffer)&&this.iconIndexBuffer.dispose(),this.iconVertexArrayObject=null,this.iconVertexBuffer=null,this.iconOpacityBuffer=null,this.iconIndexBuffer=null,r.isSome(this.textVertexArrayObject)&&this.textVertexArrayObject.dispose(),r.isSome(this.textVertexBuffer)&&this.textVertexBuffer.dispose(),r.isSome(this.textOpacityBuffer)&&this.textOpacityBuffer.dispose(),r.isSome(this.textIndexBuffer)&&this.textIndexBuffer.dispose(),this.textVertexArrayObject=null,this.textVertexBuffer=null,this.textOpacityBuffer=null,this.textIndexBuffer=null,this.memoryUsed=0},t.prototype.updateOpacityInfo=function(){if(this.opacityChanged){this.opacityChanged=!1;var e=r.unwrap(this.iconOpacity),t=r.unwrap(this.iconOpacityBuffer);e.length>0&&e.byteLength===t.size&&t.setSubData(e);var i=r.unwrap(this.textOpacity),n=r.unwrap(this.textOpacityBuffer);i.length>0&&i.byteLength===n.size&&n.setSubData(i)}},t.prototype.doPrepareForRendering=function(e,i,o,s){var a=new Uint32Array(o),l=new Int32Array(a.buffer),u=a[s++];this.iconVertexBuffer=n.BufferObject.createVertex(e,35044,new Int32Array(l.buffer,4*s,u)),s+=u;var c=a[s++];this.iconIndexBuffer=n.BufferObject.createIndex(e,35044,new Uint32Array(a.buffer,4*s,c)),s+=c;var h=a[s++];this.textVertexBuffer=n.BufferObject.createVertex(e,35044,new Int32Array(l.buffer,4*s,h)),s+=h;var d=a[s++];this.textIndexBuffer=n.BufferObject.createIndex(e,35044,new Uint32Array(a.buffer,4*s,d)),s+=d,this.iconOpacityBuffer=n.BufferObject.createVertex(e,35044,r.unwrap(this.iconOpacity).buffer),this.textOpacityBuffer=n.BufferObject.createVertex(e,35044,r.unwrap(this.textOpacity).buffer),this.iconVertexArrayObject=new n.VertexArrayObject(e,i.getProgramAttributes(4),this.isIconDataDriven?t.vertexAttributesDD:t.vertexAttributes,{geometry:this.iconVertexBuffer,opacity:this.iconOpacityBuffer},this.iconIndexBuffer),this.textVertexArrayObject=new n.VertexArrayObject(e,i.getProgramAttributes(6),this.isTextDataDriven?t.vertexAttributesDD:t.vertexAttributes,{geometry:this.textVertexBuffer,opacity:this.textOpacityBuffer},this.textIndexBuffer)},t.vertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:4,stride:16,normalized:!1,divisor:0},{name:"a_texAngleRange",count:4,type:5121,offset:8,stride:16,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:16,normalized:!1,divisor:0}],opacity:[{name:"a_opacityInfo",count:1,type:5121,offset:0,stride:1,normalized:!1,divisor:0}]},t.vertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:24,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:4,stride:24,normalized:!1,divisor:0},{name:"a_texAngleRange",count:4,type:5121,offset:8,stride:24,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:24,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:16,stride:24,normalized:!0,divisor:0},{name:"a_size",count:1,type:5126,offset:20,stride:24,normalized:!1,divisor:0}],opacity:[{name:"a_opacityInfo",count:1,type:5121,offset:0,stride:1,normalized:!1,divisor:0}]},t}(a);t.SymbolRenderBucket=c;var h=function(e){function t(t){var i=e.call(this,t)||this;i.type=4,i.circleIndexStart=0,i.circleIndexCount=0;var r=i.bufferDataOffset,n=new Uint32Array(t);return i.circleIndexStart=n[r++],i.circleIndexCount=n[r++],i.bufferDataOffset=r,i}return i.__extends(t,e),t.prototype.hasData=function(){return this.circleIndexCount>0},t.prototype.triangleCount=function(){return this.circleIndexCount/3},t.prototype.doDestroy=function(){r.isSome(this.circleVertexArrayObject)&&this.circleVertexArrayObject.dispose(),r.isSome(this.circleVertexBuffer)&&this.circleVertexBuffer.dispose(),r.isSome(this.circleIndexBuffer)&&this.circleIndexBuffer.dispose(),this.circleVertexArrayObject=null,this.circleVertexBuffer=null,this.circleIndexBuffer=null,this.memoryUsed=0},t.prototype.doPrepareForRendering=function(e,i,r,o){var s=new Uint32Array(r),a=new Int32Array(s.buffer),l=s[o++];this.circleVertexBuffer=n.BufferObject.createVertex(e,35044,new Int32Array(a.buffer,4*o,l)),o+=l;var u=s[o++];this.circleIndexBuffer=n.BufferObject.createIndex(e,35044,new Uint32Array(s.buffer,4*o,u)),o+=u,this.circleVertexArrayObject=new n.VertexArrayObject(e,i.getProgramAttributes(5),t.circleVertexAttributes,{geometry:this.circleVertexBuffer},this.circleIndexBuffer)},t.circleVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:4,stride:16,normalized:!0,divisor:0},{name:"a_stroke_color",count:4,type:5121,offset:8,stride:16,normalized:!0,divisor:0},{name:"a_data",count:4,type:5121,offset:12,stride:16,normalized:!1,divisor:0}]},t}(a);t.CircleRenderBucket=h}).apply(null,r))||(e.exports=n)},PQCn:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("zOht"),i("BcWh"),i("LxLY"),i("2eQy"),i("fdgu"),i("XQQU"),i("4LVV"),i("ooFS"),i("2JW5")],void 0===(n=(function(e,t,i,r,n,o,s,a,l,u,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SymbolFader=void 0;var h=function(e){function t(t){var i=e.call(this)||this;return i.layers=t,i._tileToHandle=new Map,i._viewState={scale:0,rotation:0,center:[0,0],size:[0,0]},i._declutterViewState={scale:0,rotation:0,center:[0,0],size:[0,0]},i._completed=!1,i._tileForest=new c.TileForest,i._symbolRepository=new u.SymbolRepository(4096,i._tileForest,(function(){return new s.VTLUniqueSymbol})),i._symbolDeclutterer=new l.SymbolDeclutterer(i._tileForest,i._symbolRepository,(function(e,t,r){return new a.CollisionJob(e,t,r,i.layers,i._zoom,i._viewState.rotation)}),(function(e,t){e.allSymbolsFadingOut=!0,e.lastOpacityUpdate=t,c.writeOpacityToBuffers(e,t,!0),e.decluttered=!0,e.requestRender()})),i}return i.__extends(t,e),t.prototype.addTile=function(e){var t=this;this._tileForest.has(e)||(e.decluttered=!1,this._tileForest.add(e),this._tileToHandle.set(e,e.on("symbols-changed",(function(){t._symbolRepository.addTile(e,!1),t.restartDeclutter()}))),this._symbolRepository.addTile(e),this.restartDeclutter())},t.prototype.removeTile=function(e){this._tileForest.has(e)&&(this._symbolRepository.removeTile(e),this.restartDeclutter(),this._tileToHandle.get(e).remove(),this._tileToHandle.delete(e),this._tileForest.remove(e))},t.prototype.update=function(e,t){return this._zoom=e,this._viewState={scale:t.scale,rotation:t.rotation,center:[t.center[0],t.center[1]],size:[t.size[0],t.size[1]]},this._continueDeclutter(),this._completed},t.prototype.restartDeclutter=function(){this._completed=!1,this._symbolDeclutterer.restart(),this._notifyUnstable()},Object.defineProperty(t.prototype,"stale",{get:function(){return this._zoom!==this._declutterZoom||this._viewState.size[0]!==this._declutterViewState.size[0]||this._viewState.size[1]!==this._declutterViewState.size[1]||this._viewState.scale!==this._declutterViewState.scale||this._viewState.rotation!==this._declutterViewState.rotation},enumerable:!1,configurable:!0}),t.prototype._continueDeclutter=function(){this._completed&&!this.stale||(this._symbolDeclutterer.running||(this._declutterZoom=this._zoom,this._declutterViewState.center[0]=this._viewState.center[0],this._declutterViewState.center[1]=this._viewState.center[1],this._declutterViewState.rotation=this._viewState.rotation,this._declutterViewState.scale=this._viewState.scale,this._declutterViewState.size[0]=this._viewState.size[0],this._declutterViewState.size[1]=this._viewState.size[1],this._symbolDeclutterer.restart()),this._symbolDeclutterer.setScreenSize(this._viewState.size[0],this._viewState.size[1]),this._completed=this._symbolDeclutterer.continue(o.DECLUTTER_BUDGET),this._completed&&this._scheduleNotifyStable())},t.prototype._scheduleNotifyStable=function(){var e=this;n.isSome(this._stableNotificationHandle)&&clearTimeout(this._stableNotificationHandle),this._stableNotificationHandle=setTimeout((function(){e._stableNotificationHandle=null,e.emit("fade-complete")}),1.5*o.FADE_DURATION)},t.prototype._notifyUnstable=function(){n.isSome(this._stableNotificationHandle)&&(clearTimeout(this._stableNotificationHandle),this._stableNotificationHandle=null),this.emit("fade-start")},t}(r);t.SymbolFader=h}).apply(null,r))||(e.exports=n)},VIUv:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("6cAc")],void 0===(n=(function(e,t,i){"use strict";return function(){function e(e,t){this._width=0,this._height=0,this._free=[],this._width=e,this._height=t,this._free.push(new i.default(0,0,e,t))}return Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),e.prototype.allocate=function(e,t){if(e>this._width||t>this._height)return new i.default;for(var r=null,n=-1,o=0;o<this._free.length;++o){var s=this._free[o];e<=s.width&&t<=s.height&&(null===r||s.y<=r.y&&s.x<=r.x)&&(r=s,n=o)}return null===r?new i.default:(this._free.splice(n,1),r.width<r.height?(r.width>e&&this._free.push(new i.default(r.x+e,r.y,r.width-e,t)),r.height>t&&this._free.push(new i.default(r.x,r.y+t,r.width,r.height-t))):(r.width>e&&this._free.push(new i.default(r.x+e,r.y,r.width-e,r.height)),r.height>t&&this._free.push(new i.default(r.x,r.y+t,e,r.height-t))),new i.default(r.x,r.y,e,t))},e.prototype.release=function(e){for(var t=0;t<this._free.length;++t){var i=this._free[t];if(i.y===e.y&&i.height===e.height&&i.x+i.width===e.x)i.width+=e.width;else if(i.x===e.x&&i.width===e.width&&i.y+i.height===e.y)i.height+=e.height;else if(e.y===i.y&&e.height===i.height&&e.x+e.width===i.x)i.x=e.x,i.width+=e.width;else{if(e.x!==i.x||e.width!==i.width||e.y+e.height!==i.y)continue;i.y=e.y,i.height+=e.height}this._free.splice(t,1),this.release(e)}this._free.push(e)},e}()}).apply(null,r))||(e.exports=n)},VjU6:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("zOht"),i("YX1r"),i("lgZd"),i("KyfE"),i("2eQy"),i("gi5q")],void 0===(n=(function(e,t,i,r,n,o,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VectorTile=void 0;var l=function(e){function t(t,i,r,o){var s=e.call(this,t,r,o,[4096,4096])||this;return s._referenced=0,s._hasSymbolBuckets=!1,s._memoryUsedByLayerData=0,s.layerData={},s.layerCount=0,s.status="loading",s.allSymbolsFadingOut=!1,s.lastOpacityUpdate=0,s.symbols=new Map,s.isCoverage=!1,s.neededForCoverage=!1,s.decluttered=!1,s.invalidating=!1,s._referenced=1,s.styleLayers=i,s.id=t.id,s.transforms.tileUnitsToPixels=n.mat3f32.create(),s}return i.__extends(t,e),Object.defineProperty(t.prototype,"hasSymbolBuckets",{get:function(){return this._hasSymbolBuckets},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isFading",{get:function(){return this._hasSymbolBuckets&&performance.now()-this.lastOpacityUpdate<s.FADE_DURATION},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isHoldingForFade",{get:function(){return this._hasSymbolBuckets&&(!this.allSymbolsFadingOut||performance.now()-this.lastOpacityUpdate<s.FADE_DURATION)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wasRequested",{get:function(){return"errored"===this.status||"loaded"===this.status||"reloading"===this.status},enumerable:!1,configurable:!0}),t.prototype.setData=function(e){this.changeDataImpl(e),this.requestRender(),this.ready(),this.invalidating=!1},t.prototype.hasData=function(){return this.layerCount>0},t.prototype.dispose=function(){t._destroyRenderBuckets(this.layerData),this.layerData={},this.layerCount=0,this._memoryUsedByLayerData=0,this.destroy()},t.prototype.release=function(){return 0==--this._referenced&&(this.dispose(),this.stage=null,!0)},t.prototype.reference=function(){++this._referenced},Object.defineProperty(t.prototype,"referenced",{get:function(){return this._referenced},enumerable:!1,configurable:!0}),t.prototype.getMemoryUsage=function(){return this._memoryUsedByLayerData/(this._referenced||1)},t.prototype.changeDataImpl=function(e){if(t._destroyRenderBuckets(this.layerData),this.layerData={},this.layerCount=0,this._memoryUsedByLayerData=0,e){var i=t._createRenderBuckets(e);for(var r in i)this.layerData[r]&&(this._memoryUsedByLayerData-=this.layerData[r].memoryUsed,this.layerData[r].destroy(),this.layerData[r]=null,this.layerCount--),this._memoryUsedByLayerData+=i[r].memoryUsed,this.layerData[r]=i[r],this.layerCount++}var n=new Map;for(var o in this._hasSymbolBuckets=!1,this.layerData){r=parseInt(o,10);var s=this.layerData[r];3===s.type&&(n.set(r,s.symbols),this._hasSymbolBuckets=!0)}this.symbols=n,this.emit("symbols-changed")},t.prototype.attachWithContext=function(e){this.stage={context:e,trashDisplayObject:function(e){e.processDetach()},untrashDisplayObject:function(){return!1}}},t.prototype.setTransform=function(t,i){e.prototype.setTransform.call(this,t,i);var n=i/(t.resolution*t.pixelRatio),o=this.size[0]/this.coordRange[0]*n,s=this.size[1]/this.coordRange[1]*n,a=t.toScreen([0,0],this.coords),l=a[0],u=a[1],c=this.transforms.tileUnitsToPixels;r.mat3.identity(c),r.mat3.translate(c,c,[l,u]),r.mat3.rotate(c,c,Math.PI*t.rotation/180),r.mat3.scale(c,c,[o,s,1])},t._destroyRenderBuckets=function(e){var t=new Set;for(var i in e){var r=e[i];t.has(r)||(r.destroy(),t.add(r))}},t._createRenderBuckets=function(e){for(var t={},i=0,r=e.buckets;i<r.length;i++){var n=r[i],s=void 0;switch(new Uint32Array(n)[0]){case 1:s=new o.FillRenderBucket(n);break;case 2:s=new o.LineRenderBucket(n);break;case 3:s=new o.SymbolRenderBucket(n);break;case 4:s=new o.CircleRenderBucket(n)}for(var a=0,l=s.layerIndices;a<l.length;a++)t[l[a]]=s}return t},t}(a.TiledDisplayObject);t.VectorTile=l}).apply(null,r))||(e.exports=n)},WsO6:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("zOht"),i("Gtr7"),i("BcWh"),i("7MDj"),i("NfRO"),i("qsST"),i("SZNs"),i("Vx27")],void 0===(n=(function(e,t,i,r,n,o,s,a,l,u){"use strict";return function(e){function t(t){var i=e.call(this,t)||this;return i.layer=null,i.parent=null,i}return i.__extends(t,e),t.prototype.initialize=function(){var e=this;this.when().catch((function(t){if("layerview:create-error"!==t.name){var i=e.layer&&e.layer.id||"no id",r=e.layer&&e.layer.title||"no title";throw a.getLogger(e.declaredClass).error("#resolve()","Failed to resolve layer view (layer title: '"+r+"', id: '"+i+"')",t),t}}))},Object.defineProperty(t.prototype,"fullOpacity",{get:function(){var e=function(e){return null==e?1:e};return e(this.get("layer.opacity"))*e(this.get("parent.fullOpacity"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"suspended",{get:function(){return!this.canResume()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"suspendInfo",{get:function(){return this.getSuspendInfo()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"legendEnabled",{get:function(){return!this.suspended&&!0===this.layer.legendEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"updating",{get:function(){return!!(this.updatingHandles&&this.updatingHandles.updating||this.isUpdating())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"visible",{get:function(){return!0===this.get("layer.visible")},set:function(e){void 0!==e?this._override("visible",e):this._clearOverride("visible")},enumerable:!1,configurable:!0}),t.prototype.canResume=function(){return!this.get("parent.suspended")&&this.get("view.ready")&&this.get("layer.loaded")&&this.visible||!1},t.prototype.getSuspendInfo=function(){var e=this.parent&&this.parent.suspended?this.parent.suspendInfo:{};return this.view&&this.view.ready||(e.viewNotReady=!0),this.layer&&this.layer.loaded||(e.layerNotLoaded=!0),this.visible||(e.layerInvisible=!0),e},t.prototype.isUpdating=function(){return!1},i.__decorate([u.property({dependsOn:["layer.opacity","parent.fullOpacity"]})],t.prototype,"fullOpacity",null),i.__decorate([u.property()],t.prototype,"layer",void 0),i.__decorate([u.property()],t.prototype,"parent",void 0),i.__decorate([u.property({readOnly:!0,dependsOn:["visible","layer.loaded","parent.suspended","view?.ready"]})],t.prototype,"suspended",null),i.__decorate([u.property({readOnly:!0,dependsOn:["visible","layer.loaded","parent.suspended","view?.ready"]})],t.prototype,"suspendInfo",null),i.__decorate([u.property({readOnly:!0,dependsOn:["suspended","layer.legendEnabled?"]})],t.prototype,"legendEnabled",null),i.__decorate([u.property({type:Boolean,dependsOn:["updatingHandles.updating"],readOnly:!0})],t.prototype,"updating",null),i.__decorate([u.property({dependsOn:["layer.visible"]})],t.prototype,"visible",null),i.__decorate([u.subclass("esri.views.layers.LayerView")],t)}(o.HandleOwnerMixin(s.IdentifiableMixin(l.EsriPromiseMixin(n.EventedMixin(r)))))}).apply(null,r))||(e.exports=n)},XQQU:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("lgZd"),i("2eQy"),i("2JW5")],void 0===(n=(function(e,t,i,r,n){"use strict";function o(e,t,i,r,n,o){for(var s=r.iconRotationAlignment,a=r.textRotationAlignment,l=r.iconTranslate,u=r.iconTranslateAnchor,c=r.textTranslate,h=r.textTranslateAnchor,d=0,p=0,f=e.colliders;p<f.length;p++){var y=f[p],_=0===y.partIndex?l:c,v=_[0],g=_[1],m=0===y.partIndex?u:h,b=y.minLod<=o&&o<=y.maxLod;d+=b?0:1,y.enabled=b,y.xScreen=y.xTile*n[0]+y.yTile*n[3]+n[6],y.yScreen=y.xTile*n[1]+y.yTile*n[4]+n[7],0===m?(y.xScreen+=i*v-t*g,y.yScreen+=t*v+i*g):(y.xScreen+=v,y.yScreen+=g),1===(0===y.partIndex?s:a)?(y.dxScreen=y.dxPixels,y.dyScreen=y.dyPixels):(y.dxScreen=i*(y.dxPixels+y.width/2)-t*(y.dyPixels+y.height/2)-y.width/2,y.dyScreen=t*(y.dxPixels+y.width/2)+i*(y.dyPixels+y.height/2)-y.height/2)}e.colliders.length>0&&d===e.colliders.length&&(e.unique.show=!1)}Object.defineProperty(t,"__esModule",{value:!0}),t.CollisionJob=void 0;var s=function(){function e(e,t,o,s,a,l){this._symbols=e,this._layers=s,this._zoom=a,this._currentLayerCursor=0,this._currentSymbolCursor=0,this._styleProps=new Map,this._allNeededMatrices=new Map,this._gridIndex=new n.GridIndex(t,o,r.COLLISION_GRID_CELL_SIZE),this._si=Math.sin(Math.PI*l/180),this._co=Math.cos(Math.PI*l/180);for(var u=0,c=e;u<c.length;u++)for(var h=0,d=c[u].symbols;h<d.length;h++){var p=d[h];this._allNeededMatrices.has(p.tile)||this._allNeededMatrices.set(p.tile,i.mat3f32.clone(p.tile.transforms.tileUnitsToPixels))}}return e.prototype.work=function(e){var t=this._gridIndex;function i(e){for(var i=e.xScreen+e.dxScreen,r=e.yScreen+e.dyScreen,n=i+e.width,o=r+e.height,s=t.getCellSpan(i,r,n,o),a=s[0],l=s[2],u=s[3],c=s[1];c<=u;c++)for(var h=a;h<=l;h++)for(var d=0,p=t.cells[c][h];d<p.length;d++){var f=p[d],y=f.xScreen+f.dxScreen,_=f.yScreen+f.dyScreen;if(!(n<y||i>y+f.width||o<_||r>_+f.height))return!0}return!1}for(var r=performance.now();this._currentLayerCursor<this._symbols.length;this._currentLayerCursor++,this._currentSymbolCursor=0)for(var n=this._symbols[this._currentLayerCursor],s=this._getProperties(n.layerIndex);this._currentSymbolCursor<n.symbols.length;this._currentSymbolCursor++){if(this._currentSymbolCursor%100==99&&performance.now()-r>e)return!1;var a=n.symbols[this._currentSymbolCursor];if(a.unique.show){o(a,this._si,this._co,s,this._allNeededMatrices.get(a.tile),this._zoom);var l=a.unique;if(l.show){for(var u=s.iconAllowOverlap,c=s.iconIgnorePlacement,h=s.textAllowOverlap,d=s.textIgnorePlacement,p=0,f=a.colliders;p<f.length;p++)(v=f[p]).enabled&&(g=l.parts[v.partIndex]).show&&!(v.partIndex?h:u)&&i(v)&&(v.hard?l.show=!1:g.show=!1);if(l.show)for(var y=0,_=a.colliders;y<_.length;y++){var v,g;if((v=_[y]).enabled&&!(v.partIndex?d:c)&&(g=l.parts[v.partIndex]).show)for(var m=v.xScreen+v.dxScreen,b=v.yScreen+v.dyScreen,w=this._gridIndex.getCellSpan(m,b,m+v.width,b+v.height),x=w[0],S=w[2],T=w[3],I=w[1];I<=T;I++)for(var O=x;O<=S;O++)this._gridIndex.cells[I][O].push(v)}}}}return!0},e.prototype._getProperties=function(e){var t=this._styleProps.get(e);if(t)return t;var i=this._zoom,r=this._layers[e],n=1===r.getLayoutValue("symbol-placement",i),o=r.getLayoutValue("icon-rotation-alignment",i);2===o&&(o=n?0:1);var s=r.getLayoutValue("text-rotation-alignment",i);2===s&&(s=n?0:1);var a=r.getPaintValue("icon-translate",i),l=r.getPaintValue("icon-translate-anchor",i),u=r.getPaintValue("text-translate",i),c=r.getPaintValue("text-translate-anchor",i),h={iconAllowOverlap:r.getLayoutValue("icon-allow-overlap",i),iconIgnorePlacement:r.getLayoutValue("icon-ignore-placement",i),textAllowOverlap:r.getLayoutValue("text-allow-overlap",i),textIgnorePlacement:r.getLayoutValue("text-ignore-placement",i),iconRotationAlignment:o,textRotationAlignment:s,iconTranslateAnchor:l,iconTranslate:a,textTranslateAnchor:c,textTranslate:u};return this._styleProps.set(e,h),h},e}();t.CollisionJob=s}).apply(null,r))||(e.exports=n)},YOjP:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("zOht"),i("pMLx"),i("M3W5"),i("f3JK")],void 0===(n=(function(e,t,i,r,n,o){"use strict";return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._fullCacheLodInfos=null,t._levelByScale={},t}return i.__extends(t,e),t.prototype.getTileParentId=function(e){var t=o.pool.acquire(e),i=0===t.level?null:o.getId(t.level-1,t.row>>1,t.col>>1,t.world);return o.pool.release(t),i},t.prototype.getTileCoverage=function(t,i,r){var n=e.prototype.getTileCoverage.call(this,t,i,r);if(!n)return n;var o=1<<n.lodInfo.level;return n.spans=n.spans.filter((function(e){return e.row>=0&&e.row<o})),n},t.prototype.scaleToLevel=function(e){if(this._fullCacheLodInfos||this._initializeFullCacheLODs(this._lodInfos),this._levelByScale[e])return this._levelByScale[e];var t=this._fullCacheLodInfos;if(e>t[0].scale)return t[0].level;for(var i=void 0,r=void 0,n=0;n<t.length-1;n++)if(e>(r=t[n+1]).scale)return(i=t[n]).level+(i.scale-e)/(i.scale-r.scale);return t[t.length-1].level},t.prototype._initializeFullCacheLODs=function(e){var t;t=0===e[0].level?e.map((function(e){return{level:e.level,resolution:e.resolution,scale:e.scale}})):r.create({size:this.tileInfo.size[0],spatialReference:this.tileInfo.spatialReference}).lods.map((function(e){return{level:e.level,resolution:e.resolution,scale:e.scale}}));for(var i=0;i<t.length;i++)this._levelByScale[t[i].scale]=t[i].level;this._fullCacheLodInfos=t},t}(n)}).apply(null,r))||(e.exports=n)},dLO5:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=(function(e,t){"use strict";function i(e,t,i,r,n,o){e.fillStyle=t,e.fillRect(i,r,n,o)}function r(e,t,i,r,n,o){e.strokeStyle=t,e.strokeRect(i,r,n,o)}function n(e,t){return""+Math.round(10*e)/10+t}Object.defineProperty(t,"__esModule",{value:!0}),t.perfElement=t.perfClear=t.perfAdd=t.drawColliders=t.drawGridIndex=void 0,t.drawGridIndex=function(e,t){e.strokeStyle="black";for(var i=t.cellSize,r=t.rows,n=t.columns,o=0;o<r;o++)for(var s=t.cells[o],a=o*i,l=(o+1)*i,u=0;u<n;u++){var c=s[u],h=u*i;e.strokeRect(h,a,(u+1)*i-h,l-a),e.fillText("cells:"+c.length,h+4,a+12)}},t.drawColliders=function(e,t){for(var n=window.COLLISION_XRAY,o=0;o<t.length;++o){var s=!t[o].unique.show;if(n||!s)for(var a=0,l=t[o].colliders;a<l.length;a++){var u=l[a];if(u.enabled){var c=!t[o].unique.parts[u.partIndex].show;if(n||!c){var h=u.xScreen,d=u.yScreen,p=u.dxScreen,f=u.dyScreen;e.globalAlpha=s||c?.2:1,i(e,"green",h-1,d-1,3,3),r(e,"red",h+p,d+f,u.width,u.height),i(e,"blue",h+p-1,d+f-1,3,3),e.globalAlpha=1}}}}},t.perfAdd=function(e,t,i){if(window.PERFORMANCE_RECORDING_STORAGE){var r=window.PERFORMANCE_RECORDING_STORAGE;r.perf=r.perf||{};var n=r.perf;n[e]=n[e]||{start:null,time:0,min:void 0,max:void 0,samples:[],unit:i},n[e].time+=t,n[e].samples.push(t),(null==n[e].min||t<n[e].min)&&(n[e].min=t),(null==n[e].max||t>n[e].max)&&(n[e].max=t)}},t.perfClear=function(){window.PERFORMANCE_RECORDING_STORAGE&&(window.PERFORMANCE_RECORDING_STORAGE.perf={})},t.perfElement=function(e){if(!window.PERFORMANCE_RECORDING_STORAGE){var t=document.createElement("div");return t.innerHTML="No recorded data is present because performance recording is disabled.",t}var i=document.createElement("div"),r="",o=window.PERFORMANCE_RECORDING_STORAGE.perf;r+='<table style="border-collapse: collapse;">',r+='<tr style="text-weight: bold; border-bottom: 1px solid "'+e+'";"><td>Name</td><td>Total</td><td>Runs</td><td>Average</td><td>Min</td><td>Distribution</td><td>Max</td><td>Histogram (50 bins)</td></tr>';var s=[];for(var a in o)s.push({name:a,value:o[a].time/o[a].samples.length,sortkey:o[a].max});s.sort((function(e,t){return-(e.sortkey-t.sortkey)}));for(var l=s.map((function(e){return e.name})),u=0,c=l;u<c.length;u++){var h=c[u];r+="<tr>",r+="<td>"+h+"</td>",r+="<td>"+n(o[h].time,o[h].unit)+"</td>",r+="<td>"+o[h].samples.length+"</td>",r+="<td>"+n(o[h].time/o[h].samples.length,o[h].unit)+"</td>",r+='<td style="text-align: right;">'+n(o[h].min,o[h].unit)+"</td>",r+="<td data-distribution='1'></td>",r+="<td>"+n(o[h].max,o[h].unit)+"</td>",r+="<td data-histogram='1'></td>",r+="</tr>"}i.innerHTML=r+="<table>";for(var d=i.querySelectorAll("td[data-distribution='1']"),p=i.querySelectorAll("td[data-histogram='1']"),f=0;f<d.length;f++){var y,_,v=d[f];if((y=document.createElement("canvas")).height=10,y.width=100,(_=y.getContext("2d")).strokeStyle=e,_.beginPath(),_.moveTo(0,5),_.lineTo(100,5),o[l[f]].max>o[l[f]].min+.001)for(var g=0,m=o[l[f]].samples;g<m.length;g++){var b=(m[g]-o[l[f]].min)/(o[l[f]].max-o[l[f]].min);_.moveTo(100*b,3),_.lineTo(100*b,7)}_.stroke(),_.strokeRect((s[f].value-o[l[f]].min)/(o[l[f]].max-o[l[f]].min)*100-2,0,4,9),v.appendChild(y),v=p[f];for(var w=new Array(50),x=0;x<w.length;x++)w[x]=0;for(var S=0,T=o[l[f]].samples;S<T.length;S++)w[O=1==(b=(T[S]-o[l[f]].min)/(o[l[f]].max-o[l[f]].min))?w.length-1:Math.floor(b*w.length)]++;(y=document.createElement("canvas")).height=30,y.width=120,(_=y.getContext("2d")).strokeStyle=e,_.fillStyle=e;for(var I=0,O=0;O<w.length;O++){var R=w[O];I=Math.max(I,R)}for(O=0;O<w.length;O++)_.fillRect(O*y.width/w.length,y.height*(1-(R=w[O])/I),y.width/w.length,y.height*(R/I));_.beginPath(),_.moveTo(0,y.height),_.lineTo(y.width,y.height),_.stroke(),v.appendChild(y)}var C=i.querySelectorAll("td");for(f=0;f<C.length;f++)C[f].style.padding="5px";return i}}).apply(null,r))||(e.exports=n)},fCqw:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("W6K4"),i("7Lgj"),i("f3JK")],void 0===(n=(function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TileManager=void 0;var o=function(e,t){return e+1/(1<<2*t)},s=function(){function e(e,t){this._tiles=new Map,this._tileCache=new i(40,(function(e){return e.dispose()})),this._viewSize=[0,0],this.acquireTile=e.acquireTile,this.releaseTile=e.releaseTile,this.tileInfoView=e.tileInfoView,this._container=t}return e.prototype.destroy=function(){this._tiles.clear(),this._tiles=null,this._tileCache.clear(),this._tileCache=null},e.prototype.update=function(e){var t=this;this._updateCacheSize(e);for(var i=this.tileInfoView.getTileCoverage(e.state,0,"smallest"),o=i.spans,s=i.lodInfo,a=s.level,l=new Set,u=new Set,c=0,h=o;c<h.length;c++)for(var d=h[c],p=d.row,f=d.colTo,y=d.colFrom;y<=f;y++){var _=n.getId(a,p,s.normalizeCol(y),s.getWorldForColumn(y)),v=this._getOrAcquireTile(_);l.add(_),v.hasData()?this._container.addChild(v):u.add(new n(_))}this._tiles.forEach((function(e,t){e.isCoverage=l.has(t)})),u.forEach((function(e){return t._findPlaceholdersForMissingTiles(e,l)}));var g=!1;return this._tiles.forEach((function(e,t){e.neededForCoverage=l.has(t),e.isHoldingForFade&&l.add(t),e.isFading&&(g=!0)})),this._tiles.forEach((function(e,i){l.has(i)||t._releaseTile(i)})),r.pool.release(i),!g},e.prototype.clearCache=function(){this._tileCache.clear()},e.prototype._findPlaceholdersForMissingTiles=function(e,t){var i=this,r=[];this._tiles.forEach((function(n){i._addPlaceholderChild(r,n,e,t)}));var n=r.reduce(o,0);Math.abs(1-n)<1e-6||this._addPlaceholderParent(e.id,t)},e.prototype._addPlaceholderChild=function(e,t,i,r){var n,o,s;t.key.level<=i.level||!t.hasData()||(n=i).row===(o=t.key).row>>(s=o.level-n.level)&&n.col===o.col>>s&&n.world===o.world&&(this._container.addChild(t),r.add(t.id),e.push(t.key.level-i.level))},e.prototype._addPlaceholderParent=function(e,t){for(var i=e;;){if(!(i=a(i))||t.has(i))return;var r=this._getTile(i);if(r&&r.hasData())return this._container.addChild(r),void t.add(r.id)}},e.prototype._getOrAcquireTile=function(e){var t=this._tiles.get(e);return t||((t=this._tileCache.pop(e))||(t=this.acquireTile(new n(e))),this._tiles.set(e,t),t)},e.prototype._getTile=function(e){var t=this._tiles.get(e);return t||((t=this._tileCache.pop(e))&&this._tiles.set(e,t),t)},e.prototype._releaseTile=function(e){var t=this._tiles.get(e);this.releaseTile(t),this._container.removeChild(t),this._tiles.delete(e),t.hasData()?this._tileCache.put(e,t,1):t.dispose()},e.prototype._updateCacheSize=function(e){var t=e.state.size;if(t[0]!==this._viewSize[0]||t[1]!==this._viewSize[1]){var i=Math.ceil(t[0]/512)+1,r=Math.ceil(t[1]/512)+1;this._viewSize[0]=t[0],this._viewSize[1]=t[1],this._tileCache.maxSize=5*i*r}},e}();function a(e){var t=e.split("/"),i=t[1],r=t[2],n=t[3],o=parseInt(t[0],10);return 0===o?null:o-1+"/"+(parseInt(i,10)>>1)+"/"+(parseInt(r,10)>>1)+"/"+parseInt(n,10)}t.TileManager=s}).apply(null,r))||(e.exports=n)},fdgu:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VTLUniqueSymbol=t.VTLSymbol=void 0,t.VTLSymbol=function(){this.xTile=0,this.yTile=0,this.hash=0,this.priority=1,this.colliders=[],this.textVertexRanges=[],this.iconVertexRanges=[]},t.VTLUniqueSymbol=function(){this.tileSymbols=[],this.parts=[{startTime:0,startOpacity:0,targetOpacity:0,show:!1},{startTime:0,startOpacity:0,targetOpacity:0,show:!1}],this.show=!1,this.visible=!0}}).apply(null,r))||(e.exports=n)},gi5q:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("zOht"),i("H1tY"),i("YX1r"),i("lgZd"),i("Brhx"),i("f3JK")],void 0===(n=(function(e,t,i,r,n,o,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TiledDisplayObject=void 0;var l=function(e){function t(t,i,r,n){void 0===n&&(n=r);var s=e.call(this)||this;return s.triangleCountReportedInDebug=0,s.transforms={dvs:o.mat3f32.create(),tileMat3:o.mat3f32.create()},s.triangleCount=0,s.key=new a(t),s.bounds=i,s.size=r,s.coordRange=n,s}return i.__extends(t,e),t.prototype.destroy=function(){this.texture&&(this.texture.dispose(),this.texture=null)},Object.defineProperty(t.prototype,"coords",{get:function(){return this._coords},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bounds",{get:function(){return this._bounds},set:function(e){this._coords=[e[0],e[3]],this._bounds=e},enumerable:!1,configurable:!0}),t.prototype.setTransform=function(e,t){r("esri-2d-debug")&&null==t&&console.debug("Tried to set tile transform but lod resolution was null");var i=t/(e.resolution*e.pixelRatio),o=this.transforms.tileMat3,s=e.toScreenNoRotation([0,0],this.coords);n.mat3.set(o,this.size[0]/this.coordRange[0]*i,0,0,0,this.size[1]/this.coordRange[1]*i,0,s[0],s[1],1),n.mat3.multiply(this.transforms.dvs,e.displayViewMat3,o)},t}(s.DisplayObject);t.TiledDisplayObject=l}).apply(null,r))||(e.exports=n)},mFzi:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("DJpR"),i("VIUv"),i("6cAc")],void 0===(n=(function(e,t,i,r,n){"use strict";return function(){function e(e,t,i){void 0===i&&(i=0),this._size=[],this._mosaicsData=[],this._textures=[],this._dirties=[],this._maxItemSize=0,this._currentPage=0,this._pageWidth=0,this._pageHeight=0,this._mosaicRects={},this.pixelRatio=1,(e<=0||t<=0)&&console.error("Sprites mosaic defaultWidth and defaultHeight must be greater than zero!"),this._pageWidth=e,this._pageHeight=t,i>0&&(this._maxItemSize=i),this._binPack=new r(e-4,t-4)}return e.prototype.getWidth=function(e){return e>=this._size.length?-1:this._size[e][0]},e.prototype.getHeight=function(e){return e>=this._size.length?-1:this._size[e][1]},e.prototype.setSpriteSource=function(e){if(this.dispose(),this.pixelRatio=e.devicePixelRatio,0===this._mosaicsData.length){this._binPack=new r(this._pageWidth-4,this._pageHeight-4);var t=Math.floor(this._pageWidth),i=Math.floor(this._pageHeight),n=new Uint32Array(t*i);this._mosaicsData[0]=n,this._dirties.push(!0),this._size.push([this._pageWidth,this._pageHeight]),this._textures.push(void 0)}this._sprites=e},e.prototype.getSpriteItem=function(e,t){void 0===t&&(t=!1);var i=this._mosaicRects[e];if(i)return i;if(!this._sprites||"loaded"!==this._sprites.loadStatus)return null;var r=this._sprites.getSpriteInfo(e);if(!r||!r.width||!r.height||r.width<0||r.height<0)return null;var n=r.width,o=r.height,s=this._allocateImage(n,o),a=s[0],l=s[1];return a.width<=0?null:(this._copy(a,r,l,s[2],t),this._mosaicRects[e]=i={rect:a,width:n,height:o,sdf:r.sdf,simplePattern:!1,pixelRatio:r.pixelRatio,page:l},i)},e.prototype.preloadSpriteItems=function(){for(var e=0,t=this._sprites.spriteNames;e<t.length;e++)this.getSpriteItem(t[e],!0)},e.prototype.getSpriteItems=function(e){for(var t={},i=0,r=e;i<r.length;i++){var n=r[i];t[n]=this.getSpriteItem(n)}return t},e.prototype.getMosaicItemPosition=function(e,t){var i=this.getSpriteItem(e,t),r=i&&i.rect;if(!r)return null;r.width=i.width,r.height=i.height;var n=this._size[i.page];return{size:[i.width,i.height],tl:[(r.x+2)/n[0],(r.y+2)/n[1]],br:[(r.x+2+i.width)/n[0],(r.y+2+i.height)/n[1]],page:i.page}},e.prototype.bind=function(e,t,r,n){void 0===r&&(r=0),void 0===n&&(n=0),this._textures[r]||(this._textures[r]=new i.Texture(e,{pixelFormat:6408,dataType:5121,wrapMode:33071,width:this._size[r][0],height:this._size[r][1]},new Uint8Array(this._mosaicsData[r].buffer)));var o=this._textures[r];o.setSamplingMode(t),this._dirties[r]&&o.setData(new Uint8Array(this._mosaicsData[r].buffer)),e.bindTexture(o,n),this._dirties[r]=!1},e._copyBits=function(e,t,i,r,n,o,s,a,l,u,c){var h=r*t+i,d=a*o+s;if(c){d-=o;for(var p=-1;p<=u;h=((++p+u)%u+r)*t+i,d+=o)for(var f=-1;f<=l;f++)n[d+f]=e[h+(f+l)%l]}else for(p=0;p<u;p++){for(f=0;f<l;f++)n[d+f]=e[h+f];h+=t,d+=o}},e.prototype._copy=function(t,i,r,n,o,s){if(this._sprites&&"loaded"===this._sprites.loadStatus&&!(r>=this._mosaicsData.length)){var a=new Uint32Array(s?s.buffer:this._sprites.image.buffer),l=this._mosaicsData[r];l&&a||console.error("Source or target images are uninitialized!"),e._copyBits(a,s?i.width:this._sprites.width,i.x,i.y,l,n[0],t.x+2,t.y+2,i.width,i.height,o),this._dirties[r]=!0}},e.prototype._allocateImage=function(e,t){e+=2,t+=2;var i=Math.max(e,t);if(this._maxItemSize&&this._maxItemSize<i){var o=new n.default(0,0,e,t);return this._mosaicsData.push(new Uint32Array(e*t)),this._dirties.push(!0),this._size.push([e,t]),this._textures.push(void 0),[o,this._mosaicsData.length-1,[e,t]]}var s=e%4?4-e%4:4,a=t%4?4-t%4:4;1===s&&(s=5),1===a&&(a=5);var l=this._binPack.allocate(e+s,t+a);return l.width<=0?(this._dirties[this._currentPage]||(this._mosaicsData[this._currentPage]=null),this._currentPage=this._mosaicsData.length,this._mosaicsData.push(new Uint32Array(this._pageWidth*this._pageHeight)),this._dirties.push(!0),this._size.push([this._pageWidth,this._pageHeight]),this._textures.push(void 0),this._binPack=new r(this._pageWidth-4,this._pageHeight-4),this._allocateImage(e,t)):[l,this._currentPage,[this._pageWidth,this._pageHeight]]},e.prototype.dispose=function(){this._binPack=null,this._mosaicRects={};for(var e=0,t=this._textures;e<t.length;e++){var i=t[e];i&&i.dispose()}this._textures.length=0},e}()}).apply(null,r))||(e.exports=n)},ooFS:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("LxLY"),i("2JW5")],void 0===(n=(function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SymbolRepository=void 0;var n=function(){function e(e,t,i){this.tileCoordRange=e,this._tileForest=t,this._createUnique=i,this._tiles=new Map,this._uniqueSymbolsReferences=new Map}return Object.defineProperty(e.prototype,"uniqueSymbols",{get:function(){return i.isNone(this._uniqueSymbolLayerArray)&&(this._uniqueSymbolLayerArray=this._createUniqueSymbolLayerArray()),this._uniqueSymbolLayerArray},enumerable:!1,configurable:!0}),e.prototype.addTile=function(e,t){var i,n=this;void 0===t&&(t=!0),this._uniqueSymbolLayerArray=null,t?this._tiles.set(e,i={flatLatestSymbols:null,indexedLatestSymbols:null}):(i=this._tiles.get(e),this._removeSymbols(i.flatLatestSymbols));var o=e.symbols;o.forEach((function(t){for(var i=0,r=t;i<r.length;i++)r[i].tile=e}));var s=new Map;o.forEach((function(e,t){var i=e.length;if(i>=32){var o=n.tileCoordRange;do{o/=2,i/=4}while(i>8&&o>64);var a=new r.GridIndex(n.tileCoordRange,n.tileCoordRange,o);s.set(t,a);for(var l=0,u=e;l<u.length;l++){var c=u[l];a.getCell(c.xTile,c.yTile).push(c)}}})),i.flatLatestSymbols=o,i.indexedLatestSymbols=s,this._addSymbols(e.key,o)},e.prototype.removeTile=function(e){this._uniqueSymbolLayerArray=null,this._removeSymbols(e.symbols),this._tiles.delete(e)},e.prototype._removeSymbols=function(e){var t=this;e.forEach((function(e,i){for(var r=0,n=e;r<n.length;r++){for(var o=n[r],s=o.unique,a=s.tileSymbols,l=a.length-1,u=0;u<l;u++)if(a[u]===o){a[u]=a[l];break}if(a.length=l,0===l){var c=t._uniqueSymbolsReferences.get(i);c.delete(s),0===c.size&&t._uniqueSymbolsReferences.delete(i)}o.unique=null,o.tile=null}}))},e.prototype._addSymbols=function(e,t){var r=this;if(0!==t.size){for(var n=0,o=this._tileForest.getRoots();n<o.length;n++){var s=o[n];s.key.world===e.world&&(s.key.level!==e.level||s.key.equals(e))&&this._matchSymbols(s,e,t)}t.forEach((function(e,t){for(var n=0,o=e;n<o.length;n++){var s=o[n];if(i.isNone(s.unique)){var a=r._createUnique();s.unique=a,a.tileSymbols.push(s);var l=r._uniqueSymbolsReferences.get(t);l||(l=new Set,r._uniqueSymbolsReferences.set(t,l)),l.add(a)}}}))}},e.prototype._matchSymbols=function(e,t,i){var n=this;if(e.key.level>t.level){var o=e.key.level-t.level;if(e.key.row>>o!==t.row||e.key.col>>o!==t.col)return}if(!(t.level>e.key.level)||t.row>>(o=t.level-e.key.level)===e.key.row&&t.col>>o===e.key.col)if(t.equals(e.key))for(var s=0,a=this._tileForest.getChildren(e);s<a.length;s++){var l=a[s];this._matchSymbols(l,t,i)}else{var u=new Map;i.forEach((function(i,o){for(var s=[],a=0,l=i;a<l.length;a++){var c=l[a],h=r.tileCoordChange(n.tileCoordRange,c.xTile,t.level,t.col,e.key.level,e.key.col),d=r.tileCoordChange(n.tileCoordRange,c.yTile,t.level,t.row,e.key.level,e.key.row);h>=0&&h<n.tileCoordRange&&d>=0&&d<n.tileCoordRange&&s.push({symbol:c,xTransformed:h,yTransformed:d})}var p=[],f=e.key.level<t.level?1:1<<e.key.level-t.level,y=n._tiles.get(e),_=y.flatLatestSymbols.get(o);if(_)for(var v=y.indexedLatestSymbols.get(o),g=0,m=s;g<m.length;g++){var b,w=m[g],x=!1,S=w.xTransformed,T=w.yTransformed;b=v?v.getCell(S,T):_;for(var I=(c=w.symbol).hash,O=0,R=b;O<R.length;O++){var C=R[O];if(I===C.hash&&Math.abs(S-C.xTile)<=f&&Math.abs(T-C.yTile)<=f){var D=C.unique;c.unique=D,D.tileSymbols.push(c),x=!0;break}}x||p.push(c)}p.length>0&&u.set(o,p)}));for(var c=0,h=this._tileForest.getChildren(e);c<h.length;c++)this._matchSymbols(l=h[c],t,u)}},e.prototype._createUniqueSymbolLayerArray=function(){var e=new Array(this._uniqueSymbolsReferences.size),t=0;return this._uniqueSymbolsReferences.forEach((function(i,r){var n=[];i.forEach((function(e){n.push(e)})),e[t]={layerIndex:r,uniqueSymbols:n},t++})),e},e}();t.SymbolRepository=n}).apply(null,r))||(e.exports=n)},suOV:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("zp6E"),i("H1tY"),i("v7zm"),i("qMld")],void 0===(n=(function(e,t,i,r,n,o){"use strict";var s=function(){function e(e){if(this._metrics=[],this._bitmaps=[],e)for(;e.next();)switch(e.tag()){case 1:for(var t=e.getMessage();t.next();)switch(t.tag()){case 3:for(var i=t.getMessage(),r=void 0,n=void 0,o=void 0,s=void 0,a=void 0,l=void 0,u=void 0;i.next();)switch(i.tag()){case 1:r=i.getUInt32();break;case 2:n=i.getBytes();break;case 3:o=i.getUInt32();break;case 4:s=i.getUInt32();break;case 5:a=i.getSInt32();break;case 6:l=i.getSInt32();break;case 7:u=i.getUInt32();break;default:i.skip()}i.release(),r&&(this._metrics[r]={width:o,height:s,left:a,top:l,advance:u},this._bitmaps[r]=n);break;default:t.skip()}t.release();break;default:e.skip()}}return e.prototype.getMetrics=function(e){return this._metrics[e]},e.prototype.getBitmap=function(e){return this._bitmaps[e]},e}(),a=function(){function e(){this._ranges=[]}return e.prototype.getRange=function(e){return this._ranges[e]},e.prototype.addRange=function(e,t){this._ranges[e]=t},e}();return function(){function e(e){this._glyphInfo={},this._baseURL=e}return e.prototype.getRange=function(e,t){var a=this._getFontStack(e);if(r("stable-symbol-rendering")&&t>0)return a.addRange(t,new s),o.resolve();if(a.getRange(t))return o.resolve();var l=256*t,u=l+255,c=this._baseURL.replace("{fontstack}",e).replace("{range}",l+"-"+u);return i(c,{responseType:"array-buffer"}).then((function(e){a.addRange(t,new s(new n(new Uint8Array(e.data),new DataView(e.data))))})).catch((function(){a.addRange(t,new s)}))},e.prototype.getGlyph=function(e,t){var i=this._getFontStack(e);if(i){var r=Math.floor(t/256);if(!(r>256)){var n=i.getRange(r);if(n)return{metrics:n.getMetrics(t),bitmap:n.getBitmap(t)}}}},e.prototype._getFontStack=function(e){var t=this._glyphInfo[e];return t||(t=this._glyphInfo[e]=new a),t},e}()}).apply(null,r))||(e.exports=n)},ts8o:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("zOht"),i("TMur"),i("Vx27"),i("YADd"),i("Lzvl"),i("ZMIQ")],void 0===(n=(function(e,t,i,r,n,o,s,a){"use strict";var l={base:o,key:"type",typeMap:{extent:r.Extent,polygon:r.Polygon}};return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="geometry",t.geometry=null,t}var r;return i.__extends(t,e),r=t,Object.defineProperty(t.prototype,"version",{get:function(){return(this._get("version")||0)+1},enumerable:!1,configurable:!0}),t.prototype.clone=function(){return new r({geometry:this.geometry.clone()})},i.__decorate([n.property({types:l,json:{read:s.fromJSON,write:!0}})],t.prototype,"geometry",void 0),i.__decorate([n.property({readOnly:!0,dependsOn:["geometry"]})],t.prototype,"version",null),r=i.__decorate([n.subclass("esri.views.layers.support.Geometry")],t)}(a)}).apply(null,r))||(e.exports=n)},"uf/D":function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("zOht"),i("LxLY"),i("qMld"),i("lRq4"),i("dLO5"),i("PQCn"),i("JNkf"),i("wUCb"),i("gi5q"),i("7Lgj"),i("f3JK")],void 0===(n=(function(e,t,i,r,n,o,s,a,l,u,c,h,d){"use strict";function p(e,t){if(e){var i=e.getLayoutProperty("visibility");if(!i||"none"!==i.getValue()&&(void 0===e.minzoom||e.minzoom<t+1e-6)&&(void 0===e.maxzoom||e.maxzoom>=t-1e-6))return!0}return!1}Object.defineProperty(t,"__esModule",{value:!0}),t.VectorTileContainer=void 0;var f=function(e){function t(t){var i=e.call(this,t)||this;return i._backgroundTiles=[],i._pointToCallbacks=new Map,i._fading=!1,i}return i.__extends(t,e),t.prototype.destroy=function(){this.removeAllChildren(),this.children.forEach((function(e){return e.destroy()})),this._spriteMosaic&&this._spriteMosaic.dispose(),this._glyphMosaic&&this._glyphMosaic.dispose()},t.prototype.setStyleResources=function(e,t,i){var n=this;if(this._spriteMosaic=e,this._glyphMosaic=t,this._styleRepository=i,r.isNone(this._symbolFader)){var o=new a.SymbolFader(this._styleRepository.layers);o.on("fade-start",(function(){n.emit("fade-start"),n._fading=!0,n.requestRender()})),o.on("fade-complete",(function(){n.emit("fade-complete"),n._fading=!1,n.requestRender()})),this._symbolFader=o}r.unwrap(this._symbolFader).layers=i.layers},t.prototype.hitTest=function(e,t){return i.__awaiter(this,void 0,void 0,(function(){var r,o;return i.__generator(this,(function(i){return r=[e,t],o=n.createResolver(),this._pointToCallbacks.set(r,o),this.requestRender(),[2,o.promise]}))}))},t.prototype.enterTileInvalidation=function(){for(var e=0,t=this.children;e<t.length;e++)t[e].invalidating=!0},t.prototype.createRenderParams=function(t){return i.__assign(i.__assign({},e.prototype.createRenderParams.call(this,t)),{renderPass:null,styleLayer:null,styleLayerId:-1,glyphMosaic:this._glyphMosaic,spriteMosaic:this._spriteMosaic,hasClipping:!!this._clippingInfos})},t.prototype.doRender=function(t){!this.visible||t.drawPhase!==l.WGLDrawPhase.MAP&&t.drawPhase!==l.WGLDrawPhase.DEBUG||void 0===this._spriteMosaic||e.prototype.doRender.call(this,t)},t.prototype.addChild=function(t){return e.prototype.addChild.call(this,t),r.isSome(this._symbolFader)?this._symbolFader.addTile(t):t.decluttered=!0,this.requestRender(),t},t.prototype.removeChild=function(t){return r.isSome(this._symbolFader)&&this._symbolFader.removeTile(t),this.requestRender(),e.prototype.removeChild.call(this,t)},t.prototype.renderChildren=function(t){if(t.drawPhase!==l.WGLDrawPhase.DEBUG){if(this._doRender(t),this._pointToCallbacks.size>0){var i=t.context,r=i.getBoundFramebufferObject();t.drawPhase=l.WGLDrawPhase.HITTEST;var n=t.painter.effects.hittest;n.bind(t),this._doRender(t),n.draw(t,this._pointToCallbacks,6),i.bindFramebuffer(r)}}else e.prototype.renderChildren.call(this,t)},t.prototype.removeAllChildren=function(){for(var t=0;t<this.children.length;t++){var i=this.children[t];r.isSome(this._symbolFader)&&this._symbolFader.removeTile(i),i.dispose()}e.prototype.removeAllChildren.call(this)},t.prototype.getStencilTarget=function(){return this.children.filter((function(e){return e.neededForCoverage}))},t.prototype.restartDeclutter=function(){r.isSome(this._symbolFader)&&this._symbolFader.restartDeclutter()},t.prototype._doRender=function(t){var i,n,o,a=t.context,u=this._styleRepository,c=u.layers,h=!0;t.drawPhase===l.WGLDrawPhase.HITTEST&&(h=!1),u.backgroundBucketIds.length>0&&(t.renderPass="background",this._renderBackgroundLayers(t,u.backgroundBucketIds)),e.prototype.renderChildren.call(this,t);var d=this.children.filter((function(e){return e.visible}));if(d&&0!==d.length){for(var p=0,f=d;p<f.length;p++)f[p].triangleCount=0;a.setStencilWriteMask(0),a.setColorMask(!0,!0,!0,!0),a.setStencilOp(7680,7680,7681),a.setStencilTestEnabled(!0),a.setBlendingEnabled(!1),a.setDepthTestEnabled(!0),a.setDepthWriteEnabled(!0),a.setDepthFunction(515),a.setClearDepth(1),a.clear(a.gl.DEPTH_BUFFER_BIT),t.renderPass="opaque";for(var y=c.length-1;y>=0;y--)this._renderStyleLayer(y,t,d);for(a.setDepthWriteEnabled(!1),a.setBlendingEnabled(h),a.setBlendFunctionSeparate(1,771,1,771),t.renderPass="translucent",y=0;y<c.length;y++)this._renderStyleLayer(y,t,d);for(a.setDepthTestEnabled(!1),t.renderPass="symbol",y=0;y<c.length;y++)this._renderStyleLayer(y,t,d);if(a.bindVAO(),a.setStencilTestEnabled(!0),a.setBlendingEnabled(!0),t.drawPhase===l.WGLDrawPhase.MAP){this._fade(t.displayLevel,t.state);var _=window.COLLISION_DEBUG_CTX;if(_&&r.isSome(this._symbolFader)&&(_.clearRect(0,0,_.canvas.width,_.canvas.height),!this._fading||window.COLLISION_XRAY))for(var v=function(e){if(e.symbols){var t=[];if(e.symbols.forEach((function(e){t.push.apply(t,e)})),window.COLLISION_SHOW_GRID){var r=null===(o=null===(n=null===(i=g._symbolFader)||void 0===i?void 0:i._symbolDeclutterer)||void 0===n?void 0:n._collisionJob)||void 0===o?void 0:o._gridIndex;r&&s.drawGridIndex(_,r)}s.drawColliders(_,t)}},g=this,m=0,b=this.children;m<b.length;m++)v(b[m])}}},t.prototype._fade=function(e,t){r.isSome(this._symbolFader)&&(this._symbolFader.update(e,t)||this.requestRender())},t.prototype._renderStyleLayer=function(e,t,i){var r=t.painter,n=t.renderPass,o=this._styleRepository.layers[e];if(void 0!==o){var s;switch(o.type){case 0:return;case 1:if("opaque"!==n&&"translucent"!==t.renderPass)return;s="vtlFill";break;case 2:if("translucent"!==n)return;s="vtlLine";break;case 4:if("symbol"!==n)return;s="vtlCircle";break;case 3:if("symbol"!==n)return;s="vtlSymbol"}if(i=i.filter(3===o.type?function(e){return e.decluttered}:function(e){return e.neededForCoverage}),"vtlSymbol"!==s){var a=t.displayLevel;if(0===i.length||void 0!==o.minzoom&&o.minzoom>=a+1e-6||void 0!==o.maxzoom&&o.maxzoom<a-1e-6)return}t.styleLayerId=e,t.styleLayer=o;for(var l=0,u=i;l<u.length;l++)if(u[l].layerData[e]){r.renderObjects(t,i,s);break}}},t.prototype._renderBackgroundLayers=function(e,t){for(var i=e.context,n=e.displayLevel,s=e.painter,a=e.state,u=this._styleRepository,f=!1,y=0,_=t;y<_.length;y++){var v=_[y];if(p(u.layers[v],n)){f=!0;break}}if(f){var g=this._tileInfoView.getTileCoverage(e.state,0,"smallest"),m=g.spans,b=g.lodInfo,w=b.level,x=o.create(),S=[];if(this._renderPasses){var T=this._renderPasses[0];r.isSome(this._clippingInfos)&&(T.brushes[0].prepareState(e,this._clippingInfos[0]),T.brushes[0].drawMany(e,this._clippingInfos))}for(var I,O=this._backgroundTiles,R=0,C=0,D=m;C<D.length;C++)for(var P=D[C],M=P.row,A=P.colTo,V=P.colFrom;V<=A;V++){if(R<O.length)(I=O[R]).key.set(w,M,b.normalizeCol(V),b.getWorldForColumn(V)),this._tileInfoView.getTileBounds(x,I.key,!1),I.bounds=x,I.coords[0]=x[0],I.coords[1]=x[3];else{var k=new d(w,M,b.normalizeCol(V),b.getWorldForColumn(V));I=new c.TiledDisplayObject(k,this._tileInfoView.getTileBounds(o.create(),k),[512,512],[4096,4096]),O.push(I)}I.setTransform(a,this._tileInfoView.getTileResolution(I.key)),S.push(I),R++}i.setStencilWriteMask(0),i.setColorMask(!0,!0,!0,!0),i.setStencilOp(7680,7680,7681),i.setStencilFunction(514,0,255);var L=!0;e.drawPhase===l.WGLDrawPhase.HITTEST&&(L=!1),i.setStencilTestEnabled(L);for(var j=0,B=t;j<B.length;j++){var z=u.layers[v=B[j]];p(z,n)&&(e.styleLayerId=v,e.styleLayer=z,s.renderObjects(e,S,"vtlBackground"))}h.pool.release(g)}},t}(u.default);t.VectorTileContainer=f}).apply(null,r))||(e.exports=n)},wUCb:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("zOht"),i("JNkf"),i("/U66"),i("66cO"),i("p2sx")],void 0===(n=(function(e,t,i,r,n,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sortByLevel=void 0,t.sortByLevel=function(e,t){return e.key.level-t.key.level!=0?e.key.level-t.key.level:e.key.row-t.key.row!=0?e.key.row-t.key.row:e.key.col-t.key.col};var a=function(e){function n(t){var i=e.call(this)||this;return i._tileInfoView=t,i}return i.__extends(n,e),n.prototype.renderChildren=function(i){this.sortChildren(t.sortByLevel),this.setStencilReference(),e.prototype.renderChildren.call(this,i)},n.prototype.createRenderParams=function(t){var r=t.state;return i.__assign(i.__assign({},e.prototype.createRenderParams.call(this,t)),{requiredLevel:this._tileInfoView.getClosestInfoForScale(r.scale).level,displayLevel:this._tileInfoView.tileInfo.scaleToZoom(r.scale)})},n.prototype.prepareRenderPasses=function(t){var n=this,a=t.registerRenderPass({name:"stencil",brushes:[s.default],drawPhase:r.WGLDrawPhase.DEBUG|r.WGLDrawPhase.MAP,target:function(){return n.getStencilTarget()}}),l=t.registerRenderPass({name:"tileInfo",brushes:[o.default],drawPhase:r.WGLDrawPhase.DEBUG,target:function(){return n.children},has:"esri-tiles-debug"});return i.__spreadArrays(e.prototype.prepareRenderPasses.call(this,t),[a,l])},n.prototype.getStencilTarget=function(){return this.children},n.prototype.updateTransforms=function(e){for(var t=0,i=this.children;t<i.length;t++){var r=i[t],n=this._tileInfoView.getTileResolution(r.key);r.setTransform(e,n)}},n.prototype.setStencilReference=function(){for(var e=1,t=0,i=this.children;t<i.length;t++)i[t].stencilRef=e++},n}(n.default);t.default=a}).apply(null,r))||(e.exports=n)},xkJJ:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("zOht"),i("jZlN"),i("ma1f"),i("eIBl"),i("qsST"),i("qMld"),i("Vx27"),i("lRq4"),i("BEij"),i("fCqw"),i("VjU6"),i("uf/D"),i("6i4F"),i("YOjP"),i("EBSo"),i("WsO6")],void 0===(n=(function(e,t,i,r,n,o,s,a,l,u,c,h,d,p,f,y,_,v){"use strict";var g=s.getLogger("esri.views.2d.layers.VectorTileLayerView2D");return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._handles=new o,t._fetchQueue=null,t._parseQueue=null,t._isTileHandlerPromiseFulfilled=!1,t.fading=!1,t}return i.__extends(t,e),t.prototype.initialize=function(){var e=this,t=this.layer.tileInfo;(t&&t.spatialReference).equals(this.view.spatialReference)?(this._tileInfoView=new y(this.layer.tileInfo,this.layer.fullExtent),this._vectorTileContainer=new p.VectorTileContainer(this._tileInfoView),this._tileHandler=new c.TileHandler(this.layer,window.devicePixelRatio||1,null),this.container.addChild(this._vectorTileContainer),this.handles.add([this._vectorTileContainer.on("updating-change",(function(){return e.notifyChange("updating")})),this.watch("layer.currentStyleInfo",(function(){return e._start()})),this._vectorTileContainer.on("fade-start",(function(){e.fading=!0})),this._vectorTileContainer.on("fade-complete",(function(){e.fading=!1,e.requestUpdate()}))])):this.addResolvingPromise(a.reject(new n("layerview:spatial-reference-incompatible","The spatial reference of this layer does not meet the requirements of the view",{layer:this.layer})))},t.prototype.destroy=function(){var e,t;this._stop(),this.container.removeAllChildren(),null===(e=this._vectorTileContainer)||void 0===e||e.destroy(),this._vectorTileContainer=null,null===(t=this._tileHandler)||void 0===t||t.destroy(),this._tileHandler=null},t.prototype.hitTest=function(e,t){return i.__awaiter(this,void 0,void 0,(function(){var n,o,s,a;return i.__generator(this,(function(i){switch(i.label){case 0:return this.suspended||!this._tileHandlerPromise?[2,null]:[4,this._tileHandlerPromise];case 1:return i.sent(),[4,this._vectorTileContainer.hitTest(e,t)];case 2:return(n=i.sent())&&0!==n.length?(o=n[0]-1,s=this._tileHandler.getStyleRepository().layers,o>=s.length?[2,null]:((a=new r({attributes:{layerId:o,layerName:s[o].id}})).layer=this.layer,a.sourceLayer=this.layer,[2,a])):[2,null]}}))}))},t.prototype.update=function(e){if(this._tileHandlerPromise&&this._isTileHandlerPromiseFulfilled){if(e.pixelRatio!==this._tileHandler.devicePixelRatio)return this._start(),void(this._tileHandler.devicePixelRatio=e.pixelRatio);this._fetchQueue.pause(),this._parseQueue.pause(),this._fetchQueue.state=e.state,this._parseQueue.state=e.state,this._tileManager.update(e)||this.requestUpdate(),this._parseQueue.resume(),this._fetchQueue.resume()}},t.prototype.attach=function(){var e=this;this._start(),this._handles.add([this.layer.on("paint-change",(function(){e._vectorTileContainer.restartDeclutter(),e._vectorTileContainer.requestRender()})),this.layer.on("layout-change",(function(){e._vectorTileContainer.enterTileInvalidation(),e._issueStyleInvalidation(),e.notifyChange("updating"),e.requestUpdate()}))])},t.prototype.detach=function(){this._stop(),this._handles.removeAll()},t.prototype.moveStart=function(){this.requestUpdate()},t.prototype.viewChange=function(){this.requestUpdate()},t.prototype.moveEnd=function(){this.requestUpdate()},t.prototype.canResume=function(){var t=e.prototype.canResume.call(this),i=this.layer;if(t&&i.currentStyleInfo){var r=this.view.scale,n=i.currentStyleInfo;if(n&&n.layerDefinition){var o=n.layerDefinition;o.minScale&&o.minScale<r&&(t=!1),o.maxScale&&o.maxScale>r&&(t=!1)}}return t},t.prototype.isUpdating=function(){var e,t,i,r,n=this._vectorTileContainer.children;return!this._isTileHandlerPromiseFulfilled||null!==(t=null===(e=this._fetchQueue)||void 0===e?void 0:e.updating)&&void 0!==t&&t||null!==(r=null===(i=this._parseQueue)||void 0===i?void 0:i.updating)&&void 0!==r&&r||n.length>0&&n.filter((function(e){return e.invalidating})).length>0||this.fading},t.prototype.acquireTile=function(e){var t=this,i=this._createVectorTile(e);return this._tileHandlerPromise.then((function(){t.notifyChange("updating"),t.updateTile(i)})),i},t.prototype.updateTile=function(e){var t=this;e.key&&this._fetchQueue.push(e.key).then((function(i){return t._parseQueue.push({key:e.key,data:i})})).then((function(i){e.once("attach",(function(){return t.requestUpdate()})),i&&(e.setData(i.tileData),t.requestUpdate(),t.notifyChange("updating"))})).catch((function(e){t.notifyChange("updating"),a.isAbortError(e)||g.error(e)}))},t.prototype.releaseTile=function(e){var t=e.key.id;this._fetchQueue.abort(t),this._parseQueue.abort(t),this.requestUpdate()},t.prototype._start=function(){var e=this;if(this._stop(),this._tileManager=new h.TileManager({acquireTile:function(t){return e.acquireTile(t)},releaseTile:function(t){return e.releaseTile(t)},tileInfoView:this._tileInfoView},this._vectorTileContainer),this.layer.currentStyleInfo){var t=new AbortController,i=this._tileHandler.start({signal:t.signal}).then((function(){e._fetchQueue=new _({tileInfoView:e._tileInfoView,process:function(t,i){return e._getTileData(t,i)},concurrency:15}),e._parseQueue=new _({tileInfoView:e._tileInfoView,process:function(t,i){return e._parseTileData(t,i)},concurrency:8}),e.requestUpdate(),e._isTileHandlerPromiseFulfilled=!0}));this._tileHandler.spriteMosaic.then((function(t){e._vectorTileContainer.setStyleResources(t,e._tileHandler.glyphMosaic,e.layer.styleRepository),e.requestUpdate()})),this._tileHandlerAbortController=t,this._tileHandlerPromise=i}},t.prototype._stop=function(){if(this._tileHandlerAbortController&&this._vectorTileContainer){var e=this._tileHandlerAbortController;e&&e.abort(),this._tileHandlerPromise=null,this._isTileHandlerPromiseFulfilled=!1,this._fetchQueue&&(this._fetchQueue.destroy(),this._fetchQueue=null),this._parseQueue&&(this._parseQueue.destroy(),this._parseQueue=null),this._tileManager&&(this._tileManager.destroy(),this._tileManager=null),this._vectorTileContainer.removeAllChildren()}},t.prototype._getTileData=function(e,t){return i.__awaiter(this,void 0,void 0,(function(){var r;return i.__generator(this,(function(i){switch(i.label){case 0:return[4,this._tileHandler.fetchTileData(e,t)];case 1:return r=i.sent(),this.notifyChange("updating"),[2,r]}}))}))},t.prototype._parseTileData=function(e,t){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(i){return[2,this._tileHandler.parseTileData(e,t)]}))}))},t.prototype._issueStyleInvalidation=function(){var e=this;this.notifyChange("updating"),this._tileHandlerAbortController.abort(),this._tileHandlerAbortController=a.createAbortController();var t=this._tileHandlerAbortController.signal;this._tileHandlerPromise=this._tileHandler.updateStyle().then((function(){t.aborted||e._tileHandler.spriteMosaic.then((function(i){t.aborted||(e._vectorTileContainer.setStyleResources(i,e._tileHandler.glyphMosaic,e.layer.styleRepository),e._updateTiles())}))}))},t.prototype._updateTiles=function(){this._tileManager.clearCache(),this._fetchQueue.pause(),this._parseQueue.pause(),this._fetchQueue.clear(),this._parseQueue.clear();for(var e=0,t=this._vectorTileContainer.children;e<t.length;e++)this.updateTile(t[e]);this._parseQueue.resume(),this._fetchQueue.resume(),this.notifyChange("updating"),this.requestUpdate()},t.prototype._createVectorTile=function(e){var t=this._tileInfoView.getTileBounds(u.create(),e);return new d.VectorTile(e,this.layer.styleRepository,t,[512,512])},i.__decorate([l.property()],t.prototype,"_fetchQueue",void 0),i.__decorate([l.property()],t.prototype,"_parseQueue",void 0),i.__decorate([l.property()],t.prototype,"_isTileHandlerPromiseFulfilled",void 0),i.__decorate([l.property({dependsOn:["view.scale","layer.currentStyleInfo"]})],t.prototype,"suspended",void 0),i.__decorate([l.property()],t.prototype,"fading",void 0),i.__decorate([l.property({dependsOn:["_isTileHandlerPromiseFulfilled","_parseQueue.updating","_parseQueue.updating","fading"]})],t.prototype,"updating",void 0),i.__decorate([l.subclass("esri.views.2d.layers.VectorTileLayerView2D")],t)}(f.LayerView2DMixin(v))}).apply(null,r))||(e.exports=n)}}]);