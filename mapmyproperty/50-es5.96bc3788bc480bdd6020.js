!function(){function e(e,t,r,n,i,a,s){try{var u=e[a](s),o=u.value}catch(l){return void r(l)}u.done?t(o):Promise.resolve(o).then(n,i)}function t(t){return function(){var r=this,n=arguments;return new Promise(function(i,a){var s=t.apply(r,n);function u(t){e(s,i,a,u,o,"next",t)}function o(t){e(s,i,a,u,o,"throw",t)}u(void 0)})}}function r(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,u=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return u=e.done,e},e:function(e){o=!0,s=e},f:function(){try{u||null==r.return||r.return()}finally{if(o)throw s}}}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{"64Oa":function(e,n,a){"use strict";a.r(n);var s=a("srIe"),u=a("6S2I"),o=a("zlDU"),l=a("KLE9"),c=a("kYAx"),f=a("xk++"),p=a("Hu/a"),h=a("Klsb"),d=a("q7ja"),y=a("DJok"),m=u.a.getLogger("esri.views.2d.layers.features.support.whereUtils"),v={getAttribute:function(e,t){return e.field(t)}},b=u.a.getLogger("esri.views.2d.layers.features.controllers.FeatureFilter");n.default=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._geometryBounds=Object(c.g)(),this._idToVisibility=new Map,this._serviceInfo=t}var n,u,g,w,R,O;return n=e,(u=[{key:"hash",get:function(){return this._hash}},{key:"check",value:function(e){return this._applyFilter(e)}},{key:"clear",value:function(){var e=this._resetAllHiddenIds();return this.update(),{show:e,hide:[]}}},{key:"invalidate",value:function(){var e=this;this._idToVisibility.forEach(function(t,r){e._idToVisibility.set(r,0)})}},{key:"setKnownIds",value:function(e){var t,n=r(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;this._idToVisibility.set(i,1)}}catch(a){n.e(a)}finally{n.f()}}},{key:"setTrue",value:function(e){var t=this,r=[],n=[],i=new Set(e);return this._idToVisibility.forEach(function(e,a){var s=!!(1&t._idToVisibility.get(a)),u=i.has(a);!s&&u?r.push(a):s&&!u&&n.push(a),t._idToVisibility.set(a,u?3:0)}),{show:r,hide:n}}},{key:"createQuery",value:function(){var e=this.geometry,t=this.spatialRel,r=this.where,n=this.timeExtent,i=this.objectIds;return f.a.fromJSON({geometry:e,spatialRel:t,where:r,timeExtent:n,objectIds:i})}},{key:"update",value:(O=t(regeneratorRuntime.mark(function e(t,r){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._hash=JSON.stringify(t),e.next=3,Object(p.e)(t,null,r);case 3:return n=e.sent,e.next=6,Promise.all([this._setGeometryFilter(n),this._setIdFilter(n),this._setAttributeFilter(n),this._setTimeFilter(n)]);case 6:case"end":return e.stop()}},e,this)})),function(e,t){return O.apply(this,arguments)})},{key:"_setAttributeFilter",value:(R=t(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r&&r.where){e.next=2;break}return e.abrupt("return",(this._clause=null,void(this.where=null)));case 2:return e.next=4,function(){var e=t(regeneratorRuntime.mark(function e(t,r){var n,i,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.e(6).then(a.bind(null,"ZqIb"));case 2:return n=e.sent,e.prev=3,(i=n.WhereClause.create(t,r)).isStandardized||(s=new o.a("mapview - bad input","Unable to apply filter's definition expression, as expression is not standardized.",i),m.error(s)),e.abrupt("return",function(e){var t=e.readArcadeFeature();return i.testFeature(t,v)});case 9:return e.prev=9,e.t0=e.catch(3),e.abrupt("return",(m.warn("mapview-bad-where-clause","Encountered an error when evaluating where clause",t),function(e){return!0}));case 12:case"end":return e.stop()}},e,null,[[3,9]])}));return function(t,r){return e.apply(this,arguments)}}()(r.where,this._serviceInfo.fieldsIndex);case 4:this._clause=e.sent,this.where=r.where;case 6:case"end":return e.stop()}},e,this)})),function(e){return R.apply(this,arguments)})},{key:"_setIdFilter",value:function(e){this._idsToShow=e&&e.objectIds&&new Set(e.objectIds),this._idsToHide=e&&e.hiddenIds&&new Set(e.hiddenIds),this.objectIds=e&&e.objectIds}},{key:"_setGeometryFilter",value:(w=t(regeneratorRuntime.mark(function e(t){var r,n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.geometry){e.next=2;break}return e.abrupt("return",(this._spatialQueryOperator=null,this.geometry=null,void(this.spatialRel=null)));case 2:return r=t.geometry,n=t.spatialRel||"esriSpatialRelIntersects",e.next=6,Object(h.c)(n,r,this._serviceInfo.geometryType,this._serviceInfo.hasZ,this._serviceInfo.hasM);case 6:i=e.sent,Object(l.a)(this._geometryBounds,r),this._spatialQueryOperator=i,this.geometry=r,this.spatialRel=n;case 8:case"end":return e.stop()}},e,this)})),function(e){return w.apply(this,arguments)})},{key:"_setTimeFilter",value:function(e){if(this.timeExtent=this._timeOperator=null,e&&e.timeExtent)if(this._serviceInfo.timeInfo)this.timeExtent=e.timeExtent,this._timeOperator=Object(d.b)(this._serviceInfo.timeInfo,e.timeExtent,y.b);else{var t=new o.a("feature-layer-view:time-filter-not-available","Unable to apply time filter, as layer doesn't have time metadata.",e.timeExtent);b.error(t)}}},{key:"_applyFilter",value:function(e){return this._filterByGeometry(e)&&this._filterById(e)&&this._filterByTime(e)&&this._filterByExpression(e)}},{key:"_filterByExpression",value:function(e){return!this.where||this._clause(e)}},{key:"_filterById",value:function(e){return(!this._idsToHide||!this._idsToHide.size||!this._idsToHide.has(e.getObjectId()))&&(!this._idsToShow||!this._idsToShow.size||this._idsToShow.has(e.getObjectId()))}},{key:"_filterByGeometry",value:function(e){if(!this.geometry)return!0;var t=e.readHydratedGeometry();return!!t&&this._spatialQueryOperator(t)}},{key:"_filterByTime",value:function(e){return!Object(s.k)(this._timeOperator)||this._timeOperator(e)}},{key:"_resetAllHiddenIds",value:function(){var e=this,t=[];return this._idToVisibility.forEach(function(r,n){1&r||(e._idToVisibility.set(n,1),t.push(n))}),t}}])&&i(n.prototype,u),g&&i(n,g),e}()},"Hu/a":function(e,r,n){"use strict";n.d(r,"a",function(){return y}),n.d(r,"b",function(){return x}),n.d(r,"c",function(){return R}),n.d(r,"d",function(){return O}),n.d(r,"e",function(){return _}),n.d(r,"f",function(){return w});var i=n("srIe"),a=n("+opI"),s=n("f4Nx"),u=n("+NQI"),o=n("qatw"),l=n("gEht"),c=n("qNUd"),f=n("gVKr"),p=n("ZlUD"),h=(n("2X7Z"),n("HsO1")),d=new a.a({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),y=Object.freeze({}),m=new f.a,v=new f.a,b=new f.a,g={esriGeometryPoint:p.m,esriGeometryPolyline:p.o,esriGeometryPolygon:p.n,esriGeometryMultipoint:p.l};function w(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.hasZ,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e.hasM,a=e.hasZ&&n,s=e.hasM&&i;if(r){var u=Object(p.u)(b,t,e.hasZ,e.hasM,"esriGeometryPoint",r,n,i);return Object(p.m)(u,a,s)}return Object(p.m)(t,a,s)}function R(e,t,r,n,i,a){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:t,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:r,o=t&&s,l=r&&u,c=n?"coords"in n?n:n.geometry:null;if(!c)return null;if(i){var f=Object(p.q)(v,c,t,r,e,i,s,u);return a&&(f=Object(p.u)(b,f,o,l,e,a)),g[e](f,o,l)}if(a){var h=Object(p.u)(b,c,t,r,e,a,s,u);return g[e](h,o,l)}return Object(p.x)(m,c,t,r,s,u),g[e](m,o,l)}function O(e,t,r){return S.apply(this,arguments)}function S(){return(S=t(regeneratorRuntime.mark(function e(t,r,n){var i,a,s,u,o,l,c,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.outFields,a=t.orderByFields,s=t.groupByFieldsForStatistics,u=t.outStatistics,i)for(o=0;o<i.length;o++)i[o]=i[o].trim();if(a)for(l=0;l<a.length;l++)a[l]=a[l].trim();if(s)for(c=0;c<s.length;c++)s[c]=s[c].trim();if(u)for(f=0;f<u.length;f++)u[f].onStatisticField&&(u[f].onStatisticField=u[f].onStatisticField.trim());return e.abrupt("return",(t.geometry&&!t.outSR&&(t.outSR=t.geometry.spatialReference),_(t,r,n)));case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function _(e,t,r){return j.apply(this,arguments)}function j(){return(j=t(regeneratorRuntime.mark(function e(r,a,f){var p,m,v,b,g,w;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return",null);case 2:if(p=r.where,r.where=p=p&&p.trim(),(!p||/^1 *= *1$/.test(p)||a&&a===p)&&(r.where=null),r.geometry){e.next=5;break}return e.abrupt("return",r);case 5:return e.next=7,function(){var e=t(regeneratorRuntime.mark(function e(r){var i,a,u,o,c,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=r.geometry,a=r.distance,u=r.units,null!=a&&!("vertexAttributes"in i)){e.next=3;break}return e.abrupt("return",i);case 3:if(o=i.spatialReference,c=u?d.fromJSON(u):Object(l.h)(o),!o||!Object(s.f)(o)&&!Object(s.m)(o)){e.next=9;break}e.t0=i,e.next=12;break;case 9:return e.next=11,Object(h.a)(o,s.a).then(function(){return Object(h.b)(i,s.a)});case 11:e.t0=e.sent;case 12:return f=e.t0,e.next=15,t(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e(0),n.e(20)]).then(n.bind(null,"AKzY"));case 2:return e.abrupt("return",e.sent.geodesicBuffer);case 3:case"end":return e.stop()}},e)}))();case 15:return e.t1=e.sent,e.abrupt("return",(0,e.t1)(f.spatialReference,f,a,c));case 17:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()(r);case 7:return m=e.sent,r.distance=0,r.units=null,"esriSpatialRelEnvelopeIntersects"===r.spatialRel&&(v=r.geometry.spatialReference,(m=Object(u.a)(m)).spatialReference=v),r.geometry=m,e.next=12,Object(h.a)(m.spatialReference,f);case 12:return e.next=14,Object(c.a)(Object(o.a)(m));case 14:if(b=e.sent[0],!Object(i.j)(b)){e.next=17;break}throw y;case 17:return g=b.toJSON(),e.next=20,Object(h.b)(g,g.spatialReference,f);case 20:if(w=e.sent){e.next=23;break}throw y;case 23:return e.abrupt("return",(w.spatialReference=f,r.geometry=w,r));case 24:case"end":return e.stop()}},e)}))).apply(this,arguments)}function x(e){return e&&I in e?JSON.parse(JSON.stringify(e,k)):e}var I="_geVersion",k=function(e,t){return e!==I?t:void 0}},Klsb:function(e,n,i){"use strict";i.d(n,"a",function(){return _}),i.d(n,"b",function(){return O}),i.d(n,"c",function(){return R});var a=i("zlDU"),s=i("f4Nx"),u=i("IXLn"),o=i("PNY3"),l=i("qatw"),c=i("gVKr"),f=i("ZlUD");function p(e,t){return e?t?4:3:t?3:2}function h(e,t,n,i,a){if(!e)return!1;var s,u=p(t,n),o=e.coords,l=!1,c=0,f=r(e.lengths);try{for(f.s();!(s=f.n()).done;){var h=s.value;l=d(l,o,u,c,h,i,a),c+=h*u}}catch(y){f.e(y)}finally{f.f()}return l}function d(e,t,r,n,i,a,s){for(var u=e,o=n,l=n,c=n+i*r;l<c;l+=r){(o=l+r)===c&&(o=n);var f=t[l],p=t[l+1],h=t[o],d=t[o+1];(p<s&&d>=s||d<s&&p>=s)&&f+(s-p)/(d-p)*(h-f)<a&&(u=!u)}return u}var y=i("HsO1"),m=i("Hu/a"),v={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},b={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},g={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},w={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};function R(e,t,r,n,a){if(Object(l.g)(t)&&"esriGeometryPoint"===r&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e)){var s=Object(f.g)(new c.a,t,!1,!1);return Promise.resolve(function(e){return function(e,t,r,n){return h(e,!1,!1,n.coords[0],n.coords[1])}(s,0,0,e)})}if(Object(l.g)(t)&&"esriGeometryMultipoint"===r){var d=Object(f.g)(new c.a,t,!1,!1);if("esriSpatialRelContains"===e)return Promise.resolve(function(e){return function(e,t,r,n,i,a){var s=p(i,a),u=n.coords,o=n.lengths;if(!o)return!1;for(var l=0,c=0;l<o.length;l++,c+=s)if(!h(e,!1,!1,u[c],u[c+1]))return!1;return!0}(d,0,0,e,n,a)})}if(Object(l.d)(t)&&"esriGeometryPoint"===r&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e))return Promise.resolve(function(e){return Object(u.e)(t,Object(m.c)(r,n,a,e))});if(Object(l.d)(t)&&"esriGeometryMultipoint"===r&&"esriSpatialRelContains"===e)return Promise.resolve(function(e){return Object(u.d)(t,Object(m.c)(r,n,a,e))});if(Object(l.d)(t)&&"esriSpatialRelIntersects"===e){var y=Object(o.b)(r);return Promise.resolve(function(e){return y(t,Object(m.c)(r,n,a,e))})}return Promise.all([i.e(0),i.e(20)]).then(i.bind(null,"AKzY")).then(function(i){var s=i[v[e]].bind(null,t.spatialReference,t);return function(e){return s(Object(m.c)(r,n,a,e))}})}function O(e,t,r){return S.apply(this,arguments)}function S(){return(S=t(regeneratorRuntime.mark(function e(t,r,n){var i,u,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.spatialRel,!(u=t.geometry)){e.next=11;break}if(!0===b[i]){e.next=4;break}throw new a.a("feature-store:unsupported-query","Unsupported query spatial relationship",{query:t});case 4:if(!Object(s.i)(u.spatialReference)||!Object(s.i)(n)){e.next=11;break}if(o=u,!0===g[Object(l.c)(o)]){e.next=7;break}throw new a.a("feature-store:unsupported-query","Unsupported query geometry type",{query:t});case 7:if(function(e){return!0===w[e]}(r)){e.next=9;break}throw new a.a("feature-store:unsupported-query","Unsupported layer geometry type",{query:t});case 9:if(!t.outSR){e.next=11;break}return e.abrupt("return",Object(y.a)(t.geometry&&t.geometry.spatialReference,t.outSR));case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}function _(e){if(Object(l.d)(e))return!0;if(Object(l.g)(e)){var t,n=r(e.rings);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(5!==i.length)return!1;if(i[0][0]!==i[1][0]||i[0][0]!==i[4][0]||i[2][0]!==i[3][0]||i[0][1]!==i[3][1]||i[0][1]!==i[4][1]||i[1][1]!==i[2][1])return!1}}catch(a){n.e(a)}finally{n.f()}return!0}return!1}},q7ja:function(e,t,r){"use strict";function n(e,t){if(!e)return null;var r=t.featureAdapter,n=e.startTimeField,i=e.endTimeField,a=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;if(n&&i)t.forEach(function(e){var t=r.getAttribute(e,n),u=r.getAttribute(e,i);null==t||isNaN(t)||(a=Math.min(a,t)),null==u||isNaN(u)||(s=Math.max(s,u))});else{var u=n||i;t.forEach(function(e){var t=r.getAttribute(e,u);null==t||isNaN(t)||(a=Math.min(a,t),s=Math.max(s,t))})}return{start:a,end:s}}function i(e,t,r){if(!t||!e)return null;var n=e.startTimeField,i=e.endTimeField;if(!n&&!i)return null;var a=t.start,s=t.end;return null===a&&null===s?null:void 0===a&&void 0===s?function(){return!1}:n&&i?function(e,t,r,n,i){return null!=n&&null!=i?function(a){var s=e.getAttribute(a,t),u=e.getAttribute(a,r);return(null==s||s<=i)&&(null==u||u>=n)}:null!=n?function(t){var i=e.getAttribute(t,r);return null==i||i>=n}:null!=i?function(r){var n=e.getAttribute(r,t);return null==n||n<=i}:void 0}(r,n,i,a,s):function(e,t,r,n){return null!=r&&null!=n&&r===n?function(n){return e.getAttribute(n,t)===r}:null!=r&&null!=n?function(i){var a=e.getAttribute(i,t);return a>=r&&a<=n}:null!=r?function(n){return e.getAttribute(n,t)>=r}:null!=n?function(r){return e.getAttribute(r,t)<=n}:void 0}(r,n||i,a,s)}r.d(t,"a",function(){return n}),r.d(t,"b",function(){return i})}}])}();