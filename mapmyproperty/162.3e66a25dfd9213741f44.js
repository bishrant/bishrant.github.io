(function(){var e={"arcgis-js-api/views/2d/engine/webgl/effects/post-processing/DropShadow":"Vu5b"},t=this||window,i=t.webpackJsonp=t.webpackJsonp||[];i.registerAbsMids?i.registerAbsMids(e):(i.absMidsWaiting=i.absMidsWaiting||[]).push(e)})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[162],{Vu5b:function(e,t,i){var r,s;r=[i.dj.c(e.i),t,i("jBNx"),i("DJpR"),i("Nwkb")],void 0===(s=(function(e,t,i,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DropShadow=void 0;var o=[1,0],a=[0,1],n=function(){function e(){this._horizontalBlurFBO=null,this._verticalBlurFBO=null,this._size=[0,0],this._programDesc={blur:{vsPath:"post-processing/drop-shadow",fsPath:"post-processing/blur/gaussianBlur",attributes:{a_position:0}},composite:{vsPath:"post-processing/pp",fsPath:"post-processing/drop-shadow/composite",attributes:{a_position:0}},blit:{vsPath:"post-processing/pp",fsPath:"post-processing/blit",attributes:{a_position:0}}}}return e.prototype.dispose=function(){this._layerFBOTexture&&(this._layerFBOTexture.dispose(),this._layerFBOTexture=null),this._horizontalBlurFBO&&(this._horizontalBlurFBO.dispose(),this._horizontalBlurFBO=null),this._verticalBlurFBO&&(this._verticalBlurFBO.dispose(),this._verticalBlurFBO=null)},e.prototype.draw=function(e,t,r){var n=e.context,l=e.state,u=e.pixelRatio,p=l.size,d=e.painter.materialManager,h=this._programDesc,c=Math.round(u*p[0]),f=Math.round(u*p[1]),_=[Math.round(c/2),Math.round(f/2)],b=r.blurRadius,B=r.offsetY,g=r.color,m=[u*i.pt2px(r.offsetX/2),u*i.pt2px(B/2)];this._createOrResizeResources(e,_);var w=this._horizontalBlurFBO,F=this._verticalBlurFBO;n.setStencilWriteMask(0),n.setStencilTestEnabled(!1),n.setDepthWriteEnabled(!1),n.setDepthTestEnabled(!1);var v=this._layerFBOTexture;t.copyToTexture(0,0,c,f,0,0,v),this._quad||(this._quad=new s(n,[-1,-1,1,-1,-1,1,1,1])),n.setViewport(0,0,_[0],_[1]);var x=this._quad;x.bind(),n.setBlendingEnabled(!1);var T=d.getProgram(e,h.blur,[{name:"radius",value:Math.ceil(b)}]);n.bindProgram(T),n.bindFramebuffer(w),n.bindTexture(t.colorTexture,4),T.setUniformMatrix3fv("u_displayViewMat3",l.displayMat3),T.setUniform2fv("u_offset",m),T.setUniform1i("u_colorTexture",4),T.setUniform2fv("u_texSize",_),T.setUniform2fv("u_direction",o),T.setUniform1f("u_sigma",b),x.draw(),n.bindFramebuffer(F),n.bindTexture(w.colorTexture,5),T.setUniformMatrix3fv("u_displayViewMat3",l.displayMat3),T.setUniform2fv("u_offset",[0,0]),T.setUniform1i("u_colorTexture",5),T.setUniform2fv("u_direction",a),x.draw(),n.bindFramebuffer(t),n.setViewport(0,0,c,f);var O=d.getProgram(e,h.composite);n.bindProgram(O),n.bindTexture(F.colorTexture,2),O.setUniform1i("u_blurTexture",2),n.bindTexture(v,3),O.setUniform1i("u_layerFBOTexture",3),O.setUniform4fv("u_shadowColor",[g[3]*(g[0]/255),g[3]*(g[1]/255),g[3]*(g[2]/255),g[3]]),x.draw(),n.setBlendingEnabled(!0),n.setStencilTestEnabled(!0),n.setBlendFunction(1,771),x.unbind()},e.prototype._createOrResizeResources=function(e,t){var i=e.context,s=e.pixelRatio,o=e.state.size,a=Math.round(s*o[0]),n=Math.round(s*o[1]);this._horizontalBlurFBO&&this._size[0]===a&&this._size[1]===n||(this._size[0]=a,this._size[1]=n,this._horizontalBlurFBO?this._horizontalBlurFBO.resize(t[0],t[1]):this._horizontalBlurFBO=new r.FramebufferObject(i,{colorTarget:0,depthStencilTarget:0,width:t[0],height:t[1]},{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!1,width:t[0],height:t[1]}),this._verticalBlurFBO?this._verticalBlurFBO.resize(t[0],t[1]):this._verticalBlurFBO=new r.FramebufferObject(i,{colorTarget:0,depthStencilTarget:0,width:t[0],height:t[1]},{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!1,width:t[0],height:t[1]}),this._layerFBOTexture?this._layerFBOTexture.resize(a,n):this._layerFBOTexture=new r.Texture(i,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!1,width:a,height:n}))},e}();t.DropShadow=n}).apply(null,r))||(e.exports=s)}}]);