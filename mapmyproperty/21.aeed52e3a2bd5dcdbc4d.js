(function(){var e={"arcgis-js-api/views/2d/layers/support/util":"+MAT","arcgis-js-api/views/2d/layers/FeatureLayerView2D":"/Ck8","arcgis-js-api/renderers/support/clickToleranceUtils":"/E+R","arcgis-js-api/views/layers/support/Path":"20TT","arcgis-js-api/views/layers/support/cssFilterParser":"3MK9","arcgis-js-api/views/2d/layers/LayerView2D":"6i4F","arcgis-js-api/views/layers/support/ClipRect":"7MXx","arcgis-js-api/views/layers/FeatureLayerView":"8iBb","arcgis-js-api/core/MD5":"CaYo","arcgis-js-api/views/layers/support/popupUtils":"I6zq","arcgis-js-api/views/support/drapedUtils":"NbdF","arcgis-js-api/views/2d/layers/features/support/rendererUtils":"NfUe","arcgis-js-api/views/2d/layers/support/FeatureLayerProxy":"WbzV","arcgis-js-api/views/layers/LayerView":"WsO6","arcgis-js-api/views/layers/support/ClipArea":"ZMIQ","arcgis-js-api/views/layers/support/FeatureEffect":"dDbr","arcgis-js-api/views/layers/support/FeatureFilter":"e4th","arcgis-js-api/views/layers/support/Transition":"gd70","arcgis-js-api/views/layers/support/ParsedFeatureEffect":"iO/m","arcgis-js-api/AggregateGraphic":"jci6","arcgis-js-api/views/2d/layers/features/tileRenderers":"sQ+t","arcgis-js-api/views/layers/support/Geometry":"ts8o","arcgis-js-api/views/2d/layers/support/clusterUtils":"w0Ef"},t=this||window,r=t.webpackJsonp=t.webpackJsonp||[];r.registerAbsMids?r.registerAbsMids(e):(r.absMidsWaiting=r.absMidsWaiting||[]).push(e)})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{"+MAT":function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("ImIS")],void 0===(n=(function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var i=new r.default({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});t.toJSONGeometryType=function(e){return i.toJSON(e)},t.analyzeRings=function(e,t,r){for(var i=[],n=[],o=0,a=0,s=0,u=e;s<u.length;s++){var l=u[s],c=a,p=l[0][0],d=l[0][1];i[a++]=p,i[a++]=d;for(var f=0,h=1;h<l.length;++h){var y=d;f+=(d=l[h][1])*p-(p=l[h][0])*y,i[a++]=p,i[a++]=d}t(f/2),f>0?(c-o>0&&(r(o,c,i,n),o=c),n.length=0):f<0&&c-o>0?n.push(.5*(c-o)):a=c}a-o>0&&r(o,a,i,n)}}).apply(null,i))||(e.exports=n)},"/Ck8":function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("zOht"),r("jci6"),r("TMur"),r("jZlN"),r("KY0m"),r("y4WC"),r("ma1f"),r("H1tY"),r("qsST"),r("R2Zq"),r("LxLY"),r("qMld"),r("8MXS"),r("Vx27"),r("Q2Em"),r("/E+R"),r("w1v0"),r("IpeC"),r("YaB4"),r("6i4F"),r("sQ+t"),r("NfUe"),r("w0Ef"),r("WbzV"),r("+MAT"),r("ovos"),r("8iBb"),r("WsO6"),r("7XLS"),r("e4th"),r("dDbr"),r("NbdF")],void 0===(n=(function(e,t,r,i,n,o,a,s,u,l,c,p,d,f,h,y,v,g,_,m,b,w,x,S,R,F,E,O,C,j,I,T,V,A){var P=c.getLogger("esri.views.2d.layers.FeatureLayerView2D");return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._pipelineIsUpdating=!0,t._updatingPipelineConfig=!1,t._viewStateId=-1,t._visibilityOverrides=new Set,t._effect=null,t._highlightIds=new Map,t._onGoingEdits=0,t.filter=null,t.doRefresh=f.debounce((function(){return t._onGoingEdits=0,t._proxy.refresh().catch((function(e){f.isAbortError(e)||P.error(e)}))})),t._onRenderingConfigChange=f.debounce((function(){return r.__awaiter(t,void 0,void 0,(function(){var e,t,i,n,o,a,s,u,l,c,f,h,y,v,g,_,m,b,w,x;return r.__generator(this,(function(r){switch(r.label){case 0:return this._hasRequiredSupport(this.layer)?(this._set("_updatingPipelineConfig",!0),t=(e=this).effect,i=e.filter,[4,this._effectiveRendererPromise]):[2];case 1:return n=r.sent(),o=n.renderer,a=n.aggregateFields,s=n.featureReduction,[4,this._updateRequiredFields()];case 2:return r.sent(),u=this.availableFields.join("."),l=this._createLayerFilterHash(),c=this._createTileRendererHash(o),f=this._createFeatureDataHash(o,i,t),h=this._createMeshHash(o),y=u!==this._clientDataHash,_=(g=f!==this._featureDataHash||y)&&!!this.layer.featureReduction,b={invalidateFeatureData:g,invalidateMesh:m=h!==this._meshHash||_,layerFilterChanged:v=l!==this._layerFilterHash},w=this._createConfiguration(o,a,s,i,t),c===this._tileRendererHash?[3,9]:[4,this._initTileRenderer(o)];case 3:return r.sent(),[4,this._createServiceOptions()];case 4:return x=r.sent(),this.effects.forEach((function(e){return d.isSome(e)&&d.isSome(e.filter)&&e.filter.enable()})),this.tileRenderer.onConfigUpdate(o),[4,this._proxy.startup(this.view.featuresTilingScheme,w,x,b)];case 5:return r.sent(),this.hasHighlight()?[4,this._proxy.setHighlight(p.keysOfMap(this._highlightIds))]:[3,7];case 6:r.sent(),r.label=7;case 7:return[4,this._onceTilesUpdated()];case 8:return r.sent(),this.tileRenderer.onConfigUpdate(o),[3,14];case 9:return this._lockAttributeTextureUpload(),y||v||g||m?[4,this._proxy.update(w,b)]:[3,11];case 10:r.sent(),r.label=11;case 11:return v?[4,this._onceTilesUpdated()]:[3,13];case 12:r.sent(),r.label=13;case 13:this._unlockAttributeTextureUpload(),this.effects.forEach((function(e){return d.isSome(e)&&d.isSome(e.filter)&&e.filter.enable()})),this.tileRenderer.onConfigUpdate(o),this._forceAttributeTextureUpload(),r.label=14;case 14:return this._clientDataHash=u,this._layerFilterHash=l,this._tileRendererHash=c,this._meshHash=h,this._featureDataHash=f,this.tileRenderer.invalidateLabels(),this.requestUpdate(),[2]}}))}))})),t._updateHighlight=f.debounce((function(){return r.__awaiter(t,void 0,void 0,(function(){return r.__generator(this,(function(e){return[2,this._proxy.setHighlight(p.keysOfMap(this._highlightIds))]}))}))})),t}return r.__extends(t,e),t.prototype.destroy=function(){this._proxy.destroy(),d.andThen(this._updateClusterSizeTask,(function(e){return e.remove()}))},t.prototype.initialize=function(){var e=this;this.addResolvingPromise(this._initProxy()),this.handles.add([this.on("valueRangesChanged",(function(t){e._set("_aggregateValueRanges",t.valueRanges)}))])},t.prototype._initProxy=function(){return r.__awaiter(this,void 0,void 0,(function(){var e,t,i;return r.__generator(this,(function(r){if("stream"!==this.layer.type&&"ogc-feature"!==this.layer.type&&this.layer.isTable)throw new u("featurelayerview:table-not-supported","table feature layer can't be displayed",{layer:this.layer});if(e=this.layer.spatialReference,t=n.SpatialReference.WGS84,this.layer.featureReduction&&!v.doesBrowserSupportProjection(e,t))throw new u("featurelayerview:featureReduction-not-supported","cannot project feature layer to WGS84",{inSpatialReference:e,outSpatialReference:t});return this._proxy&&this._proxy.destroy(),i=this._createClientOptions(),this._set("_proxy",new F.default({client:i})),[2,this._proxy.when()]}))}))},Object.defineProperty(t.prototype,"_effectiveRendererPromise",{get:function(){var e=this,t=this._getEffectiveRenderer();return t.then((function(t){return e._set("_effectiveRenderer",t.renderer)})),t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"labelsVisible",{get:function(){return!this.suspended&&this.layer.labelingInfo&&this.layer.labelsVisible},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effect",{get:function(){return d.unwrapOr(this._effect,null)},set:function(e){var t=this._effect;d.isSome(t)&&d.isSome(t.filter)&&t.filter.enabled&&d.isSome(e)&&d.isSome(e.filter)&&e.filter.enable(),this._effect=e,this.notifyChange("effect")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effects",{get:function(){return this.effect&&[this.effect]||[]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numFeatures",{get:function(){var e=0;return this._tileStrategy.tiles.forEach((function(t){e+=t.iconDisplayRecords?t.iconDisplayRecords.length:0})),e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderingConfigHash",{get:function(){if(!this.layer)return null;var e=this.availableFields,t=this.layer,r=t.definitionExpression,i=t.renderer,n=t.labelingInfo,o="feature"===t.type?t.gdbVersion:void 0,a="feature"===t.type&&t.historicMoment?t.historicMoment.getTime():void 0,s=this.timeExtent,u="stream"===t.type?""+JSON.stringify(t.geometryDefinition)+t.definitionExpression:null,l=JSON.stringify(this.clips),c=t.featureReduction&&t.featureReduction.toJSON();return JSON.stringify({filterHash:d.isSome(this.filter)&&this.filter.toJSON(),effectHash:d.isSome(this.effect)&&this.effect.toJSON(),streamFilter:u,gdbVersion:o,definitionExpression:r,historicMoment:a,availableFields:e,renderer:i,labelingInfo:n,timeExtent:s,clipsHash:l,featureReduction:c})},enumerable:!0,configurable:!0}),t.prototype.highlight=function(e){var t,r=this;return e instanceof o?t=[e.getObjectId()]:"number"==typeof e?t=[e]:s.isCollection(e)?t=e.map((function(e){return e&&e.getAttribute(r.layer.objectIdField)})).toArray():Array.isArray(e)&&e.length>0&&(t="number"==typeof e[0]?e:e.map((function(e){return e&&e.getAttribute(r.layer.objectIdField)}))),t&&t.length?(t=t.filter((function(e){return null!=e})),this._addHighlight(t),{remove:function(){return r._removeHighlight(t)},pause:function(){return r._removeHighlight(t)},resume:function(){return r._addHighlight(t)}}):{remove:function(){},pause:function(){},resume:function(){}}},t.prototype.hasHighlight=function(){return!!this._highlightIds.size},t.prototype.hitTest=function(e,t){return this._hitTest(e,t)},t.prototype.queryStatistics=function(){return this._proxy.queryStatistics()},t.prototype.queryFeatures=function(e,t){var r=this;return this.queryFeaturesJSON(e,t).then((function(e){var t=_.fromJSON(e);return t.features.forEach((function(e){e.layer=r.layer,e.sourceLayer=r.layer})),t}))},t.prototype.queryFeaturesJSON=function(e,t){return this._proxy.queryFeatures(this._cleanUpQuery(e),t)},t.prototype.queryObjectIds=function(e,t){return this._proxy.queryObjectIds(this._cleanUpQuery(e),t)},t.prototype.queryFeatureCount=function(e,t){return this._proxy.queryFeatureCount(this._cleanUpQuery(e),t)},t.prototype.queryExtent=function(e,t){return this._proxy.queryExtent(this._cleanUpQuery(e),t).then((function(e){return{count:e.count,extent:n.Extent.fromJSON(e.extent)}}))},t.prototype.setVisibility=function(e,t){t?this._visibilityOverrides.delete(e):this._visibilityOverrides.add(e),this._renderingConfigHashChanged()},t.prototype.update=function(e){if(this._tileStrategy&&this.tileRenderer){this._tileStrategy.update(e)||this.requestUpdate();var t=e.state;this._viewStateId!==t.id&&(this._proxy.setViewState(t),this._viewStateId=t.id),this.notifyChange("numFeatures"),this.notifyChange("updating")}},t.prototype.attach=function(){var e=this;this.view.timeline.record(this.layer.title+" (FeatureLayer) Attach"),this._tileStrategy=new O({cachePolicy:"purge",acquireTile:function(t){return e._acquireTile(t)},releaseTile:function(t){return e._releaseTile(t)},tileInfoView:this.view.featuresTilingScheme,buffer:0}),this.handles.add(h.init(this,"renderingConfigHash",(function(){return e._renderingConfigHashChanged()}),!0),"attach"),"stream"!==this.layer.type&&this.handles.add(this.layer.on("edits",(function(t){return r.__awaiter(e,void 0,void 0,(function(){return r.__generator(this,(function(e){switch(e.label){case 0:return this._onGoingEdits++,[4,this._proxy.onEdits(t)];case 1:return e.sent(),this._onGoingEdits=Math.max(0,this._onGoingEdits-1),[2]}}))}))})),"attach")},t.prototype.detach=function(){this.container.removeAllChildren(),this.handles.remove("attach"),this._updatingPipelineConfig=!1,this.tileRenderer&&(this.tileRenderer.uninstall(this.container),this.tileRenderer=null),this._tileStrategy&&(this._tileStrategy.destroy(),this._tileStrategy=null),this._tileRendererHash=null,this._meshHash=null,this._clientDataHash=null,this._layerFilterHash=null},t.prototype.moveStart=function(){this.requestUpdate()},t.prototype.viewChange=function(){this.requestUpdate()},t.prototype.moveEnd=function(){this.requestUpdate()},t.prototype.fetchPopupFeatures=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n,o,s,u;return r.__generator(this,(function(r){return d.isSome(t)&&t.clientGraphics.length&&(n=t.clientGraphics[0])instanceof i?[2,[n]]:(o=this.validateFetchPopupFeatures(t))?[2,f.reject(o)]:d.isSome(t)&&0===t.clientGraphics.length?[2,f.resolve([])]:(s=this.fetchClientPopupFeatures(t),e?(u=this._fetchServicePopupFeatures(e,t),[2,f.eachAlwaysValues([s,u]).then(a.flatten)]):[2,s])}))}))},t.prototype._fetchServicePopupFeatures=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var i,n,o,a,s,u,l,c,p,f;return r.__generator(this,(function(r){switch(r.label){case 0:return"stream"===this.layer.type?[2,[]]:[4,this.createPopupQuery(t)];case 1:if(i=r.sent(),o=(n=this.layer).renderer,a=d.isSome(t)?t.event:null,s=g.calculateTolerance({renderer:o,event:a}),i.geometry=this.createFetchPopupFeaturesQueryGeometry(e,s),u=new Set,l=n.objectIdField,c=d.isSome(t)?t.clientGraphics:null)for(p=0,f=c;p<f.length;p++)u.add(f[p].attributes[l]);return[2,n.queryFeatures(i).then((function(e){return e.features.filter((function(e){return!u.has(e.attributes[l])}))}))]}}))}))},t.prototype.createFetchPopupFeaturesQueryGeometry=function(e,t){return A.createQueryGeometry(e,t,this.view)},t.prototype.isUpdating=function(){return null!=this.layer.renderer&&(null!=this._updatingRequiredFieldsPromise||null==this.tileRenderer||!this._proxy||!this._proxy.isReady||this._pipelineIsUpdating||this._updatingPipelineConfig||this.tileRenderer.updating||this._onGoingEdits>0)},t.prototype._createClientOptions=function(){var e=this;return{setUpdating:function(t){e._set("_pipelineIsUpdating",t)},emitEvent:function(t){e.emit(t.name,t.event)}}},t.prototype._createServiceOptions=function(){return r.__awaiter(this,void 0,void 0,(function(){var e,t,i,n,o,a,s,u,l,c;return r.__generator(this,(function(r){switch(r.label){case 0:return"stream"===(e=this.layer).type?[2,null]:(t=e.capabilities,i=e.objectIdField,n=e.fields.map((function(e){return e.toJSON()})),o=e.fullExtent&&e.fullExtent.toJSON(),a=E.toJSONGeometryType(e.geometryType),s=e.timeInfo&&e.timeInfo.toJSON()||null,u=e.spatialReference?e.spatialReference.toJSON():null,"ogc-feature"!==e.type?[3,1]:(l=function(e){return{capabilities:e.capabilities,collectionId:e.collectionId,url:e.url,layerDefinition:e.source.layerDefinition}}(e),[3,5]));case 1:return function(e){return e&&"openPorts"in e}(e.source)?[4,e.source.openPorts()]:[3,3];case 2:return c=r.sent(),[3,4];case 3:c="dynamicDataSource"in e?e.dynamicDataSource?e.parsedUrl:e.url+"/"+e.layerId:e.parsedUrl,r.label=4;case 4:l=c,r.label=5;case 5:return[2,{type:"on-demand",maxRecordCount:t.query.maxRecordCount,tileMaxRecordCount:t.query.tileMaxRecordCount,capabilities:t,fields:n,fullExtent:o,geometryType:a,objectIdField:i,source:l,timeInfo:s,spatialReference:u}]}}))}))},t.prototype._createMemoryServiceOptions=function(e){return r.__awaiter(this,void 0,void 0,(function(){var t;return r.__generator(this,(function(i){switch(i.label){case 0:return[4,e.openPorts()];case 1:return t=i.sent(),[2,r.__assign(r.__assign({},this._createServiceOptions()),{type:"memory",source:t})]}}))}))},t.prototype._cleanUpQuery=function(e){var t=m.from(e)||this.createQuery();return t.outSpatialReference||(t.outSpatialReference=this.view.spatialReference),t},t.prototype._createUpdateClusterSizeTask=function(e,t){var i=this;return this.watch("_aggregateValueRanges",(function(n){return r.__awaiter(i,void 0,void 0,(function(){return r.__generator(this,(function(r){return this._updateClusterEffectiveRendererSizeVariable(e,t,n),this._updatingPipelineConfig||this.tileRenderer.onConfigUpdate(this._effectiveRenderer),[2]}))}))}))},t.prototype._updateClusterEffectiveRendererSizeVariable=function(e,t,i){return r.__awaiter(this,void 0,void 0,(function(){var n,o,a;return r.__generator(this,(function(r){return e.dynamicClusterSize&&"visualVariables"in e&&e.visualVariables&&(n=R.findSizeVV(e.visualVariables),d.isSome(n)&&"cluster_count"===n.field&&(o=e.visualVariables.indexOf(n),e.visualVariables[o]=R.createClusterCountSizeVariable(t,i),(a=e.clone()).dynamicClusterSize=!0,this._set("_effectiveRenderer",a))),[2]}))}))},t.prototype._getEffectiveRenderer=function(){return r.__awaiter(this,void 0,void 0,(function(){var e,t,i,n,o;return r.__generator(this,(function(r){switch(r.label){case 0:return e=this.layer.renderer,t=this.layer.featureReduction,d.isSome(this._updateClusterSizeTask)&&(this._updateClusterSizeTask.remove(),this._updateClusterSizeTask=null),t&&"cluster"===t.type&&R.isClusterCompatibleRenderer(e)?[4,R.createClusterRenderer(n=[],this.layer.fields,e,i=t,this._aggregateValueRanges)]:[3,2];case 1:return o=r.sent(),d.andThen(this._updateClusterSizeTask,(function(e){return e.remove()})),this._updateClusterSizeTask=this._createUpdateClusterSizeTask(o,i),[2,{renderer:o,aggregateFields:n,featureReduction:t}];case 2:return[2,{renderer:e,aggregateFields:[],featureReduction:null}]}}))}))},t.prototype._acquireTile=function(e){var t=this,r=this.tileRenderer.acquireTile(e);return r.once("attach",(function(){t.requestUpdate()})),r},t.prototype._releaseTile=function(e){this.tileRenderer.releaseTile(e)},t.prototype._initTileRenderer=function(e){return r.__awaiter(this,void 0,void 0,(function(){var t;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,x.createOrReuseTileRenderer(e,{layerView:this,tileInfoView:this.view.featuresTilingScheme,layer:this.layer})];case 1:return t=r.sent(),this.tileRenderer&&(this._tileStrategy.clear(),this.tileRenderer.uninstall(this.container),this.tileRenderer.destroy(),this.tileRenderer=null),this._proxy.tileRenderer=t,this._set("tileRenderer",t),this.tileRenderer.install(this.container),this.tileRenderer.onConfigUpdate(e),this.requestUpdate(),[2,this.tileRenderer]}}))}))},t.prototype._createLayerFilterHash=function(){return this.layer.definitionExpression+"."+("feature"===this.layer.type&&this.layer.historicMoment?this.layer.historicMoment.getTime():void 0)+"."+("feature"===this.layer.type?this.layer.gdbVersion:void 0)},t.prototype._createTileRendererHash=function(e){return("heatmap"===e.type?"heatmap":"symbol")+"."+("dot-density"===e.type)},t.prototype._createFeatureDataHash=function(e,t,r){var i=e.getAttributeHash(),n=JSON.stringify(t),o=d.isSome(r)&&JSON.stringify(r.filter),a=JSON.stringify(this.timeExtent),s="";return this._visibilityOverrides.forEach((function(e){return s+=e})),i+"."+n+"."+o+"."+a+"."+s},t.prototype._createMeshHash=function(e){var t=b.getVVFlags("visualVariables"in e&&e.visualVariables||[]),r=this.layer.labelingInfo&&this.layer.labelingInfo.map((function(e){return JSON.stringify(e)})).join("/"),i=JSON.stringify(this.layer.featureReduction);return e.getMeshHash()+"."+t+"."+r+"."+i},t.prototype._injectOverrides=function(e){var t=d.isSome(e)?e.timeExtent:null,r=this.timeExtent&&t?this.timeExtent.intersection(t):this.timeExtent||t;if(!this._visibilityOverrides.size&&!r)return e;var i=d.isSome(e)&&e.clone()||new T;return i.hiddenIds=this._visibilityOverrides,i.timeExtent=r,i},t.prototype._createConfiguration=function(e,t,r,i,n){var o=S.simplifyVVRenderer(e),a=this.layer.labelingInfo,s="feature"===this.layer.type&&this.layer.historicMoment?this.layer.historicMoment.getTime():void 0,u="feature"===this.layer.type?this.layer.gdbVersion:void 0,l=new Array(b.definitions.MAX_FILTERS),c=this._injectOverrides(i);return l[0]=d.isSome(c)?c.toJSON():null,l[1]=d.isSome(n)&&n.filter?n.filter.toJSON():null,{featureReduction:d.andThen(r,(function(e){var t=e.toJSON();return"showLabels"in t&&!t.showLabels&&t.drawingInfo&&(t.drawingInfo.labelingInfo=null),t})),definitionExpression:this.layer.definitionExpression,availableFields:this.availableFields,labelingInfo:a&&a.map((function(e){return e.toJSON()})),renderer:o.toJSON(),gdbVersion:u,historicMoment:s,devicePixelRatio:window.devicePixelRatio||1,filters:l,aggregateFields:t}},t.prototype._hasRequiredSupport=function(e){return!("dot-density"===e.renderer.type&&!l("esri-webgl-texture-float")&&(P.error(new u("webgl-missing-extension","Missing WebGL extension OES_Texture_Float which is required for DotDensity")),1))},t.prototype._onceTilesUpdated=function(){return this.requestUpdate(),h.whenFalseOnce(this,"_pipelineIsUpdating",!0)},t.prototype._lockAttributeTextureUpload=function(){this.tileRenderer&&this.tileRenderer.lockAttributeTextureUpload()},t.prototype._unlockAttributeTextureUpload=function(){this.tileRenderer&&this.tileRenderer.unlockAttributeTextureUpload()},t.prototype._forceAttributeTextureUpload=function(){this.tileRenderer&&this.tileRenderer.forceAttributeTextureUpload()},t.prototype._renderingConfigHashChanged=function(){var e=this;this.view.timeline.begin(this.layer.title+" (FeatureLayer) Initial Pipeline Config");var t=this._onRenderingConfigChange();this._updatingPromise=t;var r=function(){t===e._updatingPromise&&e._set("_updatingPipelineConfig",!1),e.view&&e.view.timeline.end(e.layer.title+" (FeatureLayer) Initial Pipeline Config")};t.then(r).catch((function(e){f.isAbortError(e)||P.error(e),r()}))},t.prototype._addHighlight=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];if(this._highlightIds.has(i)){var n=this._highlightIds.get(i);this._highlightIds.set(i,n+1)}else this._highlightIds.set(i,1)}this._updateHighlight().catch((function(e){f.isAbortError(e)||P.error(e)}))},t.prototype._removeHighlight=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];if(this._highlightIds.has(i)){var n=this._highlightIds.get(i)-1;0===n?this._highlightIds.delete(i):this._highlightIds.set(i,n)}}this._updateHighlight().catch((function(e){f.isAbortError(e)||P.error(e)}))},t.prototype._createHittestResult=function(e){return e.layer=this.layer,e.sourceLayer=this.layer,d.isSome(e.geometry)&&(e.geometry.spatialReference=this.view.spatialReference),e},t.prototype._queryFeature=function(e){return r.__awaiter(this,void 0,void 0,(function(){var t,i,n;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,this._proxy.getObjectId(e)];case 1:return t=r.sent(),[4,this._proxy.queryFeatures(new m({objectIds:[t],outSpatialReference:this.view.spatialReference,returnGeometry:!0}))];case 2:return i=r.sent(),(n=i.features[0])?[2,n]:[2,null]}}))}))},t.prototype._hitTest=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n,a,s,u,l=this;return r.__generator(this,(function(r){switch(r.label){case 0:return this.suspended||!this.tileRenderer?[2,null]:[4,this.tileRenderer.hitTest(e,t)];case 1:return 0!==(n=r.sent()).length?[3,3]:[4,f.after(1)];case 2:return r.sent(),[2,null];case 3:return function(e){return(2147483648&e)>>>31==1}(a=n[0])?[3,5]:[4,this._queryFeature(a)];case 4:return u=r.sent(),[2,d.andThen(u,(function(e){return l._createHittestResult(o.fromJSON(e))}))];case 5:return[4,this._proxy.getAggregate(a)];case 6:return s=r.sent(),d.isNone(s)?[2,null]:d.isSome(s.referenceId)?[4,this._queryFeature(s.referenceId)]:[3,8];case 7:return u=r.sent(),[2,d.andThen(u,(function(e){return l._createHittestResult(o.fromJSON(e))}))];case 8:return[2,this._createHittestResult(i.fromJSON(s))]}}))}))},r.__decorate([y.property()],t.prototype,"_proxy",void 0),r.__decorate([y.property()],t.prototype,"_pipelineIsUpdating",void 0),r.__decorate([y.property()],t.prototype,"_updatingPipelineConfig",void 0),r.__decorate([y.property()],t.prototype,"_effectiveRenderer",void 0),r.__decorate([y.property()],t.prototype,"_aggregateValueRanges",void 0),r.__decorate([y.property()],t.prototype,"_onGoingEdits",void 0),r.__decorate([y.property({dependsOn:["layer.renderer","layer.featureReduction"]})],t.prototype,"_effectiveRendererPromise",null),r.__decorate([y.property({dependsOn:["suspended","layer.labelingInfo","layer.labelsVisible"]})],t.prototype,"labelsVisible",null),r.__decorate([y.property({type:T})],t.prototype,"filter",void 0),r.__decorate([y.property({type:V})],t.prototype,"effect",null),r.__decorate([y.property({readOnly:!0,dependsOn:["effect"]})],t.prototype,"effects",null),r.__decorate([y.property()],t.prototype,"numFeatures",null),r.__decorate([y.property({dependsOn:["layer.renderer","availableFields","layer.definitionExpression","layer.gdbVersion?","layer.geometryDefinition?","layer.historicMoment?","layer.labelingInfo","layer.featureReduction","filter","effect","timeExtent","clips"]})],t.prototype,"renderingConfigHash",null),r.__decorate([y.property()],t.prototype,"tileRenderer",void 0),r.__decorate([y.property({dependsOn:["layer.renderer","tileRenderer.updating","_updatingPipelineConfig","_pipelineIsUpdating","_updatingRequiredFieldsPromise","_proxy","_proxy.isReady?","_onGoingEdits"]})],t.prototype,"updating",void 0),r.__decorate([y.subclass("esri.views.2d.layers.FeatureLayerView2D")],t)}(C.FeatureLayerView(I.RefreshableLayerView(w.LayerView2DMixin(j))))}).apply(null,i))||(e.exports=n)},"/E+R":function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=(function(e,t){function r(e,t){return t?"xoffset"in t&&t.xoffset?Math.max(e,Math.abs(t.xoffset)):"yoffset"in t&&t.yoffset?Math.max(e,Math.abs(t.yoffset||0)):e:e}function i(e,t){return"number"==typeof e?e:e&&e.stops&&e.stops.length?function(e){for(var t=0,r=0,i=0;i<e.length;i++){var n=e[i].size;"number"==typeof n&&(t+=n,r++)}return t/r}(e.stops):t}Object.defineProperty(t,"__esModule",{value:!0}),t.calculateTolerance=function(e){var t=e&&e.renderer,n="touch"===(e&&e.event&&e.event.pointerType)?9:6;if(!t)return n;var o="visualVariables"in t?function(e,t){if(!t)return e;var r=t.filter((function(e){return"size"===e.type})).map((function(t){var r=t.minSize;return(i(t.maxSize,e)+i(r,e))/2})),n=0,o=r.length;if(0===o)return e;for(var a=0;a<o;a++)n+=r[a];var s=Math.floor(n/o);return Math.max(s,e)}(n,t.visualVariables):n;if("simple"===t.type)return r(o,t.symbol);if("unique-value"===t.type){var a=o;return t.uniqueValueInfos.forEach((function(e){a=r(a,e.symbol)})),a}if("class-breaks"===t.type){var s=o;return t.classBreakInfos.forEach((function(e){s=r(s,e.symbol)})),s}return o}}).apply(null,i))||(e.exports=n)},"20TT":function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("zOht"),r("Vx27"),r("ZMIQ")],void 0===(n=(function(e,t,r,i,n){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="path",t.path=[],t}return r.__extends(t,e),Object.defineProperty(t.prototype,"version",{get:function(){return(this._get("version")||0)+1},enumerable:!0,configurable:!0}),r.__decorate([i.property({type:[[[Number]]],json:{write:!0}})],t.prototype,"path",void 0),r.__decorate([i.property({readOnly:!0,dependsOn:["path"]})],t.prototype,"version",null),r.__decorate([i.subclass("esri.views.layers.support.Path")],t)}(n)}).apply(null,i))||(e.exports=n)},"3MK9":function(e,t,r){var i,n;void 0===(n="function"==typeof(i=function(){"use strict";function e(t,r,i,n){this.message=t,this.expected=r,this.found=i,this.location=n,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,e)}return function(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}(e,Error),e.buildMessage=function(e,t){var r={literal:function(e){return'"'+n(e.text)+'"'},class:function(e){var t,r="";for(t=0;t<e.parts.length;t++)r+=e.parts[t]instanceof Array?o(e.parts[t][0])+"-"+o(e.parts[t][1]):o(e.parts[t]);return"["+(e.inverted?"^":"")+r+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};function i(e){return e.charCodeAt(0).toString(16).toUpperCase()}function n(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+i(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+i(e)}))}function o(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+i(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+i(e)}))}return"Expected "+function(e){var t,i,n,o=new Array(e.length);for(t=0;t<e.length;t++)o[t]=r[(n=e[t]).type](n);if(o.sort(),o.length>0){for(t=1,i=1;t<o.length;t++)o[t-1]!==o[t]&&(o[i]=o[t],i++);o.length=i}switch(o.length){case 1:return o[0];case 2:return o[0]+" or "+o[1];default:return o.slice(0,-1).join(", ")+", or "+o[o.length-1]}}(e)+" but "+function(e){return e?'"'+n(e)+'"':"end of input"}(t)+" found."},{SyntaxError:e,parse:function(t,r){r=void 0!==r?r:{};var i,n={},o={start:Te},a=Te,s=Oe("none"),u=Fe("none",!1),l=Oe("blur()"),c=Fe("blur(",!1),p=Fe(")",!1),d=Oe("brightness()"),f=Fe("brightness(",!1),h=Oe("contrast()"),y=Fe("contrast(",!1),v=Oe("drop-shadow()"),g=Fe("drop-shadow(",!1),_=Oe("grayscale()"),m=Fe("grayscale(",!1),b=Oe("hue-rotate()"),w=Fe("hue-rotate(",!1),x=Oe("invert()"),S=Fe("invert(",!1),R=Oe("opacity()"),F=Fe("opacity(",!1),E=Oe("saturate()"),O=Fe("saturate(",!1),C=Oe("sepia()"),j=Fe("sepia(",!1),I=Oe("<number-percentage>"),T=Oe("<integer>"),V=/^[0-9]/,A=Ee([["0","9"]],!1,!1),P=Oe("<number>"),q=Fe(".",!1),M=function(){return parseFloat(Re())},k=Oe("<signedNumber>"),z=/^[+\-]/,N=Ee(["+","-"],!1,!1),L=Fe("%",!1),U=Oe("<angle>"),H=function(e,t){return e*t},J=Fe("0",!1),D=Oe("<unit>"),G=Fe("deg",!1),Q=Fe("grad",!1),B=Fe("rad",!1),W=Fe("turn",!1),Y=Oe("<length>"),Z=Fe("px",!1),X=Fe("cm",!1),K=Fe("mm",!1),$=Fe("Q",!1),ee=Fe("in",!1),te=Fe("pc",!1),re=Fe("pt",!1),ie=Fe("#",!1),ne=Fe("rgba(",!1),oe=Fe(",",!1),ae=function(e,t,r){return[255*e,255*t,255*r,1]},se=function(e,t,r){return[e,t,r,1]},ue=Fe("rgb(",!1),le=/^[0-9a-fA-F]/,ce=Ee([["0","9"],["a","f"],["A","F"]],!1,!1),pe=Oe("whitespace"),de=/^[ \t\n\r]/,fe=Ee([" ","\t","\n","\r"],!1,!1),he=Oe("<named-color>"),ye=/^[a-z]/,ve=Ee([["a","z"]],!1,!1),ge=function(){var t=Re();return He.has(t)||function(t,r){throw function(t,r){return new e(t,null,null,r)}(t,r=void 0!==r?r:je(me,_e))}('unknown color "'+t+'"'),Ue[t].concat(1)},_e=0,me=0,be=[{line:1,column:1}],we=0,xe=[],Se=0;if("startRule"in r){if(!(r.startRule in o))throw new Error("Can't start parsing from rule \""+r.startRule+'".');a=o[r.startRule]}function Re(){return t.substring(me,_e)}function Fe(e,t){return{type:"literal",text:e,ignoreCase:t}}function Ee(e,t,r){return{type:"class",parts:e,inverted:t,ignoreCase:r}}function Oe(e){return{type:"other",description:e}}function Ce(e){var r,i=be[e];if(i)return i;for(r=e-1;!be[r];)r--;for(i={line:(i=be[r]).line,column:i.column};r<e;)10===t.charCodeAt(r)?(i.line++,i.column=1):i.column++,r++;return be[e]=i,i}function je(e,t){var r=Ce(e),i=Ce(t);return{start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:i.line,column:i.column}}}function Ie(e){_e<we||(_e>we&&(we=_e,xe=[]),xe.push(e))}function Te(){var e;return(e=function(){var e,r;return Se++,e=_e,Le()!==n?("none"===t.substr(_e,4)?(r="none",_e+=4):(r=n,0===Se&&Ie(u)),r!==n&&Le()!==n?(me=e,e=null):(_e=e,e=n)):(_e=e,e=n),Se--,e===n&&0===Se&&Ie(s),e}())===n&&(e=function(){var e,t;if(e=[],(t=Ve())!==n)for(;t!==n;)e.push(t),t=Ve();else e=n;return e}()),e}function Ve(){var e;return(e=function(){var e,r,i,o;return Se++,e=_e,Le()!==n?("blur("===t.substr(_e,5)?(r="blur(",_e+=5):(r=n,0===Se&&Ie(c)),r!==n&&Le()!==n&&(i=ke())!==n&&Le()!==n?(41===t.charCodeAt(_e)?(o=")",_e++):(o=n,0===Se&&Ie(p)),o!==n&&Le()!==n?(me=e,e={type:"blur",radius:i}):(_e=e,e=n)):(_e=e,e=n)):(_e=e,e=n),Se--,e===n&&0===Se&&Ie(l),e}())===n&&(e=function(){var e,r,i,o;return Se++,e=_e,Le()!==n?("brightness("===t.substr(_e,11)?(r="brightness(",_e+=11):(r=n,0===Se&&Ie(f)),r!==n&&Le()!==n&&(i=Ae())!==n&&Le()!==n?(41===t.charCodeAt(_e)?(o=")",_e++):(o=n,0===Se&&Ie(p)),o!==n&&Le()!==n?(me=e,e={type:"brightness",amount:i}):(_e=e,e=n)):(_e=e,e=n)):(_e=e,e=n),Se--,e===n&&0===Se&&Ie(d),e}())===n&&(e=function(){var e,r,i,o;return Se++,e=_e,Le()!==n?("contrast("===t.substr(_e,9)?(r="contrast(",_e+=9):(r=n,0===Se&&Ie(y)),r!==n&&Le()!==n&&(i=Ae())!==n&&Le()!==n?(41===t.charCodeAt(_e)?(o=")",_e++):(o=n,0===Se&&Ie(p)),o!==n&&Le()!==n?(me=e,e={type:"contrast",amount:i}):(_e=e,e=n)):(_e=e,e=n)):(_e=e,e=n),Se--,e===n&&0===Se&&Ie(h),e}())===n&&(e=function(){var e,r,i,o,a,s,u;return Se++,e=_e,Le()!==n?("drop-shadow("===t.substr(_e,12)?(r="drop-shadow(",_e+=12):(r=n,0===Se&&Ie(g)),r!==n&&Le()!==n&&(i=ke())!==n&&Le()!==n&&(o=ke())!==n&&Le()!==n?((a=ke())===n&&(a=null),a!==n&&Le()!==n?((s=function(){var e,r,i,o,a,s,u,l,c,d,f,h,y,v,g,_,m;return e=_e,35===t.charCodeAt(_e)?(r="#",_e++):(r=n,0===Se&&Ie(ie)),r!==n?(i=_e,(o=Ne())!==n&&(a=Ne())!==n?i=o=[o,a]:(_e=i,i=n),i!==n?(o=_e,(a=Ne())!==n&&(s=Ne())!==n?o=a=[a,s]:(_e=o,o=n),o!==n?(a=_e,(s=Ne())!==n&&(u=Ne())!==n?a=s=[s,u]:(_e=a,a=n),a!==n?(me=e,_=o,m=a,e=r=[parseInt(i.join(""),16),parseInt(_.join(""),16),parseInt(m.join(""),16)]):(_e=e,e=n)):(_e=e,e=n)):(_e=e,e=n)):(_e=e,e=n),e===n&&(e=_e,35===t.charCodeAt(_e)?(r="#",_e++):(r=n,0===Se&&Ie(ie)),r!==n&&(i=Ne())!==n&&(o=Ne())!==n&&(a=Ne())!==n?(me=e,r=function(e,t,r){return[parseInt([e,e].join(""),16),parseInt([t,t].join(""),16),parseInt([r,r].join(""),16)]}(i,o,a),e=r):(_e=e,e=n),e===n&&(e=_e,"rgba("===t.substr(_e,5)?(r="rgba(",_e+=5):(r=n,0===Se&&Ie(ne)),r!==n&&(i=Le())!==n&&(o=qe())!==n&&(a=Le())!==n?(44===t.charCodeAt(_e)?(s=",",_e++):(s=n,0===Se&&Ie(oe)),s!==n&&(u=Le())!==n&&(l=qe())!==n&&Le()!==n?(44===t.charCodeAt(_e)?(c=",",_e++):(c=n,0===Se&&Ie(oe)),c!==n&&Le()!==n&&(d=qe())!==n&&(f=Le())!==n?(44===t.charCodeAt(_e)?(h=",",_e++):(h=n,0===Se&&Ie(oe)),h!==n&&(y=Le())!==n&&(v=Ae())!==n&&Le()!==n?(41===t.charCodeAt(_e)?(g=")",_e++):(g=n,0===Se&&Ie(p)),g!==n?(me=e,e=r=function(e,t,r,i){return[255*e,255*t,255*r,i]}(o,l,d,v)):(_e=e,e=n)):(_e=e,e=n)):(_e=e,e=n)):(_e=e,e=n)):(_e=e,e=n),e===n&&(e=_e,"rgba("===t.substr(_e,5)?(r="rgba(",_e+=5):(r=n,0===Se&&Ie(ne)),r!==n&&(i=Le())!==n&&(o=Pe())!==n&&(a=Le())!==n?(44===t.charCodeAt(_e)?(s=",",_e++):(s=n,0===Se&&Ie(oe)),s!==n&&(u=Le())!==n&&(l=Pe())!==n&&Le()!==n?(44===t.charCodeAt(_e)?(c=",",_e++):(c=n,0===Se&&Ie(oe)),c!==n&&Le()!==n&&(d=Pe())!==n?(44===t.charCodeAt(_e)?(f=",",_e++):(f=n,0===Se&&Ie(oe)),f!==n&&(h=Le())!==n&&(y=Ae())!==n?(41===t.charCodeAt(_e)?(v=")",_e++):(v=n,0===Se&&Ie(p)),v!==n?(me=e,e=r=function(e,t,r,i){return[e,t,r,i]}(o,l,d,y)):(_e=e,e=n)):(_e=e,e=n)):(_e=e,e=n)):(_e=e,e=n)):(_e=e,e=n),e===n&&(e=_e,"rgba("===t.substr(_e,5)?(r="rgba(",_e+=5):(r=n,0===Se&&Ie(ne)),r!==n&&(i=Le())!==n&&(o=qe())!==n&&(a=Le())!==n?(44===t.charCodeAt(_e)?(s=",",_e++):(s=n,0===Se&&Ie(oe)),s!==n&&(u=Le())!==n&&(l=qe())!==n&&Le()!==n?(44===t.charCodeAt(_e)?(c=",",_e++):(c=n,0===Se&&Ie(oe)),c!==n&&Le()!==n&&(d=qe())!==n&&(f=Le())!==n?(41===t.charCodeAt(_e)?(h=")",_e++):(h=n,0===Se&&Ie(p)),h!==n?(me=e,e=r=ae(o,l,d)):(_e=e,e=n)):(_e=e,e=n)):(_e=e,e=n)):(_e=e,e=n),e===n&&(e=_e,"rgba("===t.substr(_e,5)?(r="rgba(",_e+=5):(r=n,0===Se&&Ie(ne)),r!==n&&(i=Le())!==n&&(o=Pe())!==n&&(a=Le())!==n?(44===t.charCodeAt(_e)?(s=",",_e++):(s=n,0===Se&&Ie(oe)),s!==n&&(u=Le())!==n&&(l=Pe())!==n&&Le()!==n?(44===t.charCodeAt(_e)?(c=",",_e++):(c=n,0===Se&&Ie(oe)),c!==n&&Le()!==n&&(d=Pe())!==n?(41===t.charCodeAt(_e)?(f=")",_e++):(f=n,0===Se&&Ie(p)),f!==n?(me=e,e=r=se(o,l,d)):(_e=e,e=n)):(_e=e,e=n)):(_e=e,e=n)):(_e=e,e=n),e===n&&(e=_e,"rgb("===t.substr(_e,4)?(r="rgb(",_e+=4):(r=n,0===Se&&Ie(ue)),r!==n&&(i=Le())!==n&&(o=qe())!==n&&(a=Le())!==n?(44===t.charCodeAt(_e)?(s=",",_e++):(s=n,0===Se&&Ie(oe)),s!==n&&(u=Le())!==n&&(l=qe())!==n&&Le()!==n?(44===t.charCodeAt(_e)?(c=",",_e++):(c=n,0===Se&&Ie(oe)),c!==n&&Le()!==n&&(d=qe())!==n&&(f=Le())!==n?(41===t.charCodeAt(_e)?(h=")",_e++):(h=n,0===Se&&Ie(p)),h!==n?(me=e,e=r=ae(o,l,d)):(_e=e,e=n)):(_e=e,e=n)):(_e=e,e=n)):(_e=e,e=n),e===n&&(e=_e,"rgb("===t.substr(_e,4)?(r="rgb(",_e+=4):(r=n,0===Se&&Ie(ue)),r!==n&&(i=Le())!==n&&(o=Pe())!==n&&(a=Le())!==n?(44===t.charCodeAt(_e)?(s=",",_e++):(s=n,0===Se&&Ie(oe)),s!==n&&(u=Le())!==n&&(l=Pe())!==n&&Le()!==n?(44===t.charCodeAt(_e)?(c=",",_e++):(c=n,0===Se&&Ie(oe)),c!==n&&Le()!==n&&(d=Pe())!==n&&(f=Le())!==n?(41===t.charCodeAt(_e)?(h=")",_e++):(h=n,0===Se&&Ie(p)),h!==n?(me=e,e=r=se(o,l,d)):(_e=e,e=n)):(_e=e,e=n)):(_e=e,e=n)):(_e=e,e=n),e===n&&(e=function(){var e,r,i;if(Se++,e=_e,r=[],ye.test(t.charAt(_e))?(i=t.charAt(_e),_e++):(i=n,0===Se&&Ie(ve)),i!==n)for(;i!==n;)r.push(i),ye.test(t.charAt(_e))?(i=t.charAt(_e),_e++):(i=n,0===Se&&Ie(ve));else r=n;return r!==n&&(me=e,r=ge()),Se--,(e=r)===n&&(r=n,0===Se&&Ie(he)),e}())))))))),e}())===n&&(s=null),s!==n&&Le()!==n?(41===t.charCodeAt(_e)?(u=")",_e++):(u=n,0===Se&&Ie(p)),u!==n&&Le()!==n?(me=e,e={type:"drop-shadow",offsetX:i,offsetY:o,blurRadius:a,color:s}):(_e=e,e=n)):(_e=e,e=n)):(_e=e,e=n)):(_e=e,e=n)):(_e=e,e=n),Se--,e===n&&0===Se&&Ie(v),e}())===n&&(e=function(){var e,r,i,o;return Se++,e=_e,Le()!==n?("grayscale("===t.substr(_e,10)?(r="grayscale(",_e+=10):(r=n,0===Se&&Ie(m)),r!==n&&Le()!==n&&(i=Ae())!==n&&Le()!==n?(41===t.charCodeAt(_e)?(o=")",_e++):(o=n,0===Se&&Ie(p)),o!==n&&Le()!==n?(me=e,e={type:"grayscale",amount:i}):(_e=e,e=n)):(_e=e,e=n)):(_e=e,e=n),Se--,e===n&&0===Se&&Ie(_),e}())===n&&(e=function(){var e,r,i,o;return Se++,e=_e,Le()!==n?("hue-rotate("===t.substr(_e,11)?(r="hue-rotate(",_e+=11):(r=n,0===Se&&Ie(w)),r!==n&&Le()!==n&&(i=function(){var e,r,i;return Se++,e=_e,(r=function(){var e,r;return Se++,e=_e,z.test(t.charAt(_e))?(r=t.charAt(_e),_e++):(r=n,0===Se&&Ie(N)),r===n&&(r=null),r!==n&&Pe()!==n?(me=e,e=r=M()):(_e=e,e=n),Se--,e===n&&(r=n,0===Se&&Ie(k)),e}())!==n&&(i=Me())!==n?(me=e,e=r=H(r,i)):(_e=e,e=n),e===n&&(e=_e,48===t.charCodeAt(_e)?(r="0",_e++):(r=n,0===Se&&Ie(J)),r!==n?((i=Me())===n&&(i=null),i!==n?(me=e,e=r=0):(_e=e,e=n)):(_e=e,e=n)),Se--,e===n&&(r=n,0===Se&&Ie(U)),e}())!==n&&Le()!==n?(41===t.charCodeAt(_e)?(o=")",_e++):(o=n,0===Se&&Ie(p)),o!==n&&Le()!==n?(me=e,e={type:"hue-rotate",angle:i}):(_e=e,e=n)):(_e=e,e=n)):(_e=e,e=n),Se--,e===n&&0===Se&&Ie(b),e}())===n&&(e=function(){var e,r,i,o;return Se++,e=_e,Le()!==n?("invert("===t.substr(_e,7)?(r="invert(",_e+=7):(r=n,0===Se&&Ie(S)),r!==n&&Le()!==n&&(i=Ae())!==n&&Le()!==n?(41===t.charCodeAt(_e)?(o=")",_e++):(o=n,0===Se&&Ie(p)),o!==n&&Le()!==n?(me=e,e={type:"invert",amount:i}):(_e=e,e=n)):(_e=e,e=n)):(_e=e,e=n),Se--,e===n&&0===Se&&Ie(x),e}())===n&&(e=function(){var e,r,i,o;return Se++,e=_e,Le()!==n?("opacity("===t.substr(_e,8)?(r="opacity(",_e+=8):(r=n,0===Se&&Ie(F)),r!==n&&Le()!==n&&(i=Ae())!==n&&Le()!==n?(41===t.charCodeAt(_e)?(o=")",_e++):(o=n,0===Se&&Ie(p)),o!==n&&Le()!==n?(me=e,e={type:"opacity",amount:i}):(_e=e,e=n)):(_e=e,e=n)):(_e=e,e=n),Se--,e===n&&0===Se&&Ie(R),e}())===n&&(e=function(){var e,r,i,o;return Se++,e=_e,Le()!==n?("saturate("===t.substr(_e,9)?(r="saturate(",_e+=9):(r=n,0===Se&&Ie(O)),r!==n&&Le()!==n&&(i=Ae())!==n&&Le()!==n?(41===t.charCodeAt(_e)?(o=")",_e++):(o=n,0===Se&&Ie(p)),o!==n&&Le()!==n?(me=e,e={type:"saturate",amount:i}):(_e=e,e=n)):(_e=e,e=n)):(_e=e,e=n),Se--,e===n&&0===Se&&Ie(E),e}())===n&&(e=function(){var e,r,i,o;return Se++,e=_e,Le()!==n?("sepia("===t.substr(_e,6)?(r="sepia(",_e+=6):(r=n,0===Se&&Ie(j)),r!==n&&Le()!==n&&(i=Ae())!==n&&Le()!==n?(41===t.charCodeAt(_e)?(o=")",_e++):(o=n,0===Se&&Ie(p)),o!==n&&Le()!==n?(me=e,e={type:"sepia",amount:i}):(_e=e,e=n)):(_e=e,e=n)):(_e=e,e=n),Se--,e===n&&0===Se&&Ie(C),e}()),e}function Ae(){var e;return Se++,(e=qe())===n&&(e=Pe()),Se--,e===n&&0===Se&&Ie(I),e}function Pe(){var e,r,i,o,a;if(Se++,e=_e,r=[],V.test(t.charAt(_e))?(i=t.charAt(_e),_e++):(i=n,0===Se&&Ie(A)),i!==n)for(;i!==n;)r.push(i),V.test(t.charAt(_e))?(i=t.charAt(_e),_e++):(i=n,0===Se&&Ie(A));else r=n;if(r!==n)if(46===t.charCodeAt(_e)?(i=".",_e++):(i=n,0===Se&&Ie(q)),i!==n){if(o=[],V.test(t.charAt(_e))?(a=t.charAt(_e),_e++):(a=n,0===Se&&Ie(A)),a!==n)for(;a!==n;)o.push(a),V.test(t.charAt(_e))?(a=t.charAt(_e),_e++):(a=n,0===Se&&Ie(A));else o=n;o!==n?(me=e,e=r=M()):(_e=e,e=n)}else _e=e,e=n;else _e=e,e=n;return e===n&&(e=function(){var e,r,i;if(Se++,e=_e,r=[],V.test(t.charAt(_e))?(i=t.charAt(_e),_e++):(i=n,0===Se&&Ie(A)),i!==n)for(;i!==n;)r.push(i),V.test(t.charAt(_e))?(i=t.charAt(_e),_e++):(i=n,0===Se&&Ie(A));else r=n;return r!==n&&(me=e,r=parseInt(Re(),10)),Se--,(e=r)===n&&(r=n,0===Se&&Ie(T)),e}()),Se--,e===n&&(r=n,0===Se&&Ie(P)),e}function qe(){var e,r,i;return e=_e,(r=Pe())!==n?(37===t.charCodeAt(_e)?(i="%",_e++):(i=n,0===Se&&Ie(L)),i!==n?(me=e,e=r/=100):(_e=e,e=n)):(_e=e,e=n),e}function Me(){var e,r;return Se++,e=_e,"deg"===t.substr(_e,3)?(r="deg",_e+=3):(r=n,0===Se&&Ie(G)),r!==n&&(me=e,r=1),(e=r)===n&&(e=_e,"grad"===t.substr(_e,4)?(r="grad",_e+=4):(r=n,0===Se&&Ie(Q)),r!==n&&(me=e,r=.9),(e=r)===n&&(e=_e,"rad"===t.substr(_e,3)?(r="rad",_e+=3):(r=n,0===Se&&Ie(B)),r!==n&&(me=e,r=180/Math.PI),(e=r)===n&&(e=_e,"turn"===t.substr(_e,4)?(r="turn",_e+=4):(r=n,0===Se&&Ie(W)),r!==n&&(me=e,r=1/360),e=r))),Se--,e===n&&(r=n,0===Se&&Ie(D)),e}function ke(){var e,r,i;return Se++,e=_e,(r=Pe())!==n&&(i=ze())!==n?(me=e,e=r=H(r,i)):(_e=e,e=n),e===n&&(e=_e,48===t.charCodeAt(_e)?(r="0",_e++):(r=n,0===Se&&Ie(J)),r!==n?((i=ze())===n&&(i=null),i!==n?(me=e,e=r=0):(_e=e,e=n)):(_e=e,e=n)),Se--,e===n&&(r=n,0===Se&&Ie(Y)),e}function ze(){var e,r;return e=_e,"px"===t.substr(_e,2)?(r="px",_e+=2):(r=n,0===Se&&Ie(Z)),r!==n&&(me=e,r=1),(e=r)===n&&(e=_e,"cm"===t.substr(_e,2)?(r="cm",_e+=2):(r=n,0===Se&&Ie(X)),r!==n&&(me=e,r=96/2.54),(e=r)===n&&(e=_e,"mm"===t.substr(_e,2)?(r="mm",_e+=2):(r=n,0===Se&&Ie(K)),r!==n&&(me=e,r=96/2.54/10),(e=r)===n&&(e=_e,81===t.charCodeAt(_e)?(r="Q",_e++):(r=n,0===Se&&Ie($)),r!==n&&(me=e,r=96/2.54/40),(e=r)===n&&(e=_e,"in"===t.substr(_e,2)?(r="in",_e+=2):(r=n,0===Se&&Ie(ee)),r!==n&&(me=e,r=96),(e=r)===n&&(e=_e,"pc"===t.substr(_e,2)?(r="pc",_e+=2):(r=n,0===Se&&Ie(te)),r!==n&&(me=e,r=16),(e=r)===n&&(e=_e,"pt"===t.substr(_e,2)?(r="pt",_e+=2):(r=n,0===Se&&Ie(re)),r!==n&&(me=e,r=96/73),e=r)))))),e}function Ne(){var e;return le.test(t.charAt(_e))?(e=t.charAt(_e),_e++):(e=n,0===Se&&Ie(ce)),e}function Le(){var e,r;for(Se++,e=[],de.test(t.charAt(_e))?(r=t.charAt(_e),_e++):(r=n,0===Se&&Ie(fe));r!==n;)e.push(r),de.test(t.charAt(_e))?(r=t.charAt(_e),_e++):(r=n,0===Se&&Ie(fe));return Se--,e===n&&(r=n,0===Se&&Ie(pe)),e}var Ue={transparent:[0,0,0,0],black:[0,0,0],silver:[192,192,192],gray:[128,128,128],white:[255,255,255],maroon:[128,0,0],red:[255,0,0],purple:[128,0,128],fuchsia:[255,0,255],green:[0,128,0],lime:[0,255,0],olive:[128,128,0],yellow:[255,255,0],navy:[0,0,128],blue:[0,0,255],teal:[0,128,128],aqua:[0,255,255],aliceblue:[240,248,255],antiquewhite:[250,235,215],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],blanchedalmond:[255,235,205],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],oldlace:[253,245,230],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],rebeccapurple:[102,51,153],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],whitesmoke:[245,245,245],yellowgreen:[154,205,50]},He=new Set(Object.keys(Ue));if((i=a())!==n&&_e===t.length)return i;throw i!==n&&_e<t.length&&Ie({type:"end"}),function(t,r,i){return new e(e.buildMessage(t,r),t,r,i)}(xe,we<t.length?t.charAt(we):null,je(we,we<t.length?we+1:we))}}})?i.apply(null,[]):i)||(e.exports=n)},"6i4F":function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("zOht"),r("y4WC"),r("K2Kz"),r("8MXS"),r("Vx27"),r("YaB4"),r("ZMIQ"),r("7MXx"),r("ts8o"),r("20TT")],void 0===(n=(function(e,t,r,i,n,o,a,s,u,l,c,p){Object.defineProperty(t,"__esModule",{value:!0});var d=i.ofType({key:"type",base:u,typeMap:{rect:l,path:p,geometry:c}});t.LayerView2DMixin=function(e){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.clips=new d,t.moving=!1,t.attached=!1,t.lastUpdateId=-1,t.updateRequested=!1,t}return r.__extends(t,e),t.prototype.initialize=function(){var e,t=this;this.container||(this.container=new s.Container),this.handles.add([o.init(this,"suspended",(function(e){t.container&&(t.container.visible=!e),t.view&&!e&&t.updateRequested&&t.view.requestUpdate()}),!0),o.init(this,["layer.opacity","container"],(function(){var e,r;t.container&&(t.container.opacity=null!==(r=null===(e=t.layer)||void 0===e?void 0:e.opacity)&&void 0!==r?r:1)}),!0),o.init(this,["layer.blendMode"],(function(e){t.container&&(t.container.blendMode=e)}),!0),this.clips.on("change",(function(){t.container.clips=t.clips,t.notifyChange("clips")}))]),this.container.clips=this.clips,(null===(e=this.view)||void 0===e?void 0:e.whenLayerView)?this.view.whenLayerView(this.layer).then((function(e){e!==t||t.attached||t.destroyed||(t.attach(),t.requestUpdate(),t.attached=!0)}),(function(){})):this.when().then((function(){t.attached||t.destroyed||(t.attach(),t.requestUpdate(),t.attached=!0)}),(function(){}))},t.prototype.destroy=function(){this.attached&&(this.detach(),this.attached=!1),this.handles.remove("initialize"),this.updateRequested=!1,this.layer=null,this.view=null},Object.defineProperty(t.prototype,"updating",{get:function(){return!this.attached||!this.suspended&&(this.updateRequested||this.isUpdating())},enumerable:!0,configurable:!0}),t.prototype.isVisibleAtScale=function(e){var t=!0,r=this.layer,i=r.minScale,n=r.maxScale;if(null!=i&&null!=n){var o=!i,a=!n;!o&&e<=i&&(o=!0),!a&&e>=n&&(a=!0),t=o&&a}return t},t.prototype.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.suspended||this.view.requestUpdate())},t.prototype.processUpdate=function(e){!this.isFulfilled()||this.isResolved()?(this._set("updateParameters",e),this.updateRequested&&!this.suspended&&(this.updateRequested=!1,this.update(e))):this.updateRequested=!1},t.prototype.isUpdating=function(){return!1},t.prototype.isRendering=function(){return!1},t.prototype.canResume=function(){return!!e.prototype.canResume.call(this)&&this.isVisibleAtScale(this.view.scale)},r.__decorate([a.property({type:d,set:function(e){var t=n.referenceSetter(e,this._get("clips"),d);this._set("clips",t)}})],t.prototype,"clips",void 0),r.__decorate([a.property()],t.prototype,"moving",void 0),r.__decorate([a.property()],t.prototype,"attached",void 0),r.__decorate([a.property()],t.prototype,"container",void 0),r.__decorate([a.property({dependsOn:["view.scale","layer.minScale","layer.maxScale"]})],t.prototype,"suspended",void 0),r.__decorate([a.property({readOnly:!0})],t.prototype,"updateParameters",void 0),r.__decorate([a.property()],t.prototype,"updateRequested",void 0),r.__decorate([a.property({dependsOn:["attached","updateRequested","suspended"]})],t.prototype,"updating",null),r.__decorate([a.property()],t.prototype,"view",void 0),r.__decorate([a.subclass("esri.views.2d.layers.LayerView2D")],t)}(e)}}).apply(null,i))||(e.exports=n)},"7MXx":function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("zOht"),r("Vx27"),r("ZMIQ")],void 0===(n=(function(e,t,r,i,n){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="rect",t.left=null,t.right=null,t.top=null,t.bottom=null,t}var n;return r.__extends(t,e),n=t,t.prototype.clone=function(){return new n({left:this.left,right:this.right,top:this.top,bottom:this.bottom})},Object.defineProperty(t.prototype,"version",{get:function(){return(this._get("version")||0)+1},enumerable:!0,configurable:!0}),r.__decorate([i.property({type:[Number,String],json:{write:!0}})],t.prototype,"left",void 0),r.__decorate([i.property({type:[Number,String],json:{write:!0}})],t.prototype,"right",void 0),r.__decorate([i.property({type:[Number,String],json:{write:!0}})],t.prototype,"top",void 0),r.__decorate([i.property({type:[Number,String],json:{write:!0}})],t.prototype,"bottom",void 0),r.__decorate([i.property({readOnly:!0,dependsOn:["left","right","top","bottom"]})],t.prototype,"version",null),n=r.__decorate([i.subclass("esri.views.layers.support.ClipRect")],t)}(n)}).apply(null,i))||(e.exports=n)},"8iBb":function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("zOht"),r("ma1f"),r("qsST"),r("LxLY"),r("qMld"),r("ULaq"),r("8MXS"),r("Vx27"),r("k7g7"),r("ml7j"),r("sCbS"),r("IpeC"),r("dDbr"),r("e4th"),r("I6zq")],void 0===(n=(function(e,t,r,i,n,o,a,s,u,l,c,p,d,f,h,y,v){Object.defineProperty(t,"__esModule",{value:!0});var g=n.getLogger("esri.views.layers.FeatureLayerView");t.FeatureLayerView=function(e){return function(e){function t(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var i=e.apply(this,t)||this;return i._updatingRequiredFieldsPromise=null,i.effect=null,i.filter=null,i.layer=null,i.requiredFields=[],i.view=null,i}return r.__extends(t,e),t.prototype.initialize=function(){var e=this;u.init(this,["layer.renderer","layer.labelingInfo","layer.elevationInfo.featureExpressionInfo","layer.displayField","filter","effect","layer.timeInfo","timeExtent"],(function(){return e._handleRequiredFieldsChange()}),!0)},Object.defineProperty(t.prototype,"availableFields",{get:function(){var e=this.layer,t=this.layer.fields,i=this.requiredFields;return c.fixFields(t,"outFields"in e&&e.outFields?r.__spreadArrays(c.unpackFieldNames(t,e.outFields),i):i)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maximumNumberOfFeatures",{get:function(){return 0},set:function(e){g.error("#maximumNumberOfFeatures=","Setting maximum number of features is not supported")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maximumNumberOfFeaturesExceeded",{get:function(){return!1},enumerable:!0,configurable:!0}),t.prototype.highlight=function(e,t){throw void 0===t&&(t={}),new Error("missing implementation")},t.prototype.createQuery=function(){var e={outFields:["*"],returnGeometry:!0,outSpatialReference:this.view.spatialReference},t=o.isSome(this.filter)?this.filter.createQuery(e):new f(e);return this.timeExtent&&(t.timeExtent=t.timeExtent?t.timeExtent.intersection(this.timeExtent):this.timeExtent.clone()),t},t.prototype.queryFeatures=function(e,t){throw new Error("missing implementation")},t.prototype.queryObjectIds=function(e,t){throw new Error("missing implementation")},t.prototype.queryFeatureCount=function(e,t){throw new Error("missing implementation")},t.prototype.queryExtent=function(e,t){throw new Error("missing implementation")},t.prototype._loadArcadeModules=function(e){if(e.get("expressionInfos.length"))return d.loadArcade()},t.prototype._handleRequiredFieldsChange=function(){var e=this,t=this._updateRequiredFields();this._set("_updatingRequiredFieldsPromise",t),t.then((function(){e._updatingRequiredFieldsPromise===t&&e._set("_updatingRequiredFieldsPromise",null)}))},t.prototype._updateRequiredFields=function(){return r.__awaiter(this,void 0,void 0,(function(){var e,t,i,n,u,l,p,d,f,h,y,v,_,m,b;return r.__generator(this,(function(r){switch(r.label){case 0:return this.layer&&this.view?(e="3d"===this.view.type,i=(t=this).layer,u=(n=t.layer).fields,l=n.objectIdField,p=n.renderer,d=n.displayField,f=i.featureReduction,h=new Set,[4,a.eachAlways([p?p.collectRequiredFields(h,u):null,c.collectLabelingFields(h,i),e?c.collectElevationFields(h,i):null,o.isSome(this.filter)?c.collectFilterFields(h,i,this.filter):null,this.effect?c.collectFilterFields(h,i,this.effect.filter):null,f?c.collectFeatureReductionFields(h,i,f):null])]):[2];case 1:for(y=r.sent(),i.timeInfo&&this.timeExtent&&c.collectFields(h,i.fields,[i.timeInfo.startField,i.timeInfo.endField]),v=0,_=y;v<_.length;v++)(m=_[v]).error&&g.error(m.error);return c.collectField(h,u,l),e&&d&&c.collectField(h,u,d),b=s.valuesOfSet(h).sort(),this._set("requiredFields",b),[2]}}))}))},t.prototype.validateFetchPopupFeatures=function(e){var t=this.layer;return this.layer.popupEnabled?v.getFetchPopupTemplate(this.layer,e)?void 0:new i("featurelayerview:fetchPopupFeatures","Layer does not define a popup template",{layer:t}):new i("featurelayerview:fetchPopupFeatures","Popups are disabled",{layer:t})},t.prototype.fetchClientPopupFeatures=function(e){return r.__awaiter(this,void 0,void 0,(function(){var t,i,n,s,u,l,p,d,f,h,y,g;return r.__generator(this,(function(r){switch(r.label){case 0:return(t=o.isSome(e)?e.clientGraphics:null)&&0!==t.length?(i=[],n=[],u=v.getFetchPopupTemplate(s=this.layer,e),o.isSome(u)?[4,this._loadArcadeModules(u)]:[2,a.resolve([])]):[2,a.resolve([])];case 1:return l=r.sent(),p=l&&l.arcadeUtils.hasGeometryOperations(u),[4,this.createPopupQuery(e)];case 2:for(d=r.sent(),f=c.unpackFieldNames(s.fields,d.outFields),h=0,y=t;h<y.length;h++)g=y[h],p||!c.featureHasFields(f,g)?n.push(g):i.push(g);return"stream"===s.type||0===n.length?[2,a.resolve(i)]:(d.objectIds=n.map((function(e){return e.attributes[s.objectIdField]})),[2,s.queryFeatures(d).then((function(e){return i.concat(e.features)})).catch((function(){return n}))])}}))}))},t.prototype.createPopupQuery=function(e){return r.__awaiter(this,void 0,void 0,(function(){var t,i;return r.__generator(this,(function(r){switch(r.label){case 0:return(t=this.layer.createQuery()).returnGeometry=!0,t.returnZ=!0,t.returnM=!0,i=t,[4,v.getRequiredFields(this.layer,v.getFetchPopupTemplate(this.layer,e))];case 1:return i.outFields=r.sent(),t.outSpatialReference=this.view.spatialReference,[2,t]}}))}))},t.prototype.canResume=function(){var t;return!(!e.prototype.canResume.call(this)||null!==(t=this.timeExtent)&&void 0!==t&&t.isEmpty)},r.__decorate([l.property()],t.prototype,"_updatingRequiredFieldsPromise",void 0),r.__decorate([l.property({readOnly:!0,dependsOn:["layer.outFields?","requiredFields"]})],t.prototype,"availableFields",null),r.__decorate([l.property({type:h})],t.prototype,"effect",void 0),r.__decorate([l.property({type:y})],t.prototype,"filter",void 0),r.__decorate([l.property(p.combinedViewLayerTimeExtentProperty)],t.prototype,"timeExtent",void 0),r.__decorate([l.property()],t.prototype,"layer",void 0),r.__decorate([l.property({type:Number})],t.prototype,"maximumNumberOfFeatures",null),r.__decorate([l.property({readOnly:!0,type:Boolean})],t.prototype,"maximumNumberOfFeaturesExceeded",null),r.__decorate([l.property({readOnly:!0})],t.prototype,"requiredFields",void 0),r.__decorate([l.property({dependsOn:["timeExtent"]})],t.prototype,"suspended",void 0),r.__decorate([l.property()],t.prototype,"view",void 0),r.__decorate([l.subclass("esri.views.layers.FeatureLayerView")],t)}(e)}}).apply(null,i))||(e.exports=n)},CaYo:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=(function(e,t){function r(e,t){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function i(e,t,i,n,o,a){return r((s=r(r(t,e),r(n,a)))<<(u=o)|s>>>32-u,i);var s,u}function n(e,t,r,n,o,a,s){return i(t&r|~t&n,e,t,o,a,s)}function o(e,t,r,n,o,a,s){return i(t&n|r&~n,e,t,o,a,s)}function a(e,t,r,n,o,a,s){return i(t^r^n,e,t,o,a,s)}function s(e,t,r,n,o,a,s){return i(r^(t|~n),e,t,o,a,s)}Object.defineProperty(t,"__esModule",{value:!0}),t.outputTypes={Base64:0,Hex:1,String:2,Raw:3},t.createMD5Hash=function(e,i){void 0===i&&(i=t.outputTypes.Hex);var u=i||t.outputTypes.Base64,l=function(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var i=1732584193,u=-271733879,l=-1732584194,c=271733878,p=0;p<e.length;p+=16){var d=i,f=u,h=l,y=c;i=n(i,u,l,c,e[p+0],7,-680876936),c=n(c,i,u,l,e[p+1],12,-389564586),l=n(l,c,i,u,e[p+2],17,606105819),u=n(u,l,c,i,e[p+3],22,-1044525330),i=n(i,u,l,c,e[p+4],7,-176418897),c=n(c,i,u,l,e[p+5],12,1200080426),l=n(l,c,i,u,e[p+6],17,-1473231341),u=n(u,l,c,i,e[p+7],22,-45705983),i=n(i,u,l,c,e[p+8],7,1770035416),c=n(c,i,u,l,e[p+9],12,-1958414417),l=n(l,c,i,u,e[p+10],17,-42063),u=n(u,l,c,i,e[p+11],22,-1990404162),i=n(i,u,l,c,e[p+12],7,1804603682),c=n(c,i,u,l,e[p+13],12,-40341101),l=n(l,c,i,u,e[p+14],17,-1502002290),i=o(i,u=n(u,l,c,i,e[p+15],22,1236535329),l,c,e[p+1],5,-165796510),c=o(c,i,u,l,e[p+6],9,-1069501632),l=o(l,c,i,u,e[p+11],14,643717713),u=o(u,l,c,i,e[p+0],20,-373897302),i=o(i,u,l,c,e[p+5],5,-701558691),c=o(c,i,u,l,e[p+10],9,38016083),l=o(l,c,i,u,e[p+15],14,-660478335),u=o(u,l,c,i,e[p+4],20,-405537848),i=o(i,u,l,c,e[p+9],5,568446438),c=o(c,i,u,l,e[p+14],9,-1019803690),l=o(l,c,i,u,e[p+3],14,-187363961),u=o(u,l,c,i,e[p+8],20,1163531501),i=o(i,u,l,c,e[p+13],5,-1444681467),c=o(c,i,u,l,e[p+2],9,-51403784),l=o(l,c,i,u,e[p+7],14,1735328473),i=a(i,u=o(u,l,c,i,e[p+12],20,-1926607734),l,c,e[p+5],4,-378558),c=a(c,i,u,l,e[p+8],11,-2022574463),l=a(l,c,i,u,e[p+11],16,1839030562),u=a(u,l,c,i,e[p+14],23,-35309556),i=a(i,u,l,c,e[p+1],4,-1530992060),c=a(c,i,u,l,e[p+4],11,1272893353),l=a(l,c,i,u,e[p+7],16,-155497632),u=a(u,l,c,i,e[p+10],23,-1094730640),i=a(i,u,l,c,e[p+13],4,681279174),c=a(c,i,u,l,e[p+0],11,-358537222),l=a(l,c,i,u,e[p+3],16,-722521979),u=a(u,l,c,i,e[p+6],23,76029189),i=a(i,u,l,c,e[p+9],4,-640364487),c=a(c,i,u,l,e[p+12],11,-421815835),l=a(l,c,i,u,e[p+15],16,530742520),i=s(i,u=a(u,l,c,i,e[p+2],23,-995338651),l,c,e[p+0],6,-198630844),c=s(c,i,u,l,e[p+7],10,1126891415),l=s(l,c,i,u,e[p+14],15,-1416354905),u=s(u,l,c,i,e[p+5],21,-57434055),i=s(i,u,l,c,e[p+12],6,1700485571),c=s(c,i,u,l,e[p+3],10,-1894986606),l=s(l,c,i,u,e[p+10],15,-1051523),u=s(u,l,c,i,e[p+1],21,-2054922799),i=s(i,u,l,c,e[p+8],6,1873313359),c=s(c,i,u,l,e[p+15],10,-30611744),l=s(l,c,i,u,e[p+6],15,-1560198380),u=s(u,l,c,i,e[p+13],21,1309151649),i=s(i,u,l,c,e[p+4],6,-145523070),c=s(c,i,u,l,e[p+11],10,-1120210379),l=s(l,c,i,u,e[p+2],15,718787259),u=s(u,l,c,i,e[p+9],21,-343485551),i=r(i,d),u=r(u,f),l=r(l,h),c=r(c,y)}return[i,u,l,c]}(function(e){for(var t=[],r=0,i=8*e.length;r<i;r+=8)t[r>>5]|=(255&e.charCodeAt(r/8))<<r%32;return t}(e),8*e.length);switch(u){case t.outputTypes.Raw:return l;case t.outputTypes.Hex:return function(e){for(var t="0123456789abcdef",r=[],i=0,n=4*e.length;i<n;i++)r.push(t.charAt(e[i>>2]>>i%4*8+4&15)+t.charAt(e[i>>2]>>i%4*8&15));return r.join("")}(l);case t.outputTypes.String:return function(e){for(var t=[],r=0,i=32*e.length;r<i;r+=8)t.push(String.fromCharCode(e[r>>5]>>>r%32&255));return t.join("")}(l);case t.outputTypes.Base64:return function(e){for(var t=[],r=0,i=4*e.length;r<i;r+=3)for(var n=(e[r>>2]>>r%4*8&255)<<16|(e[r+1>>2]>>(r+1)%4*8&255)<<8|e[r+2>>2]>>(r+2)%4*8&255,o=0;o<4;o++)t.push(8*r+6*o>32*e.length?"=":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(n>>6*(3-o)&63));return t.join("")}(l)}}}).apply(null,i))||(e.exports=n)},I6zq:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("zOht"),r("ll/V"),r("LxLY"),r("k7g7")],void 0===(n=(function(e,t,r,i,n,o){Object.defineProperty(t,"__esModule",{value:!0}),t.getRequiredFields=function(e,t){return void 0===t&&(t=e.popupTemplate),r.__awaiter(this,void 0,void 0,(function(){var a,s,u,l,c,p,d,f;return r.__generator(this,(function(h){switch(h.label){case 0:return n.isSome(t)?[4,t.getRequiredFields(e.fields)]:[2,[]];case 1:return a=h.sent(),s=t.lastEditInfoEnabled,u=e.objectIdField,l=e.typeIdField,c=e.globalIdField,p=e.relationships,i.includes(a,"*")?[2,["*"]]:s?[4,o.getFeatureEditFields(e)]:[3,3];case 2:return d=h.sent(),[3,4];case 3:d=[],h.label=4;case 4:return f=o.fixFields(e.fields,r.__spreadArrays(a,d)),l&&f.push(l),f&&u&&o.hasField(e.fields,u)&&-1===f.indexOf(u)&&f.push(u),f&&c&&o.hasField(e.fields,c)&&-1===f.indexOf(c)&&f.push(c),p&&p.forEach((function(t){var r=t.keyField;f&&r&&o.hasField(e.fields,r)&&-1===f.indexOf(r)&&f.push(r)})),[2,f]}}))}))},t.getFetchPopupTemplate=function(e,t){return e.popupTemplate?e.popupTemplate:n.isSome(t)&&t.defaultPopupTemplateEnabled&&n.isSome(e.defaultPopupTemplate)?e.defaultPopupTemplate:null}}).apply(null,i))||(e.exports=n)},NbdF:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("TMur"),r("LxLY"),r("8uEs"),r("/E+R")],void 0===(n=(function(e,t,r,i,n,o){function a(e,t,i,o){var a;if(void 0===o&&(o=new r.Extent),"2d"===i.type)a=t*i.resolution;else if("3d"===i.type){var s=i.basemapTerrain,u=s.overlayManager,l=u?u.overlayPixelSizeInMapUnits(e):1;a=s&&!s.spatialReference.equals(i.spatialReference)?n.getMetersPerUnitForSR(s.spatialReference)/n.getMetersPerUnitForSR(i.spatialReference):t*l}var c=e.x-a,p=e.y-a,d=e.x+a,f=e.y+a,h=i.spatialReference;return o.xmin=Math.min(c,d),o.ymin=Math.min(p,f),o.xmax=Math.max(c,d),o.ymax=Math.max(p,f),o.spatialReference=h,o}Object.defineProperty(t,"__esModule",{value:!0}),t.createQueryGeometry=a,t.intersectsDrapedGeometry=function(e,t,r){var n=r.toMap(e);return i.isNone(n)?null:a(n,o.calculateTolerance(),r,s).intersects(t)?n:null};var s=new r.Extent}).apply(null,i))||(e.exports=n)},NfUe:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("zOht"),r("qsST"),r("jBNx"),r("YaB4")],void 0===(n=(function(e,t,r,i,n,o){Object.defineProperty(t,"__esModule",{value:!0});var a=o.definitions.WEBGL_MAX_INNER_STOPS,s=o.definitions.WEBGL_MAX_STOPS,u=i.getLogger("esri.renderers.visualVariables.support.utils");function l(e,t,r){return(1-r)*e+r*t}t.simplifyVVRenderer=function(e){if(!("visualVariables"in e&&e.visualVariables&&e.visualVariables.length))return e;var t=e.clone(),i=t.visualVariables.map((function(e){return function(e){return("size"===e.type||"color"===e.type||"opacity"===e.type)&&null!=e.stops}(e)?function(e){return e.stops=function(e,t){return t.length<=s?t:(u.warn("Found "+t.length+" Visual Variable stops, but MapView only supports "+s+". Displayed stops will be simplified."),t.length>2*s?function(e,t){for(var i=t[0],o=t.slice(1),s=o.pop(),u=o[0].value,c=o[o.length-1].value,p=(c-u)/a,d=[],f=u;f<c;f+=p){for(var h=0;f>=o[h].value;)h++;var y=o[h],v=t[h-1],g=y.value===v.value?1:(f-v.value)/(y.value-v.value);if("color"===e){var _=o[h],m=t[h-1],b=_.color.clone();b.r=l(m.color.r,b.r,g),b.g=l(m.color.g,b.g,g),b.b=l(m.color.b,b.b,g),b.a=l(m.color.a,b.a,g),d.push({value:f,color:b,label:_.label})}else if("size"===e){var w=o[h],x=t[h-1],S=n.toPt(w.size),R=l(n.toPt(x.size),S,g);d.push({value:f,size:R,label:w.label})}else{var F=o[h],E=l(t[h-1].opacity,F.opacity,g);d.push({value:f,opacity:E,label:F.label})}}return r.__spreadArrays([i],d,[s])}(e,t):function(e){for(var t=e[0],i=e.slice(1),n=i.pop();i.length>a;){for(var o=0,s=0,u=1;u<i.length;u++){var l=Math.abs(i[u].value-i[u-1].value);l>s&&(s=l,o=u)}i.splice(o,1)}return r.__spreadArrays([t],i,[n])}(t))}(e.type,e.stops),e}(e):e}));return t.visualVariables=i,t}}).apply(null,i))||(e.exports=n)},WbzV:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("zOht"),r("SZNs"),r("qMld"),r("8V7H"),r("Vx27")],void 0===(n=(function(e,t,r,i,n,o,a){Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(t){var r=e.call(this,t)||this;return r._startupResolver=n.createResolver(),r.isReady=!1,r}return r.__extends(t,e),t.prototype.initialize=function(){this._controller=n.createAbortController(),this.addResolvingPromise(this._startWorker(this._controller.signal))},t.prototype.destroy=function(){this._controller.abort(),this._connection&&this._connection.close()},Object.defineProperty(t.prototype,"tileRenderer",{set:function(e){this.client.tileRenderer=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"closed",{get:function(){return this._connection.closed},enumerable:!0,configurable:!0}),t.prototype.startup=function(e,t,i,n){return r.__awaiter(this,void 0,void 0,(function(){var o,a,s;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,this.when()];case 1:return r.sent(),o=this._controller.signal,a=Array.isArray(i.source)?{transferList:i.source,signal:o}:void 0,s=e.tileInfo.toJSON(),[4,this._connection.invoke("startup",{service:i,config:t,tileInfo:s,options:n},a)];case 2:return r.sent(),this._startupResolver.resolve(),this._set("isReady",!0),[2]}}))}))},t.prototype.update=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var i;return r.__generator(this,(function(r){switch(r.label){case 0:return i={config:e,options:t},[4,this._startupResolver.promise];case 1:return r.sent(),[2,this._connection.invoke("update",i)]}}))}))},t.prototype.setHighlight=function(e){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,this._startupResolver.promise];case 1:return t.sent(),[2,this._connection.invoke("controller.setHighlight",e)]}}))}))},t.prototype.refresh=function(){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(e){switch(e.label){case 0:return[4,this._startupResolver.promise];case 1:return e.sent(),[2,this._connection.invoke("controller.refresh")]}}))}))},t.prototype.setViewState=function(e){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,this._startupResolver.promise];case 1:return t.sent(),[2,this._connection.invoke("setViewState",e.toJSON())]}}))}))},t.prototype.queryFeatures=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(r){switch(r.label){case 0:return[4,this._startupResolver.promise];case 1:return r.sent(),[2,this._connection.invoke("controller.queryFeatures",e.toJSON(),t)]}}))}))},t.prototype.queryObjectIds=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(r){switch(r.label){case 0:return[4,this._startupResolver.promise];case 1:return r.sent(),[2,this._connection.invoke("controller.queryObjectIds",e.toJSON(),t)]}}))}))},t.prototype.queryFeatureCount=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(r){switch(r.label){case 0:return[4,this._startupResolver.promise];case 1:return r.sent(),[2,this._connection.invoke("controller.queryFeatureCount",e.toJSON(),t)]}}))}))},t.prototype.queryExtent=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(r){return[2,this._connection.invoke("controller.queryExtent",e.toJSON(),t)]}))}))},t.prototype.queryLatestObservations=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(r){switch(r.label){case 0:return[4,this._startupResolver.promise];case 1:return r.sent(),[2,this._connection.invoke("controller.queryLatestObservations",e.toJSON(),t)]}}))}))},t.prototype.queryStatistics=function(e){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,this._startupResolver.promise];case 1:return t.sent(),[2,this._connection.invoke("controller.queryStatistics",e)]}}))}))},t.prototype.getObjectId=function(e){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,this._startupResolver.promise];case 1:return t.sent(),[2,this._connection.invoke("controller.getObjectId",e)]}}))}))},t.prototype.getLocalId=function(e){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,this._startupResolver.promise];case 1:return t.sent(),[2,this._connection.invoke("controller.getLocalId",e)]}}))}))},t.prototype.getAggregate=function(e){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,this._startupResolver.promise];case 1:return t.sent(),[2,this._connection.invoke("controller.getAggregate",e)]}}))}))},t.prototype.getAggregateValueRanges=function(){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(e){switch(e.label){case 0:return[4,this._startupResolver.promise];case 1:return e.sent(),[2,this._connection.invoke("controller.getAggregateValueRanges")]}}))}))},t.prototype.mapValidLocalIds=function(e){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,this._startupResolver.promise];case 1:return t.sent(),[2,this._connection.invoke("controller.mapValidLocalIds",e)]}}))}))},t.prototype.onEdits=function(e){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,this._startupResolver.promise];case 1:return t.sent(),[2,this._connection.invoke("controller.onEdits",{addedFeatures:e.addedFeatures,deletedFeatures:e.deletedFeatures,updatedFeatures:e.updatedFeatures})]}}))}))},t.prototype.enableEvent=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(r){switch(r.label){case 0:return[4,this._startupResolver.promise];case 1:return r.sent(),[2,this._connection.invoke("controller.enableEvent",{name:e,value:t})]}}))}))},t.prototype._startWorker=function(e){return r.__awaiter(this,void 0,void 0,(function(){var t,i;return r.__generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),t=this,[4,o.open("Pipeline",{client:this.client,strategy:"dedicated",signal:e})];case 1:return t._connection=r.sent(),[3,3];case 2:return i=r.sent(),n.throwIfNotAbortError(i),[3,3];case 3:return[2]}}))}))},r.__decorate([a.property()],t.prototype,"isReady",void 0),r.__decorate([a.property()],t.prototype,"client",void 0),r.__decorate([a.property()],t.prototype,"tileRenderer",null),r.__decorate([a.subclass("esri.views.2d.layers.support.FeatureLayerProxy")],t)}(i.EsriPromise);t.default=s}).apply(null,i))||(e.exports=n)},WsO6:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("zOht"),r("Gtr7"),r("BcWh"),r("7MDj"),r("NfRO"),r("qsST"),r("SZNs"),r("Vx27")],void 0===(n=(function(e,t,r,i,n,o,a,s,u,l){return function(e){function t(t){var r=e.call(this,t)||this;return r.layer=null,r.parent=null,r}return r.__extends(t,e),t.prototype.initialize=function(){var e=this;this.when().catch((function(t){if("layerview:create-error"!==t.name){var r=e.layer&&e.layer.id||"no id",i=e.layer&&e.layer.title||"no title";throw s.getLogger(e.declaredClass).error("#resolve()","Failed to resolve layer view (layer title: '"+i+"', id: '"+r+"')",t),t}}))},t.prototype.destroy=function(){this.layer=this.parent=null},Object.defineProperty(t.prototype,"fullOpacity",{get:function(){var e=function(e){return null==e?1:e};return e(this.get("layer.opacity"))*e(this.get("parent.fullOpacity"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"suspended",{get:function(){return!this.canResume()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"suspendInfo",{get:function(){return this.getSuspendInfo()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updating",{get:function(){return!!(this.updatingHandles&&this.updatingHandles.updating||this.isUpdating())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visible",{get:function(){return!0===this.get("layer.visible")},set:function(e){void 0!==e?this._override("visible",e):this._clearOverride("visible")},enumerable:!0,configurable:!0}),t.prototype.canResume=function(){return!this.get("parent.suspended")&&this.get("view.ready")&&this.get("layer.loaded")&&this.visible||!1},t.prototype.getSuspendInfo=function(){var e=this.parent&&this.parent.suspended?this.parent.suspendInfo:{};return this.view&&this.view.ready||(e.viewNotReady=!0),this.layer&&this.layer.loaded||(e.layerNotLoaded=!0),this.visible||(e.layerInvisible=!0),e},t.prototype.isUpdating=function(){return!1},r.__decorate([l.property({dependsOn:["layer.opacity","parent.fullOpacity"]})],t.prototype,"fullOpacity",null),r.__decorate([l.property()],t.prototype,"layer",void 0),r.__decorate([l.property()],t.prototype,"parent",void 0),r.__decorate([l.property({readOnly:!0,dependsOn:["visible","layer.loaded","parent.suspended","view?.ready"]})],t.prototype,"suspended",null),r.__decorate([l.property({readOnly:!0,dependsOn:["visible","layer.loaded","parent.suspended","view?.ready"]})],t.prototype,"suspendInfo",null),r.__decorate([l.property({type:Boolean,dependsOn:["updatingHandles.updating"],readOnly:!0})],t.prototype,"updating",null),r.__decorate([l.property({dependsOn:["layer.visible"]})],t.prototype,"visible",null),r.__decorate([l.subclass("esri.views.layers.LayerView")],t)}(o.HandleOwnerMixin(a.IdentifiableMixin(u.EsriPromiseMixin(n.EventedMixin(i)))))}).apply(null,i))||(e.exports=n)},ZMIQ:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("zOht"),r("ycL1"),r("Vx27")],void 0===(n=(function(e,t,r,i,n){return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),r.__decorate([n.subclass("esri.views.layers.support.ClipArea")],t)}(i.JSONSupport)}).apply(null,i))||(e.exports=n)},dDbr:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("zOht"),r("ycL1"),r("qsST"),r("LxLY"),r("Vx27"),r("e4th"),r("iO/m"),r("gd70")],void 0===(n=(function(e,t,r,i,n,o,a,s,u,l){var c=n.getLogger("esri.views.layers.support.FeatureEffect");return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.filter=null,t.includedEffect=null,t.excludedEffect=null,t.excludedLabelsVisible=!1,t}var i;return r.__extends(t,e),i=t,Object.defineProperty(t.prototype,"insideEffect",{get:function(){return c.warn("insideEffect is a temporary interface that will be removed. Use includedEffect instead"),this.includedEffect},set:function(e){c.warn("insideEffect is a temporary interface that will be removed. Use includedEffect instead"),this.includedEffect=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outsideEffect",{get:function(){return c.warn("outsideEffect is a temporary interface that will be removed. Use excludedEffect instead"),this.excludedEffect},set:function(e){c.warn("outsideEffect is a temporary interface that will be removed. Use excludedEffect instead"),this.excludedEffect=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parsedIncludedEffect",{get:function(){return o.isSome(this.includedEffect)?"string"==typeof this.includedEffect?u.fromString(this.includedEffect):new l({from:u.fromString(this.includedEffect.from),to:u.fromString(this.includedEffect.to),duration:this.includedEffect.duration}):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parsedExcludedEffect",{get:function(){return o.isSome(this.excludedEffect)?"string"==typeof this.excludedEffect?u.fromString(this.excludedEffect):new l({from:u.fromString(this.excludedEffect.from),to:u.fromString(this.excludedEffect.to),duration:this.excludedEffect.duration}):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderingHash",{get:function(){return this.excludedLabelsVisible+"-"+this.includedEffect+"-"+this.excludedEffect},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"done",{get:function(){return(!o.isSome(this.parsedIncludedEffect)||this.parsedIncludedEffect.done)&&(!o.isSome(this.parsedExcludedEffect)||this.parsedExcludedEffect.done)},enumerable:!0,configurable:!0}),t.prototype.clone=function(){return new i({filter:this.filter&&this.filter.clone(),includedEffect:this.includedEffect,excludedEffect:this.excludedEffect,excludedLabelsVisible:this.excludedLabelsVisible})},r.__decorate([a.property({type:s,json:{write:!0}})],t.prototype,"filter",void 0),r.__decorate([a.property({type:String,json:{write:!0}})],t.prototype,"includedEffect",void 0),r.__decorate([a.property({type:String,json:{write:!0}})],t.prototype,"excludedEffect",void 0),r.__decorate([a.property({type:Boolean,json:{write:!0}})],t.prototype,"excludedLabelsVisible",void 0),r.__decorate([a.property({dependsOn:["includedEffect"]})],t.prototype,"parsedIncludedEffect",null),r.__decorate([a.property({dependsOn:["excludedEffect"]})],t.prototype,"parsedExcludedEffect",null),r.__decorate([a.property({dependsOn:["includedEffect","excludedEffect"]})],t.prototype,"renderingHash",null),i=r.__decorate([a.subclass("esri.views.layers.support.FeatureEffect")],t)}(i.JSONSupport)}).apply(null,i))||(e.exports=n)},e4th:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("zOht"),r("TMur"),r("9gfz"),r("ImIS"),r("ycL1"),r("rg9i"),r("ULaq"),r("Vx27"),r("Lzvl"),r("IpeC")],void 0===(n=(function(e,t,r,i,n,o,a,s,u,l,c,p){var d=new o.default({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),f=new o.default({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});return function(e){function t(t){var r=e.call(this,t)||this;return r.where=null,r.geometry=null,r.spatialRelationship="intersects",r.hiddenIds=new Set,r.distance=void 0,r.objectIds=null,r.units=null,r.timeExtent=null,r.enabled=!1,r}var o;return r.__extends(t,e),o=t,t.prototype.writeWhere=function(e,t){t.where=e||"1=1"},t.prototype.enable=function(){this._set("enabled",!0)},t.prototype.createQuery=function(e){void 0===e&&(e={});var t=this,i=t.where,n=t.spatialRelationship,o=t.timeExtent,a=t.objectIds,u=t.units,l=t.distance;return new p(r.__assign({geometry:s.clone(t.geometry),objectIds:s.clone(a),spatialRelationship:n,timeExtent:s.clone(o),where:i,units:u,distance:l},e))},t.prototype.clone=function(){var e=this,t=e.where,r=e.geometry,i=e.spatialRelationship,n=e.hiddenIds,a=e.timeExtent,u=e.objectIds,l=e.units,c=e.distance,p=new Set;return n.forEach((function(e){return p.add(e)})),new o({geometry:s.clone(r),hiddenIds:p,objectIds:s.clone(u),spatialRelationship:i,timeExtent:s.clone(a),where:t,units:l,distance:c})},r.__decorate([l.property({type:String})],t.prototype,"where",void 0),r.__decorate([l.writer("where")],t.prototype,"writeWhere",null),r.__decorate([l.property({types:i.geometryTypes,json:{read:c.fromJSON,write:!0}})],t.prototype,"geometry",void 0),r.__decorate([l.property({type:String,json:{read:{source:"spatialRel",reader:d.read},write:{target:"spatialRel",writer:d.write}}})],t.prototype,"spatialRelationship",void 0),r.__decorate([l.property({json:{write:function(e,t,r){return t[r]=u.valuesOfSet(e)},read:function(e){return u.SetFromValues(e)}}})],t.prototype,"hiddenIds",void 0),r.__decorate([l.property({type:Number,json:{write:{overridePolicy:function(e){return{enabled:e>0}}}}})],t.prototype,"distance",void 0),r.__decorate([l.property({type:[Number],json:{write:!0}})],t.prototype,"objectIds",void 0),r.__decorate([l.property({type:String,json:{read:f.read,write:{writer:f.write,overridePolicy:function(e){return{enabled:e&&this.distance>0}}}}})],t.prototype,"units",void 0),r.__decorate([l.property({type:n,json:{write:!0}})],t.prototype,"timeExtent",void 0),r.__decorate([l.property({readOnly:!0})],t.prototype,"enabled",void 0),o=r.__decorate([l.subclass("esri.views.layers.support.FeatureFilter")],t)}(a.JSONSupport)}).apply(null,i))||(e.exports=n)},gd70:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("zOht"),r("Gtr7"),r("Vx27"),r("FXVB")],void 0===(n=(function(e,t,r,i,n,o){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.from=null,t.to=null,t.duration=4e3,t.repeat=!0,t.done=!1,t}var i;return r.__extends(t,e),i=t,t.prototype.getColorMatrix=function(){if(this.done=!1,null==this._lastTime)this._currentStep=0,this._lastTime=Date.now();else{var e=this._lastTime,t=Date.now();this._currentStep=this._currentStep+(t-e),this._currentStep>=2147483647&&(this._currentStep=0),this._lastTime=t}var r=this._currentStep%this.duration/(this.duration/2),i=r<=1?r:2-r,n=this.from.getColorMatrix(),a=this.to.getColorMatrix();return o.mat4.multiplyScalar(n,n,1-i),o.mat4.multiplyScalar(a,a,i),!this.repeat&&this._currentStep>=this.duration&&(this.done=!0),o.mat4.add(n,n,a)},t.prototype.getOpacity=function(){throw new Error("No getOpacity definition for Transition")},t.prototype.clone=function(){var e=new i({from:this.from.clone(),to:this.to.clone(),duration:this.duration});return e._lastTime=this._lastTime,e._currentStep=this._currentStep,e},r.__decorate([n.property()],t.prototype,"from",void 0),r.__decorate([n.property()],t.prototype,"to",void 0),r.__decorate([n.property({type:Number})],t.prototype,"duration",void 0),r.__decorate([n.property({type:Boolean})],t.prototype,"repeat",void 0),i=r.__decorate([n.subclass("esri.views.layers.support.Transition")],t)}(i)}).apply(null,i))||(e.exports=n)},"iO/m":function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("zOht"),r("ma1f"),r("ycL1"),r("qsST"),r("LxLY"),r("Vx27"),r("FXVB"),r("oZZu"),r("3MK9")],void 0===(n=(function(e,t,r,i,n,o,a,s,u,l,c){var p=o.getLogger("esri.views.layers.support.ParsedFeatureEffect"),d={grayscale:function(e){var t=1-e.amount,r=l.mat4f32.fromValues(.2126+.7874*t,.7152-.7152*t,.0722-.0722*t,0,.2126-.2126*t,.7152+.2848*t,.0722-.0722*t,0,.2126-.2126*t,.7152-.7152*t,.0722+.9278*t,0,0,0,0,1);return u.mat4.transpose(r,r)},sepia:function(e){var t=1-e.amount,r=l.mat4f32.fromValues(.393+.607*t,.769-.769*t,.189-.189*t,0,.349-.349*t,.686+.314*t,.168-.168*t,0,.272-.272*t,.534-.534*t,.131+.869*t,0,0,0,0,1);return u.mat4.transpose(r,r)},saturate:function(e){var t=e.amount,r=l.mat4f32.fromValues(.213+.787*t,.715-.715*t,.072-.072*t,0,.213-.213*t,.715+.285*t,.072-.072*t,0,.213-.213*t,.715-.715*t,.072+.928*t,0,0,0,0,1);return u.mat4.transpose(r,r)},"hue-rotate":function(e){var t=Math.sin(e.angle*Math.PI/180),r=Math.cos(e.angle*Math.PI/180),i=l.mat4f32.fromValues(.213+.787*r-.213*t,.715-.715*r-.715*t,.072-.072*r+.928*t,0,.213-.213*r+.143*t,.715+.285*r+.14*t,.072-.072*r-.283*t,0,.213-.213*r-.787*t,.715-.715*r+.715*t,.072+.928*r+.072*t,0,0,0,0,1);return u.mat4.transpose(i,i)},invert:function(e){var t=1-2*e.amount,r=e.amount,i=l.mat4f32.fromValues(t,0,0,r,0,t,0,r,0,0,t,r,0,0,0,1);return u.mat4.transpose(i,i)},brightness:function(e){var t=e.amount,r=l.mat4f32.fromValues(t,0,0,0,0,t,0,0,0,0,t,0,0,0,0,1);return u.mat4.transpose(r,r)},contrast:function(e){var t=e.amount,r=l.mat4f32.fromValues(t,0,0,.5-.5*t,0,t,0,.5-.5*t,0,0,t,.5-.5*t,0,0,0,1);return u.mat4.transpose(r,r)}};return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.customTransforms=null,t.done=!0,t}var n;return r.__extends(t,e),n=t,t.fromString=function(e){var t=[],r=null;try{for(var o=0,a=c.parse(e);o<a.length;o++){var s=a[o];"opacity"===s.type?r=s:t.push(s)}}catch(e){p.error(new i("invalid-type","Encountered an error when parsing css",e))}return new n({transforms:t,opacity:r})},t.prototype.getOpacity=function(){return a.isSome(this.opacity)?this.opacity.amount:1},t.prototype.getColorMatrix=function(){var e=this;return(this.transforms||[]).map((function(e){return r.__assign({},e)})).reverse().reduce((function(t,r){return u.mat4.multiply(t,t,e._getFactory(r)(r))}),l.mat4f32.create())},t.prototype.clone=function(){return new n({transforms:this.transforms&&this.transforms.map((function(e){return r.__assign({},e)})),customTransforms:this.customTransforms&&this.customTransforms.map((function(e){return r.__assign({},e)}))})},t.prototype._getFactory=function(e){var t=d[e.type];if(t)return t;if(this.customTransforms)for(var r=function(t){if(t.type===e.type){var r=l.mat4f32.fromValues.apply(l.mat4f32,t.matrix),i=u.mat4.transpose(r,r);return{value:function(){return i}}}},i=0,n=this.customTransforms;i<n.length;i++){var o=r(n[i]);if("object"==typeof o)return o.value}return p.error("invalid-type","No effect "+e.type+" exists"),function(){return l.mat4f32.create()}},r.__decorate([s.property()],t.prototype,"opacity",void 0),r.__decorate([s.property()],t.prototype,"transforms",void 0),r.__decorate([s.property()],t.prototype,"customTransforms",void 0),n=r.__decorate([s.subclass("esri.views.layers.support.ParsedFeatureEffect")],t)}(n.JSONSupport)}).apply(null,i))||(e.exports=n)},jci6:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("zOht"),r("jZlN"),r("Vx27")],void 0===(n=(function(e,t,r,i,n){return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var i;return r.__extends(t,e),i=t,t.prototype.getEffectivePopupTemplate=function(e){if(void 0===e&&(e=!1),this.popupTemplate)return this.popupTemplate;var t=this.sourceLayer&&this.sourceLayer.featureReduction;return t&&"popupTemplate"in t&&t.popupEnabled?t.popupTemplate:null},t.prototype.getObjectId=function(){return this.objectId},t.prototype.clone=function(){return new i(r.__assign({objectId:this.objectId},this.cloneProperties()))},r.__decorate([n.property({type:Number,json:{read:!0}})],t.prototype,"objectId",void 0),i=r.__decorate([n.subclass("esri.AggregateGraphic")],t)}(i)}).apply(null,i))||(e.exports=n)},"sQ+t":function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("zOht"),r("2Kdy")],void 0===(n=(function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.createOrReuseTileRenderer=function(e,t){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(i){switch(i.label){case 0:if(!e)return[2,null];switch(e.type){case"class-breaks":case"simple":case"unique-value":case"dot-density":case"dictionary":return[3,1];case"heatmap":return[3,3]}return[3,5];case 1:return[4,new Promise((function(e,t){Promise.all([r.e(1),r.e(62)]).then((function(){var t=[r("IBem")];e.apply(null,t)}).bind(this)).catch(t.bind(this))}))];case 2:return[2,new(i.sent().default)(t)];case 3:return[4,new Promise((function(e,t){Promise.all([r.e(1),r.e(94)]).then((function(){var t=[r("GCYV")];e.apply(null,t)}).bind(this)).catch(t.bind(this))}))];case 4:return[2,new(i.sent().default)(t)];case 5:return[2]}}))}))}}).apply(null,i))||(e.exports=n)},ts8o:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("zOht"),r("TMur"),r("Vx27"),r("YADd"),r("Lzvl"),r("ZMIQ")],void 0===(n=(function(e,t,r,i,n,o,a,s){var u={base:o,key:"type",typeMap:{extent:i.Extent,polygon:i.Polygon}};return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="geometry",t.geometry=null,t}var i;return r.__extends(t,e),i=t,Object.defineProperty(t.prototype,"version",{get:function(){return(this._get("version")||0)+1},enumerable:!0,configurable:!0}),t.prototype.clone=function(){return new i({geometry:this.geometry.clone()})},r.__decorate([n.property({types:u,json:{read:a.fromJSON,write:!0}})],t.prototype,"geometry",void 0),r.__decorate([n.property({readOnly:!0,dependsOn:["geometry"]})],t.prototype,"version",null),i=r.__decorate([n.subclass("esri.views.layers.support.Geometry")],t)}(s)}).apply(null,i))||(e.exports=n)},w0Ef:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("zOht"),r("ma1f"),r("H1tY"),r("qsST"),r("LxLY"),r("CaYo"),r("n7H0"),r("/3kq"),r("YaB4")],void 0===(n=(function(e,t,r,i,n,o,a,s,u,l,c){var p=this;Object.defineProperty(t,"__esModule",{value:!0});var d=o.getLogger("esri.views.2d.layers.support.clusterUtils");n.add("esri-cluster-arcade-enabled",1);var f=n("esri-cluster-arcade-enabled");function h(e,t){var r=t.name,n=t.outStatistic,o=n.onStatisticField,a=n.onStatisticValueExpression,u=n.statisticType;if(a){var l=s.createMD5Hash(a.toLowerCase());e.push({name:r,outStatistic:{onStatisticField:l,onStatisticValueExpression:a,statisticType:u}})}else o?e.push({name:r,outStatistic:{onStatisticField:o,statisticType:u}}):d.error(new i("mapview-unsupported-field","Unable to handle field",{field:t}))}function y(e,t,r){var i=s.createMD5Hash(t),n="mode"===r?"cluster_type_"+i:"cluster_avg_"+i;return e.some((function(e){return e.name===n}))||e.push({name:n,outStatistic:{onStatisticField:i,onStatisticValueExpression:t,statisticType:r}}),n}function v(e,t,r,i){if("cluster_count"===t||e.some((function(e){return e.name===t})))return t;var n=function(e,t,r){switch(e){case"avg":case"avg_angle":return"cluster_avg_"+t;case"mode":return"cluster_type_"+t;case"norm":var i=r,n=t.toLowerCase()+",norm:field,"+i.toLowerCase();return"cluster_avg_"+s.createMD5Hash(n)}}(r,t,i);return e.some((function(e){return e.name===n}))||e.push("norm"===r?{name:n,outStatistic:{onStatisticField:t,onStatisticNormalizationField:i,statisticType:r}}:{name:n,outStatistic:{onStatisticField:t,statisticType:r}}),n}t.createClusterRenderer=function(e,i,n,o,s){return r.__awaiter(p,void 0,void 0,(function(){var i,u,l,c,p;return r.__generator(this,(function(r){if(i=n.clone(),!t.isClusterCompatibleRenderer(i))return[2,i];if(o.fields)for(u=0,l=o.fields;u<l.length;u++)h(e,l[u]);switch("visualVariables"in i&&(c=(i.visualVariables||[]).filter((function(e){return"$view.scale"!==e.valueExpression})),p=t.findSizeVV(c),c.forEach((function(t){"rotation"===t.type?t.field?t.field=v(e,t.field,"avg_angle"):t.valueExpression&&(t.field=y(e,t.valueExpression,"avg_angle"),t.valueExpression=null):t.normalizationField?(t.field=v(e,t.field,"norm",t.normalizationField),t.normalizationField=null):t.field?t.field=v(e,t.field,"avg"):(t.field=y(e,t.valueExpression,"avg"),t.valueExpression=null)})),a.isNone(p)&&!t.hasClusterCountVV(c)&&(c.push(t.createClusterCountSizeVariable(o,s)),i.dynamicClusterSize=!0),i.visualVariables=c),i.type){case"simple":break;case"unique-value":i.field?i.field=v(e,i.field,"mode"):i.valueExpression&&(i.field=y(e,i.valueExpression,"mode"),i.valueExpression=null);break;case"class-breaks":i.normalizationField?(i.field=v(e,i.field,"norm",i.normalizationField),i.normalizationField=null):i.field?i.field=v(e,i.field,"avg"):(i.field=y(e,i.valueExpression,"avg"),i.valueExpression=null)}return[2,i]}))}))},t.findSizeVV=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];if("size"===i.type)return i}return null},t.hasClusterCountVV=function(e){for(var t=0,r=e;t<r.length;t++)if("cluster_count"===r[t].field)return!0;return!1},t.createClusterCountSizeVariable=function(e,t){var i=[new l({value:0,size:0}),new l({value:1})];if(a.isNone(t))return new u({field:"cluster_count",stops:r.__spreadArrays(i,[new l({value:2,size:0})])});var n=Object.keys(t).reduce((function(n,o){var a;return r.__assign(r.__assign({},n),((a={})[o]=r.__spreadArrays(i,[new l({value:Math.max(2,t[o].minValue),size:e.clusterMinSize}),new l({value:Math.max(3,t[o].maxValue),size:e.clusterMaxSize})]),a))}),{});return new c.LevelDependentSizeVariable({field:"cluster_count",levels:n})},t.isClusterCompatibleRenderer=function(e){var t=function(t){return d.error(new i("Unsupported-renderer",t,{renderer:e}))};if("unique-value"===e.type){if(e.field2||e.field3)return t("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),!1}else if("class-breaks"===e.type){if(e.normalizationField){var r=e.normalizationType;if("field"!==r)return t("FeatureReductionCluster does not support a normalizationType of "+r),!1}}else if("simple"!==e.type)return t("FeatureReductionCluster does not support renderers of type "+e.type),!1;if(!f){if("valueExpression"in e&&e.valueExpression)return t("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),!1;if(("visualVariables"in e&&e.visualVariables||[]).some((function(e){return!(!("valueExpression"in e)||!e.valueExpression)})))return t("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),!1}return!0}}).apply(null,i))||(e.exports=n)}}]);