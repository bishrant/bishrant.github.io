(function(){var e={"esri/views/3d/webgl-engine/core/shaderLibrary/ScreenSpacePass":"0W55","esri/views/3d/webgl-engine/lib/GeometryUtil":"4ziW","esri/views/3d/webgl-engine/core/shaderLibrary/util/CameraSpace.glsl":"58az","esri/views/3d/interactive/manipulatorUtils":"5T2R","esri/views/3d/webgl-engine/core/shaderLibrary/output/ReadLinearDepth.glsl":"6vp1","esri/views/3d/webgl-engine/core/shaderLibrary/shading/LineStipple.glsl":"7zqm","esri/views/3d/webgl-engine/lib/BufferVectorMath":"83/a","esri/views/3d/interactive/editingTools/dragEventPipeline3D":"B3XD","esri/views/3d/layers/graphics/graphicUtils":"BwdQ","esri/views/3d/webgl-engine/shaders/ColorMaterial.glsl":"DFuO","esri/views/3d/webgl-engine/core/shaderLibrary/attributes/RibbonVertexPosition.glsl":"E/g4","esri/views/3d/webgl-engine/shaders/ColorMaterialTechnique":"EiS2","esri/views/3d/webgl-engine/materials/lineStippleUtils":"FbvD","esri/views/3d/webgl-engine/materials/internal/DefaultBufferWriter":"LZD4","esri/views/3d/support/buffer/glUtil":"MzcX","arcgis-js-api/views/3d/support/buffer/glUtil":"MzcX","esri/views/3d/webgl-engine/shaders/ShadedColorMaterial.glsl":"NiJV","esri/views/3d/webgl-engine/materials/RibbonLineMaterial":"RC9r","esri/views/3d/webgl-engine/lib/Camera":"RsYQ","esri/views/3d/webgl-engine/shaders/RibbonLineTechnique":"SNs2","esri/views/3d/webgl-engine/shaders/LaserlinePath.glsl":"UGy0","esri/views/3d/support/pointUtils":"UidR","esri/views/3d/webgl-engine/lib/Layer":"ZO6V","esri/views/3d/webgl-engine/materials/VisualVariableMaterialParameters":"ama6","esri/views/3d/webgl-engine/shaders/ShadedColorMaterialTechnique":"fQ2U","esri/views/3d/webgl-engine/shaders/LaserlineTechnique":"fUJJ","esri/views/3d/support/LaserlinePathData":"gG9S","esri/views/3d/support/LaserLineRenderer":"hX2R","esri/views/3d/webgl-engine/core/shaderLibrary/Laserline.glsl":"hk44","esri/views/3d/webgl-engine/lib/Intersector":"m4lJ","esri/views/3d/webgl-engine/lib/Octree":"mYMs","arcgis-js-api/views/3d/support/projectionUtils":"mmEe","esri/views/3d/support/projectionUtils":"mmEe","esri/views/3d/webgl-engine/shaders/RibbonLine.glsl":"ne9J","esri/views/3d/webgl-engine/materials/ColorMaterial":"o5p5","esri/views/3d/webgl-engine/shaders/Laserlines.glsl":"qSzK","esri/views/3d/webgl-engine/shaders/LaserlinePathTechnique":"raiv","esri/views/3d/webgl-engine/materials/ShadedColorMaterial":"uZGf","esri/views/3d/support/ElevationProvider":"vA3N","esri/views/3d/interactive/Manipulator3D":"woUR","esri/layers/graphics/hydratedFeatures":"xdO3"},t=this||window,n=t.webpackJsonp=t.webpackJsonp||[];n.registerAbsMids?n.registerAbsMids(e):(n.absMidsWaiting=n.absMidsWaiting||[]).push(e)})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{"0W55":function(e,t,n){var r,i;r=[n.dj.c(e.i),t,n("zOht"),n("7Aei")],void 0===(i=(function(e,t,n,r){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.ScreenSpacePass=void 0,t.ScreenSpacePass=function(e){e.attributes.add("position","vec2"),e.varyings.add("uv","vec2"),e.vertex.code.add(r.glsl(i||(i=n.__makeTemplateObject(["\n    void main(void) {\n      gl_Position = vec4(position, 0.0, 1.0);\n      uv = position * 0.5 + vec2(0.5);\n    }\n  "],["\n    void main(void) {\n      gl_Position = vec4(position, 0.0, 1.0);\n      uv = position * 0.5 + vec2(0.5);\n    }\n  "]))))}}).apply(null,r))||(e.exports=i)},"4ziW":function(e,t,n){var r,i;r=[n.dj.c(e.i),t,n("0LE5"),n("vlC2"),n("Rdxj"),n("aWgr"),n("83/a"),n("AgDx"),n("CIy2")],void 0===(i=(function(e,t,n,r,i,a,o,s,l){"use strict";var c,p,u,d,h=o.Vec3Compact;!function(e){for(var t=.5,n=[[-t,-t,t],[t,-t,t],[t,t,t],[-t,t,t],[-t,-t,-t],[t,-t,-t],[t,t,-t],[-t,t,-t]],r=[0,0,1,-1,0,0,1,0,0,0,-1,0,0,1,0,0,0,-1],i=[0,0,1,0,1,1,0,1],a=[0,1,2,2,3,0,4,0,3,3,7,4,1,5,6,6,2,1,1,0,4,4,5,1,3,2,6,6,7,3,5,4,7,7,6,5],o=new Array(36),c=0;c<6;c++)for(var p=0;p<6;p++)o[6*c+p]=c;var u=new Array(36);for(c=0;c<6;c++)u[6*c+0]=0,u[6*c+1]=1,u[6*c+2]=2,u[6*c+3]=2,u[6*c+4]=3,u[6*c+5]=0;e.createGeometry=function(e){Array.isArray(e)||(e=[e,e,e]);for(var t=new Float32Array(24),c=0;c<8;c++)t[3*c]=n[c][0]*e[0],t[3*c+1]=n[c][1]*e[1],t[3*c+2]=n[c][2]*e[2];var p={};p[l.VertexAttrConstants.POSITION]=new Uint32Array(a),p[l.VertexAttrConstants.NORMAL]=new Uint32Array(o),p[l.VertexAttrConstants.UV0]=new Uint32Array(u);var d={};return d[l.VertexAttrConstants.POSITION]={size:3,data:t},d[l.VertexAttrConstants.NORMAL]={size:3,data:new Float32Array(r)},d[l.VertexAttrConstants.UV0]={size:2,data:new Float32Array(i)},new s.GeometryData(d,p)}}(c||(c={})),function(e){var t=.5,n=[[-t,0,-t],[t,0,-t],[t,0,t],[-t,0,t],[0,-t,0],[0,t,0]],r=[0,1,-1,1,1,0,0,1,1,-1,1,0,0,-1,-1,1,-1,0,0,-1,1,-1,-1,0],i=[5,1,0,5,2,1,5,3,2,5,0,3,4,0,1,4,1,2,4,2,3,4,3,0],a=[0,0,0,1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6,7,7,7];e.createGeometry=function(e){Array.isArray(e)||(e=[e,e,e]);for(var t=new Float32Array(18),o=0;o<6;o++)t[3*o]=n[o][0]*e[0],t[3*o+1]=n[o][1]*e[1],t[3*o+2]=n[o][2]*e[2];var c={};c[l.VertexAttrConstants.POSITION]=new Uint32Array(i),c[l.VertexAttrConstants.NORMAL]=new Uint32Array(a);var p={};return p[l.VertexAttrConstants.POSITION]={size:3,data:t},p[l.VertexAttrConstants.NORMAL]={size:3,data:new Float32Array(r)},new s.GeometryData(p,c)}}(p||(p={})),function(e){var t=.5,i=r.vec3f32.fromValues(-t,0,-t),a=r.vec3f32.fromValues(t,0,-t),o=r.vec3f32.fromValues(0,0,t),c=r.vec3f32.fromValues(0,.5,0),p=r.vec3f32.create(),u=r.vec3f32.create(),d=r.vec3f32.create(),h=r.vec3f32.create(),f=r.vec3f32.create();n.vec3.subtract(p,i,c),n.vec3.subtract(u,i,a),n.vec3.cross(d,p,u),n.vec3.normalize(d,d),n.vec3.subtract(p,a,c),n.vec3.subtract(u,a,o),n.vec3.cross(h,p,u),n.vec3.normalize(h,h),n.vec3.subtract(p,o,c),n.vec3.subtract(u,o,i),n.vec3.cross(f,p,u),n.vec3.normalize(f,f);var v=[i,a,o,c],m=[0,-1,0,d[0],d[1],d[2],h[0],h[1],h[2],f[0],f[1],f[2]],g=[0,1,2,3,1,0,3,2,1,3,0,2],y=[0,0,0,1,1,1,2,2,2,3,3,3];e.createGeometry=function(e){Array.isArray(e)||(e=[e,e,e]);for(var t=new Float32Array(12),n=0;n<4;n++)t[3*n]=v[n][0]*e[0],t[3*n+1]=v[n][1]*e[1],t[3*n+2]=v[n][2]*e[2];var r={};r[l.VertexAttrConstants.POSITION]=new Uint32Array(g),r[l.VertexAttrConstants.NORMAL]=new Uint32Array(y);var i={};return i[l.VertexAttrConstants.POSITION]={size:3,data:t},i[l.VertexAttrConstants.NORMAL]={size:3,data:new Float32Array(m)},new s.GeometryData(i,r)}}(u||(u={})),function(e){e.createBoxGeometry=c.createGeometry,e.createDiamondGeometry=p.createGeometry,e.createTetrahedronGeometry=u.createGeometry,e.createSphereGeometry=function(e,t,n,r,i,a,o){e=e||50,r=void 0!==r?r:-Math.PI,i=void 0!==i?i:2*Math.PI,a=void 0!==a?a:.5*-Math.PI,o=void 0!==o?o:Math.PI;for(var c=Math.max(3,Math.floor(t)||8),p=Math.max(2,Math.floor(n)||6),u=(c+1)*(p+1),d=new Float32Array(3*u),h=new Float32Array(3*u),f=new Float32Array(2*u),v=[],m=0,g=0;g<=p;g++){for(var y=[],b=g/p,_=a+b*o,x=Math.cos(_),P=0;P<=c;P++){var S=P/c,O=r+S*i,w=Math.cos(O)*x,C=Math.sin(_),A=-Math.sin(O)*x;d[3*m]=w*e,d[3*m+1]=C*e,d[3*m+2]=A*e,h[3*m]=w,h[3*m+1]=C,h[3*m+2]=A,f[2*m]=S,f[2*m+1]=b,y.push(m),++m}v.push(y)}var D=new Uint32Array(2*c*(p-1)*3);for(m=0,g=0;g<p;g++)for(P=0;P<c;P++){var V=v[g][P],j=v[g][P+1],R=v[g+1][P+1],T=v[g+1][P];0===g?(D[m++]=V,D[m++]=R,D[m++]=T):g===p-1?(D[m++]=V,D[m++]=j,D[m++]=R):(D[m++]=V,D[m++]=j,D[m++]=R,D[m++]=R,D[m++]=T,D[m++]=V)}l.assert(m===D.length);var L={};L[l.VertexAttrConstants.POSITION]=D,L[l.VertexAttrConstants.NORMAL]=D,L[l.VertexAttrConstants.UV0]=D;var M={};return M[l.VertexAttrConstants.POSITION]={size:3,data:d},M[l.VertexAttrConstants.NORMAL]={size:3,data:h},M[l.VertexAttrConstants.UV0]={size:2,data:f},new s.GeometryData(M,L)},e.createPolySphereGeometry=function(e,t,n){var r,i,a=e;if(n)r=[0,-1,0,1,0,0,0,0,1,-1,0,0,0,0,-1,0,1,0],i=new Uint32Array([0,1,2,0,2,3,0,3,4,0,4,1,1,5,2,2,5,3,3,5,4,4,5,1]);else{var o=a*(1+Math.sqrt(5))/2;r=[-a,o,0,a,o,0,-a,-o,0,a,-o,0,0,-a,o,0,a,o,0,-a,-o,0,a,-o,o,0,-a,o,0,a,-o,0,-a,-o,0,a],i=new Uint32Array([0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1])}for(var c=0;c<r.length;c+=3)h.scale(r,c,e/h.length(r,c));var p={};function u(t,n){var i;t>n&&(t=(i=[n,t])[0],n=i[1]);var a=t.toString()+"."+n.toString();if(p[a])return p[a];var o=r.length;return r.length+=3,h.add(r,3*t,r,3*n,r,o),h.scale(r,o,e/h.length(r,o)),p[a]=o/=3,o}for(c=0;c<t;c++){for(var d=i.length,f=new Uint32Array(4*d),v=0;v<d;v+=3){var m=i[v],g=i[v+1],y=i[v+2],b=u(m,g),_=u(g,y),x=u(y,m),P=4*v;f[P]=m,f[P+1]=b,f[P+2]=x,f[P+3]=g,f[P+4]=_,f[P+5]=b,f[P+6]=y,f[P+7]=x,f[P+8]=_,f[P+9]=b,f[P+10]=_,f[P+11]=x}i=f,p={}}var S=new Float32Array(r);for(c=0;c<S.length;c+=3)h.normalize(S,c);var O={};O[l.VertexAttrConstants.POSITION]=i,O[l.VertexAttrConstants.NORMAL]=i;var w={};return w[l.VertexAttrConstants.POSITION]={size:3,data:new Float32Array(r)},w[l.VertexAttrConstants.NORMAL]={size:3,data:S},new s.GeometryData(w,O)},e.createPointGeometry=function(e,t,n,r,i,a,o,c){var p=t?new Float64Array([t[0],t[1],t[2]]):new Float32Array([0,0,0]),u=e?new Float32Array([e[0],e[1],e[2]]):new Float32Array([0,0,1]),d=a?new Float32Array(a):new Float32Array([0,0]),h=n?new Uint8Array([255*n[0],255*n[1],255*n[2],n.length>3?255*n[3]:255]):new Uint8Array([255,255,255,255]),f=null!=r&&2===r.length?new Float32Array(r):new Float32Array([1,1]),v={};if(v[l.VertexAttrConstants.POSITION]={size:3,data:p},v[l.VertexAttrConstants.NORMAL]={size:3,data:u},v[l.VertexAttrConstants.UV0]={size:d.length,data:d},v[l.VertexAttrConstants.COLOR]={size:4,data:h},v[l.VertexAttrConstants.SIZE]={size:2,data:f},null!=i){var m=new Float32Array([i[0],i[1],i[2],i[3]]);v[l.VertexAttrConstants.AUXPOS1]={size:4,data:m}}if(null!=o){var g=new Float32Array([o[0],o[1],o[2],o[3]]);v[l.VertexAttrConstants.AUXPOS2]={size:4,data:g}}return null!=c?(c.initialize(v,s.GeometryData.DefaultIndices,"point"),c):new s.GeometryData(v,s.GeometryData.DefaultIndices,"point")},e.updatePointGeometry=function(e,t,n,r,i,a,o,s){var c,p=s.vertexAttributes;return null!=e&&((c=p[l.VertexAttrConstants.NORMAL].data)[0]=e[0],c[1]=e[1],c[2]=e[2]),null!=t&&((c=p[l.VertexAttrConstants.POSITION].data)[0]=t[0],c[1]=t[1],c[2]=t[2]),null!=n&&((c=p[l.VertexAttrConstants.COLOR].data)[0]=n[0],c[1]=n[1],c[2]=n[2],c[3]=n[3]),null!=r&&((c=p[l.VertexAttrConstants.SIZE].data)[0]=r[0],c[1]=r[1]),null!=i&&((c=p[l.VertexAttrConstants.AUXPOS1].data)[0]=i[0],c[1]=i[1],c[2]=i[2],c[3]=i[3]),null!=a&&((c=p[l.VertexAttrConstants.UV0].data)[0]=a[0],c[1]=a[1]),null!=o&&((c=p[l.VertexAttrConstants.AUXPOS2].data)[0]=o[0],c[1]=o[1],c[2]=o[2],c[3]=o[3]),s},e.createPointArrayGeometry=function(e,t){for(var n=new Float32Array(3*e.length),r=new Float32Array(t?3*e.length:3),i=new Uint32Array(e.length),a=new Uint32Array(e.length),o=0;o<e.length;o++)n[3*o]=e[o][0],n[3*o+1]=e[o][1],n[3*o+2]=e[o][2],t&&(r[3*o]=t[o][0],r[3*o+1]=t[o][1],r[3*o+2]=t[o][2]),i[o]=o,a[o]=0;t||(r[0]=0,r[1]=1,r[2]=0);var c=new Float32Array(2);c[0]=0,c[1]=0;var p={};p[l.VertexAttrConstants.POSITION]=i,p[l.VertexAttrConstants.NORMAL]=t?i:a,p[l.VertexAttrConstants.UV0]=a;var u={};return u[l.VertexAttrConstants.POSITION]={size:3,data:n},u[l.VertexAttrConstants.NORMAL]={size:3,data:r},u[l.VertexAttrConstants.UV0]={size:2,data:c},new s.GeometryData(u,p,"point")},e.createTriangleGeometry=function(){var e=new Float32Array([0,0,0,0,0,100,100,0,0]),t=new Uint32Array([0,1,2]),n=new Float32Array([0,1,0]),r=new Uint32Array([0,0,0]),i=new Float32Array([0,0]),a=new Uint32Array([0,0,0]),o={};o[l.VertexAttrConstants.POSITION]=t,o[l.VertexAttrConstants.NORMAL]=r,o[l.VertexAttrConstants.UV0]=a;var c={};return c[l.VertexAttrConstants.POSITION]={size:3,data:e},c[l.VertexAttrConstants.NORMAL]={size:3,data:n},c[l.VertexAttrConstants.UV0]={size:2,data:i},new s.GeometryData(c,o)};var t=[[-1,-1,0],[1,-1,0],[1,1,0],[-1,1,0]];function o(e,t,r,i,a){return!(Math.abs(n.vec3.dot(t,e))>a||(n.vec3.cross(r,e,t),n.vec3.normalize(r,r),n.vec3.cross(i,r,e),n.vec3.normalize(i,i),0))}function d(e,t,n,r,i,a,s){return o(e,t,i,a,s)||o(e,n,i,a,s)||o(e,r,i,a,s)}e.createSquareGeometry=function(e){var n,r;void 0===e&&(e=t);for(var i=new Float64Array(12),a=0;a<4;a++)for(var o=0;o<3;o++)i[3*a+o]=e[a][o];var c=new Uint32Array([0,1,2,2,3,0]),p=new Float32Array([0,0,1]),u=new Uint32Array([0,0,0,0,0,0]),d=new Float32Array([0,0,1,0,1,1,0,1]),h=new Uint8Array([255,255,255,255]),f=((n={})[l.VertexAttrConstants.POSITION]=c,n[l.VertexAttrConstants.NORMAL]=u,n[l.VertexAttrConstants.UV0]=c,n[l.VertexAttrConstants.COLOR]=u,n),v=((r={})[l.VertexAttrConstants.POSITION]={size:3,data:i},r[l.VertexAttrConstants.NORMAL]={size:3,data:p},r[l.VertexAttrConstants.UV0]={size:2,data:d},r[l.VertexAttrConstants.COLOR]={size:4,data:h},r);return new s.GeometryData(v,f)},e.createConeGeometry=function(e,t,n,i,a,o){void 0===a&&(a=!0),void 0===o&&(o=!0);var c=0,p=t,u=e,d=r.vec3f32.fromValues(0,c,0),h=r.vec3f32.fromValues(0,c+u,0),f=r.vec3f32.fromValues(0,-1,0),v=r.vec3f32.fromValues(0,1,0);i&&(c=u,h=r.vec3f32.fromValues(0,0,0),d=r.vec3f32.fromValues(0,c,0),f=r.vec3f32.fromValues(0,1,0),v=r.vec3f32.fromValues(0,-1,0));var m=[h,d],g=[f,v],y=n+2,b=Math.sqrt(u*u+p*p);if(i)for(_=n-1;_>=0;_--)x=_*(2*Math.PI/n),P=r.vec3f32.fromValues(Math.cos(x)*p,c,Math.sin(x)*p),m.push(P),S=r.vec3f32.fromValues(u*Math.cos(x)/b,-p/b,u*Math.sin(x)/b),g.push(S);else for(var _=0;_<n;_++){var x=_*(2*Math.PI/n),P=r.vec3f32.fromValues(Math.cos(x)*p,c,Math.sin(x)*p);m.push(P);var S=r.vec3f32.fromValues(u*Math.cos(x)/b,p/b,u*Math.sin(x)/b);g.push(S)}var O=new Uint32Array(2*(n+2)*3),w=new Uint32Array(2*(n+2)*3),C=0,A=0;if(a){for(_=3;_<m.length;_++)O[C++]=1,O[C++]=_-1,O[C++]=_,w[A++]=0,w[A++]=0,w[A++]=0;O[C++]=m.length-1,O[C++]=2,O[C++]=1,w[A++]=0,w[A++]=0,w[A++]=0}if(o){for(_=3;_<m.length;_++)O[C++]=_,O[C++]=_-1,O[C++]=0,w[A++]=_,w[A++]=_-1,w[A++]=1;O[C++]=0,O[C++]=2,O[C++]=m.length-1,w[A++]=1,w[A++]=2,w[A++]=g.length-1}var D=new Float32Array(3*y);for(_=0;_<y;_++)D[3*_]=m[_][0],D[3*_+1]=m[_][1],D[3*_+2]=m[_][2];var V=new Float32Array(3*y);for(_=0;_<y;_++)V[3*_]=g[_][0],V[3*_+1]=g[_][1],V[3*_+2]=g[_][2];var j={};j[l.VertexAttrConstants.POSITION]=O,j[l.VertexAttrConstants.NORMAL]=w;var R={};return R[l.VertexAttrConstants.POSITION]={size:3,data:D},R[l.VertexAttrConstants.NORMAL]={size:3,data:V},new s.GeometryData(R,j)},e.createCylinderGeometry=function(e,t,i,a,o,c){var p=a?r.vec3f32.clone(a):r.vec3f32.fromValues(1,0,0),u=o?r.vec3f32.clone(o):r.vec3f32.fromValues(0,0,0),d=void 0===c||c,h=r.vec3f32.create();n.vec3.normalize(h,p);var f=r.vec3f32.create();n.vec3.scale(f,h,Math.abs(e));var v=r.vec3f32.create();n.vec3.scale(v,f,-.5),n.vec3.add(v,v,u);var m=r.vec3f32.fromValues(0,1,0);Math.abs(1-n.vec3.dot(h,m))<.2&&n.vec3.set(m,0,0,1);var g=r.vec3f32.create();n.vec3.cross(g,h,m),n.vec3.normalize(g,g),n.vec3.cross(m,g,h);var y=2*i+(d?2:0),b=i+(d?2:0),_=new Float32Array(3*y),x=new Float32Array(3*b),P=new Float32Array(2*y),S=new Uint32Array(3*i*(d?4:2)),O=new Uint32Array(3*i*(d?4:2));d&&(_[3*(y-2)+0]=v[0],_[3*(y-2)+1]=v[1],_[3*(y-2)+2]=v[2],P[2*(y-2)]=0,P[2*(y-2)+1]=0,_[3*(y-1)+0]=_[3*(y-2)+0]+f[0],_[3*(y-1)+1]=_[3*(y-2)+1]+f[1],_[3*(y-1)+2]=_[3*(y-2)+2]+f[2],P[2*(y-1)]=1,P[2*(y-1)+1]=1,x[3*(b-2)+0]=-h[0],x[3*(b-2)+1]=-h[1],x[3*(b-2)+2]=-h[2],x[3*(b-1)+0]=h[0],x[3*(b-1)+1]=h[1],x[3*(b-1)+2]=h[2]);for(var w=function(e,t,n){S[e]=t,O[e]=n},C=0,A=r.vec3f32.create(),D=r.vec3f32.create(),V=0;V<i;V++){var j=V*(2*Math.PI/i);n.vec3.scale(A,m,Math.sin(j)),n.vec3.scale(D,g,Math.cos(j)),n.vec3.add(A,A,D),x[3*V+0]=A[0],x[3*V+1]=A[1],x[3*V+2]=A[2],n.vec3.scale(A,A,t),n.vec3.add(A,A,v),_[3*V+0]=A[0],_[3*V+1]=A[1],_[3*V+2]=A[2],P[2*V+0]=V/i,P[2*V+1]=0,_[3*(V+i)+0]=_[3*V+0]+f[0],_[3*(V+i)+1]=_[3*V+1]+f[1],_[3*(V+i)+2]=_[3*V+2]+f[2],P[2*(V+i)+0]=V/i,P[2*V+1]=1;var R=(V+1)%i;w(C++,V,V),w(C++,V+i,V),w(C++,R,R),w(C++,R,R),w(C++,V+i,V),w(C++,R+i,R)}if(d){for(V=0;V<i;V++)R=(V+1)%i,w(C++,y-2,b-2),w(C++,V,b-2),w(C++,R,b-2);for(V=0;V<i;V++)R=(V+1)%i,w(C++,V+i,b-1),w(C++,y-1,b-1),w(C++,R+i,b-1)}var T={};T[l.VertexAttrConstants.POSITION]=S,T[l.VertexAttrConstants.NORMAL]=O,T[l.VertexAttrConstants.UV0]=S;var L={};return L[l.VertexAttrConstants.POSITION]={size:3,data:_},L[l.VertexAttrConstants.NORMAL]={size:3,data:x},L[l.VertexAttrConstants.UV0]={size:2,data:P},new s.GeometryData(L,T)},e.createTubeGeometry=function(t,n,r,i,a){r=r||10,i=null==i||i,l.assert(t.length>1);for(var o=[],s=[],c=0;c<r;c++){o.push([0,-c-1,-(c+1)%r-1]);var p=c/r*2*Math.PI;s.push([Math.cos(p)*n,Math.sin(p)*n])}return e.createPathExtrusionGeometry(s,t,[[0,0,0]],o,i,a)},e.createPathExtrusionGeometry=function(e,t,o,c,p,u){void 0===u&&(u=r.vec3f32.fromValues(0,0,0));var h=e.length,v=new Float32Array(t.length*h*3+(6*o.length||0)),m=new Float32Array(t.length*h+(2*o.length||0)),g=new Float32Array(t.length*h*3+(o?6:0)),y=(t.length-1)*h*6+3*c.length*2,b=new Uint32Array(y),_=new Uint32Array(y),x=0,P=0,S=0,O=0,w=0,C=r.vec3f32.create(),A=r.vec3f32.create(),D=r.vec3f32.create(),V=r.vec3f32.create(),j=r.vec3f32.create(),R=r.vec3f32.create(),T=r.vec3f32.create(),L=i.vec3f64.create(),M=r.vec3f32.create(),E=r.vec3f32.create(),I=r.vec3f32.create(),z=r.vec3f32.create(),N=r.vec3f32.create(),F=a.plane.create();n.vec3.set(M,0,1,0),n.vec3.subtract(A,t[1],t[0]),n.vec3.normalize(A,A),p?(n.vec3.add(L,t[0],u),n.vec3.normalize(D,L)):n.vec3.set(D,0,0,1),d(A,D,M,M,j,D,f),n.vec3.copy(V,D),n.vec3.copy(z,j);for(var U=0;U<o.length;U++)n.vec3.scale(R,j,o[U][0]),n.vec3.scale(L,D,o[U][2]),n.vec3.add(R,R,L),n.vec3.add(R,R,t[0]),v[x++]=R[0],v[x++]=R[1],v[x++]=R[2],m[S++]=0;for(g[P++]=-A[0],g[P++]=-A[1],g[P++]=-A[2],U=0;U<c.length;U++)b[O++]=c[U][0]>0?c[U][0]:-c[U][0]-1+o.length,b[O++]=c[U][1]>0?c[U][1]:-c[U][1]-1+o.length,b[O++]=c[U][2]>0?c[U][2]:-c[U][2]-1+o.length,_[w++]=0,_[w++]=0,_[w++]=0;for(var q=o.length,W=o.length-1,B=0;B<t.length;B++){var G=!1;B>0&&(n.vec3.copy(C,A),B<t.length-1?(n.vec3.subtract(A,t[B+1],t[B]),n.vec3.normalize(A,A)):G=!0,n.vec3.add(E,C,A),n.vec3.normalize(E,E),n.vec3.add(I,t[B-1],V),a.plane.fromPositionAndNormal(t[B],E,F),a.plane.intersectRay(F,a.ray.wrap(I,C),L)?(n.vec3.subtract(L,L,t[B]),n.vec3.normalize(D,L),n.vec3.cross(j,E,D),n.vec3.normalize(j,j)):d(E,V,z,M,j,D,f),n.vec3.copy(V,D),n.vec3.copy(z,j)),p&&(n.vec3.add(L,t[B],u),n.vec3.normalize(N,L));for(var k=0;k<h;k++)if(n.vec3.scale(R,j,e[k][0]),n.vec3.scale(L,D,e[k][1]),n.vec3.add(R,R,L),n.vec3.normalize(T,R),g[P++]=T[0],g[P++]=T[1],g[P++]=T[2],m[S++]=p?n.vec3.dot(R,N):R[2],n.vec3.add(R,R,t[B]),v[x++]=R[0],v[x++]=R[1],v[x++]=R[2],!G){var H=(k+1)%h;b[O++]=q+k,b[O++]=q+h+k,b[O++]=q+H,b[O++]=q+H,b[O++]=q+h+k,b[O++]=q+h+H;for(var X=0;X<6;X++)_[w++]=b[O-6+X]-W}q+=h}var Y=t[t.length-1];for(U=0;U<o.length;U++)n.vec3.scale(R,j,o[U][0]),n.vec3.scale(L,D,o[U][1]),n.vec3.add(R,R,L),n.vec3.add(R,R,Y),v[x++]=R[0],v[x++]=R[1],v[x++]=R[2],m[S++]=0;var Z=P/3;g[P++]=A[0],g[P++]=A[1],g[P++]=A[2];var J=q-h;for(U=0;U<c.length;U++)b[O++]=c[U][0]>=0?q+c[U][0]:-c[U][0]-1+J,b[O++]=c[U][2]>=0?q+c[U][2]:-c[U][2]-1+J,b[O++]=c[U][1]>=0?q+c[U][1]:-c[U][1]-1+J,_[w++]=Z,_[w++]=Z,_[w++]=Z;var Q={};Q[l.VertexAttrConstants.POSITION]=b,Q[l.VertexAttrConstants.NORMAL]=_;var K={};return K[l.VertexAttrConstants.POSITION]={size:3,data:v},K.zOffset={size:1,data:m},K[l.VertexAttrConstants.NORMAL]={size:3,data:g},new s.GeometryData(K,Q)},e.createPolylineGeometry=function(e,t){l.assert(e.length>1,"createPolylineGeometry(): polyline needs at least 2 points"),l.assert(3===e[0].length,"createPolylineGeometry(): malformed vertex"),l.assert(void 0===t||t.length===e.length,"createPolylineGeometry: need same number of points and normals"),l.assert(void 0===t||3===t[0].length,"createPolylineGeometry(): malformed normal");for(var n=new Float64Array(3*e.length),r=new Uint32Array(2*(e.length-1)),i=0,a=0,o=0;o<e.length;o++){for(var c=0;c<3;c++)n[i++]=e[o][c];o>0&&(r[a++]=o-1,r[a++]=o)}var p={},u={};if(p[l.VertexAttrConstants.POSITION]=r,u[l.VertexAttrConstants.POSITION]={size:3,data:n},t){var d=new Float32Array(3*t.length),h=0;for(o=0;o<e.length;o++)for(c=0;c<3;c++)d[h++]=t[o][c];p[l.VertexAttrConstants.NORMAL]=r,u[l.VertexAttrConstants.NORMAL]={size:3,data:d}}return new s.GeometryData(u,p,"line")},e.createExtrudedTriangle=function(e,t,n,r){for(var i,a,o=new Float32Array(18),c=[[-t,0,r/2],[n,0,r/2],[0,e,r/2],[-t,0,-r/2],[n,0,-r/2],[0,e,-r/2]],p=0;p<6;p++)o[3*p]=c[p][0],o[3*p+1]=c[p][1],o[3*p+2]=c[p][2];var u=((i={})[l.VertexAttrConstants.POSITION]=new Uint32Array([0,1,2,3,0,2,2,5,3,1,4,5,5,2,1,1,0,3,3,4,1,4,3,5]),i),d=((a={})[l.VertexAttrConstants.POSITION]={size:3,data:o},a);return new s.GeometryData(d,u)},e.transformInPlace=function(e,t){for(var r=e.vertexAttributes[l.VertexAttrConstants.POSITION].data,i=0;i<r.length;i+=3)n.vec3.set(v,r[i],r[i+1],r[i+2]),n.vec3.transformMat4(v,v,t),r[i]=v[0],r[i+1]=v[1],r[i+2]=v[2]},e.cgToGIS=function(e,t){void 0===t&&(t=e);var n=e.getVertexAttr(),r=n.position.data,i=n.normal.data,a=t.getVertexAttr(),o=a.position.data,s=a.normal.data;if(i)for(var l=0;l<i.length;l+=3){var c=i[l+1];s[l+1]=-i[l+2],s[l+2]=c}if(r)for(l=0;l<r.length;l+=3)c=r[l+1],o[l+1]=-r[l+2],o[l+2]=c;return t},e.makeOrthoBasisDirUp=o,e.makeOrthoBasisDirUpFallback=d}(d||(d={}));var f=.99619469809,v=r.vec3f32.create();return d}).apply(null,r))||(e.exports=i)},"58az":function(e,t,n){var r,i;r=[n.dj.c(e.i),t,n("zOht"),n("7Aei")],void 0===(i=(function(e,t,n,r){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.CameraSpace=void 0,t.CameraSpace=function(e){e.fragment.uniforms.add("projInfo","vec4"),e.fragment.uniforms.add("zScale","vec2"),e.fragment.code.add(r.glsl(i||(i=n.__makeTemplateObject(["\n    vec3 reconstructPosition(vec2 fragCoord, float depth) {\n      return vec3((fragCoord * projInfo.xy + projInfo.zw) * (zScale.x * depth + zScale.y), depth);\n    }\n  "],["\n    vec3 reconstructPosition(vec2 fragCoord, float depth) {\n      return vec3((fragCoord * projInfo.xy + projInfo.zw) * (zScale.x * depth + zScale.y), depth);\n    }\n  "]))))}}).apply(null,r))||(e.exports=i)},"5T2R":function(e,t,n){var r,i;r=[n.dj.c(e.i),t,n("LxLY"),n("FXVB"),n("0LE5"),n("O7NG"),n("xdO3"),n("woUR"),n("BwdQ"),n("JjCO"),n("ys4y"),n("4ziW"),n("o5p5"),n("uZGf")],void 0===(i=(function(e,t,n,r,i,a,o,s,l,c,p,u,d,h){"use strict";function f(e,t){void 0===t&&(t=4);var n=a.vec4f64.fromValues(e[0],e[1],e[2],e.length>3?e[3]:1),r=new h.ShadedColorMaterial({color:n,transparent:e[3]<1,writeDepth:!0,cullFace:2},"manipulator");return r.renderOccluded=t,r}function v(e,t,n,r){var a=i.vec3.normalize(c.sv3d.get(),e),o=i.vec3.normalize(c.sv3d.get(),t),s=i.vec3.cross(c.sv3d.get(),a,o);return r[0]=a[0],r[1]=a[1],r[2]=a[2],r[3]=0,r[4]=o[0],r[5]=o[1],r[6]=o[2],r[7]=0,r[8]=s[0],r[9]=s[1],r[10]=s[2],r[11]=0,r[12]=n[0],r[13]=n[1],r[14]=n[2],r[15]=1,r}function m(e,t){var r=e.getViewForGraphic(t);return n.isSome(r)&&"computeAttachmentOrigin"in r?r.computeAttachmentOrigin(t,e.spatialReference):null}Object.defineProperty(t,"__esModule",{value:!0}),t.placeAtGraphic=t.getGraphicAttachmentOrigin=t.calculateTranslateRotateFromBases=t.calculateInputRotationTransform=t.createSphereManipulator=t.createManipulatorOutlineMaterial=t.createManipulatorMaterial=void 0,t.createManipulatorMaterial=f,t.createManipulatorOutlineMaterial=function(e,t){void 0===t&&(t=4);var n=a.vec4f64.fromValues(e[0],e[1],e[2],4===e.length?e[3]:1),r=new d({color:n,transparent:!0,writeDepth:!0,cullFace:1},"manipulator-outline");return r.renderOccluded=t,r},t.createSphereManipulator=function(e,t,n){return new s.Manipulator3D({view:e,renderObjects:[{geometry:new p(u.createSphereGeometry(1,32,32),"manipulator"),material:f(a.vec4f64.fromValues(t[0],t[1],t[2],null!=n?n:1))}]})},t.calculateInputRotationTransform=function(e,t,n,a){var o=i.vec3.subtract(c.sv3d.get(),e,n),s=v(o,i.vec3.cross(c.sv3d.get(),a,o),n,c.sm4d.get());r.mat4.invert(s,s);var l=i.vec3.transformMat4(c.sv3d.get(),t,s);return Math.atan2(l[1],l[0])},t.calculateTranslateRotateFromBases=v,t.getGraphicAttachmentOrigin=m,t.placeAtGraphic=function(e,t,r){var i=m(e,r);n.isSome(i)?t.elevationAlignedLocation=i:function(e,t){if(!n.isNone(t)){var r=l.computeCentroid(t);n.isNone(r)||(e.location=o.hydrateGeometry(r))}}(t,r.geometry)}}).apply(null,r))||(e.exports=i)},"6vp1":function(e,t,n){var r,i;r=[n.dj.c(e.i),t,n("zOht"),n("DKwL"),n("7Aei")],void 0===(i=(function(e,t,n,r,i){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),t.ReadLinearDepth=void 0,t.ReadLinearDepth=function(e){e.fragment.include(r.RgbaFloatEncoding),e.fragment.code.add(i.glsl(a||(a=n.__makeTemplateObject(["\n    float linearDepthFromTexture(sampler2D depthTex, vec2 uv, vec2 nearFar) {\n      return -(rgba2float(texture2D(depthTex, uv)) * (nearFar[1] - nearFar[0]) + nearFar[0]);\n    }\n  "],["\n    float linearDepthFromTexture(sampler2D depthTex, vec2 uv, vec2 nearFar) {\n      return -(rgba2float(texture2D(depthTex, uv)) * (nearFar[1] - nearFar[0]) + nearFar[0]);\n    }\n  "]))))}}).apply(null,r))||(e.exports=i)},"7zqm":function(e,t,n){var r,i;r=[n.dj.c(e.i),t,n("zOht"),n("7Aei")],void 0===(i=(function(e,t,n,r){"use strict";var i,a,o,s;Object.defineProperty(t,"__esModule",{value:!0}),t.LineStipple=void 0,t.LineStipple=function(e,t){e.defines.addFloat("STIPPLE_ALPHA_COLOR_DISCARD",.001),e.defines.addFloat("STIPPLE_ALPHA_HIGHLIGHT_DISCARD",.5),t.stippleEnabled?function(e,t){e.vertex.uniforms.add("stipplePatternPixelSizeInv","float"),t.stippleUVMaxEnabled&&e.varyings.add("stipplePatternUvMax","float"),e.varyings.add("stipplePatternUv","float"),e.fragment.uniforms.add("stipplePatternTexture","sampler2D"),t.stippleOffColorEnabled&&e.fragment.uniforms.add("stippleOffColor","vec4"),e.fragment.code.add(r.glsl(i||(i=n.__makeTemplateObject(["\n  float getStippleAlpha() {\n    float stipplePatternUvClamped = stipplePatternUv * gl_FragCoord.w;\n    ","\n\n    return texture2D(stipplePatternTexture, vec2(mod(stipplePatternUvClamped, 1.0), 0.5)).a;\n  }"],["\n  float getStippleAlpha() {\n    float stipplePatternUvClamped = stipplePatternUv * gl_FragCoord.w;\n    ","\n\n    return texture2D(stipplePatternTexture, vec2(mod(stipplePatternUvClamped, 1.0), 0.5)).a;\n  }"])),t.stippleUVMaxEnabled?"stipplePatternUvClamped = clamp(stipplePatternUvClamped, 0.0, stipplePatternUvMax);":"")),e.fragment.code.add(r.glsl(t.stippleOffColorEnabled?a||(a=n.__makeTemplateObject(["\n    #define discardByStippleAlpha(stippleAlpha, threshold) {}\n    #define blendStipple(color, stippleAlpha) mix(color, stippleOffColor, stippleAlpha)\n    "],["\n    #define discardByStippleAlpha(stippleAlpha, threshold) {}\n    #define blendStipple(color, stippleAlpha) mix(color, stippleOffColor, stippleAlpha)\n    "])):o||(o=n.__makeTemplateObject(["\n    #define discardByStippleAlpha(stippleAlpha, threshold) if (stippleAlpha < threshold) { discard; }\n    #define blendStipple(color, stippleAlpha) vec4(color.rgb, color.a * stippleAlpha)\n    "],["\n    #define discardByStippleAlpha(stippleAlpha, threshold) if (stippleAlpha < threshold) { discard; }\n    #define blendStipple(color, stippleAlpha) vec4(color.rgb, color.a * stippleAlpha)\n    "]))))}(e,t):function(e){e.fragment.code.add(r.glsl(s||(s=n.__makeTemplateObject(["\n  float getStippleAlpha() { return 1.0; }\n\n  #define discardByStippleAlpha(_stippleAlpha_, _threshold_) {}\n  #define blendStipple(color, _stippleAlpha_) color\n  "],["\n  float getStippleAlpha() { return 1.0; }\n\n  #define discardByStippleAlpha(_stippleAlpha_, _threshold_) {}\n  #define blendStipple(color, _stippleAlpha_) color\n  "]))))}(e)}}).apply(null,r))||(e.exports=i)},"83/a":function(e,t,n){var r,i;r=[n.dj.c(e.i),t],void 0===(i=(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Vec3Compact=void 0,function(e){e.length=function(e,t){var n=e[t],r=e[t+1],i=e[t+2];return Math.sqrt(n*n+r*r+i*i)},e.normalize=function(e,t){var n=e[t],r=e[t+1],i=e[t+2],a=1/Math.sqrt(n*n+r*r+i*i);e[t]*=a,e[t+1]*=a,e[t+2]*=a},e.scale=function(e,t,n){e[t]*=n,e[t+1]*=n,e[t+2]*=n},e.add=function(e,t,n,r,i,a){void 0===a&&(a=t),(i=i||e)[a]=e[t]+n[r],i[a+1]=e[t+1]+n[r+1],i[a+2]=e[t+2]+n[r+2]},e.subtract=function(e,t,n,r,i,a){void 0===a&&(a=t),(i=i||e)[a]=e[t]-n[r],i[a+1]=e[t+1]-n[r+1],i[a+2]=e[t+2]-n[r+2]}}(t.Vec3Compact||(t.Vec3Compact={}))}).apply(null,r))||(e.exports=i)},B3XD:function(e,t,n){var r,i;r=[n.dj.c(e.i),t,n("zOht"),n("TMur"),n("xoE+"),n("LxLY"),n("jBNx"),n("0LE5"),n("Rdxj"),n("DtIM"),n("aWgr"),n("aWgr"),n("UidR"),n("JjCO"),n("m4lJ"),n("9DjX"),n("bz+r")],void 0===(i=(function(e,t,n,r,i,a,o,s,l,c,p,u,d,h,f,v,m){"use strict";function g(e,t){var r=l.vec3f64.create(),i=l.vec3f64.create(),a=!1;return function(s){if("start"===s.action){var l=o.screenPointObjectToArray(s.screenStart,o.castScreenPointArray(h.sv2d.get())),c=u.ray.fromScreen(e.state.camera,l,w);a=u.plane.intersectRay(t,c,r)}if(!a)return null;var p=o.screenPointObjectToArray(s.screenEnd,o.castScreenPointArray(h.sv2d.get())),d=u.ray.fromScreen(e.state.camera,p,w);return u.plane.intersectRay(t,d,i)?n.__assign(n.__assign({},s),{renderStart:r,renderEnd:i,plane:t,ray:d}):null}}function y(e,t,r,i){void 0===i&&(i=null);var s=null;return function(l){if("start"===l.action&&(s=e.sceneIntersectionHelper.intersectElevationFromScreen(o.createScreenPointArray(l.screenStart.x,l.screenStart.y),t,r),a.isSome(s)&&a.isSome(i)&&!d.pointToPoint(s,s,i)))return null;if(a.isNone(s))return null;var c=e.sceneIntersectionHelper.intersectElevationFromScreen(o.createScreenPointArray(l.screenEnd.x,l.screenEnd.y),t,r);return a.isSome(c)?a.isSome(i)&&!d.pointToPoint(c,c,i)?null:n.__assign(n.__assign({},l),{mapStart:s,mapEnd:c}):null}}function b(e,t,n,r){return void 0===r&&(r=null),y(e,n,c.getZForElevationMode(t,e,n),r)}function _(e,t,n,r){return void 0===r&&(r=null),b(e,n,c.getGraphicEffectiveElevationInfo(t),r)}function x(e,t){var n=l.vec3f64.create(),r=s.vec3.length(t);e.renderCoordsHelper.worldUpAtPosition(t,n);var a=l.vec3f64.create(),o=l.vec3f64.create(),c=function(a){return s.vec3.subtract(a,a,t),p.vector.projectPoint(n,a,a),"global"===e.viewingMode&&s.vec3.length(a)*i.sign(s.vec3.dot(n,a))<.001-r&&s.vec3.subtract(a,s.vec3.scale(a,n,.001),t),s.vec3.add(a,a,t),a};return function(e){return e.renderStart=c(s.vec3.copy(a,e.renderStart)),e.renderEnd=c(s.vec3.copy(o,e.renderEnd)),e}}function P(e,t){var i=e.renderCoordsHelper;return function(e){var o=i.fromRenderCoords(e.renderStart,new r.Point,t),s=i.fromRenderCoords(e.renderEnd,new r.Point,t);return a.isSome(o)&&a.isSome(s)?n.__assign(n.__assign({},e),{mapStart:o,mapEnd:s}):null}}Object.defineProperty(t,"__esModule",{value:!0}),t.screenToMap3D=t.hideManipulatorWhileDragging=t.convertToMapCoordinates=t.projectToWorldUp=t.screenToZConstrained=t.screenToMapXYForGraphic=t.screenToMapXYForGraphicAtLocation=t.screenToMapXYAtLocation=t.screenToMapXY=t.screenToRenderPlane=void 0,t.screenToRenderPlane=g,t.screenToMapXY=y,t.screenToMapXYAtLocation=b,t.screenToMapXYForGraphicAtLocation=_,t.screenToMapXYForGraphic=function(e,t,n,r){var i=t.toMap(e.screenStart,{include:[n]});return a.isSome(i)?_(t,n,i,r):null},t.screenToZConstrained=function(e,t,n){var r=null,i=new m.EventPipeline;return i.next(g(e,function(e,t){var n=S,r=O,i=u.plane.create();e.renderCoordsHelper.worldUpAtPosition(t,n);var a=s.vec3.cross(i,n,s.vec3.subtract(r,t,e.state.camera.eye));return s.vec3.cross(a,a,n),u.plane.fromPositionAndNormal(t,a,i)}(e,t))).next(x(e,t)).next(P(e,n)).next((function(e){e.mapEnd.x=e.mapStart.x,e.mapEnd.y=e.mapStart.y,r=e})),function(e){return r=null,i.execute(e),r}},t.projectToWorldUp=x,t.convertToMapCoordinates=P,t.hideManipulatorWhileDragging=function(e){var t=null;return function(n){switch(n.action){case"start":t=e.disableDisplay();break;case"end":case"cancel":a.isSome(t)&&(t.remove(),t=null)}return n}},t.screenToMap3D=function(e,t){void 0===t&&(t=null);var i=null,s=new f.Intersector(e.state.mode);s.options.selectionMode=!0,s.options.store=0;var c=o.createScreenPointArray(),p={requiresGroundFeedback:!0,enableDraped:!0,exclude:new Set},u=l.vec3f64.create(),d=a.unwrapOr(t,e.spatialReference),h=function(t){e.map.ground&&e.map.ground.opacity<1?p.exclude.add(v.TERRAIN_ID):p.exclude.delete(v.TERRAIN_ID),e.sceneIntersectionHelper.intersectIntersectorScreen(o.screenPointObjectToArray(t,c),s,p);var n,i=s.results.min;if(i.getIntersectionPoint(u))n="TerrainRenderer"===i.intersector?0:1;else{if(!s.results.ground.getIntersectionPoint(u))return null;n=0}var a=new r.Point({spatialReference:d});return e.renderCoordsHelper.fromRenderCoords(u,a),{location:a,surfaceType:n}};return function(e){if("start"===e.action){var t=h(e.screenStart);i=a.isSome(t)?t.location:null}if(a.isNone(i))return null;var r=h(e.screenEnd);return a.isSome(r)?n.__assign(n.__assign({},e),{mapStart:i,mapEnd:r.location,surfaceType:r.surfaceType}):null}};var S=l.vec3f64.create(),O=l.vec3f64.create(),w=u.ray.create()}).apply(null,r))||(e.exports=i)},BwdQ:function(e,t,n){var r,i;r=[n.dj.c(e.i),t,n("xoE+"),n("LxLY"),n("FXVB"),n("1m5D"),n("DIqE"),n("Rdxj"),n("2fXB"),n("O7NG"),n("WRgd"),n("lRq4"),n("0FS0"),n("ZPQp"),n("ZcgO"),n("xdO3"),n("UidR")],void 0===(i=(function(e,t,n,r,i,a,o,s,l,c,p,u,d,h,f,v,m){"use strict";function g(e){var t=e.paths[0];if(!t||0===t.length)return null;var n=h.getPointOnPath(t,h.getPathLength(t)/2);return f.makeDehydratedPoint(n[0],n[1],n[2],e.spatialReference)}function y(e,t,n){var r=n?e:v.clonePoint(e);return t&&e?m.pointToPoint(e,r,t)?r:null:r}function b(e){if(Array.isArray(e)){for(var t=0,n=e;t<n.length;t++)if(!b(n[t]))return!1;return!0}return null==e||e>=0}Object.defineProperty(t,"__esModule",{value:!0}),t.namedAnchorToHUDMaterialAnchorPos=t.demResolutionForBoundingBox=t.computeObjectRotation=t.isValidSize=t.validateSymbolLayerSize=t.computeObjectScale=t.overrideColor=t.mixinColorAndOpacity=t.updateVertexAttributeAuxpos1w=t.enlargeExtent=t.computeCentroid=void 0,t.computeCentroid=function(e,t){if("point"===e.type)return y(e,t,!1);if(v.isHydratedGeometry(e))switch(e.type){case"extent":return y(e.center,t,!1);case"polygon":return y(e.centroid,t,!1);case"polyline":return y(g(e),t,!0);case"mesh":return y(e.extent.center,t,!1)}else switch(e.type){case"extent":return y(function(e){var t=n.isFinite(e.zmin);return f.makeDehydratedPoint(.5*(e.xmax+e.xmin),.5*(e.ymax+e.ymin),t?.5*(e.zmax+e.zmin):void 0,e.spatialReference)}(e),t,!0);case"polygon":return y(function(e){var t=e.rings[0];if(!t||0===t.length)return null;var n=d.ringsCentroid(e.rings,e.hasZ);return f.makeDehydratedPoint(n[0],n[1],n[2],e.spatialReference)}(e),t,!0);case"polyline":return y(g(e),t,!0)}},t.enlargeExtent=function(e,t,n,r){if(void 0===r&&(r=0),e){t||(t=u.create());var i=.5*e.width*(n-1),a=.5*e.height*(n-1);return e.width<1e-7*e.height?i+=a/20:e.height<1e-7*e.width&&(a+=i/20),l.vec4.set(t,e.xmin-i-r,e.ymin-a-r,e.xmax+i+r,e.ymax+a+r),t}return null},t.updateVertexAttributeAuxpos1w=function(e,t){for(var n=0;n<e.geometries.length;++n){var r=e.geometries[n].data.vertexAttributes.auxpos1;r&&r.data[3]!==t&&(r.data[3]=t,e.geometryVertexAttrsUpdated(n))}},t.mixinColorAndOpacity=function(e,t){var n=c.vec4f64.clone(c.vec4f64.ONES);return r.isSome(e)&&(n[0]=e[0],n[1]=e[1],n[2]=e[2]),r.isSome(t)?n[3]=t:r.isSome(e)&&e.length>3&&(n[3]=e[3]),n},t.overrideColor=function(e,t,n,i,a,o){void 0===o&&(o=[0,0,0,0]);for(var s=0;s<3;++s)o[s]=r.isSome(e)&&null!=e[s]?e[s]:r.isSome(n)&&null!=n[s]?n[s]:a[s];return o[3]=r.isSome(t)?t:r.isSome(i)?i:a[3],o},t.computeObjectScale=function(e,t,n,i){void 0===e&&(e=s.vec3f64.ONES),void 0===i&&(i=1);var a=new Array(3);if(r.isNone(t)||r.isNone(n))a[0]=1,a[1]=1,a[2]=1;else{for(var o=void 0,l=0,c=2;c>=0;c--){var p=e[c],u=void 0,d=null!=p,h=n[c];"symbol-value"===p||0===c&&!o&&!d?u=0!==h?t[c]/h:1:d&&"proportional"!==p&&isFinite(p)&&(u=0!==h?p/h:1),null!=u&&(a[c]=u,o=u,l=Math.max(l,Math.abs(u)))}for(c=2;c>=0;c--)null==a[c]?a[c]=o:0===a[c]&&(a[c]=.001*l)}for(c=2;c>=0;c--)a[c]/=i;return s.vec3f64.fromArray(a)},t.validateSymbolLayerSize=function(e){return null!=e.isPrimitive&&(e=[e.width,e.depth,e.height]),b(e)?null:"Symbol sizes may not be negative values"},t.isValidSize=b,t.computeObjectRotation=function(e,t,n,r){void 0===r&&(r=a.mat4f64.create());var o=e||0,s=t||0,l=n||0;return 0!==o&&i.mat4.rotateZ(r,r,-o/180*Math.PI),0!==s&&i.mat4.rotateX(r,r,s/180*Math.PI),0!==l&&i.mat4.rotateY(r,r,l/180*Math.PI),r},t.demResolutionForBoundingBox=function(e,t){return null!=t.minDemResolution?t.minDemResolution:p.isPoint(e)?t.minDemResolutionForPoints:.01*p.maximumDimension(e)},t.namedAnchorToHUDMaterialAnchorPos={"bottom-left":o.vec2f64.fromValues(0,0),bottom:o.vec2f64.fromValues(.5,0),"bottom-right":o.vec2f64.fromValues(1,0),left:o.vec2f64.fromValues(0,.5),center:o.vec2f64.fromValues(.5,.5),right:o.vec2f64.fromValues(1,.5),"top-left":o.vec2f64.fromValues(0,1),top:o.vec2f64.fromValues(.5,1),"top-right":o.vec2f64.fromValues(1,1)}}).apply(null,r))||(e.exports=i)},DFuO:function(e,t,n){var r,i;r=[n.dj.c(e.i),t,n("zOht"),n("fese"),n("3kdR"),n("6t3m"),n("PaEL"),n("IwVr"),n("7Aei"),n("aExC")],void 0===(i=(function(e,t,n,r,i,a,o,s,l,c){"use strict";var p,u,d,h;Object.defineProperty(t,"__esModule",{value:!0}),t.build=void 0,t.build=function(e){var t=new c.ShaderBuilder;return t.include(i.Transform,{linearDepth:!1}),t.include(a.VertexColor,e),t.vertex.uniforms.add("proj","mat4").add("view","mat4"),t.attributes.add("position","vec3"),t.varyings.add("vpos","vec3"),t.vertex.code.add(l.glsl(p||(p=n.__makeTemplateObject(["\n    void main(void) {\n      vpos = position;\n      forwardNormalizedVertexColor();\n      gl_Position = transformPosition(proj, view, vpos);\n    }\n  "],["\n    void main(void) {\n      vpos = position;\n      forwardNormalizedVertexColor();\n      gl_Position = transformPosition(proj, view, vpos);\n    }\n  "])))),t.include(r.Slice,e),t.fragment.uniforms.add("eColor","vec4"),4===e.output&&t.include(o.OutputHighlight),t.fragment.code.add(l.glsl(h||(h=n.__makeTemplateObject(["\n  void main() {\n    discardBySlice(vpos);\n    vec4 color = ","\n\n    if (color.a < ",") {\n      discard;\n    }\n\n    ","\n    ",";\n  }\n  "],["\n  void main() {\n    discardBySlice(vpos);\n    vec4 color = ","\n\n    if (color.a < ",") {\n      discard;\n    }\n\n    ","\n    ",";\n  }\n  "])),e.attributeColor?"vColor * eColor;":"eColor;",l.glsl.float(s.symbolAlphaCutoff),0===e.output?l.glsl(u||(u=n.__makeTemplateObject(["gl_FragColor = highlightSlice(color, vpos);"],["gl_FragColor = highlightSlice(color, vpos);"]))):"",4===e.output?l.glsl(d||(d=n.__makeTemplateObject(["outputHighlight();"],["outputHighlight();"]))):"")),t}}).apply(null,r))||(e.exports=i)},"E/g4":function(e,t,n){var r,i;r=[n.dj.c(e.i),t,n("zOht"),n("7Aei")],void 0===(i=(function(e,t,n,r){"use strict";var i,a,o,s,l,c;Object.defineProperty(t,"__esModule",{value:!0}),t.RibbonVertexPosition=void 0,t.RibbonVertexPosition=function(e,t){e.vertex.uniforms.add("intrinsicWidth","float"),t.vvSize?(e.attributes.add("sizeFeatureAttribute","float"),e.vertex.uniforms.add("vvSizeMinSize","vec3"),e.vertex.uniforms.add("vvSizeMaxSize","vec3"),e.vertex.uniforms.add("vvSizeOffset","vec3"),e.vertex.uniforms.add("vvSizeFactor","vec3"),e.vertex.code.add(r.glsl(i||(i=n.__makeTemplateObject(["\n    float getSize() {\n      return intrinsicWidth * clamp(vvSizeOffset + sizeFeatureAttribute * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize).x;\n    }\n    "],["\n    float getSize() {\n      return intrinsicWidth * clamp(vvSizeOffset + sizeFeatureAttribute * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize).x;\n    }\n    "]))))):(e.attributes.add("size","float"),e.vertex.code.add(r.glsl(a||(a=n.__makeTemplateObject(["\n    float getSize(){\n      return intrinsicWidth * size;\n    }\n    "],["\n    float getSize(){\n      return intrinsicWidth * size;\n    }\n    "]))))),t.vvOpacity?(e.attributes.add("opacityFeatureAttribute","float"),e.vertex.defines.addInt("VV_OPACITY_N",8),e.vertex.code.add(r.glsl(o||(o=n.__makeTemplateObject(["\n    uniform float vvOpacityValues[VV_OPACITY_N];\n    uniform float vvOpacityOpacities[VV_OPACITY_N];\n\n    float interpolateOpacity( float value ){\n      if (value <= vvOpacityValues[0]) {\n        return vvOpacityOpacities[0];\n      }\n\n      for (int i = 1; i < VV_OPACITY_N; ++i) {\n        if (vvOpacityValues[i] >= value) {\n          float f = (value - vvOpacityValues[i-1]) / (vvOpacityValues[i] - vvOpacityValues[i-1]);\n          return mix(vvOpacityOpacities[i-1], vvOpacityOpacities[i], f);\n        }\n      }\n\n      return vvOpacityOpacities[VV_OPACITY_N - 1];\n    }\n\n    vec4 applyOpacity( vec4 color ){\n      return vec4(color.xyz, interpolateOpacity(opacityFeatureAttribute));\n    }\n    "],["\n    uniform float vvOpacityValues[VV_OPACITY_N];\n    uniform float vvOpacityOpacities[VV_OPACITY_N];\n\n    float interpolateOpacity( float value ){\n      if (value <= vvOpacityValues[0]) {\n        return vvOpacityOpacities[0];\n      }\n\n      for (int i = 1; i < VV_OPACITY_N; ++i) {\n        if (vvOpacityValues[i] >= value) {\n          float f = (value - vvOpacityValues[i-1]) / (vvOpacityValues[i] - vvOpacityValues[i-1]);\n          return mix(vvOpacityOpacities[i-1], vvOpacityOpacities[i], f);\n        }\n      }\n\n      return vvOpacityOpacities[VV_OPACITY_N - 1];\n    }\n\n    vec4 applyOpacity( vec4 color ){\n      return vec4(color.xyz, interpolateOpacity(opacityFeatureAttribute));\n    }\n    "]))))):e.vertex.code.add(r.glsl(s||(s=n.__makeTemplateObject(["\n    vec4 applyOpacity( vec4 color ){\n      return color;\n    }\n    "],["\n    vec4 applyOpacity( vec4 color ){\n      return color;\n    }\n    "])))),t.vvColor?(e.attributes.add("colorFeatureAttribute","float"),e.vertex.defines.addInt("VV_COLOR_N",8),e.vertex.code.add(r.glsl(l||(l=n.__makeTemplateObject(["\n    uniform float vvColorValues[VV_COLOR_N];\n    uniform vec4 vvColorColors[VV_COLOR_N];\n\n    vec4 interpolateColor( float value ) {\n      if (value <= vvColorValues[0]) {\n        return vvColorColors[0];\n      }\n\n      for (int i = 1; i < VV_COLOR_N; ++i) {\n        if (vvColorValues[i] >= value) {\n          float f = (value - vvColorValues[i-1]) / (vvColorValues[i] - vvColorValues[i-1]);\n          return mix(vvColorColors[i-1], vvColorColors[i], f);\n        }\n      }\n\n      return vvColorColors[VV_COLOR_N - 1];\n    }\n\n    vec4 getColor(){\n      return applyOpacity(interpolateColor(colorFeatureAttribute));\n    }\n    "],["\n    uniform float vvColorValues[VV_COLOR_N];\n    uniform vec4 vvColorColors[VV_COLOR_N];\n\n    vec4 interpolateColor( float value ) {\n      if (value <= vvColorValues[0]) {\n        return vvColorColors[0];\n      }\n\n      for (int i = 1; i < VV_COLOR_N; ++i) {\n        if (vvColorValues[i] >= value) {\n          float f = (value - vvColorValues[i-1]) / (vvColorValues[i] - vvColorValues[i-1]);\n          return mix(vvColorColors[i-1], vvColorColors[i], f);\n        }\n      }\n\n      return vvColorColors[VV_COLOR_N - 1];\n    }\n\n    vec4 getColor(){\n      return applyOpacity(interpolateColor(colorFeatureAttribute));\n    }\n    "]))))):(e.attributes.add("color","vec4"),e.vertex.code.add(r.glsl(c||(c=n.__makeTemplateObject(["\n    vec4 getColor(){\n      return applyOpacity(color);\n    }\n    "],["\n    vec4 getColor(){\n      return applyOpacity(color);\n    }\n    "])))))}}).apply(null,r))||(e.exports=i)},EiS2:function(e,t,n){var r,i;r=[n.dj.c(e.i),t,n("zOht"),n("fese"),n("PaEL"),n("2NOe"),n("W/V4"),n("FQ4r"),n("lBa0"),n("ff/U"),n("lfQW"),n("DFuO"),n("G0ER"),n("qbr3"),n("2Kdy")],void 0===(i=(function(e,t,r,i,a,o,s,l,c,p,u,d,h,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColorMaterialTechniqueConfiguration=t.ColorMaterialTechnique=void 0;var v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.initializeProgram=function(e){var n=t.shader.get(),r=this.configuration,i=n.build({output:r.output,attributeColor:r.vertexColors,slicePlaneEnabled:r.slicePlaneEnabled,sliceHighlightDisabled:r.sliceHighlightDisabled,sliceEnabledForVertexPrograms:!1});return new h(e.rctx,i.generateSource("vertex"),i.generateSource("fragment"),p.Default3D)},t.prototype.bindPass=function(e,t,n){o.View.bindProjectionMatrix(this.program,n.camera.projectionMatrix),this.program.setUniform4fv("eColor",t.color),4===this.configuration.output&&a.OutputHighlight.bindOutputHighlight(e,this.program,n)},t.prototype.bindDraw=function(e){o.View.bindView(this.program,e),i.Slice.bindUniformsWithOrigin(this.program,this.configuration,e)},t.prototype.initializePipeline=function(){var e=this.configuration,t=f.separateBlendingParams(770,1,771,771),n=0===e.output?e.transparent&&t:null,r=function(t){return f.makePipelineState({blending:n,polygonOffset:e.polygonOffset&&m,culling:(r=e.cullFace,0!==r&&{face:1===r?1028:1029,mode:2305}),depthTest:u.depthCompareLess,depthWrite:e.writeDepth&&f.defaultDepthWriteParams,colorWrite:f.defaultColorWriteParams,stencilWrite:e.sceneHasOcludees?u.stencilWriteMaskOn:null,stencilTest:e.sceneHasOcludees?t?u.stencilToolMaskBaseParams:u.stencilBaseAllZerosParams:null});var r};return this._occludeeState=r(!0),r(!1)},Object.defineProperty(t.prototype,"opaqueOccludeeState",{get:function(){return this._occludeeState},enumerable:!1,configurable:!0}),t.shader=new s.ReloadableShaderModule(d,(function(){return new Promise((function(e,t){Promise.resolve().then((function(){var t=[n("DFuO")];e.apply(null,t)}).bind(this)).catch(t.bind(this))}))})),t}(l.ShaderTechnique);t.ColorMaterialTechnique=v;var m={factor:1,units:1},g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.output=0,t.cullFace=0,t.slicePlaneEnabled=!1,t.sliceHighlightDisabled=!1,t.vertexColors=!1,t.transparent=!1,t.polygonOffset=!1,t.writeDepth=!0,t.sceneHasOcludees=!1,t}return r.__extends(t,e),r.__decorate([c.parameter({count:7})],t.prototype,"output",void 0),r.__decorate([c.parameter({count:3})],t.prototype,"cullFace",void 0),r.__decorate([c.parameter()],t.prototype,"slicePlaneEnabled",void 0),r.__decorate([c.parameter()],t.prototype,"sliceHighlightDisabled",void 0),r.__decorate([c.parameter()],t.prototype,"vertexColors",void 0),r.__decorate([c.parameter()],t.prototype,"transparent",void 0),r.__decorate([c.parameter()],t.prototype,"polygonOffset",void 0),r.__decorate([c.parameter()],t.prototype,"writeDepth",void 0),r.__decorate([c.parameter()],t.prototype,"sceneHasOcludees",void 0),t}(c.ShaderTechniqueConfiguration);t.ColorMaterialTechniqueConfiguration=g}).apply(null,r))||(e.exports=i)},FbvD:function(e,t,n){var r,i;r=[n.dj.c(e.i),t,n("LxLY"),n("DJpR")],void 0===(i=(function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createStipplePatternSimple=t.createStipplePattern=t.StippleTextureRepository=void 0;var i=function(){function e(){this.cache=new Map}return e.prototype.dispose=function(){this.cache.forEach((function(e){n.isSome(e.texture)&&(e.texture.dispose(),e.texture=null)})),this.cache.clear()},e.prototype.acquire=function(e){if(n.isNone(e))return null;var t=this.patternId(e),i=this.cache.get(t);if(i)return i.refCount++,i.bind;var a=this.patternToTextureData(e,2),o=a.length/2,s={refCount:1,texture:null,bind:function(e,t){return n.isNone(s.texture)&&(s.texture=new r.Texture(e,{width:a.length,height:1,internalFormat:6406,pixelFormat:6406,dataType:5121,wrapMode:33071},a)),e.bindTexture(s.texture,t),o}};return this.cache.set(t,s),s.bind},e.prototype.release=function(e){if(!n.isNone(e)){var t=this.patternId(e),r=this.cache.get(t);r&&(r.refCount--,0===r.refCount&&(n.isSome(r.texture)&&r.texture.dispose(),this.cache.delete(t)))}},e.prototype.swap=function(e,t){var n=this.acquire(t);return this.release(e),n},e.prototype.patternId=function(e){return e.join(",")},e.prototype.patternToTextureData=function(e,t){for(var n=e.reduce((function(e,t){return e+t}))*t,r=new Uint8Array(n),i=!0,a=0,o=0,s=e;o<s.length;o++){for(var l=s[o],c=0;c<l*t;c++)r[a++]=i?255:0;i=!i}return r},e}();t.StippleTextureRepository=i,t.createStipplePattern=function(e){return n.isNone(e)?e:e.slice()},t.createStipplePatternSimple=function(e){return[e,e]}}).apply(null,r))||(e.exports=i)},LZD4:function(e,t,n){var r,i;r=[n.dj.c(e.i),t,n("2B1V"),n("CIy2"),n("ILj8")],void 0===(i=(function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultBufferWriter=t.PositionColorMapSpaceUVBoundsLayout=t.PositionColorMapSpaceUVLayout=t.PositionColorLayout=t.PositionUVLayout=t.PositionLayout=void 0,t.PositionLayout=n.newLayout().vec3f(r.VertexAttrConstants.POSITION),t.PositionUVLayout=n.newLayout().vec3f(r.VertexAttrConstants.POSITION).vec2f(r.VertexAttrConstants.UV0),t.PositionColorLayout=n.newLayout().vec3f(r.VertexAttrConstants.POSITION).vec4u8(r.VertexAttrConstants.COLOR),t.PositionColorMapSpaceUVLayout=n.newLayout().vec3f(r.VertexAttrConstants.POSITION).vec4u8(r.VertexAttrConstants.COLOR).vec4f(r.VertexAttrConstants.UVMAPSPACE).vec3f(r.VertexAttrConstants.MEANVERTEXPOSITION),t.PositionColorMapSpaceUVBoundsLayout=n.newLayout().vec3f(r.VertexAttrConstants.POSITION).vec4u8(r.VertexAttrConstants.COLOR).vec4f(r.VertexAttrConstants.UVMAPSPACE).vec3f(r.VertexAttrConstants.BOUND1).vec3f(r.VertexAttrConstants.BOUND2).vec3f(r.VertexAttrConstants.BOUND3);var a=function(){function e(e){this.vertexBufferLayout=e}return e.prototype.allocate=function(e){return this.vertexBufferLayout.createBuffer(e)},e.prototype.elementCount=function(e){return e.indices[r.VertexAttrConstants.POSITION].length},e.prototype.write=function(e,t,n,r){i.writeDefaultAttributes(t,this.vertexBufferLayout,e.transformation,e.invTranspTransformation,n,r)},e}();t.DefaultBufferWriter=a}).apply(null,r))||(e.exports=i)},MzcX:function(e,t,n){var r,i;r=[n.dj.c(e.i),t,n("zOht")],void 0===(i=(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.glLayout=void 0;var r={divisor:0};t.glLayout=function(e,t){void 0===t&&(t={}),t=n.__assign(n.__assign({},r),t);var a=e.stride;return e.fieldNames.filter((function(t){var n=e.fields.get(t).optional;return!(n&&n.glPadding)})).map((function(n){var r=e.fields.get(n),o=r.constructor.ElementCount,s=function(e){var t=i[e];if(t)return t;throw new Error("BufferType not supported in WebGL")}(r.constructor.ElementType);return{name:n,stride:a,count:o,type:s,offset:r.offset,normalized:!(!r.optional||!r.optional.glNormalized),divisor:t.divisor}}))};var i={u8:5121,u16:5123,u32:5125,i8:5120,i16:5122,i32:5124,f32:5126}}).apply(null,r))||(e.exports=i)},NiJV:function(e,t,n){var r,i;r=[n.dj.c(e.i),t,n("zOht"),n("fese"),n("3kdR"),n("7Aei"),n("aExC")],void 0===(i=(function(e,t,n,r,i,a,o){"use strict";var s,l;Object.defineProperty(t,"__esModule",{value:!0}),t.build=void 0,t.build=function(e){var t=new o.ShaderBuilder;return t.include(i.Transform,{linearDepth:!1}),t.vertex.uniforms.add("proj","mat4").add("view","mat4").add("viewNormal","mat4"),t.fragment.uniforms.add("color","vec4").add("shadedColor","vec4").add("shadingDirection","vec3"),t.attributes.add("position","vec3"),t.attributes.add("normal","vec3"),t.varyings.add("vWorldPosition","vec3"),t.varyings.add("vViewNormal","vec3"),t.varyings.add("vViewDirection","vec3"),t.vertex.code.add(a.glsl(s||(s=n.__makeTemplateObject(["\n    void main(void) {\n      vWorldPosition = position;\n\n      vec3 worldNormal = normal;\n      vViewNormal = (viewNormal * vec4(worldNormal, 1)).xyz;\n\n      gl_Position = transformPosition(proj, view, vWorldPosition);\n    }\n  "],["\n    void main(void) {\n      vWorldPosition = position;\n\n      vec3 worldNormal = normal;\n      vViewNormal = (viewNormal * vec4(worldNormal, 1)).xyz;\n\n      gl_Position = transformPosition(proj, view, vWorldPosition);\n    }\n  "])))),t.include(r.Slice,e),t.fragment.code.add(a.glsl(l||(l=n.__makeTemplateObject(["\n    void main() {\n      discardBySlice(vWorldPosition);\n\n      vec3 viewNormalNorm = normalize(vViewNormal);\n\n      float shadingFactor = 1.0 - clamp(-dot(viewNormalNorm, shadingDirection), 0.0, 1.0);\n      vec4 colorWithShading = mix(color, shadedColor, shadingFactor);\n\n      gl_FragColor = highlightSlice(colorWithShading, vWorldPosition);\n    }\n    "],["\n    void main() {\n      discardBySlice(vWorldPosition);\n\n      vec3 viewNormalNorm = normalize(vViewNormal);\n\n      float shadingFactor = 1.0 - clamp(-dot(viewNormalNorm, shadingDirection), 0.0, 1.0);\n      vec4 colorWithShading = mix(color, shadedColor, shadingFactor);\n\n      gl_FragColor = highlightSlice(colorWithShading, vWorldPosition);\n    }\n    "])))),t}}).apply(null,r))||(e.exports=i)},RC9r:function(e,t,n){var r,i;r=[n.dj.c(e.i),t,n("zOht"),n("qsST"),n("xoE+"),n("LxLY"),n("jBNx"),n("W9tT"),n("0LE5"),n("Rdxj"),n("aWgr"),n("2B1V"),n("+nCE"),n("tUyH"),n("FNtW"),n("CIy2"),n("ama6"),n("s6rJ"),n("PwS/"),n("SNs2"),n("SNs2")],void 0===(i=(function(e,t,n,r,i,a,o,s,l,c,p,u,d,h,f,v,m,g,y,b,_){"use strict";var x=r.getLogger("esri.views.3d.webgl-engine.materials.RibbonLineMaterial"),P=function(e){function t(t,n){var r=e.call(this,n)||this;return r._vertexAttributeLocations=_.ribbonVertexAttributeLocations,r.techniqueConfig=new _.RibbonLineTechniqueConfiguration,r.params=g.copyParameters(t,O),r.validateParams(),r.params.transparent=r.params.color[3]<1||r.params.transparent,r.layout=r.createLayout(),r}return n.__extends(t,e),t.prototype.isClosed=function(e,t){return D(this.params,e,t)},t.prototype.dispose=function(){},t.prototype.setParameterValues=function(e){for(var t in e)if("cap"!==t){if("join"===t&&"round"===this.params[t]!=("round"===e[t])){x.error("join cannot be changed after creation");continue}if("stipplePattern"===t&&!!this.params[t]!=!!e[t]){x.error("stippledness cannot be changed after creation");continue}this.params[t]=e[t]}else x.error("cap cannot be changed after creation");this.validateParams(),this.parametersChanged()},t.prototype.getParameters=function(){return this.params},t.prototype.getPassParameters=function(){return this.params},t.prototype.getTechniqueConfig=function(e){this.techniqueConfig.output=e;var t=a.isSome(this.params.stipplePattern);return this.techniqueConfig.stippleEnabled=t,this.techniqueConfig.stippleIntegerRepeatsEnabled=t&&this.params.stippleIntegerRepeats,this.techniqueConfig.stippleOffColorEnabled=t&&a.isSome(this.params.stippleOffColor),this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled,this.techniqueConfig.sceneHasOcludees=this.params.sceneHasOcludees,this.techniqueConfig.roundJoins="round"===this.params.join,this.techniqueConfig.roundCaps="round"===this.params.cap,this.techniqueConfig.transparent=this.params.transparent,this.techniqueConfig.polygonOffset=this.params.polygonOffset,this.techniqueConfig.writeDepth=this.params.writeDepth,this.techniqueConfig.vvColor=this.params.vvColorEnabled,this.techniqueConfig.vvOpacity=this.params.vvOpacityEnabled,this.techniqueConfig.vvSize=this.params.vvSizeEnabled,this.techniqueConfig.innerColorEnabled=this.params.innerWidth>0&&a.isSome(this.params.innerColor),this.techniqueConfig.falloffEnabled=this.params.falloff>0,this.techniqueConfig.occluder=8===this.renderOccluded,this.techniqueConfig},t.prototype.intersect=function(e,t,n,r,i,a,o,s,l){l?this.intersectDrapedLineGeometry(e,r,a,o):this.intersectLineGeometry(e,t,n,r,this.params.width,o)},t.prototype.intersectDrapedLineGeometry=function(e,t,n,r){if(t.options.selectionMode){var a=e.getAttribute(_.RibbonVertexAttributeConstants.POSITION).data,o=e.getAttribute(_.RibbonVertexAttributeConstants.SIZE),s=this.params.width;if(this.params.vvSizeEnabled){var l=e.getAttribute(_.RibbonVertexAttributeConstants.SIZEFEATUREATTRIBUTE).data[0];s*=i.clamp(this.params.vvSizeOffset[0]+l*this.params.vvSizeFactor[0],this.params.vvSizeMinSize[0],this.params.vvSizeMaxSize[0])}else o&&(s*=o.data[0]);for(var c=n[0],p=n[1],u=(s/2+4)*e.screenToWorldRatio,d=Number.MAX_VALUE,h=0;h<a.length-5;h+=3){var f=a[h],v=a[h+1],m=c-f,g=p-v,y=a[h+3]-f,b=a[h+4]-v,x=i.clamp((y*m+b*g)/(y*y+b*b),0,1),P=y*x-m,S=b*x-g,O=P*P+S*S;O<d&&(d=O)}d<u*u&&r()}},t.prototype.intersectLineGeometry=function(e,t,n,r,a,o){if(r.options.selectionMode&&!y.isInstanceHidden(t))if(v.isTranslationMatrix(n)){var c=e.data,u=c.getVertexAttr(),d=u[_.RibbonVertexAttributeConstants.POSITION].data,h=a;this.params.vvSizeEnabled?h*=i.clamp(this.params.vvSizeOffset[0]+u[_.RibbonVertexAttributeConstants.SIZEFEATUREATTRIBUTE].data[0]*this.params.vvSizeFactor[0],this.params.vvSizeMinSize[0],this.params.vvSizeMaxSize[0]):u[_.RibbonVertexAttributeConstants.SIZE]&&(h*=u[_.RibbonVertexAttributeConstants.SIZE].data[0]);var f=r.camera,m=E;s.vec2.copy(m,r.point);var g=h*f.pixelRatio/2+4*f.pixelRatio;l.vec3.set(k[0],m[0]-g,m[1]+g,0),l.vec3.set(k[1],m[0]+g,m[1]+g,0),l.vec3.set(k[2],m[0]+g,m[1]-g,0),l.vec3.set(k[3],m[0]-g,m[1]-g,0);for(var b=0;b<4;b++)f.unprojectPoint(k[b],H[b]);p.plane.fromPoints(f.eye,H[0],H[1],X),p.plane.fromPoints(f.eye,H[1],H[2],Y),p.plane.fromPoints(f.eye,H[2],H[3],Z),p.plane.fromPoints(f.eye,H[3],H[0],J);var P=Number.MAX_VALUE,S=A(this.params,u,c.indices)?d.length-2:d.length-5;for(b=0;b<S;b+=3){R[0]=d[b]+n[12],R[1]=d[b+1]+n[13],R[2]=d[b+2]+n[14];var O=(b+3)%d.length;if(T[0]=d[O]+n[12],T[1]=d[O+1]+n[13],T[2]=d[O+2]+n[14],!(p.plane.signedDistance(X,R)<0&&p.plane.signedDistance(X,T)<0||p.plane.signedDistance(Y,R)<0&&p.plane.signedDistance(Y,T)<0||p.plane.signedDistance(Z,R)<0&&p.plane.signedDistance(Z,T)<0||p.plane.signedDistance(J,R)<0&&p.plane.signedDistance(J,T)<0)){if(f.projectPoint(R,I),f.projectPoint(T,z),I[2]<0&&z[2]>0){l.vec3.subtract(L,R,T);var w=f.frustum,C=-p.plane.signedDistance(w.planes[4],R)/l.vec3.dot(L,p.plane.normal(w.planes[4]));l.vec3.scale(L,L,C),l.vec3.add(R,R,L),f.projectPoint(R,I)}else if(I[2]>0&&z[2]<0)l.vec3.subtract(L,T,R),C=-p.plane.signedDistance((w=f.frustum).planes[4],T)/l.vec3.dot(L,p.plane.normal(w.planes[4])),l.vec3.scale(L,L,C),l.vec3.add(T,T,L),f.projectPoint(T,z);else if(I[2]<0&&z[2]<0)continue;I[2]=0,z[2]=0;var D=p.lineSegment.distance2(p.lineSegment.fromPoints(I,z,U),m);D<P&&(P=D,l.vec3.copy(N,R),l.vec3.copy(F,T))}}var V=r.rayBeginPoint,j=r.rayEndPoint;if(P<g*g){var W=Number.MAX_VALUE;if(p.lineSegment.closestLineSegmentPoint(p.lineSegment.fromPoints(N,F,U),p.lineSegment.fromPoints(V,j,q),M)){l.vec3.subtract(M,M,V);var B=l.vec3.length(M);l.vec3.scale(M,M,1/B),W=B/l.vec3.distance(V,j)}o(W,M)}}else x.error("intersection assumes a translation-only matrix")},t.prototype.computeAttachmentOrigin=function(e,t){var n=e.data,r="getVertexAttr"in n?n.getVertexAttr():"vertexAttr"in n?n.vertexAttr:null;if(!r)return null;var i=_.RibbonVertexAttributeConstants.POSITION,a="getVertexAttr"in n?n.indices:null;return d.computeAttachmentOriginLines(r[i],a?a[i]:null,a&&A(this.params,r,a),t)},t.prototype.createLayout=function(){var e=u.newLayout().vec3f(_.RibbonVertexAttributeConstants.POSITION).f32(_.RibbonVertexAttributeConstants.SUBDIVISIONFACTOR).vec2f(_.RibbonVertexAttributeConstants.UV0).vec3f(_.RibbonVertexAttributeConstants.AUXPOS1).vec3f(_.RibbonVertexAttributeConstants.AUXPOS2);return e.f32(this.params.vvSizeEnabled?_.RibbonVertexAttributeConstants.SIZEFEATUREATTRIBUTE:_.RibbonVertexAttributeConstants.SIZE),this.params.vvColorEnabled?e.f32(_.RibbonVertexAttributeConstants.COLORFEATUREATTRIBUTE):e.vec4f(_.RibbonVertexAttributeConstants.COLOR),this.params.vvOpacityEnabled&&e.f32(_.RibbonVertexAttributeConstants.OPACITYFEATUREATTRIBUTE),e},t.prototype.createBufferWriter=function(){return new w(this.layout,this.params)},t.prototype.getGLMaterial=function(e){return 0===e.output||4===e.output?new S(e):void 0},t.prototype.validateParams=function(){"miter"!==this.params.join&&(this.params.miterLimit=0)},t}(f.Material),S=function(e){function t(t){var n=e.call(this,t)||this;return n.updateParameters(),n}return n.__extends(t,e),t.prototype.updateParameters=function(){this.technique=this.techniqueRep.acquireAndReleaseExisting(b.RibbonLineTechnique,this.material.getTechniqueConfig(this.output),this.technique)},t.prototype.beginSlot=function(e){return this.technique.configuration.occluder?3===e||10===e||11===e:0===this.output?(this.targetSlot=this.technique.configuration.writeDepth?5:8,e===this.targetSlot):3===e},t.prototype._updateOccludeeState=function(e){e.hasOccludees!==this.material.getParameters().sceneHasOcludees&&(this.material.setParameterValues({sceneHasOcludees:e.hasOccludees}),this.updateParameters())},t.prototype.ensureParameters=function(e){0===this.output&&this._updateOccludeeState(e)},t.prototype.bind=function(e,t){e.bindProgram(this.technique.program),this.technique.bindPass(e,this.material.getPassParameters(),t)},t.prototype.getPipelineState=function(e,t){return t?this.technique.occludeePipeline:this.technique.configuration.occluder?11===e?this.technique.occluderPipelineTransparent:10===e?this.technique.occluderPipelineOpaque:this.technique.occluderPipelineMaskWrite:this.technique.pipeline},t}(h.GLMaterial),O=n.__assign({width:0,color:[1,1,1,1],join:"miter",cap:"butt",miterLimit:5,writeDepth:!0,polygonOffset:!1,stipplePattern:null,stippleIntegerRepeats:!1,stippleOffColor:null,slicePlaneEnabled:!1,vvFastUpdate:!1,transparent:!1,isClosed:!1,falloff:0,innerWidth:0,innerColor:null,sceneHasOcludees:!1},m.Default),w=function(){function e(e,t){switch(this.params=t,this.numJoinSubdivisions=0,this.vertexBufferLayout=e,this.params.join){case"miter":case"bevel":this.numJoinSubdivisions=t.stipplePattern?1:0;break;case"round":this.numJoinSubdivisions=j}}return e.prototype.isClosed=function(e){return A(this.params,e.vertexAttr,e.indices)},e.prototype.numCapSubdivisions=function(e){if(this.isClosed(e))return 0;switch(this.params.cap){case"butt":return 0;case"square":return 1;case"round":return V}},e.prototype.allocate=function(e){return this.vertexBufferLayout.createBuffer(e)},e.prototype.elementCount=function(e){var t=2*this.numCapSubdivisions(e)+2,n=e.indices[_.RibbonVertexAttributeConstants.POSITION].length/2+1,r=this.isClosed(e),i=r?2:2*t,a=r?0:1,o=r?n:n-1;if(e.vertexAttr[_.RibbonVertexAttributeConstants.SUBDIVISIONS])for(var s=e.vertexAttr[_.RibbonVertexAttributeConstants.SUBDIVISIONS].data,l=a;l<o;++l)i+=4+2*s[l];else i+=(o-a)*(2*this.numJoinSubdivisions+4);return i+2},e.prototype.write=function(e,t,n,r){var i=this,a=W,o=B,s=G,c=t.vertexAttr[_.RibbonVertexAttributeConstants.POSITION].data,p=t.indices&&t.indices[_.RibbonVertexAttributeConstants.POSITION],u=this.numCapSubdivisions(t);p&&p.length!==2*(c.length/3-1)&&console.warn("RibbonLineMaterial does not support indices");var d=null;t.vertexAttr[_.RibbonVertexAttributeConstants.SUBDIVISIONS]&&(d=t.vertexAttr[_.RibbonVertexAttributeConstants.SUBDIVISIONS].data);var h=1,f=0;this.params.vvSizeEnabled?f=t.vertexAttr[_.RibbonVertexAttributeConstants.SIZEFEATUREATTRIBUTE].data[0]:t.vertexAttr[_.RibbonVertexAttributeConstants.SIZE]&&(h=t.vertexAttr[_.RibbonVertexAttributeConstants.SIZE].data[0]);var v=[1,1,1,1],m=0;this.params.vvColorEnabled?m=t.vertexAttr[_.RibbonVertexAttributeConstants.COLORFEATUREATTRIBUTE].data[0]:t.vertexAttr[_.RibbonVertexAttributeConstants.COLOR]&&(v=t.vertexAttr[_.RibbonVertexAttributeConstants.COLOR].data);var g=0;this.params.vvOpacityEnabled&&(g=t.vertexAttr[_.RibbonVertexAttributeConstants.OPACITYFEATUREATTRIBUTE].data[0]);var y=c.length/3,b=e.transformation,x=new Float32Array(n.buffer),P=this.vertexBufferLayout.stride/4,S=r*P,O=S,w=function(e,t,n,r,a,o){x[S++]=t[0],x[S++]=t[1],x[S++]=t[2],x[S++]=r,x[S++]=a,x[S++]=o,x[S++]=e[0],x[S++]=e[1],x[S++]=e[2],x[S++]=n[0],x[S++]=n[1],x[S++]=n[2],x[S++]=i.params.vvSizeEnabled?f:h,i.params.vvColorEnabled?x[S++]=m:(x[S++]=v[0],x[S++]=v[1],x[S++]=v[2],x[S++]=v[3]),i.params.vvOpacityEnabled&&(x[S++]=g)};S+=P,l.vec3.set(o,c[0],c[1],c[2]),b&&l.vec3.transformMat4(o,o,b);var A=this.isClosed(t);if(A){var D=c.length-3;l.vec3.set(a,c[D],c[D+1],c[D+2]),b&&l.vec3.transformMat4(a,a,b)}else{l.vec3.copy(a,o),l.vec3.set(s,c[3],c[4],c[5]),b&&l.vec3.transformMat4(s,s,b);for(var V=0;V<u;++V)w(a,o,s,M=1-V/u,1,-4),w(a,o,s,M,1,4);w(a,o,s,0,0,-4),w(a,o,s,0,0,4),l.vec3.copy(a,o),l.vec3.copy(o,s)}var j=A?y:y-1;for(V=A?0:1;V<j;V++){var R=(V+1)%y*3;l.vec3.set(s,c[R+0],c[R+1],c[R+2]),b&&l.vec3.transformMat4(s,s,b),w(a,o,s,0,1,-1),w(a,o,s,0,1,1);for(var T=d?d[V]:this.numJoinSubdivisions,L=0;L<T;++L)w(a,o,s,M=(L+1)/(T+1),1,-2),w(a,o,s,M,1,2);w(a,o,s,1,0,-2),w(a,o,s,1,0,2),l.vec3.copy(a,o),l.vec3.copy(o,s)}if(A)S=C(x,O+P,x,S,2*P);else for(w(a,o,s,0,1,-5),w(a,o,s,0,1,5),V=0;V<u;++V){var M;w(a,o,s,M=(V+1)/u,1,-5),w(a,o,s,M,1,5)}C(x,O+P,x,O,P),S=C(x,S-P,x,S,P)},e}();function C(e,t,n,r,i){for(var a=0;a<i;a++)n[r++]=e[t++];return r}function A(e,t,n){return D(e,t[_.RibbonVertexAttributeConstants.POSITION].data,n?n[_.RibbonVertexAttributeConstants.POSITION]:null)}function D(e,t,n){return!!e.isClosed&&(n?n.length>2:t.length>6)}var V=3,j=1,R=c.vec3f64.create(),T=c.vec3f64.create(),L=c.vec3f64.create(),M=c.vec3f64.create(),E=c.vec3f64.create(),I=o.createRenderScreenPointArray3(),z=o.createRenderScreenPointArray3(),N=c.vec3f64.create(),F=c.vec3f64.create(),U=p.lineSegment.create(),q=p.lineSegment.create(),W=c.vec3f64.create(),B=c.vec3f64.create(),G=c.vec3f64.create(),k=[o.createRenderScreenPointArray3(),o.createRenderScreenPointArray3(),o.createRenderScreenPointArray3(),o.createRenderScreenPointArray3()],H=[c.vec3f64.create(),c.vec3f64.create(),c.vec3f64.create(),c.vec3f64.create()],X=p.plane.create(),Y=p.plane.create(),Z=p.plane.create(),J=p.plane.create();return P}).apply(null,r))||(e.exports=i)},RsYQ:function(e,t,n){var r,i;r=[n.dj.c(e.i),t,n("xoE+"),n("jBNx"),n("FXVB"),n("1m5D"),n("W9tT"),n("DIqE"),n("0LE5"),n("Rdxj"),n("2fXB"),n("O7NG"),n("aWgr"),n("AzkI"),n("18xY"),n("CIy2")],void 0===(i=(function(e,t,n,r,i,a,o,s,l,c,p,u,d,h,f,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(){function e(e,t,n){void 0===e&&(e=c.vec3f64.create()),void 0===t&&(t=c.vec3f64.create()),void 0===n&&(n=c.vec3f64.fromValues(0,0,1)),this._viewUp=c.vec3f64.create(),this._viewForward=c.vec3f64.create(),this._viewRight=c.vec3f64.create(),this._ray=d.ray.createWrapper(),this._viewport=u.vec4f64.fromValues(0,0,1,1),this._padding=u.vec4f64.fromValues(0,0,0,0),this._fov=55/180*Math.PI,this._nearFar=s.vec2f64.fromValues(1,1e3),this._viewDirty=!0,this._viewMatrix=a.mat4f64.create(),this._projectionDirty=!0,this._projectionMatrix=a.mat4f64.create(),this._viewProjectionDirty=!0,this._viewProjectionMatrix=a.mat4f64.create(),this._viewInverseTransposeMatrixDirty=!0,this._viewInverseTransposeMatrix=a.mat4f64.create(),this._frustumDirty=!0,this._frustum=d.frustum.create(),this._fullViewport=null,this.pixelRatio=1,this.relativeElevation=0,this._eye=c.vec3f64.clone(e),this._center=c.vec3f64.clone(t),this._up=c.vec3f64.clone(n),this._padding=u.vec4f64.create()}return Object.defineProperty(e.prototype,"eye",{get:function(){return this._eye},set:function(e){this._compareAndSetView(e,this._eye)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"center",{get:function(){return this._center},set:function(e){this._compareAndSetView(e,this._center)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ray",{get:function(){return this._ray.origin=this.eye,this._ray.direction||(this._ray.direction=c.vec3f64.create()),l.vec3.subtract(this._ray.direction,this.center,this.eye),this._ray},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"up",{get:function(){return this._up},set:function(e){this._compareAndSetView(e,this._up)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewMatrix",{get:function(){return this._ensureViewClean(),this._viewMatrix},set:function(e){i.mat4.copy(this._viewMatrix,e),this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewForward",{get:function(){return this._ensureViewClean(),this._viewForward},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewUp",{get:function(){return this._ensureViewClean(),this._viewUp},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewRight",{get:function(){return this._ensureViewClean(),this._viewRight},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nearFar",{get:function(){return this._nearFar},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"near",{get:function(){return this._nearFar[0]},set:function(e){this._nearFar[0]!==e&&(this._nearFar[0]=e,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"far",{get:function(){return this._nearFar[1]},set:function(e){this._nearFar[1]!==e&&(this._nearFar[1]=e,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewport",{get:function(){return this._viewport},set:function(e){this.x=e[0],this.y=e[1],this.width=e[2],this.height=e[3]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this._viewport[0]},set:function(e){this._viewport[0]!==(e+=this._padding[3])&&(this._viewport[0]=e,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._viewport[1]},set:function(e){this._viewport[1]!==(e+=this._padding[2])&&(this._viewport[1]=e,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._viewport[2]},set:function(e){this._viewport[2]!==e&&(this._viewport[2]=e,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._viewport[3]},set:function(e){this._viewport[3]!==e&&(this._viewport[3]=e,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fullWidth",{get:function(){return this._viewport[2]+this._padding[1]+this._padding[3]},set:function(e){this.width=e-(this._padding[1]+this._padding[3])},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fullHeight",{get:function(){return this._viewport[3]+this._padding[0]+this._padding[2]},set:function(e){this.height=e-(this._padding[0]+this._padding[2])},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fullViewport",{get:function(){return this._fullViewport||(this._fullViewport=u.vec4f64.create()),this._fullViewport[0]=this._viewport[0]-this._padding[3],this._fullViewport[1]=this._viewport[1]-this._padding[2],this._fullViewport[2]=this.fullWidth,this._fullViewport[3]=this.fullHeight,this._fullViewport},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"aspect",{get:function(){return this.width/this.height},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"padding",{get:function(){return this._padding},set:function(e){this._padding[0]===e[0]&&this._padding[1]===e[1]&&this._padding[2]===e[2]&&this._padding[3]===e[3]||(this._viewport[0]+=e[3]-this._padding[3],this._viewport[1]+=e[2]-this._padding[2],this._viewport[2]-=e[1]+e[3]-(this._padding[1]+this._padding[3]),this._viewport[3]-=e[0]+e[2]-(this._padding[0]+this._padding[2]),p.vec4.copy(this._padding,e),this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewProjectionMatrix",{get:function(){return this._viewProjectionDirty&&(i.mat4.multiply(this._viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),this._viewProjectionDirty=!1),this._viewProjectionMatrix},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"projectionMatrix",{get:function(){if(this._projectionDirty){var e=this.width,t=this.height,n=this.near*Math.tan(this.fovY/2),r=n*this.aspect;i.mat4.frustum(this._projectionMatrix,-r*(1+2*this._padding[3]/e),r*(1+2*this._padding[1]/e),-n*(1+2*this._padding[2]/t),n*(1+2*this._padding[0]/t),this.near,this.far),this._projectionDirty=!1}return this._projectionMatrix},set:function(e){i.mat4.copy(this._projectionMatrix,e),this._projectionDirty=!1,this._viewProjectionDirty=!0,this._frustumDirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fov",{get:function(){return this._fov},set:function(e){this._fov=e,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fovX",{get:function(){return v.fovd2fovx(this._fov,this.width,this.height)},set:function(e){this._fov=v.fovx2fovd(e,this.width,this.height),this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fovY",{get:function(){return v.fovd2fovy(this._fov,this.width,this.height)},set:function(e){this._fov=v.fovy2fovd(e,this.width,this.height),this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"distance",{get:function(){return l.vec3.distance(this._center,this._eye)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frustum",{get:function(){return this._recomputeFrustum(),this._frustum},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewInverseTransposeMatrix",{get:function(){return(this._viewInverseTransposeMatrixDirty||this._viewDirty)&&(this._viewInverseTransposeMatrix||(this._viewInverseTransposeMatrix=a.mat4f64.create()),i.mat4.invert(this._viewInverseTransposeMatrix,this.viewMatrix),i.mat4.transpose(this._viewInverseTransposeMatrix,this._viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=!1),this._viewInverseTransposeMatrix},enumerable:!1,configurable:!0}),e.prototype.depthNDCToWorld=function(e){return 2*this.near*this.far/(this.far+this.near-(2*e-1)*(this.far-this.near))},Object.defineProperty(e.prototype,"perRenderPixelRatio",{get:function(){return Math.tan(this.fovX/2)/(this.width/2)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"perScreenPixelRatio",{get:function(){return this.perRenderPixelRatio*this.pixelRatio},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"aboveGround",{get:function(){return this.relativeElevation&&this.relativeElevation>=0},enumerable:!1,configurable:!0}),e.prototype.copyFrom=function(e){var t=e;return l.vec3.copy(this._eye,t._eye),l.vec3.copy(this._center,t._center),l.vec3.copy(this._up,t._up),p.vec4.copy(this._viewport,t._viewport),p.vec4.copy(this._padding,t._padding),o.vec2.copy(this._nearFar,t._nearFar),this._fov=t._fov,this.relativeElevation=e.relativeElevation,this._viewDirty=t._viewDirty,this._viewDirty||(i.mat4.copy(this._viewMatrix,t._viewMatrix),l.vec3.copy(this._viewRight,t._viewRight),l.vec3.copy(this._viewUp,t._viewUp),l.vec3.copy(this._viewForward,t._viewForward)),t._projectionDirty?this._projectionDirty=!0:(i.mat4.copy(this._projectionMatrix,t._projectionMatrix),this._projectionDirty=!1),this._viewProjectionDirty=!0,this._frustumDirty=t._frustumDirty,this._frustumDirty||(d.frustum.copy(t._frustum,this._frustum),this._frustumDirty=!1),t._viewInverseTransposeMatrixDirty?this._viewInverseTransposeMatrixDirty=!0:(this._viewInverseTransposeMatrix?i.mat4.copy(this._viewInverseTransposeMatrix,t._viewInverseTransposeMatrix):this._viewInverseTransposeMatrix=a.mat4f64.clone(t._viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=!1),t._fullViewport?this._fullViewport?p.vec4.copy(this._fullViewport,t._fullViewport):this._fullViewport=u.vec4f64.clone(t._fullViewport):this._fullViewport=null,this.pixelRatio=e.pixelRatio,this},e.prototype.copyViewFrom=function(e){this.eye=e.eye,this.center=e.center,this.up=e.up},e.prototype.clone=function(){var t=new e;return t.copyFrom(this),t},e.prototype.equals=function(e){return l.vec3.exactEquals(this._eye,e._eye)&&l.vec3.exactEquals(this._center,e._center)&&l.vec3.exactEquals(this._up,e._up)&&p.vec4.exactEquals(this._viewport,e._viewport)&&p.vec4.exactEquals(this._padding,e._padding)&&o.vec2.exactEquals(this._nearFar,e._nearFar)&&this._fov===e._fov&&this.pixelRatio===e.pixelRatio&&this.relativeElevation===e.relativeElevation},e.prototype.almostEquals=function(e){if(this.pixelRatio!==e.pixelRatio||Math.abs(e._fov-this._fov)>=.001)return!1;l.vec3.sub(b,e._eye,e._center),l.vec3.sub(_,this._eye,this._center);var t=l.vec3.dot(b,_),n=l.vec3.sqrLen(b),r=l.vec3.sqrLen(_);return t*t>=(1-1e-10)*n*r&&l.vec3.sqrDist(e._eye,this._eye)<5e-4*Math.max(n,r)*5e-4&&p.vec4.squaredDistance(e._padding,this._padding)<.5&&p.vec4.squaredDistance(e._viewport,this._viewport)<.5},e.prototype.markViewDirty=function(){this._viewDirty=!0,this._frustumDirty=!0,this._viewProjectionDirty=!0},e.prototype.computeRenderPixelSizeAt=function(e){return this.computeRenderPixelSizeAtDist(this.viewDirectionDistance(e))},e.prototype.computeRenderPixelSizeAtDist=function(e){return e*this.perRenderPixelRatio},e.prototype.computeScreenPixelSizeAt=function(e){return this.computeScreenPixelSizeAtDist(this.viewDirectionDistance(e))},e.prototype.viewDirectionDistance=function(e){return Math.abs(f.projectPointSignedLength(this.viewForward,l.vec3.subtract(b,e,this._eye)))},e.prototype.computeScreenPixelSizeAtDist=function(e){return e*this.perScreenPixelRatio},e.prototype.computeDistanceFromRadius=function(e,t){return e/Math.tan(Math.min(this.fovX,this.fovY)/(2*(t||1)))},e.prototype.getScreenCenter=function(e){return void 0===e&&(e=r.createScreenPointArray()),e[0]=(this.padding[3]+this.width/2)/this.pixelRatio,e[1]=(this.padding[0]+this.height/2)/this.pixelRatio,e},e.prototype.getRenderCenter=function(e,t,n){return void 0===t&&(t=.5),void 0===n&&(n=.5),e||(e=r.createRenderScreenPointArray3()),e[0]=this.padding[3]+this.width*t,e[1]=this.padding[2]+this.height*n,e.length>2&&(e[2]=.5),e},e.prototype.setGLViewport=function(e){var t=this.viewport,n=this.padding;e.setViewport(t[0]-n[3],t[1]-n[2],t[2]+n[1]+n[3],t[3]+n[0]+n[2])},e.prototype.applyProjection=function(e,t,r){void 0===r&&(r=!1),e!==g&&l.vec3.copy(g,e),g[3]=1,r&&(t[2]=-g[2]),p.vec4.transformMat4(g,g,this.projectionMatrix),l.vec3.scale(g,g,1/Math.abs(g[3]));var i=this.fullViewport;return t[0]=n.lerp(0,i[0]+i[2],.5+.5*g[0]),t[1]=n.lerp(0,i[1]+i[3],.5+.5*g[1]),r||(t[2]=.5*(g[2]+1)),t},e.prototype.projectPoint=function(e,t){if(g[0]=e[0],g[1]=e[1],g[2]=e[2],g[3]=1,p.vec4.transformMat4(g,g,this.viewProjectionMatrix),0===g[3])return null;l.vec3.scale(g,g,1/Math.abs(g[3]));var r=this.fullViewport;return"x"in t?(t.x=n.lerp(0,r[0]+r[2],.5+.5*g[0]),t.y=n.lerp(0,r[1]+r[3],.5+.5*g[1])):(t[0]=n.lerp(0,r[0]+r[2],.5+.5*g[0]),t[1]=n.lerp(0,r[1]+r[3],.5+.5*g[1]),t.length>2&&(t[2]=.5*(g[2]+1))),t},e.prototype.unprojectPoint=function(e,t){if(i.mat4.multiply(y,this.projectionMatrix,this.viewMatrix),!i.mat4.invert(y,y))return null;var n=this.fullViewport;return g[0]=2*(e[0]-n[0])/n[2]-1,g[1]=2*(e[1]-n[1])/n[3]-1,g[2]=2*e[2]-1,g[3]=1,p.vec4.transformMat4(g,g,y),0===g[3]?null:(t[0]=g[0]/g[3],t[1]=g[1]/g[3],t[2]=g[2]/g[3],t)},e.prototype.computeUp=function(e){1===e?this.computeUpGlobal():this.computeUpLocal()},e.prototype.screenToRender=function(e,t){var n=this.fullHeight-e[1]*this.pixelRatio;return t[0]=e[0]*this.pixelRatio,t[1]=n,t},e.prototype.renderToScreen=function(e,t){var n=(this.fullHeight-e[1])/this.pixelRatio;return t[0]=e[0]/this.pixelRatio,t[1]=n,t},e.prototype.computeUpGlobal=function(){l.vec3.subtract(b,this.center,this.eye);var e=l.vec3.length(this.center);e<1?(l.vec3.set(this.up,0,0,1),this.markViewDirty()):Math.abs(l.vec3.dot(b,this.center))>.9999*l.vec3.length(b)*e||(l.vec3.cross(this.up,b,this.center),l.vec3.cross(this.up,this.up,b),l.vec3.normalize(this.up,this.up),this.markViewDirty())},e.prototype.computeUpLocal=function(){h.directionFromTo(b,this.eye,this.center),Math.abs(b[2])<=.9999&&(l.vec3.scale(b,b,b[2]),l.vec3.set(this.up,-b[0],-b[1],1-b[2]),l.vec3.normalize(this.up,this.up),this.markViewDirty())},e.prototype._compareAndSetView=function(e,t){l.vec3.exactEquals(e,t)||(l.vec3.copy(t,e),this._viewDirty=!0,this._frustumDirty=!0,this._viewProjectionDirty=!0)},e.prototype._recomputeFrustum=function(){this._frustumDirty&&(d.frustum.fromMatrix(this.viewMatrix,this.projectionMatrix,this._frustum),this._frustumDirty=!1)},e.prototype._ensureViewClean=function(){this._viewDirty&&(i.mat4.lookAt(this._viewMatrix,this._eye,this._center,this._up),l.vec3.set(this._viewForward,-this._viewMatrix[2],-this._viewMatrix[6],-this._viewMatrix[10]),l.vec3.set(this._viewUp,this._viewMatrix[1],this._viewMatrix[5],this._viewMatrix[9]),l.vec3.set(this._viewRight,this._viewMatrix[0],this._viewMatrix[4],this._viewMatrix[8]),this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0)},e}();t.default=m;var g=u.vec4f64.create(),y=a.mat4f64.create(),b=c.vec3f64.create(),_=c.vec3f64.create()}).apply(null,r))||(e.exports=i)},SNs2:function(e,t,n){var r,i;r=[n.dj.c(e.i),t,n("zOht"),n("LxLY"),n("LxLY"),n("fese"),n("PaEL"),n("3PFg"),n("2NOe"),n("W/V4"),n("FQ4r"),n("lBa0"),n("lfQW"),n("ne9J"),n("G0ER"),n("qbr3"),n("2Kdy")],void 0===(i=(function(e,t,r,i,a,o,s,l,c,p,u,d,h,f,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RibbonLineTechniqueConfiguration=t.RibbonLineTechnique=t.ribbonVertexAttributeLocations=t.RibbonVertexAttributeConstants=void 0,t.RibbonVertexAttributeConstants={POSITION:"position",SUBDIVISIONFACTOR:"subdivisionFactor",UV0:"uv0",AUXPOS1:"auxpos1",AUXPOS2:"auxpos2",SUBDIVISIONS:"subdivisions",COLOR:"color",COLORFEATUREATTRIBUTE:"colorFeatureAttribute",SIZE:"size",SIZEFEATUREATTRIBUTE:"sizeFeatureAttribute",OPACITYFEATUREATTRIBUTE:"opacityFeatureAttribute"},t.ribbonVertexAttributeLocations={position:0,subdivisionFactor:1,uv0:2,auxpos1:3,auxpos2:4,size:6,sizeFeatureAttribute:6,color:5,colorFeatureAttribute:5,opacityFeatureAttribute:7};var g=function(e){function u(t,n){var r=e.call(this,t,n)||this;return r.stipplePattern=null,r.stippleTextureBind=null,r.stippleTextureRepository=t.stippleTextureRepository,r}return r.__extends(u,e),u.prototype.initializeProgram=function(e){var n=u.shader.get(),r=this.configuration,i=n.build({output:r.output,slicePlaneEnabled:r.slicePlaneEnabled,sliceHighlightDisabled:r.sliceHighlightDisabled,sliceEnabledForVertexPrograms:!1,stippleEnabled:r.stippleEnabled,stippleOffColorEnabled:r.stippleOffColorEnabled,stippleUVMaxEnabled:r.stippleIntegerRepeatsEnabled,stippleIntegerRepeatsEnabled:r.stippleIntegerRepeatsEnabled,roundCaps:r.roundCaps,roundJoins:r.roundJoins,vvColor:r.vvColor,vvSize:r.vvSize,vvInstancingEnabled:!0,vvOpacity:r.vvOpacity,falloffEnabled:r.falloffEnabled,innerColorEnabled:r.innerColorEnabled});return new v(e.rctx,i.generateSource("vertex"),i.generateSource("fragment"),t.ribbonVertexAttributeLocations)},u.prototype.dispose=function(){e.prototype.dispose.call(this),this.stippleTextureRepository.release(this.stipplePattern),this.stipplePattern=null,this.stippleTextureBind=null},u.prototype.bindPass=function(e,t,n){if(c.View.bindProjectionMatrix(this.program,n.camera.projectionMatrix),4===this.configuration.output&&s.OutputHighlight.bindOutputHighlight(e,this.program,n),this.program.setUniform1f("intrinsicWidth",t.width),this.program.setUniform4fv("intrinsicColor",t.color),this.program.setUniform1f("miterLimit","miter"!==t.join?0:t.miterLimit),this.program.setUniform1f("nearPlane",n.camera.nearFar[0]),this.program.setUniform1f("pixelRatio",n.camera.pixelRatio),this.program.setUniform2f("screenSize",n.camera.fullViewport[2],n.camera.fullViewport[3]),l.VisualVariables.bindUniformsWithOpacity(this.program,t),this.stipplePattern!==t.stipplePattern){var r=t.stipplePattern;this.stippleTextureBind=this.stippleTextureRepository.swap(this.stipplePattern,r),this.stipplePattern=r}if(this.configuration.stippleEnabled){var o=a.isSome(this.stippleTextureBind)?this.stippleTextureBind(e,0)*n.camera.pixelRatio:1;if(this.program.setUniform1i("stipplePatternTexture",0),this.program.setUniform1f("stipplePatternPixelSizeInv",1/o),this.configuration.stippleOffColorEnabled){var p=i.unwrap(t.stippleOffColor);this.program.setUniform4f("stippleOffColor",p[0],p[1],p[2],p.length>3?p[3]:1)}}this.configuration.falloffEnabled&&this.program.setUniform1f("falloff",t.falloff),this.configuration.innerColorEnabled&&(this.program.setUniform4fv("innerColor",i.unwrapOr(t.innerColor,t.color)),this.program.setUniform1f("innerWidth",t.innerWidth*n.camera.pixelRatio))},u.prototype.bindDraw=function(e){c.View.bindView(this.program,e),o.Slice.bindUniformsWithOrigin(this.program,this.configuration,e)},u.prototype.initializePipeline=function(){var e=this.configuration,t=m.separateBlendingParams(770,1,771,771),n=e.polygonOffset&&y;if(e.occluder&&(this._occluderPipelineTransparent=m.makePipelineState({blending:t,polygonOffset:n,depthTest:h.depthCompareAlways,depthWrite:null,colorWrite:m.defaultColorWriteParams,stencilWrite:null,stencilTest:h.stencilToolTransparentOccluderParams}),this._occluderPipelineOpaque=m.makePipelineState({polygonOffset:n,depthTest:h.depthCompareAlways,depthWrite:null,colorWrite:m.defaultColorWriteParams,stencilWrite:h.stencilWriteMaskOff,stencilTest:h.stencilToolMaskOccluderParams}),this._occluderPipelineMaskWrite=m.makePipelineState({polygonOffset:n,depthTest:h.depthCompareLess,depthWrite:null,colorWrite:null,stencilWrite:h.stencilWriteMaskOn,stencilTest:h.stencilToolMaskBaseParams})),0===e.output){var r=function(r){return m.makePipelineState({blending:t,polygonOffset:n,depthTest:h.depthCompareLess,depthWrite:!e.transparent&&e.writeDepth&&m.defaultDepthWriteParams,colorWrite:m.defaultColorWriteParams,stencilWrite:e.sceneHasOcludees?h.stencilWriteMaskOn:null,stencilTest:e.sceneHasOcludees?r?h.stencilToolMaskBaseParams:h.stencilBaseAllZerosParams:null})};return this._occludeePipeline=r(!0),r(!1)}return m.makePipelineState({polygonOffset:n,depthTest:h.depthCompareLess,depthWrite:!e.transparent&&e.writeDepth&&m.defaultDepthWriteParams,colorWrite:m.defaultColorWriteParams})},Object.defineProperty(u.prototype,"occluderPipelineTransparent",{get:function(){return this._occluderPipelineTransparent},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"occluderPipelineOpaque",{get:function(){return this._occluderPipelineOpaque},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"occludeePipeline",{get:function(){return this._occludeePipeline},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"occluderPipelineMaskWrite",{get:function(){return this._occluderPipelineMaskWrite},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"primitiveType",{get:function(){return 5},enumerable:!1,configurable:!0}),u.shader=new p.ReloadableShaderModule(f,(function(){return new Promise((function(e,t){Promise.resolve().then((function(){var t=[n("ne9J")];e.apply(null,t)}).bind(this)).catch(t.bind(this))}))})),u}(u.ShaderTechnique);t.RibbonLineTechnique=g;var y={factor:0,units:-4},b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.output=0,t.occluder=!1,t.slicePlaneEnabled=!1,t.sliceHighlightDisabled=!1,t.vertexColors=!1,t.transparent=!1,t.polygonOffset=!1,t.writeDepth=!1,t.stippleEnabled=!1,t.stippleOffColorEnabled=!1,t.stippleIntegerRepeatsEnabled=!1,t.roundCaps=!1,t.roundJoins=!1,t.vvSize=!1,t.vvColor=!1,t.vvOpacity=!1,t.falloffEnabled=!1,t.innerColorEnabled=!1,t.sceneHasOcludees=!1,t}return r.__extends(t,e),r.__decorate([d.parameter({count:7})],t.prototype,"output",void 0),r.__decorate([d.parameter()],t.prototype,"occluder",void 0),r.__decorate([d.parameter()],t.prototype,"slicePlaneEnabled",void 0),r.__decorate([d.parameter()],t.prototype,"sliceHighlightDisabled",void 0),r.__decorate([d.parameter()],t.prototype,"vertexColors",void 0),r.__decorate([d.parameter()],t.prototype,"transparent",void 0),r.__decorate([d.parameter()],t.prototype,"polygonOffset",void 0),r.__decorate([d.parameter()],t.prototype,"writeDepth",void 0),r.__decorate([d.parameter()],t.prototype,"stippleEnabled",void 0),r.__decorate([d.parameter()],t.prototype,"stippleOffColorEnabled",void 0),r.__decorate([d.parameter()],t.prototype,"stippleIntegerRepeatsEnabled",void 0),r.__decorate([d.parameter()],t.prototype,"roundCaps",void 0),r.__decorate([d.parameter()],t.prototype,"roundJoins",void 0),r.__decorate([d.parameter()],t.prototype,"vvSize",void 0),r.__decorate([d.parameter()],t.prototype,"vvColor",void 0),r.__decorate([d.parameter()],t.prototype,"vvOpacity",void 0),r.__decorate([d.parameter()],t.prototype,"falloffEnabled",void 0),r.__decorate([d.parameter()],t.prototype,"innerColorEnabled",void 0),r.__decorate([d.parameter()],t.prototype,"sceneHasOcludees",void 0),t}(d.ShaderTechniqueConfiguration);t.RibbonLineTechniqueConfiguration=b}).apply(null,r))||(e.exports=i)},UGy0:function(e,t,n){var r,i;r=[n.dj.c(e.i),t,n("zOht"),n("hk44"),n("7Aei"),n("aExC")],void 0===(i=(function(e,t,n,r,i,a){"use strict";var o,s;Object.defineProperty(t,"__esModule",{value:!0}),t.build=void 0,t.build=function(e){var t=new a.ShaderBuilder;return t.include(r.Laserline,e),t.vertex.uniforms.add("uModelViewMatrix","mat4"),t.vertex.uniforms.add("uProjectionMatrix","mat4"),t.attributes.add("start","vec3"),t.attributes.add("end","vec3"),t.attributes.add("up","vec3"),t.attributes.add("extrude","vec2"),t.varyings.add("uv","vec2"),t.varyings.add("vViewStart","vec3"),t.varyings.add("vViewEnd","vec3"),t.varyings.add("vViewPlane","vec4"),t.vertex.uniforms.add("glowWidth","float"),t.vertex.uniforms.add("pixelToNDC","vec2"),t.vertex.code.add(i.glsl(o||(o=n.__makeTemplateObject(["\n  void main() {\n    vec3 pos = mix(start, end, extrude.x);\n\n    vec4 viewPos = uModelViewMatrix * vec4(pos, 1);\n    vec4 projPos = uProjectionMatrix * viewPos;\n    vec2 ndcPos = projPos.xy / projPos.w;\n\n    vec3 viewUp = (uModelViewMatrix * vec4(extrude.y * up, 0)).xyz;\n    vec4 projPosUp = uProjectionMatrix * vec4(viewPos.xyz + viewUp, 1);\n    vec2 projExtrudeDir = normalize(projPosUp.xy / projPosUp.w - ndcPos);\n\n    vec2 lxy = abs(sign(projExtrudeDir) - ndcPos);\n    ndcPos += length(lxy) * projExtrudeDir;\n\n    vec3 worldPlaneNormal = normalize(cross(up, normalize(end - start)));\n    vec3 viewPlaneNormal = (uModelViewMatrix * vec4(worldPlaneNormal, 0)).xyz;\n\n    vViewStart = (uModelViewMatrix * vec4(start, 1)).xyz;\n    vViewEnd = (uModelViewMatrix * vec4(end, 1)).xyz;\n    vViewPlane = vec4(viewPlaneNormal, -dot(viewPlaneNormal, vViewStart));\n\n    // Add enough padding in the X screen space direction for glow\n    float xPaddingPixels = sign(dot(viewPlaneNormal, viewPos.xyz)) * (extrude.x * 2.0 - 1.0) * glowWidth;\n    ndcPos.x += xPaddingPixels * pixelToNDC.x;\n\n    uv = ndcPos * 0.5 + 0.5;\n    gl_Position = vec4(ndcPos, 0, 1);\n  }\n  "],["\n  void main() {\n    vec3 pos = mix(start, end, extrude.x);\n\n    vec4 viewPos = uModelViewMatrix * vec4(pos, 1);\n    vec4 projPos = uProjectionMatrix * viewPos;\n    vec2 ndcPos = projPos.xy / projPos.w;\n\n    vec3 viewUp = (uModelViewMatrix * vec4(extrude.y * up, 0)).xyz;\n    vec4 projPosUp = uProjectionMatrix * vec4(viewPos.xyz + viewUp, 1);\n    vec2 projExtrudeDir = normalize(projPosUp.xy / projPosUp.w - ndcPos);\n\n    vec2 lxy = abs(sign(projExtrudeDir) - ndcPos);\n    ndcPos += length(lxy) * projExtrudeDir;\n\n    vec3 worldPlaneNormal = normalize(cross(up, normalize(end - start)));\n    vec3 viewPlaneNormal = (uModelViewMatrix * vec4(worldPlaneNormal, 0)).xyz;\n\n    vViewStart = (uModelViewMatrix * vec4(start, 1)).xyz;\n    vViewEnd = (uModelViewMatrix * vec4(end, 1)).xyz;\n    vViewPlane = vec4(viewPlaneNormal, -dot(viewPlaneNormal, vViewStart));\n\n    // Add enough padding in the X screen space direction for glow\n    float xPaddingPixels = sign(dot(viewPlaneNormal, viewPos.xyz)) * (extrude.x * 2.0 - 1.0) * glowWidth;\n    ndcPos.x += xPaddingPixels * pixelToNDC.x;\n\n    uv = ndcPos * 0.5 + 0.5;\n    gl_Position = vec4(ndcPos, 0, 1);\n  }\n  "])))),t.fragment.uniforms.add("globalAlpha","float"),t.fragment.uniforms.add("perScreenPixelRatio","float"),t.fragment.code.add(i.glsl(s||(s=n.__makeTemplateObject(["\n  float planeDistancePixels(vec4 plane, vec3 pos, vec3 start, vec3 end) {\n    vec3 origin = mix(start, end, 0.5);\n    vec3 basis = end - origin;\n    vec3 posAtOrigin = pos - origin;\n\n    float x = dot(normalize(basis), posAtOrigin);\n    float y = dot(plane.xyz, posAtOrigin);\n\n    float dx = max(abs(x) - length(basis), 0.0);\n    float dy = y;\n\n    float dist = length(vec2(dx, dy));\n\n    float width = fwidth(y);\n    float maxPixelDistance = length(pos) * perScreenPixelRatio * 2.0;\n    float pixelDist = dist / min(width, maxPixelDistance);\n    return abs(pixelDist);\n  }\n\n  void main() {\n    vec3 pos;\n    vec3 normal;\n    float depthDiscontinuityAlpha;\n\n    if (!laserlineReconstructFromDepth(pos, normal, depthDiscontinuityAlpha)) {\n      discard;\n    }\n\n    float distance = planeDistancePixels(vViewPlane, pos, vViewStart, vViewEnd);\n\n    vec4 color = laserlineProfile(distance);\n    float alpha = 1.0 - smoothstep(0.995, 0.999, abs(dot(normal, vViewPlane.xyz)));\n\n    gl_FragColor = laserlineOutput(color * alpha * depthDiscontinuityAlpha);\n  }\n  "],["\n  float planeDistancePixels(vec4 plane, vec3 pos, vec3 start, vec3 end) {\n    vec3 origin = mix(start, end, 0.5);\n    vec3 basis = end - origin;\n    vec3 posAtOrigin = pos - origin;\n\n    float x = dot(normalize(basis), posAtOrigin);\n    float y = dot(plane.xyz, posAtOrigin);\n\n    float dx = max(abs(x) - length(basis), 0.0);\n    float dy = y;\n\n    float dist = length(vec2(dx, dy));\n\n    float width = fwidth(y);\n    float maxPixelDistance = length(pos) * perScreenPixelRatio * 2.0;\n    float pixelDist = dist / min(width, maxPixelDistance);\n    return abs(pixelDist);\n  }\n\n  void main() {\n    vec3 pos;\n    vec3 normal;\n    float depthDiscontinuityAlpha;\n\n    if (!laserlineReconstructFromDepth(pos, normal, depthDiscontinuityAlpha)) {\n      discard;\n    }\n\n    float distance = planeDistancePixels(vViewPlane, pos, vViewStart, vViewEnd);\n\n    vec4 color = laserlineProfile(distance);\n    float alpha = 1.0 - smoothstep(0.995, 0.999, abs(dot(normal, vViewPlane.xyz)));\n\n    gl_FragColor = laserlineOutput(color * alpha * depthDiscontinuityAlpha);\n  }\n  "])))),t}}).apply(null,r))||(e.exports=i)},UidR:function(e,t,n){var r,i;r=[n.dj.c(e.i),t,n("TMur"),n("LxLY"),n("Rdxj"),n("mmEe")],void 0===(i=(function(e,t,n,r,i,a){"use strict";function o(e,t){return s[0]=e.x,s[1]=e.y,s[2]=e.hasZ?e.z:0,a.vectorToWGS84ComparableLonLat(s,e.spatialReference,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.pointToWGS84ComparableLonLatPoint=t.pointToWGS84ComparableLonLat=t.pointToVector=t.pointToPoint=t.vectorToDehydratedPoint=t.vectorToPoint=void 0,t.vectorToPoint=function(e,t,i,o){return o=r.isSome(o)?o:new n.Point({spatialReference:i}),a.bufferToBuffer(e,t,0,s,i,0,1)?(o.x=s[0],o.y=s[1],o.z=s[2],o.spatialReference=i,o):null},t.vectorToDehydratedPoint=function(e,t,n,i){return r.isNone(i)&&(i=n.spatialReference),a.bufferToBuffer(e,t,0,s,i,0,1)?(n.x=s[0],n.y=s[1],n.z=s[2],n.spatialReference=i,n):null},t.pointToPoint=function(e,t,n,r){void 0===n&&(n=t.spatialReference),void 0===r&&(r=0),s[0]=e.x,s[1]=e.y;var i=e.z;return s[2]=void 0!==i?i:r,!!a.bufferToBuffer(s,e.spatialReference,0,s,n,0,1)&&(t.x=s[0],t.y=s[1],t.spatialReference=n,void 0!==i?(t.z=s[2],t.hasZ=!0):(t.z=void 0,t.hasZ=!1),!0)},t.pointToVector=function(e,t,n,r){void 0===r&&(r=0),s[0]=e.x,s[1]=e.y;var i=e.z;return s[2]=void 0!==i?i:r,a.bufferToBuffer(s,e.spatialReference,0,t,n,0,1)},t.pointToWGS84ComparableLonLat=o,t.pointToWGS84ComparableLonLatPoint=function(e,t){return!!o(e,s)&&(t.x=s[0],t.y=s[1],t.z=s[2],!0)};var s=i.vec3f64.create()}).apply(null,r))||(e.exports=i)},ZO6V:function(e,t,n){var r,i;r=[n.dj.c(e.i),t,n("zOht"),n("KY0m"),n("BcWh"),n("Rdxj"),n("W0kZ"),n("mYMs")],void 0===(i=(function(e,t,n,r,i,a,o,s){"use strict";return function(e){function t(n,r,i){var o=e.call(this)||this;return o._parentStages=new Map,o._objects=new Set,o.id=t._idGen.gen(n),o.apiLayerUid=i,o.name=n,o.group=(r=r||{}).group||"",o.isVisible=null==r.isVisible||r.isVisible,o.isPickable=null==r.isPickable||r.isPickable,o.isSliceable=!1,o.translation=r.translation?a.vec3f64.clone(r.translation):a.vec3f64.create(),o}return n.__extends(t,e),t.prototype.addParentStage=function(e){if(!this._parentStages.has(e)){var t=this.on("dirty",(function(t){e.notifyDirty(t.origin,t.dirtyType,t.subObject)}));this._parentStages.set(e,t)}},t.prototype.removeParentStage=function(e){var t=this._parentStages.get(e);t&&(t.remove(),this._parentStages.delete(e)),this.invalidateSpatialQueryAccelerator()},t.prototype.getName=function(){return this.name},t.prototype.getGroup=function(){return this.group},t.prototype.getTranslation=function(){return this.translation},t.prototype.getObjectIds=function(){return r.keysOfSet(this._objects,(function(e){return e.id}))},t.prototype.getObjects=function(){return r.keysOfSet(this._objects)},t.prototype.addObject=function(e){this._objects.add(e),e.parentLayer=this,this.notifyDirty("layerObjectAdded",e),this._octree&&this._octree.add(e)},t.prototype.hasObject=function(e){return this._objects.has(e)},t.prototype.removeObject=function(e){return!!this._objects.delete(e)&&(e.parentLayer=null,this.notifyDirty("layerObjectRemoved",e),this._octree&&this._octree.remove(e),!0)},t.prototype.notifyObjectBBChanged=function(e,t){this._octree&&this._octree.update(e,t)},t.prototype.getSpatialQueryAccelerator=function(){return!this._octree&&this._objects.size>50&&this._createOctree(),this._octree},t.prototype.shaderTransformationChanged=function(){this.notifyDirty("shaderTransformationChanged",null)},t.prototype.invalidateSpatialQueryAccelerator=function(){this._octree&&(this._octree.destroy(),this._octree=null)},t.prototype.notifyDirty=function(e,t,n,r){n=n||0,this.emit("dirty",{origin:r||this,dirtyType:e,subObject:t})},t.prototype._createOctree=function(){this._octree=new s({getRadius:function(e){return e.getBSRadius()},getCenter:function(e){return e.getCenter()}}),this._octree.add(r.keysOfSet(this._objects))},t._idGen=new o.IdGen,t}(i)}).apply(null,r))||(e.exports=i)},ama6:function(e,t,n){var r,i;r=[n.dj.c(e.i),t,n("51bw"),n("vlC2")],void 0===(i=(function(e,t,n,r){"use strict";var i;return function(e){e.Default={vvSizeEnabled:!1,vvSizeMinSize:r.vec3f32.fromValues(1,1,1),vvSizeMaxSize:r.vec3f32.fromValues(100,100,100),vvSizeOffset:r.vec3f32.fromValues(0,0,0),vvSizeFactor:r.vec3f32.fromValues(1,1,1),vvSizeValue:r.vec3f32.fromValues(1,1,1),vvColorEnabled:!1,vvColorValues:[0,0,0,0,0,0,0,0],vvColorColors:[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],vvOpacityEnabled:!1,vvOpacityValues:[0,0,0,0,0,0,0,0],vvOpacityOpacities:[1,1,1,1,1,1,1,1],vvSymbolAnchor:[0,0,0],vvSymbolRotationMatrix:n.mat3f64.create()}}(i||(i={})),i}).apply(null,r))||(e.exports=i)},fQ2U:function(e,t,n){var r,i;r=[n.dj.c(e.i),t,n("zOht"),n("O7NG"),n("fese"),n("2NOe"),n("W/V4"),n("FQ4r"),n("lBa0"),n("ff/U"),n("NiJV"),n("G0ER"),n("qbr3"),n("2Kdy")],void 0===(i=(function(e,t,r,i,a,o,s,l,c,p,u,d,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShadedColorMaterialTechniqueConfiguration=t.ShadedColorMaterialTechnique=void 0;var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.initializeProgram=function(e){var n=t.shader.get(),r=this.configuration,i=n.build({slicePlaneEnabled:r.slicePlaneEnabled,sliceHighlightDisabled:r.sliceHighlightDisabled,sliceEnabledForVertexPrograms:!1});return new d(e.rctx,i.generateSource("vertex"),i.generateSource("fragment"),p.Default3D)},t.prototype.bindPass=function(e,t,n){o.View.bindProjectionMatrix(this.program,n.camera.projectionMatrix);var r=t.color,i=t.shadingTint;this.program.setUniform4fv("color",r),this.program.setUniform4fv("shadedColor",this.blendColor(m,i,r)),this.program.setUniform3fv("shadingDirection",t.shadingDirection),this.program.setUniformMatrix4fv("viewNormal",n.camera.viewInverseTransposeMatrix)},t.prototype.blendColor=function(e,t,n){var r=1-t[3],i=t[3]+n[3]*r;return 0===i?(e[3]=i,e):(e[0]=(t[0]*t[3]+n[0]*n[3]*r)/i,e[1]=(t[1]*t[3]+n[1]*n[3]*r)/i,e[2]=(t[2]*t[3]+n[2]*n[3]*r)/i,e[3]=n[3],e)},t.prototype.bindDraw=function(e){o.View.bindView(this.program,e),a.Slice.bindUniformsWithOrigin(this.program,this.configuration,e)},t.prototype.initializePipeline=function(){var e,t=this.configuration,n=0===t.output?t.transparent&&h.separateBlendingParams(770,1,771,771):null;return h.makePipelineState({blending:n,culling:(e=t.cullFace,0!==e&&{face:1===e?1028:1029,mode:2305}),depthTest:{func:515},depthWrite:t.writeDepth&&h.defaultDepthWriteParams,colorWrite:h.defaultColorWriteParams})},t.shader=new s.ReloadableShaderModule(u,(function(){return new Promise((function(e,t){Promise.resolve().then((function(){var t=[n("NiJV")];e.apply(null,t)}).bind(this)).catch(t.bind(this))}))})),t}(l.ShaderTechnique);t.ShadedColorMaterialTechnique=f;var v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.output=0,t.cullFace=0,t.slicePlaneEnabled=!1,t.sliceHighlightDisabled=!1,t.transparent=!1,t.writeDepth=!0,t}return r.__extends(t,e),r.__decorate([c.parameter({count:7})],t.prototype,"output",void 0),r.__decorate([c.parameter({count:3})],t.prototype,"cullFace",void 0),r.__decorate([c.parameter()],t.prototype,"slicePlaneEnabled",void 0),r.__decorate([c.parameter()],t.prototype,"sliceHighlightDisabled",void 0),r.__decorate([c.parameter()],t.prototype,"transparent",void 0),r.__decorate([c.parameter()],t.prototype,"writeDepth",void 0),t}(c.ShaderTechniqueConfiguration);t.ShadedColorMaterialTechniqueConfiguration=v;var m=i.vec4f64.create()}).apply(null,r))||(e.exports=i)},fUJJ:function(e,t,n){var r,i;r=[n.dj.c(e.i),t,n("zOht"),n("xoE+"),n("W/V4"),n("FQ4r"),n("lBa0"),n("ff/U"),n("qSzK"),n("G0ER"),n("qbr3"),n("qbr3"),n("2Kdy")],void 0===(i=(function(e,t,r,i,a,o,s,l,c,p,u,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LaserlineTechniqueConfiguration=t.LaserlineTechnique=void 0;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.initializeProgram=function(e){var n=t.shader.get().build(this.configuration);return new p(e.rctx,n.generateSource("vertex"),n.generateSource("fragment"),l.Default3D)},t.prototype.bind=function(e,t){this.program.setUniform3fv("innerColor",e.innerColor),this.program.setUniform1f("innerWidth",e.innerWidth*t.pixelRatio),this.program.setUniform3fv("glowColor",e.glowColor),this.program.setUniform1f("glowWidth",e.glowWidth*t.pixelRatio),this.program.setUniform1f("glowFalloff",e.glowFalloff),this.program.setUniform1f("globalAlpha",e.globalAlpha),this.configuration.contrastControlEnabled&&this.program.setUniform1f("globalAlphaContrastBoost",null!=e.globalAlphaContrastBoost?e.globalAlphaContrastBoost:1);var n=null!=e.angleCutoff?e.angleCutoff:c.defaultAngleCutoff;this.program.setUniform2f("angleCutoff",Math.cos(n),Math.cos(Math.max(0,n-i.deg2rad(2)))),this.configuration.intersectsLineEnabled&&this.program.setUniform1f("perScreenPixelRatio",t.perScreenPixelRatio)},t.prototype.initializePipeline=function(){return d.makePipelineState({blending:u.simpleBlendingParams(1,771),colorWrite:d.defaultColorWriteParams})},t.shader=new a.ReloadableShaderModule(c,(function(){return new Promise((function(e,t){Promise.resolve().then((function(){var t=[n("qSzK")];e.apply(null,t)}).bind(this)).catch(t.bind(this))}))})),t}(o.ShaderTechnique);t.LaserlineTechnique=h;var f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.heightManifoldEnabled=!1,t.pointDistanceEnabled=!1,t.lineVerticalPlaneEnabled=!1,t.intersectsLineEnabled=!1,t.contrastControlEnabled=!1,t}return r.__extends(t,e),r.__decorate([s.parameter()],t.prototype,"heightManifoldEnabled",void 0),r.__decorate([s.parameter()],t.prototype,"pointDistanceEnabled",void 0),r.__decorate([s.parameter()],t.prototype,"lineVerticalPlaneEnabled",void 0),r.__decorate([s.parameter()],t.prototype,"intersectsLineEnabled",void 0),r.__decorate([s.parameter()],t.prototype,"contrastControlEnabled",void 0),t}(s.ShaderTechniqueConfiguration);t.LaserlineTechniqueConfiguration=f}).apply(null,r))||(e.exports=i)},gG9S:function(e,t,n){var r,i;r=[n.dj.c(e.i),t,n("LxLY"),n("0LE5"),n("Rdxj"),n("DJpR"),n("MzcX"),n("2B1V"),n("raiv")],void 0===(i=(function(e,t,n,r,i,a,o,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LaserlinePathData=void 0;var c=function(){function e(e){this._renderCoordsHelper=e,this._buffers=null,this._origin=i.vec3f64.create(),this._dirty=!1,this._count=0,this._vao=null}return Object.defineProperty(e.prototype,"vertices",{set:function(e){for(var t=new Float64Array(3*e.length),n=0,r=0,i=e;r<i.length;r++){var a=i[r];t[n++]=a[0],t[n++]=a[1],t[n++]=a[2]}this.buffers=[t]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"buffers",{set:function(e){if(this._buffers=e,this._buffers.length>0){var t=this._buffers[0],n=3*Math.floor(t.length/3/2);r.vec3.set(this._origin,t[n+0],t[n+1],t[n+2])}else r.vec3.set(this._origin,0,0,0);this._dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"origin",{get:function(){return this._origin},enumerable:!1,configurable:!0}),e.prototype.draw=function(e){var t=this.ensureVAO(e);n.isSome(t)&&(e.bindVAO(t),e.drawArrays(4,0,this._count))},e.prototype.dispose=function(){n.isSome(this._vao)&&this._vao.dispose()},e.prototype.ensureVAO=function(e){return n.isNone(this._buffers)?null:(n.isNone(this._vao)&&(this._vao=this.createVAO(e,this._buffers)),this.ensureVertexData(this._vao,this._buffers),this._vao)},e.prototype.createVAO=function(e,t){var n=this.createDataBuffer(t);return this._dirty=!1,new a.VertexArrayObject(e,l.LaserlinePathTechnique.attributeLocations,{data:o.glLayout(d)},{data:a.BufferObject.createVertex(e,35044,n)})},e.prototype.ensureVertexData=function(e,t){if(this._dirty){var n=this.createDataBuffer(t);e.vertexBuffers.data.setData(n),this._dirty=!1}},e.prototype.numberOfRenderVertices=function(e){return 2*(e.length/3-1)*3},e.prototype.createDataBuffer=function(e){var t=this,n=e.reduce((function(e,n){return e+t.numberOfRenderVertices(n)}),0);this._count=n;for(var i=d.createBuffer(n),a=this._origin,o=0,s=0,l=0,c=e;l<c.length;l++){for(var h=c[l],f=0;f<h.length;f+=3){var v=r.vec3.set(u,h[f+0],h[f+1],h[f+2]);0===f?s=this._renderCoordsHelper.getAltitude(v):this._renderCoordsHelper.setAltitude(s,v);var m=this._renderCoordsHelper.worldUpAtPosition(v,p),g=o+2*f,y=r.vec3.subtract(u,v,a);if(f<h.length-3){i.up.setVec(g,m),i.up.setVec(g+3,m),i.up.setVec(g+5,m);for(var b=0;b<6;b++)i.start.setVec(g+b,y);i.extrude.setValues(g+0,0,-1),i.extrude.setValues(g+1,1,-1),i.extrude.setValues(g+2,1,1),i.extrude.setValues(g+3,0,-1),i.extrude.setValues(g+4,1,1),i.extrude.setValues(g+5,0,1)}if(f>0)for(i.up.setVec(g-2,m),i.up.setVec(g-4,m),i.up.setVec(g-5,m),b=-6;b<0;b++)i.end.setVec(g+b,y)}o+=this.numberOfRenderVertices(h)}return i.buffer},e}();t.LaserlinePathData=c;var p=i.vec3f64.create(),u=i.vec3f64.create(),d=s.newLayout().vec3f("start").vec3f("end").vec3f("up").vec2f("extrude")}).apply(null,r))||(e.exports=i)},hX2R:function(e,t,n){var r,i;r=[n.dj.c(e.i),t,n("xoE+"),n("LxLY"),n("DIqE"),n("0LE5"),n("Rdxj"),n("2fXB"),n("O7NG"),n("aWgr"),n("gG9S"),n("/Bau"),n("CIy2"),n("s6rJ"),n("raiv"),n("fUJJ")],void 0===(i=(function(e,t,n,r,i,a,o,s,l,c,p,u,d,h,f,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LaserLineRenderer=void 0;var m=o.vec3f64.create(),g=l.vec4f64.create(),y={glowColor:[1,.5,0],glowWidth:8,glowFalloff:8,innerColor:[1,1,1],innerWidth:1,globalAlpha:.75,angleCutoff:n.deg2rad(6),globalAlphaContrastBoost:2};function b(e,t,n,r){var i=m,o=g;a.vec3.transformMat4(i,t,r),a.vec3.copy(o,n),o[3]=0,s.vec4.transformMat4(o,o,r),c.plane.fromPositionAndNormal(i,o,e)}var _=function(){function e(e,t,n){void 0===t&&(t={}),void 0===n&&(n={contrastControlEnabled:!1}),this._technique=null,this._projInfo=l.vec4f64.create(),this._zScale=i.vec2f64.create(),this._heightManifoldEnabled=!1,this._heightManifoldTarget=o.vec3f64.create(),this._pointDistanceEnabled=!1,this._pointDistanceOrigin=o.vec3f64.create(),this._pointDistanceTarget=o.vec3f64.create(),this._lineVerticalPlaneEnabled=!1,this._lineVerticalPlaneSegment=c.lineSegment.create(),this._intersectsLineEnabled=!1,this._intersectsLineSegment=c.lineSegment.create(),this._intersectsLineRadius=3,this._intersectsLineInfinite=!1,this._pathVerticalPlaneEnabled=!1,this._pathVerticalPlaneData=null,this._pathTechnique=null,this.canRender=!0,this._tempNormal=o.vec3f64.create(),this._tempDir=o.vec3f64.create(),this._tempUp=o.vec3f64.create(),this._tempVec3A=o.vec3f64.create(),this._tempVec3B=o.vec3f64.create(),this._tempVec4=l.vec4f64.create(),this._tempPlane=c.plane.create(),this._tempSphere=c.sphere.create(),this._renderCoordsHelper=e,this._params=h.copyParameters(t,y),this._config=n}return Object.defineProperty(e.prototype,"renderSlots",{get:function(){return[this._config.contrastControlEnabled?17:16]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"needsLinearDepth",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"heightManifoldEnabled",{get:function(){return this._heightManifoldEnabled},set:function(e){this._heightManifoldEnabled!==e&&(this._heightManifoldEnabled=e,this._requestRender())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"heightManifoldTarget",{get:function(){return this._heightManifoldTarget},set:function(e){a.vec3.copy(this._heightManifoldTarget,e),this._requestRender()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pointDistanceEnabled",{get:function(){return this._pointDistanceEnabled},set:function(e){e!==this._pointDistanceEnabled&&(this._pointDistanceEnabled=e,this._requestRender())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pointDistanceTarget",{get:function(){return this._pointDistanceTarget},set:function(e){a.vec3.copy(this._pointDistanceTarget,e),this._requestRender()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pointDistanceOrigin",{get:function(){return this._pointDistanceOrigin},set:function(e){a.vec3.copy(this._pointDistanceOrigin,e),this._requestRender()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lineVerticalPlaneEnabled",{get:function(){return this._lineVerticalPlaneEnabled},set:function(e){e!==this._lineVerticalPlaneEnabled&&(this._lineVerticalPlaneEnabled=e,this._requestRender())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lineVerticalPlaneSegment",{get:function(){return this._lineVerticalPlaneSegment},set:function(e){c.lineSegment.copy(e,this._lineVerticalPlaneSegment),this._requestRender()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"intersectsLineEnabled",{get:function(){return this._intersectsLineEnabled},set:function(e){e!==this._intersectsLineEnabled&&(this._intersectsLineEnabled=e,this._requestRender())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"intersectsLineSegment",{get:function(){return this._intersectsLineSegment},set:function(e){c.lineSegment.copy(e,this._intersectsLineSegment),this._requestRender()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"intersectsLineRadius",{get:function(){return this._intersectsLineRadius},set:function(e){e!==this._intersectsLineRadius&&(this._intersectsLineRadius=e,this._requestRender())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"intersectsLineInfinite",{get:function(){return this._intersectsLineInfinite},set:function(e){e!==this._intersectsLineInfinite&&(this._intersectsLineInfinite=e,this._requestRender())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pathVerticalPlaneEnabled",{get:function(){return this._pathVerticalPlaneEnabled},set:function(e){e!==this._pathVerticalPlaneEnabled&&(this._pathVerticalPlaneEnabled=e,r.isSome(this._pathVerticalPlaneData)&&this._requestRender())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pathVerticalPlaneVertices",{set:function(e){r.isNone(this._pathVerticalPlaneData)&&(this._pathVerticalPlaneData=new p.LaserlinePathData(this._renderCoordsHelper)),this._pathVerticalPlaneData.vertices=e,this.pathVerticalPlaneEnabled&&this._requestRender()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pathVerticalPlaneBuffers",{set:function(e){r.isNone(this._pathVerticalPlaneData)&&(this._pathVerticalPlaneData=new p.LaserlinePathData(this._renderCoordsHelper)),this._pathVerticalPlaneData.buffers=e,this.pathVerticalPlaneEnabled&&this._requestRender()},enumerable:!1,configurable:!0}),e.prototype.setParameterValues=function(e){h.updateParameters(this._params,e)&&this._requestRender()},e.prototype.initializeRenderContext=function(e){this._initContext=e,this._quadVAO=u.createQuadVAO(e.rctx),this._techniqueRepository=e.shaderTechniqueRep,this._techniqueConfig=new v.LaserlineTechniqueConfiguration,this._pathTechniqueConfig=new f.LaserlinePathTechniqueConfiguration},e.prototype.uninitializeRenderContext=function(){this._quadVAO.dispose(),this._quadVAO=null,r.isSome(this._technique)&&this._techniqueRepository.release(this._technique),r.isSome(this._pathVerticalPlaneData)&&this._pathVerticalPlaneData.dispose(),r.isSome(this._pathTechnique)&&this._techniqueRepository.release(this._pathTechnique)},e.prototype.render=function(e){var t=this.heightManifoldEnabled||this.pointDistanceEnabled||this.lineVerticalPlaneSegment||this.intersectsLineEnabled,n=this.pathVerticalPlaneEnabled;if(!t&&!n)return!0;var r=e.camera;return d.inverseProjectionInfo(r.projectionMatrix,r.fullWidth,r.fullHeight,this._projInfo,this._zScale),t&&this.renderUnified(e),n&&this.renderPath(e),!0},e.prototype.renderUnified=function(e){var t=e.rctx,n=this._selectTechnique(),r=n.program;t.bindProgram(r),n.bindPipelineState(t),this.bindGlobalUniforms(e,r),this.bindHeightManifoldUniforms(e,r),this.bindPointDistanceUniforms(e,r),this.bindLineVerticalPlaneUniforms(e,r),this.bindIntersectsLineUniforms(e,r),n.bind(this._params,e.camera),t.bindVAO(this._quadVAO),t.drawArrays(5,0,4)},e.prototype.renderPath=function(e){if(!r.isNone(this._pathVerticalPlaneData)){this._pathTechniqueConfig.contrastControlEnabled=this._config.contrastControlEnabled,this._pathTechnique=this._techniqueRepository.acquireAndReleaseExisting(f.LaserlinePathTechnique,this._pathTechniqueConfig,this._pathTechnique);var t=e.rctx,n=this._pathTechnique,i=n.program;t.bindProgram(i),n.bindPipelineState(t),this.bindGlobalUniforms(e,i),n.bind(this._params,this._pathVerticalPlaneData.origin,e.camera),this._pathVerticalPlaneData.draw(e.rctx)}},e.prototype.bindHeightManifoldUniforms=function(e,t){if(this.heightManifoldEnabled){var n=this._tempVec3A,r=this._tempPlane;this._renderCoordsHelper.worldUpAtPosition(this._heightManifoldTarget,n),b(r,this._heightManifoldTarget,n,e.camera.viewMatrix),t.setUniform4fv("heightPlane",r)}},e.prototype.bindPointDistanceUniforms=function(e,t){if(this._pointDistanceEnabled){var n=e.camera,r=this._tempSphere;a.vec3.copy(r.center,this._pointDistanceOrigin),a.vec3.transformMat4(r.center,r.center,n.viewMatrix),r.radius=a.vec3.distance(this._pointDistanceOrigin,this._pointDistanceTarget),t.setUniform4f("pointDistanceSphere",r.center[0],r.center[1],r.center[2],r.radius)}},e.prototype.bindLineVerticalPlaneUniforms=function(e,t){if(this._lineVerticalPlaneEnabled){var n=this._renderCoordsHelper,r=e.camera,i=this._tempPlane,o=this._tempVec3A,s=this._tempUp,l=this._tempDir,p=this._tempNormal;c.lineSegment.pointAt(this._lineVerticalPlaneSegment,.5,o),n.worldUpAtPosition(o,s),a.vec3.normalize(l,this._lineVerticalPlaneSegment.vector),a.vec3.cross(p,s,l),a.vec3.normalize(p,p),b(i,this._lineVerticalPlaneSegment.origin,p,r.viewMatrix),t.setUniform4fv("lineVerticalPlane",i);var u=this._tempVec3A;a.vec3.copy(u,this._lineVerticalPlaneSegment.origin),n.setAltitude(0,u),a.vec3.transformMat4(u,u,r.viewMatrix),t.setUniform3fv("lineVerticalStart",u);var d=this._tempVec3B;a.vec3.add(d,this._lineVerticalPlaneSegment.origin,this._lineVerticalPlaneSegment.vector),n.setAltitude(0,d),a.vec3.transformMat4(d,d,r.viewMatrix),t.setUniform3fv("lineVerticalEnd",d)}},e.prototype.bindIntersectsLineUniforms=function(e,t){if(this._intersectsLineEnabled){var n=P,r=S;if(this._intersectsLineInfinite){var i=e.camera;if(c.clipRay.fromRay(c.ray.wrap(this._intersectsLineSegment.origin,this._intersectsLineSegment.vector),x),x.c0=-Number.MAX_VALUE,!c.frustum.intersectClipRay(i.frustum.planes,x))return;c.clipRay.getStart(x,n),c.clipRay.getEnd(x,r)}else a.vec3.copy(n,this._intersectsLineSegment.origin),a.vec3.add(r,this._intersectsLineSegment.origin,this._intersectsLineSegment.vector);var o=this._tempVec3A;a.vec3.transformMat4(o,n,e.camera.viewMatrix),t.setUniform3fv("intersectsLineStart",o);var l=this._tempVec4;a.vec3.copy(l,this._intersectsLineSegment.vector),this._tempVec4[3]=0,s.vec4.transformMat4(this._tempVec4,this._tempVec4,e.camera.viewMatrix),a.vec3.transformMat4(r,r,e.camera.viewMatrix),t.setUniform3fv("intersectsLineEnd",r),a.vec3.normalize(l,l),t.setUniform3f("intersectsLineDirection",l[0],l[1],l[2]),t.setUniform1f("intersectsLineRadius",this._intersectsLineRadius)}},e.prototype.bindGlobalUniforms=function(e,t){var n=e.camera;t.setUniform4fv("projInfo",this._projInfo),t.setUniform2fv("zScale",this._zScale),t.setUniform2f("nearFar",n.near,n.far),this._heightManifoldEnabled?t.setUniform1f("maxPixelDistance",2*n.computeScreenPixelSizeAt(this._heightManifoldTarget)):this._pointDistanceEnabled?t.setUniform1f("maxPixelDistance",2*n.computeScreenPixelSizeAt(this._pointDistanceTarget)):this._lineVerticalPlaneEnabled&&t.setUniform1f("maxPixelDistance",2*n.computeScreenPixelSizeAt(this._lineVerticalPlaneSegment.origin)),t.setUniform1i("depthMap",0),e.rctx.bindTexture(e.offscreenRenderingHelper.linearDepthTexture,0),t.setUniform1i("frameColor",1),e.rctx.bindTexture(e.offscreenRenderingHelper.mainColorTexture,1)},e.prototype._requestRender=function(){this._initContext&&this._initContext.requestRender()},e.prototype._selectTechnique=function(){return this._techniqueConfig.heightManifoldEnabled=this.heightManifoldEnabled,this._techniqueConfig.lineVerticalPlaneEnabled=this.lineVerticalPlaneEnabled,this._techniqueConfig.pointDistanceEnabled=this.pointDistanceEnabled,this._techniqueConfig.intersectsLineEnabled=this.intersectsLineEnabled,this._techniqueConfig.contrastControlEnabled=this._config.contrastControlEnabled,this._technique=this._techniqueRepository.acquireAndReleaseExisting(v.LaserlineTechnique,this._techniqueConfig,this._technique),this._technique},e}();t.LaserLineRenderer=_;var x=c.clipRay.create(),P=o.vec3f64.create(),S=o.vec3f64.create()}).apply(null,r))||(e.exports=i)},hk44:function(e,t,n){var r,i;r=[n.dj.c(e.i),t,n("zOht"),n("6vp1"),n("58az"),n("7Aei")],void 0===(i=(function(e,t,n,r,i,a){"use strict";var o,s,l,c,p,u;Object.defineProperty(t,"__esModule",{value:!0}),t.Laserline=void 0,t.Laserline=function(e,t){e.extensions.add("GL_OES_standard_derivatives"),e.include(r.ReadLinearDepth),e.include(i.CameraSpace),e.fragment.uniforms.add("glowColor","vec3"),e.fragment.uniforms.add("glowWidth","float"),e.fragment.uniforms.add("glowFalloff","float"),e.fragment.uniforms.add("innerColor","vec3"),e.fragment.uniforms.add("innerWidth","float"),e.fragment.uniforms.add("depthMap","sampler2D"),e.fragment.uniforms.add("nearFar","vec2"),e.fragment.uniforms.add("frameColor","sampler2D"),t.contrastControlEnabled&&e.fragment.uniforms.add("globalAlphaContrastBoost","float"),e.fragment.code.add(a.glsl(o||(o=n.__makeTemplateObject(["\n  vec4 blendPremultiplied(vec4 source, vec4 dest) {\n    float oneMinusSourceAlpha = 1.0 - source.a;\n\n    return vec4(\n      source.rgb + dest.rgb * oneMinusSourceAlpha,\n      source.a + dest.a * oneMinusSourceAlpha\n    );\n  }\n  "],["\n  vec4 blendPremultiplied(vec4 source, vec4 dest) {\n    float oneMinusSourceAlpha = 1.0 - source.a;\n\n    return vec4(\n      source.rgb + dest.rgb * oneMinusSourceAlpha,\n      source.a + dest.a * oneMinusSourceAlpha\n    );\n  }\n  "])))),e.fragment.code.add(a.glsl(s||(s=n.__makeTemplateObject(["\n  vec4 premultipliedColor(vec3 rgb, float alpha) {\n    return vec4(rgb * alpha, alpha);\n  }\n  "],["\n  vec4 premultipliedColor(vec3 rgb, float alpha) {\n    return vec4(rgb * alpha, alpha);\n  }\n  "])))),e.fragment.code.add(a.glsl(l||(l=n.__makeTemplateObject(["\n  vec4 laserlineProfile(float dist) {\n    if (dist > glowWidth) {\n      return vec4(0.0);\n    }\n\n    float innerAlpha = (1.0 - smoothstep(0.0, innerWidth, dist));\n    float glowAlpha = pow(max(0.0, 1.0 - dist / glowWidth), glowFalloff);\n\n    return blendPremultiplied(\n      premultipliedColor(innerColor, innerAlpha),\n      premultipliedColor(glowColor, glowAlpha)\n    );\n  }\n  "],["\n  vec4 laserlineProfile(float dist) {\n    if (dist > glowWidth) {\n      return vec4(0.0);\n    }\n\n    float innerAlpha = (1.0 - smoothstep(0.0, innerWidth, dist));\n    float glowAlpha = pow(max(0.0, 1.0 - dist / glowWidth), glowFalloff);\n\n    return blendPremultiplied(\n      premultipliedColor(innerColor, innerAlpha),\n      premultipliedColor(glowColor, glowAlpha)\n    );\n  }\n  "])))),e.fragment.code.add(a.glsl(c||(c=n.__makeTemplateObject(["\n  bool laserlineReconstructFromDepth(out vec3 pos, out vec3 normal, out float depthDiscontinuityAlpha) {\n    float depth = linearDepthFromTexture(depthMap, uv, nearFar);\n\n    if (-depth == nearFar[0]) {\n      return false;\n    }\n\n    pos = reconstructPosition(gl_FragCoord.xy, depth);\n    normal = normalize(cross(dFdx(pos), dFdy(pos)));\n\n    float ddepth = fwidth(depth);\n    depthDiscontinuityAlpha = 1.0 - smoothstep(0.0, 0.01, -ddepth / depth);\n\n    return true;\n  }\n  "],["\n  bool laserlineReconstructFromDepth(out vec3 pos, out vec3 normal, out float depthDiscontinuityAlpha) {\n    float depth = linearDepthFromTexture(depthMap, uv, nearFar);\n\n    if (-depth == nearFar[0]) {\n      return false;\n    }\n\n    pos = reconstructPosition(gl_FragCoord.xy, depth);\n    normal = normalize(cross(dFdx(pos), dFdy(pos)));\n\n    float ddepth = fwidth(depth);\n    depthDiscontinuityAlpha = 1.0 - smoothstep(0.0, 0.01, -ddepth / depth);\n\n    return true;\n  }\n  "])))),e.fragment.code.add(a.glsl(t.contrastControlEnabled?p||(p=n.__makeTemplateObject(["\n    float rgbToLuminance(vec3 color) {\n      return dot(vec3(0.2126, 0.7152, 0.0722), color);\n    }\n\n    vec4 laserlineOutput(vec4 color) {\n      float backgroundLuminance = rgbToLuminance(texture2D(frameColor, uv).rgb);\n      float alpha = clamp(globalAlpha * max(backgroundLuminance * globalAlphaContrastBoost, 1.0), 0.0, 1.0);\n\n      return color * alpha;\n    }\n    "],["\n    float rgbToLuminance(vec3 color) {\n      return dot(vec3(0.2126, 0.7152, 0.0722), color);\n    }\n\n    vec4 laserlineOutput(vec4 color) {\n      float backgroundLuminance = rgbToLuminance(texture2D(frameColor, uv).rgb);\n      float alpha = clamp(globalAlpha * max(backgroundLuminance * globalAlphaContrastBoost, 1.0), 0.0, 1.0);\n\n      return color * alpha;\n    }\n    "])):u||(u=n.__makeTemplateObject(["\n    vec4 laserlineOutput(vec4 color) {\n      return color * globalAlpha;\n    }\n    "],["\n    vec4 laserlineOutput(vec4 color) {\n      return color * globalAlpha;\n    }\n    "]))))}}).apply(null,r))||(e.exports=i)},m4lJ:function(e,t,n){var r,i;r=[n.dj.c(e.i),t,n("H1tY"),n("LxLY"),n("1m5D"),n("0LE5"),n("Rdxj"),n("aWgr"),n("9DjX"),n("PwS/")],void 0===(i=(function(e,t,n,r,i,a,o,s,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Intersector=void 0;var p=n("esri-debug-messages"),u=function(){function e(e){this.options=new l.IntersectorOptions,this.results=new l.IntersectorResults,this.transform=new l.IntersectorTransform,this.performanceInfo={queryDuration:0,numObjectsTested:0},this.tolerance=1e-5,this.verticalOffset=null,this._ray={origin:o.vec3f64.create(),direction:o.vec3f64.create()},this._rayEndPoint=o.vec3f64.create(),this._rayStartPointTransformed=o.vec3f64.create(),this._rayEndPointTransformed=o.vec3f64.create(),this.viewingMode=null==e?1:e}return Object.defineProperty(e.prototype,"ray",{get:function(){return this._ray},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rayBeginPoint",{get:function(){return this._ray.origin},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rayEndPoint",{get:function(){return this._rayEndPoint},enumerable:!1,configurable:!0}),e.prototype.reset=function(e,t){this.resetWithRay(s.ray.fromPoints(e,t,this._ray))},e.prototype.resetWithRay=function(e){e!==this._ray&&s.ray.copy(e,this._ray),0!==this.options.verticalOffset?2===this.viewingMode?this._ray.origin[2]-=this.options.verticalOffset:this.verticalOffset=this.options.verticalOffset:this.verticalOffset=null,a.vec3.add(this._rayEndPoint,this._ray.origin,this._ray.direction),this._numObjectsTested=0,this.results.init(this._ray)},e.prototype.intersect=function(e,t,n,i,a,o){var s=this;this.point=t,this.camera=n,this.filterPredicate=a,this.tolerance=null==i?1e-5:i;var c,u=l.getVerticalOffsetObject3D(this.verticalOffset);p&&(c=performance.now());var d=o?function(e){o(e)&&s.intersectObject(e)}:function(e){s.intersectObject(e)};if(e&&e.length>0)for(var h=0,f=e;h<f.length;h++){var v=f[h],m=v.getSpatialQueryAccelerator&&v.getSpatialQueryAccelerator();if(m)r.isSome(u)?m.forEachAlongRayWithVerticalOffset(this._ray.origin,this._ray.direction,d,u):m.forEachAlongRay(this._ray.origin,this._ray.direction,d),this.options.selectionMode&&this.options.hud&&m.forEachDegenerateObject(d);else for(var g=0,y=v.getObjects();g<y.length;g++)d(y[g])}this.sortResults(),p&&(this.performanceInfo.queryDuration=performance.now()-c,this.performanceInfo.numObjectsTested=this._numObjectsTested)},e.prototype.intersectObject=function(e){var t=this;this._numObjectsTested++;var n=e.geometryRecords;if(n)for(var o,s=e.id,p=e.objectTransformation,u=l.getVerticalOffsetObject3D(this.verticalOffset),d=function(n){var d=n.geometry,f=n.material,v=n.instanceParameters;if(c.isInstanceHidden(v))return"continue";o=d.id,h.transform.setAndInvalidateLazyTransforms(p,n.getShaderTransformation()),a.vec3.transformMat4(h._rayStartPointTransformed,h._ray.origin,h.transform.inverse),a.vec3.transformMat4(h._rayEndPointTransformed,h._rayEndPoint,h.transform.inverse);var m=h.transform.transform;r.isSome(u)&&(u.objectTransform=h.transform),f.intersect(d,v,h.transform.transform,h,h._rayStartPointTransformed,h._rayEndPointTransformed,(function(n,a,c,p,u,d){if(n>=0){if(r.isSome(t.filterPredicate)&&!t.filterPredicate(t._ray.origin,t._rayEndPoint,n))return;if(u)return void((null==t.results.hud.dist||n<t.results.hud.dist)&&t.results.hud.set(e,s,n,a,i.mat4f64.IDENTITY,p,d,o,c));var h=function(t){return t.set(e,s,n,a,m,p,null,o,c)};if((null==t.results.min.drapedLayerOrder||p>=t.results.min.drapedLayerOrder)&&(null==t.results.min.dist||n<t.results.min.dist)&&h(t.results.min),0!==t.options.store&&(null==t.results.max.drapedLayerOrder||p<t.results.max.drapedLayerOrder)&&(null==t.results.max.dist||n>t.results.max.dist)&&h(t.results.max),2===t.options.store){var f=new l.IntersectorResult(t._ray);h(f),t.results.all.push(f)}}}),n.shaderTransformation)},h=this,f=0,v=n;f<v.length;f++)d(v[f])},e.prototype.sortResults=function(){this.results.all.sort((function(e,t){return e.dist!==t.dist?e.dist-t.dist:e.drapedLayerOrder!==t.drapedLayerOrder?(void 0!==e.drapedLayerOrder?e.drapedLayerOrder:Number.MAX_VALUE)-(void 0!==t.drapedLayerOrder?t.drapedLayerOrder:Number.MAX_VALUE):(void 0!==t.drapedLayerGraphicOrder?t.drapedLayerGraphicOrder:Number.MIN_VALUE)-(void 0!==e.drapedLayerGraphicOrder?e.drapedLayerGraphicOrder:Number.MIN_VALUE)}))},e.DEFAULT_TOLERANCE=1e-5,e}();t.Intersector=u}).apply(null,r))||(e.exports=i)},mYMs:function(e,t,n){var r,i;r=[n.dj.c(e.i),t,n("SyoC"),n("KBgh"),n("0LE5"),n("Rdxj"),n("aWgr"),n("CIy2")],void 0===(i=(function(e,t,n,r,i,a,o,s){"use strict";var l=function(){function e(e,t){this._objectToBoundingSphere=e,this._maximumObjectsPerNode=10,this._maximumDepth=20,this._degenerateObjects=new Set,this._objectCount=0,t&&(void 0!==t.maximumObjectsPerNode&&(this._maximumObjectsPerNode=t.maximumObjectsPerNode),void 0!==t.maximumDepth&&(this._maximumDepth=t.maximumDepth)),this._root=new c(null,a.vec3f64.fromValues(0,0,0),0)}return Object.defineProperty(e.prototype,"center",{get:function(){return this._root.center},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return 2*this._root.halfSize},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this._root.node},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maximumObjectsPerNode",{get:function(){return this._maximumObjectsPerNode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maximumDepth",{get:function(){return this._maximumDepth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"objectCount",{get:function(){return this._objectCount},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){this._degenerateObjects.clear(),this._root=null,c.clearPool(),b[0]=null,w.prune(),R.prune(),T.prune()},e.prototype.add=function(e,t){var n=_(e);this._objectCount+=t=null==t?n.length:t,this._grow(n,t);for(var r=c.acquire(),i=0;i<t;i++){var a=n[i];this._isDegenerate(a)?this._degenerateObjects.add(a):(r.init(this._root),this._add(a,r))}c.release(r)},e.prototype.remove=function(e,t){var n=_(e);this._objectCount-=n.length;for(var r=c.acquire(),i=0,a=n;i<a.length;i++){var o=a[i],s=t||this._boundingSphereFromObject(o,C);this._isValidRadius(s.radius)?(r.init(this._root),this._remove(o,s,r)):this._degenerateObjects.delete(o)}c.release(r),this._shrink()},e.prototype.update=function(e,t){!this._isValidRadius(t.radius)&&this._isDegenerate(e)||(this.remove(e,t),this.add(e))},e.prototype.forEachAlongRay=function(e,t,n){var r=this,i=o.ray.wrap(e,t);this._forEachNode(this._root,(function(e){if(!r._intersectsNode(i,e))return!1;var t=e.node;return t.terminals.forEachSimple((function(e){r._intersectsObject(i,e)&&n(e)})),null!==t.residents&&t.residents.forEachSimple((function(e){r._intersectsObject(i,e)&&n(e)})),!0}))},e.prototype.forEachAlongRayWithVerticalOffset=function(e,t,n,r){var i=this,a=o.ray.wrap(e,t);this._forEachNode(this._root,(function(e){if(!i._intersectsNodeWithOffset(a,e,r))return!1;var t=e.node;return t.terminals.forEachSimple((function(e){i._intersectsObjectWithOffset(a,e,r)&&n(e)})),null!==t.residents&&t.residents.forEachSimple((function(e){i._intersectsObjectWithOffset(a,e,r)&&n(e)})),!0}))},e.prototype.forEach=function(e){this._forEachNode(this._root,(function(t){var n=t.node;return n.terminals.forEachSimple(e),null!==n.residents&&n.residents.forEachSimple(e),!0})),this._degenerateObjects.forEach(e)},e.prototype.forEachDegenerateObject=function(e){this._degenerateObjects.forEach(e)},e.prototype.findClosest=function(e,t,n,r,i){return this._findClosest(e,"front-to-back"===t?1:-1,n,r,i)},e.prototype.forEachInDepthRange=function(e,t,n,r,i,a,o,s){this._forEachInDepthRange(e,t,"front-to-back"===n?1:-1,r,i,a,o,s)},e.prototype.forEachNode=function(e){this._forEachNode(this._root,(function(t){return e(t.node,t.center,2*t.halfSize)}))},e.prototype._intersectsNode=function(e,t){return d(t.center,2*-t.halfSize,S),d(t.center,2*t.halfSize,O),s.rayBoxTest(e.origin,e.direction,S,O)},e.prototype._intersectsNodeWithOffset=function(e,t,n){return d(t.center,2*-t.halfSize,S),d(t.center,2*t.halfSize,O),n.applyToMinMax(S,O),s.rayBoxTest(e.origin,e.direction,S,O)},e.prototype._intersectsObject=function(e,t){var n=this._objectToBoundingSphere.getRadius(t);return!(n>0)||o.sphere.intersectsRay(o.sphere.wrap(n,this._objectToBoundingSphere.getCenter(t)),e)},e.prototype._intersectsObjectWithOffset=function(e,t,n){var r=this._objectToBoundingSphere.getRadius(t);return!(r>0)||o.sphere.intersectsRay(n.applyToBoundingSphere(r,this._objectToBoundingSphere.getCenter(t)),e)},e.prototype._forEachNode=function(e,t){for(var n=c.acquire().init(e),r=[n];0!==r.length;){if(t(n=r.pop())&&!n.isLeaf())for(var i=0;i<n.node.children.length;i++)n.node.children[i]&&r.push(c.acquire().init(n).advance(i));c.release(n)}},e.prototype._forEachNodeDepthOrdered=function(e,t,n,r){void 0===r&&(r=1);var i=c.acquire().init(e),a=[i];for(function(e,t,n){if(!R.length)for(var r=0;r<8;++r)R.push({index:0,distance:0});for(r=0;r<8;++r){var i=m[r];R.data[r].index=r,R.data[r].distance=v(e,t,i)}for(R.sort((function(e,t){return e.distance-t.distance})),n.clear(),r=0;r<8;++r)n.push(R.data[r].index)}(n,r,T);0!==a.length;){if(t(i=a.pop())&&!i.isLeaf())for(var o=7;o>=0;--o){var s=T.data[o];s>=i.node.children.length||i.node.children[s]&&a.push(c.acquire().init(i).advance(s))}c.release(i)}},e.prototype._findClosest=function(e,t,n,r,a){var o=this,s=1/0,l=1/0,c=null,p=f(e,t),u=0,d=function(i){if(++u,!r||r(i)){var a=o._objectToBoundingSphere.getCenter(i),p=o._objectToBoundingSphere.getRadius(i);if(!n||!h(a,p,n)){var d=v(e,t,a),f=d-p;f<s&&(s=f,l=d+p,c=i)}}};return this._forEachNodeDepthOrdered(this._root,(function(r){if(null!=a&&u>=a)return!1;if(n&&h(r.center,r.halfSize*y,n))return!1;if(i.vec3.scale(P,p,r.halfSize),i.vec3.add(P,P,r.center),v(e,t,P)>l)return!1;var o=r.node;return o.terminals.forEachSimple((function(e){d(e)})),null!==o.residents&&o.residents.forEachSimple((function(e){d(e)})),!0}),e,t),c},e.prototype._forEachInDepthRange=function(e,t,n,r,a,o,s,l){var c=this,p=-1/0,u=1/0,d={setRange:function(e){1===n?(p=Math.max(p,e.near),u=Math.min(u,e.far)):(p=Math.max(p,-e.far),u=Math.min(u,-e.near))}};d.setRange(r);var m=v(t,n,e),g=f(t,n),b=f(t,-1*n),_=0,x=function(e){if(++_,!s||s(e)){var r=c._objectToBoundingSphere.getCenter(e),i=c._objectToBoundingSphere.getRadius(e),l=v(t,n,r)-m;l-i>u||l+i<p||o&&h(r,i,o)||a(e,d)}};this._forEachNodeDepthOrdered(this._root,(function(e){if(null!=l&&_>=l)return!1;if(o&&h(e.center,e.halfSize*y,o))return!1;if(i.vec3.scale(P,g,e.halfSize),i.vec3.add(P,P,e.center),v(t,n,P)-m>u)return!1;if(i.vec3.scale(P,b,e.halfSize),i.vec3.add(P,P,e.center),v(t,n,P)-m<p)return!1;var r=e.node;return r.terminals.forEachSimple((function(e){x(e)})),null!==r.residents&&r.residents.forEachSimple((function(e){x(e)})),!0}),t,n)},e.prototype._remove=function(e,t,n){w.clear();var r=n.advanceTo(t,(function(e,t){w.push(e.node),w.push(t)}))?n.node.terminals:n.node.residents;if(r.removeUnordered(e),0===r.length)for(var i=w.length-2;i>=0&&this._purge(w.data[i],w.data[i+1]);i-=2);},e.prototype._nodeIsEmpty=function(e){if(0!==e.terminals.length)return!1;if(null!==e.residents)return 0===e.residents.length;for(var t=0;t<e.children.length;t++)if(e.children[t])return!1;return!0},e.prototype._purge=function(e,t){return t>=0&&(e.children[t]=null),!!this._nodeIsEmpty(e)&&(null===e.residents&&(e.residents=new r({shrink:!0})),!0)},e.prototype._add=function(e,t){t.advanceTo(this._boundingSphereFromObject(e,C))?t.node.terminals.push(e):(t.node.residents.push(e),t.node.residents.length>this._maximumObjectsPerNode&&t.depth<this._maximumDepth&&this._split(t))},e.prototype._split=function(e){var t=e.node.residents;e.node.residents=null;for(var n=0;n<t.length;n++){var r=c.acquire().init(e);this._add(t.data[n],r),c.release(r)}},e.prototype._grow=function(e,t){var n=this;if(0!==t){var r=this._boundingSphereFromObjects(e,t,(function(e,t){return n._boundingSphereFromObject(e,t)}),A);if(this._isValidRadius(r.radius)&&!this._fitsInsideTree(r))if(this._nodeIsEmpty(this._root.node))i.vec3.copy(this._root.center,r.center),this._root.halfSize=1.25*r.radius;else{var a=c.acquire();this._rootBoundsForRootAsSubNode(r,a),this._placingRootViolatesMaxDepth(a)?this._rebuildTree(r,a):this._growRootAsSubNode(a),c.release(a)}}},e.prototype._rebuildTree=function(e,t){var n=this;i.vec3.copy(D.center,t.center),D.radius=t.halfSize;var r=this._boundingSphereFromObjects([e,D],2,(function(e){return e}),V),a=c.acquire().init(this._root);this._root.initFrom(null,r.center,1.25*r.radius),this._forEachNode(a,(function(e){return n.add(e.node.terminals.data,e.node.terminals.length),null!==e.node.residents&&n.add(e.node.residents.data,e.node.residents.length),!0})),c.release(a)},e.prototype._placingRootViolatesMaxDepth=function(e){var t=0;return this._forEachNode(this._root,(function(e){return t=Math.max(t,e.depth),!0})),t+Math.log(e.halfSize/this._root.halfSize)*Math.LOG2E>this._maximumDepth},e.prototype._rootBoundsForRootAsSubNode=function(e,t){for(var n=e.radius,r=e.center,i=-1/0,a=this._root.center,o=this._root.halfSize,s=0;s<3;s++){var l=r[s]+n-(a[s]+o),c=Math.max(0,Math.ceil((a[s]-o-(r[s]-n))/(2*o))),p=Math.max(0,Math.ceil(l/(2*o)))+1,u=Math.pow(2,Math.ceil(Math.log(c+p)*Math.LOG2E));i=Math.max(i,u),j[s].min=c,j[s].max=p}for(s=0;s<3;s++){var d=(i-((c=j[s].min)+(p=j[s].max)))/2;c+=Math.ceil(d),p+=Math.floor(d),x[s]=a[s]-o-c*o*2+(p+c)*o}return t.initFrom(null,x,i*o,0)},e.prototype._growRootAsSubNode=function(e){var t=this._root.node;i.vec3.copy(A.center,this._root.center),A.radius=this._root.halfSize,this._root.init(e),e.advanceTo(A,null,!0),e.node.children=t.children,e.node.residents=t.residents,e.node.terminals=t.terminals},e.prototype._shrink=function(){for(;;){var e=this._findShrinkIndex();if(-1===e)break;this._root.advance(e),this._root.depth=0}},e.prototype._findShrinkIndex=function(){if(0!==this._root.node.terminals.length||this._root.isLeaf())return-1;for(var e=null,t=this._root.node.children,n=0,r=0;r<t.length&&null==e;)e=t[n=r++];for(;r<t.length;)if(t[r++])return-1;return n},e.prototype._isDegenerate=function(e){var t=this._objectToBoundingSphere.getRadius(e);return!this._isValidRadius(t)},e.prototype._isValidRadius=function(e){return!isNaN(e)&&e!==-1/0&&e!==1/0&&e>0},e.prototype._fitsInsideTree=function(e){var t=this._root.center,n=this._root.halfSize,r=e.center;return e.radius<=n&&r[0]>=t[0]-n&&r[0]<=t[0]+n&&r[1]>=t[1]-n&&r[1]<=t[1]+n&&r[2]>=t[2]-n&&r[2]<=t[2]+n},e.prototype._boundingSphereFromObject=function(e,t){return i.vec3.copy(t.center,this._objectToBoundingSphere.getCenter(e)),t.radius=this._objectToBoundingSphere.getRadius(e),t},e.prototype._boundingSphereFromObjects=function(e,t,n,r){if(1===t){var a=n(e[0],A);i.vec3.copy(r.center,a.center),r.radius=a.radius}else{S[0]=1/0,S[1]=1/0,S[2]=1/0,O[0]=-1/0,O[1]=-1/0,O[2]=-1/0;for(var o=0;o<t;o++)a=n(e[o],A),this._isValidRadius(a.radius)&&(p(S,a.center,a.radius),u(O,a.center,a.radius));i.vec3.lerp(r.center,S,O,.5),r.radius=Math.max(O[0]-S[0],O[1]-S[1],O[2]-S[2])/2}return r},e}(),c=function(){function e(e,t,n){void 0===n&&(n=0),this.center=a.vec3f64.create(),this.initFrom(e,t,n,0)}return e.prototype.init=function(e){return this.initFrom(e.node,e.center,e.halfSize,e.depth)},e.prototype.initFrom=function(t,n,r,a){return void 0===t&&(t=null),void 0===r&&(r=this.halfSize),void 0===a&&(a=this.depth),this.node=t||e.createEmptyNode(),n&&i.vec3.copy(this.center,n),this.halfSize=r,this.depth=a,this},e.prototype.advance=function(t){var n=this.node.children[t];n||(n=e.createEmptyNode(),this.node.children[t]=n),this.node=n,this.halfSize/=2,this.depth++;var r=m[t];return this.center[0]+=r[0]*this.halfSize,this.center[1]+=r[1]*this.halfSize,this.center[2]+=r[2]*this.halfSize,this},e.prototype.advanceTo=function(e,t,n){for(void 0===n&&(n=!1);;){if(this.isTerminalFor(e))return t&&t(this,-1),!0;if(this.isLeaf()&&!n)return t&&t(this,-1),!1;this.isLeaf()&&(this.node.residents=null);var r=this._childIndex(e);t&&t(this,r),this.advance(r)}},e.prototype.isLeaf=function(){return null!=this.node.residents},e.prototype.isTerminalFor=function(e){return e.radius>this.halfSize/2},e.prototype._childIndex=function(e){for(var t=e.center,n=this.center,r=0,i=0;i<3;i++)n[i]<t[i]&&(r|=1<<i);return r},e.createEmptyNode=function(){return{children:[null,null,null,null,null,null,null,null],terminals:new r({shrink:!0}),residents:new r({shrink:!0})}},e.acquire=function(){return e._pool.acquire()},e.release=function(t){e._pool.release(t)},e.clearPool=function(){e._pool.prune()},e._pool=new n(e),e}();function p(e,t,n){e[0]=Math.min(e[0],t[0]-n),e[1]=Math.min(e[1],t[1]-n),e[2]=Math.min(e[2],t[2]-n)}function u(e,t,n){e[0]=Math.max(e[0],t[0]+n),e[1]=Math.max(e[1],t[1]+n),e[2]=Math.max(e[2],t[2]+n)}function d(e,t,n){return(n=n||e)[0]=e[0]+t,n[1]=e[1]+t,n[2]=e[2]+t,n}function h(e,t,n){return!o.frustum.intersectsSphere(n.planes,o.sphere.wrap(t,e))}function f(e,t){for(var n=1/0,r=null,i=0;i<8;++i){var a=v(e,t,g[i]);a<n&&(n=a,r=g[i])}return r}function v(e,t,n){return t*(e[0]*n[0]+e[1]*n[1]+e[2]*n[2])}var m=[a.vec3f64.fromValues(-1,-1,-1),a.vec3f64.fromValues(1,-1,-1),a.vec3f64.fromValues(-1,1,-1),a.vec3f64.fromValues(1,1,-1),a.vec3f64.fromValues(-1,-1,1),a.vec3f64.fromValues(1,-1,1),a.vec3f64.fromValues(-1,1,1),a.vec3f64.fromValues(1,1,1)],g=[a.vec3f64.fromValues(-1,-1,-1),a.vec3f64.fromValues(-1,-1,1),a.vec3f64.fromValues(-1,1,-1),a.vec3f64.fromValues(-1,1,1),a.vec3f64.fromValues(1,-1,-1),a.vec3f64.fromValues(1,-1,1),a.vec3f64.fromValues(1,1,-1),a.vec3f64.fromValues(1,1,1)],y=Math.sqrt(3),b=[null];function _(e){return Array.isArray(e)?e:(b[0]=e,b)}var x=a.vec3f64.create(),P=a.vec3f64.create(),S=a.vec3f64.create(),O=a.vec3f64.create(),w=new r,C={center:a.vec3f64.create(),radius:0},A={center:a.vec3f64.create(),radius:0},D={center:a.vec3f64.create(),radius:0},V={center:a.vec3f64.create(),radius:0},j=[{min:0,max:0},{min:0,max:0},{min:0,max:0}],R=new r,T=new r;return l}).apply(null,r))||(e.exports=i)},mmEe:function(e,t,n){var r,i;r=[n.dj.c(e.i),t,n("xoE+"),n("LxLY"),n("8uEs"),n("FXVB"),n("0LE5"),n("Rdxj"),n("Z4y+"),n("lRq4"),n("KDna"),n("83/a")],void 0===(i=(function(e,t,n,r,i,a,o,s,l,c,p,u){"use strict";var d,h,f,v,m,g,y,b;function _(e,t,n,r){return!(e.length<2)&&(2===e.length&&(H[0]=e[0],H[1]=e[1],H[2]=0,e=H),x(e,t,0,n,r,0,1))}function x(e,t,n,i,a,o,s){void 0===s&&(s=1);var l=z(t,a,W);if(r.isNone(l))return!1;if(l===S){if(e===i&&n===o)return!0;for(var c=n+3*s,p=n,u=o;p<c;p++,u++)i[u]=e[p];return!0}var d=n+3*s;for(p=n,u=o;p<d;p+=3,u+=3)l(e,p,i,u);return!0}function P(e,n){return n.spatialReference===e?n.spatialReferenceId:(n.spatialReference=e,"metersPerUnit"in n&&(n.metersPerUnit=i.getMetersPerUnitForSR(e,1)),n.spatialReferenceId=e.wkt===t.SphericalECEFSpatialReference.wkt?1:e.isWGS84?2:e.isWebMercator?3:e.wkt===t.WGS84ECEFSpatialReference.wkt?4:4490===e.wkid?5:0)}function S(e,t,n,r){e!==n&&(n[r++]=e[t++],n[r++]=e[t++],n[r]=e[t])}function O(e,t,n,r){n[r++]=k*(e[t++]/p.earthRadius),n[r++]=k*(Math.PI/2-2*Math.atan(Math.exp(-1*e[t++]/p.earthRadius))),n[r]=e[t]}function w(e,t,n,r){O(e,t,n,r),D(n,r,n,r)}function C(e,t,n,r){O(e,t,n,r),T(n,r,n,r)}function A(e,t,r,i){var a=.4999999*Math.PI,o=n.clamp(G*e[t+1],-a,a),s=Math.sin(o);r[i++]=G*e[t]*p.earthRadius,r[i++]=p.halfEarthRadius*Math.log((1+s)/(1-s)),r[i]=e[t+2]}function D(e,t,n,r){var i=p.earthRadius+e[t+2],a=G*e[t+1],o=G*e[t],s=Math.cos(a);n[r++]=Math.cos(o)*s*i,n[r++]=Math.sin(o)*s*i,n[r]=Math.sin(a)*i}function V(e,t,r,i){var a=u.Vec3Compact.length(e,t),o=n.asinClamped(e[t+2]/(0===a?1:a)),s=Math.atan2(e[t+1],e[t]);r[i++]=k*s,r[i++]=k*o,r[i]=a-p.earthRadius}function j(e,t,n,r){V(e,t,n,r),A(n,r,n,r)}function R(e,t,n,r){V(e,t,n,r),T(n,r,n,r)}function T(e,t,n,r){var i=p.earthEllipsoidConstants,a=G*e[t],o=G*e[t+1],s=e[t+2],l=Math.sin(o),c=Math.cos(o),u=i.a/Math.sqrt(1-i.e2*l*l);n[r++]=(u+s)*c*Math.cos(a),n[r++]=(u+s)*c*Math.sin(a),n[r++]=(u*(1-i.e2)+s)*l}function L(e,t,n,r){var i,a,o,s,l,c,u,d,h,f,v,m,g,y,b,_,x,P,S,O,w,C=p.earthEllipsoidConstants,A=e[t],D=e[t+1],V=e[t+2];i=Math.abs(V),a=A*A+D*D,o=Math.sqrt(a),s=a+V*V,l=Math.sqrt(s),O=Math.atan2(D,A),c=V*V/s,y=C.a2/l,b=C.a3-C.a4/l,(u=a/s)>.3?(d=i/l*(1+u*(C.a1+y+c*b)/l),S=Math.asin(d),f=d*d,h=Math.sqrt(1-f)):(h=o/l*(1-c*(C.a5-y-u*b)/l),S=Math.acos(h),f=1-h*h,d=Math.sqrt(f)),v=1-C.e2*f,m=C.a/Math.sqrt(v),S+=P=(_=h*(b=i-(g=C.a6*m)*d)-d*(y=o-m*h))/(g/v+(x=h*y+d*b)),w=x+_*P/2,V<0&&(S=-S),n[r++]=k*O,n[r++]=k*S,n[r]=w}function M(e,t,n,r){L(e,t,n,r),D(n,r,n,r)}function E(e,t,n,r){L(e,t,n,r),A(n,r,n,r)}Object.defineProperty(t,"__esModule",{value:!0}),t.getProjector=t.wgs84ComparableLonLatToECEF=t.vectorToWGS84ComparableLonLat=t.canProjectToWGS84ComparableLonLat=t.webMercator=t.boundingRectToBoundingRect=t.mbsToMbs=t.transformDirection=t.computeLinearTransformation=t.localLinearScaleFactors=t.bufferToBuffer=t.xyzToVector=t.pathsToPaths=t.vectorToVector=t.getProjectorName=t.canProject=t.WGS84ECEFSpatialReference=t.SphericalECEFSpatialReference=void 0,t.SphericalECEFSpatialReference=new l({wkt:'GEOCCS["Spherical geocentric",\n  DATUM["Not specified",\n    SPHEROID["Sphere",'+p.earthRadius+',0]],\n  PRIMEM["Greenwich",0.0,\n    AUTHORITY["EPSG","8901"]],\n  UNIT["m",1.0],\n  AXIS["Geocentric X",OTHER],\n  AXIS["Geocentric Y",EAST],\n  AXIS["Geocentric Z",NORTH]\n]'}),t.WGS84ECEFSpatialReference=new l({wkt:'GEOCCS["WGS 84",\n  DATUM["WGS_1984",\n    SPHEROID["WGS 84",6378137,298.257223563,\n      AUTHORITY["EPSG","7030"]],\n    AUTHORITY["EPSG","6326"]],\n  PRIMEM["Greenwich",0,\n    AUTHORITY["EPSG","8901"]],\n  UNIT["m",1.0,\n    AUTHORITY["EPSG","9001"]],\n  AXIS["Geocentric X",OTHER],\n  AXIS["Geocentric Y",OTHER],\n  AXIS["Geocentric Z",NORTH],\n  AUTHORITY["EPSG","4978"]\n]'}),t.canProject=function(e,t){return!!z(e,t,W)},t.getProjectorName=function(e,t){var n=z(e,t,W);return n===S?"copy3":n===D?"wgs84ToSphericalECEF":n===A?"wgs84ToWebMercator":n===T?"wgs84ToWGS84ECEF":n===O?"webMercatorToWGS84":n===w?"webMercatorToSphericalECEF":n===C?"webMercatorToWGS84ECEF":n===L?"wgs84ECEFToWGS84":n===M?"wgs84ECEFToSphericalECEF":n===E?"wgs84ECEFToWebMercator":n===V?"sphericalECEFToWGS84":n===j?"sphericalECEFToWebMercator":n===R?"sphericalECEFToWGS84ECEF":null},t.vectorToVector=_,t.pathsToPaths=function(e,t,n,r,i,a,o){void 0===o&&(o=0);for(var s=new Array,l=0,c=e;l<c.length;l++)for(var p=0,u=m=c[l];p<u.length;p++){var d=u[p];s.push(d[0],d[1],t?d[2]:o)}if(!x(s,r,0,s,a,0,s.length/3))return!1;var h=0;i.length=0;for(var f=0,v=e;f<v.length;f++){for(var m=v[f],g=new Array,y=0,b=m;y<b.length;y++)d=b[y],t&&n?g.push([s[h++],s[h++],s[h++],d[3]]):t?g.push([s[h++],s[h++],s[h++]]):n?(g.push([s[h++],s[h++],d[2]]),h++):(g.push([s[h++],s[h++]]),h++);i.push(g)}return!0},t.xyzToVector=function(e,t,n,r,i,a){return H[0]=e,H[1]=t,H[2]=n,x(H,r,0,i,a,0,1)},t.bufferToBuffer=x,t.localLinearScaleFactors=function(e,t,n,r){var i=P(t,U),a=P(r,q);if(i===a&&0!==i||t.equals(r))return n[0]=1,n[1]=1,n[2]=1,!0;if(1===i){var s=o.vec3.length(e),l=s/Math.sqrt(e[0]*e[0]+e[1]*e[1]),c=s/p.earthRadius;if(3===a)return n[0]=l*c,n[1]=l*c,n[2]=1,!0;if(2===a||5===a){var u=180/(p.earthRadius*Math.PI);return n[0]=u*l*c,n[1]=u*c,n[2]=1,!0}}return!1},t.computeLinearTransformation=function(e,t,n,i){var o=P(e,U),s=P(i,q);if(o===s&&1!==s&&(0!==o||e.equals(i)))return a.mat4.identity(n),a.mat4.translate(n,n,t),!0;if(1===s){var l=I[o][6],c=I[6][s];if(r.isNone(l)||r.isNone(c))return!1;l(t,0,X,0),c(X,0,Y,0);var p=G*X[0],u=G*X[1],d=Math.sin(p),h=Math.cos(p),f=Math.sin(u),v=Math.cos(u),m=n;return m[0]=-d,m[4]=-f*h,m[8]=v*h,m[12]=Y[0],m[1]=h,m[5]=-f*d,m[9]=v*d,m[13]=Y[1],m[2]=0,m[6]=v,m[10]=f,m[14]=Y[2],m[3]=0,m[7]=0,m[11]=0,m[15]=1,!0}if(3===s&&(2===o||1===o)){if(r.isNone(l=I[o][6]))return!1;l(t,0,X,0);var g=G*X[1];A(X,0,Y,0),a.mat4.identity(n),a.mat4.translate(n,n,Y);var y=1/Math.cos(g);return a.mat4.scale(n,n,[y,y,1]),!0}return!1},t.transformDirection=function(e,t,n,r,i){o.vec3.copy(Z,e),o.vec3.add(J,e,t),_(Z,n,Z,i),_(J,n,J,i),o.vec3.subtract(r,J,Z),o.vec3.normalize(r,r)},t.mbsToMbs=function(e,t,n,i){var a=N(t,i,B);if(a.projector===S)return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],!0;if(r.isNone(a.projector))return!1;var o=a.source,s=a.dest;if(3===s.spatialReferenceId){var l=I[o.spatialReferenceId][2];if(r.isNone(l))return!1;l(e,0,X,0);var c=Math.abs(G*X[1])+Math.asin(e[3]/(p.earthRadius+e[2]));if(A(X,0,n,0),c>.9999*Math.PI)n[3]=Number.MAX_VALUE;else{var u=1/Math.cos(c);n[3]=u*e[3]}return!0}return a.projector(e,0,n,0),n[3]=e[3]*o.metersPerUnit/s.metersPerUnit,!0},t.boundingRectToBoundingRect=function(e,t,n,r){return!(null==e||(t.equals(r)?(c.set(n,e),0):(H[0]=e[0],H[1]=e[1],H[2]=0,!x(H,t,0,H,r,0,1)||(n[0]=H[0],n[1]=H[1],H[0]=e[2],H[1]=e[3],H[2]=0,!x(H,t,0,H,r,0,1)||(n[2]=H[0],n[3]=H[1],0)))))},function(e){e.x2lon=function(e){return e/p.earthRadius},e.y2lat=function(e){return Math.PI/2-2*Math.atan(Math.exp(-1*e/p.earthRadius))},e.lon2x=function(e){return e*p.earthRadius},e.lat2y=function(e){var t=Math.sin(e);return p.earthRadius/2*Math.log((1+t)/(1-t))}}(t.webMercator||(t.webMercator={})),t.canProjectToWGS84ComparableLonLat=function(e){var t=P(e,U);return!!I[t][6]},t.vectorToWGS84ComparableLonLat=function(e,t,n){var i=P(t,U),a=I[i][6];return!r.isNone(a)&&(a(e,0,H,0),n!==H&&(n[0]=H[0],n[1]=H[1],n.length>2&&(n[2]=H[2])),!0)},t.wgs84ComparableLonLatToECEF=function(e,t,n,r){void 0===r&&(r=0);var i=p.earthRadius+r,a=Math.cos(n);e[0]=Math.cos(t)*a*i,e[1]=Math.sin(t)*a*i,e[2]=Math.sin(n)*i};var I=((d={})[2]=((h={})[5]=null,h[6]=S,h[1]=D,h[0]=null,h[3]=A,h[2]=S,h[4]=T,h),d[5]=((f={})[5]=S,f[6]=S,f[1]=D,f[0]=null,f[3]=null,f[2]=null,f[4]=T,f),d[3]=((v={})[5]=null,v[6]=O,v[1]=w,v[0]=null,v[3]=S,v[2]=O,v[4]=C,v),d[4]=((m={})[5]=L,m[6]=L,m[1]=M,m[0]=null,m[3]=E,m[2]=L,m[4]=S,m),d[1]=((g={})[5]=V,g[6]=V,g[1]=S,g[0]=null,g[3]=j,g[2]=V,g[4]=R,g),d[0]=((y={})[5]=null,y[6]=null,y[1]=null,y[0]=S,y[3]=null,y[2]=null,y[4]=null,y),d[6]=((b={})[5]=null,b[6]=S,b[1]=D,b[0]=null,b[3]=null,b[2]=S,b[4]=T,b),d);function z(e,t,n){return void 0===n&&(n=F()),N(e,t,n).projector}function N(e,t,n){if(n.source.spatialReference===e&&n.dest.spatialReference===t)return n;var r=P(e,n.source),i=P(t,n.dest);return n.projector=0===r&&0===i?e.equals(t)?S:null:I[r][i],n}function F(){return{source:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},projector:S}}t.getProjector=z;var U={spatialReference:null,spatialReferenceId:0},q={spatialReference:null,spatialReferenceId:0},W=F(),B=F(),G=n.deg2rad(1),k=n.rad2deg(1),H=s.vec3f64.create(),X=s.vec3f64.create(),Y=s.vec3f64.create(),Z=s.vec3f64.create(),J=s.vec3f64.create()}).apply(null,r))||(e.exports=i)},ne9J:function(e,t,n){var r,i;r=[n.dj.c(e.i),t,n("zOht"),n("fese"),n("E/g4"),n("7zqm"),n("quQL"),n("IwVr"),n("7Aei"),n("aExC")],void 0===(i=(function(e,t,n,r,i,a,o,s,l,c){"use strict";var p,u,d,h,f,v,m,g,y,b,_,x,P,S,O,w,C,A,D,V,j,R,T,L,M,E;Object.defineProperty(t,"__esModule",{value:!0}),t.build=void 0,t.build=function(e){var t=new c.ShaderBuilder;t.extensions.add("GL_OES_standard_derivatives"),t.include(o.PiUtils),t.include(i.RibbonVertexPosition,e),t.include(a.LineStipple,e),t.vertex.uniforms.add("proj","mat4").add("view","mat4").add("nearPlane","float").add("pixelRatio","float").add("miterLimit","float").add("screenSize","vec2"),t.attributes.add("position","vec3"),t.attributes.add("subdivisionFactor","float"),t.attributes.add("uv0","vec2"),t.attributes.add("auxpos1","vec3"),t.attributes.add("auxpos2","vec3"),t.varyings.add("vColor","vec4"),t.varyings.add("vpos","vec3");var I=e.falloffEnabled,z=e.innerColorEnabled;return z&&t.varyings.add("vLineDistance","float"),I&&t.varyings.add("vLineDistanceNorm","float"),e.falloffEnabled&&t.fragment.uniforms.add("falloff","float"),e.innerColorEnabled&&(t.fragment.uniforms.add("innerColor","vec4"),t.fragment.uniforms.add("innerWidth","float")),t.vertex.code.add(l.glsl(p||(p=n.__makeTemplateObject(["\n\t\t#define PERPENDICULAR(v) vec2(v.y, -v.x);\n\t\t#define ISOUTSIDE (left.x * right.y - left.y * right.x)*uv0.y > 0.0\n\n\t\tfloat interp(float ncp, vec4 a, vec4 b) {\n\t\t\treturn (-ncp - a.z) / (b.z - a.z);\n\t\t}\n\n\t\tvec2 rotate(vec2 v, float a) {\n\t\t\tfloat s = sin(a);\n\t\t\tfloat c = cos(a);\n\t\t\tmat2 m = mat2(c, -s, s, c);\n\t\t\treturn m * v;\n\t\t}\n"],["\n\t\t#define PERPENDICULAR(v) vec2(v.y, -v.x);\n\t\t#define ISOUTSIDE (left.x * right.y - left.y * right.x)*uv0.y > 0.0\n\n\t\tfloat interp(float ncp, vec4 a, vec4 b) {\n\t\t\treturn (-ncp - a.z) / (b.z - a.z);\n\t\t}\n\n\t\tvec2 rotate(vec2 v, float a) {\n\t\t\tfloat s = sin(a);\n\t\t\tfloat c = cos(a);\n\t\t\tmat2 m = mat2(c, -s, s, c);\n\t\t\treturn m * v;\n\t\t}\n"])))),t.vertex.code.add(l.glsl(u||(u=n.__makeTemplateObject(["\n    vec4 projectAndScale(vec4 pos) {\n      vec4 posNdc = proj * pos;\n\n      // Note that posNdc is in -1:1, scaling by screenSize converts this to a coordinate system\n      // that is twice scaled (going from -size:size).\n      posNdc.xy *= screenSize / posNdc.w;\n      return posNdc;\n    }\n"],["\n    vec4 projectAndScale(vec4 pos) {\n      vec4 posNdc = proj * pos;\n\n      // Note that posNdc is in -1:1, scaling by screenSize converts this to a coordinate system\n      // that is twice scaled (going from -size:size).\n      posNdc.xy *= screenSize / posNdc.w;\n      return posNdc;\n    }\n"])))),t.vertex.code.add(l.glsl(d||(d=n.__makeTemplateObject(["\n    void clipAndTransform(inout vec4 pos, inout vec4 prev, inout vec4 next, in bool isStartVertex) {\n      float vnp = nearPlane*0.99;\n\n      //current pos behind ncp --\x3e we need to clip\n      if(pos.z > -nearPlane) {\n        if (!isStartVertex) {\n          //previous in front of ncp\n          if(prev.z < -nearPlane) {\n            pos = mix(prev, pos, interp(vnp, prev, pos));\n            next = pos;\n          } else {\n            pos = vec4(0.0, 0.0, 0.0, 1.0);\n          }\n        }\n        //next in front of ncp\n        if(isStartVertex) {\n          if(next.z < -nearPlane) {\n            pos = mix(pos, next, interp(vnp, pos, next));\n            prev = pos;\n          } else {\n            pos = vec4(0.0, 0.0, 0.0, 1.0);\n          }\n        }\n      } else {\n        //current position visible\n        //previous behind ncp\n        if (prev.z > -nearPlane) {\n          prev = mix(pos, prev, interp(vnp, pos, prev));\n        }\n        //next behind ncp\n        if (next.z > -nearPlane) {\n          next = mix(next, pos, interp(vnp, next, pos));\n        }\n      }\n\n      pos = projectAndScale(pos);\n      next = projectAndScale(next);\n      prev = projectAndScale(prev);\n    }\n"],["\n    void clipAndTransform(inout vec4 pos, inout vec4 prev, inout vec4 next, in bool isStartVertex) {\n      float vnp = nearPlane*0.99;\n\n      //current pos behind ncp --\x3e we need to clip\n      if(pos.z > -nearPlane) {\n        if (!isStartVertex) {\n          //previous in front of ncp\n          if(prev.z < -nearPlane) {\n            pos = mix(prev, pos, interp(vnp, prev, pos));\n            next = pos;\n          } else {\n            pos = vec4(0.0, 0.0, 0.0, 1.0);\n          }\n        }\n        //next in front of ncp\n        if(isStartVertex) {\n          if(next.z < -nearPlane) {\n            pos = mix(pos, next, interp(vnp, pos, next));\n            prev = pos;\n          } else {\n            pos = vec4(0.0, 0.0, 0.0, 1.0);\n          }\n        }\n      } else {\n        //current position visible\n        //previous behind ncp\n        if (prev.z > -nearPlane) {\n          prev = mix(pos, prev, interp(vnp, pos, prev));\n        }\n        //next behind ncp\n        if (next.z > -nearPlane) {\n          next = mix(next, pos, interp(vnp, next, pos));\n        }\n      }\n\n      pos = projectAndScale(pos);\n      next = projectAndScale(next);\n      prev = projectAndScale(prev);\n    }\n"])))),t.vertex.code.add(l.glsl(h||(h=n.__makeTemplateObject(["\n  void main(void) {\n    float coverage = 1.0;\n    vpos = position;\n\n    // Check for special value of uv0.y which is used by the Renderer when graphics\n    // are removed before the VBO is recompacted. If this is the case, then we just\n    // project outside of clip space.\n    if (uv0.y == 0.0) {\n      // Project out of clip space\n      gl_Position = vec4(1e038, 1e038, 1e038, 1.0);\n    }\n    else {\n      bool isStartVertex = abs(abs(uv0.y)-3.0) == 1.0;\n      bool isJoin = abs(uv0.y)-3.0 < 0.0;\n\n      float lineWidth = getSize() * pixelRatio;\n\n      // convert sub-pixel coverage to alpha\n      if (lineWidth < 1.0) {\n        coverage = lineWidth;\n        lineWidth = 1.0;\n      }else{\n        // Ribbon lines cannot properly render non-integer sizes. Round width to integer size if\n        // larger than one for better quality. Note that we do render < 1 pixels more or less correctly\n        // so we only really care to round anything larger than 1.\n        lineWidth = floor(lineWidth + 0.5);\n      }\n\n      vec4 pos  = view * vec4(position.xyz, 1.0);\n      vec4 prev = view * vec4(auxpos1.xyz, 1.0);\n      vec4 next = view * vec4(auxpos2.xyz, 1.0);\n\n      clipAndTransform(pos, prev, next, isStartVertex);\n\n      vec2 left = (pos.xy - prev.xy);\n      vec2 right = (next.xy - pos.xy);\n\n      float leftLen = length(left);\n      float rightLen = length(right);\n  "],["\n  void main(void) {\n    float coverage = 1.0;\n    vpos = position;\n\n    // Check for special value of uv0.y which is used by the Renderer when graphics\n    // are removed before the VBO is recompacted. If this is the case, then we just\n    // project outside of clip space.\n    if (uv0.y == 0.0) {\n      // Project out of clip space\n      gl_Position = vec4(1e038, 1e038, 1e038, 1.0);\n    }\n    else {\n      bool isStartVertex = abs(abs(uv0.y)-3.0) == 1.0;\n      bool isJoin = abs(uv0.y)-3.0 < 0.0;\n\n      float lineWidth = getSize() * pixelRatio;\n\n      // convert sub-pixel coverage to alpha\n      if (lineWidth < 1.0) {\n        coverage = lineWidth;\n        lineWidth = 1.0;\n      }else{\n        // Ribbon lines cannot properly render non-integer sizes. Round width to integer size if\n        // larger than one for better quality. Note that we do render < 1 pixels more or less correctly\n        // so we only really care to round anything larger than 1.\n        lineWidth = floor(lineWidth + 0.5);\n      }\n\n      vec4 pos  = view * vec4(position.xyz, 1.0);\n      vec4 prev = view * vec4(auxpos1.xyz, 1.0);\n      vec4 next = view * vec4(auxpos2.xyz, 1.0);\n\n      clipAndTransform(pos, prev, next, isStartVertex);\n\n      vec2 left = (pos.xy - prev.xy);\n      vec2 right = (next.xy - pos.xy);\n\n      float leftLen = length(left);\n      float rightLen = length(right);\n  "])))),e.stippleEnabled&&t.vertex.code.add(l.glsl(f||(f=n.__makeTemplateObject(["\n      // uv0.x is either 0 or 1, depending on whether this is considered the start of a line segment\n      // or the end. If start, then use pos->next, otherwise use prev->pos to define the line segment\n      // vector\n      vec4 stippleSegmentInfo = mix(vec4(pos.xy, right), vec4(prev.xy, left), uv0.x);\n      vec2 stippleSegmentOrigin = stippleSegmentInfo.xy;\n\n      // Scale s.t. it's in units of stipple pattern size.\n      vec2 stippleSegmentDirection = stippleSegmentInfo.zw;\n    "],["\n      // uv0.x is either 0 or 1, depending on whether this is considered the start of a line segment\n      // or the end. If start, then use pos->next, otherwise use prev->pos to define the line segment\n      // vector\n      vec4 stippleSegmentInfo = mix(vec4(pos.xy, right), vec4(prev.xy, left), uv0.x);\n      vec2 stippleSegmentOrigin = stippleSegmentInfo.xy;\n\n      // Scale s.t. it's in units of stipple pattern size.\n      vec2 stippleSegmentDirection = stippleSegmentInfo.zw;\n    "])))),t.vertex.code.add(l.glsl(v||(v=n.__makeTemplateObject(['\n    left = (leftLen > 0.001) ? left/leftLen : vec2(0.0, 0.0);\n    right = (rightLen > 0.001) ? right/rightLen : vec2(0.0, 0.0);\n\n    vec2 capDisplacementDir = vec2(0, 0);\n    vec2 joinDisplacementDir = vec2(0, 0);\n    float displacementLen = lineWidth;\n\n    if (isJoin) {\n\n      // JOIN handling ---------------------------------------------------\n      // determine if vertex is on the "outside or "inside" of the join\n      bool isOutside = ISOUTSIDE;\n\n      // compute miter join position first\n      joinDisplacementDir = normalize(left + right);\n      joinDisplacementDir = PERPENDICULAR(joinDisplacementDir);\n\n      // compute miter stretch\n      if (leftLen > 0.001 && rightLen > 0.001) {\n        float nDotSeg = dot(joinDisplacementDir, left);\n        displacementLen /= length(nDotSeg * left - joinDisplacementDir);\n\n        // limit displacement of inner vertices\n        if (!isOutside) {\n          displacementLen = min(displacementLen, min(leftLen, rightLen)/abs(nDotSeg));\n        }\n      }\n\n      if (isOutside && (displacementLen > miterLimit * lineWidth)) {\n    '],['\n    left = (leftLen > 0.001) ? left/leftLen : vec2(0.0, 0.0);\n    right = (rightLen > 0.001) ? right/rightLen : vec2(0.0, 0.0);\n\n    vec2 capDisplacementDir = vec2(0, 0);\n    vec2 joinDisplacementDir = vec2(0, 0);\n    float displacementLen = lineWidth;\n\n    if (isJoin) {\n\n      // JOIN handling ---------------------------------------------------\n      // determine if vertex is on the "outside or "inside" of the join\n      bool isOutside = ISOUTSIDE;\n\n      // compute miter join position first\n      joinDisplacementDir = normalize(left + right);\n      joinDisplacementDir = PERPENDICULAR(joinDisplacementDir);\n\n      // compute miter stretch\n      if (leftLen > 0.001 && rightLen > 0.001) {\n        float nDotSeg = dot(joinDisplacementDir, left);\n        displacementLen /= length(nDotSeg * left - joinDisplacementDir);\n\n        // limit displacement of inner vertices\n        if (!isOutside) {\n          displacementLen = min(displacementLen, min(leftLen, rightLen)/abs(nDotSeg));\n        }\n      }\n\n      if (isOutside && (displacementLen > miterLimit * lineWidth)) {\n    '])))),t.vertex.code.add(l.glsl(e.roundJoins?m||(m=n.__makeTemplateObject(["\n        vec2 startDir;\n        vec2 endDir;\n\n        if (leftLen < 0.001) {\n          startDir = right;\n        }\n        else{\n          startDir = left;\n        }\n        startDir = normalize(startDir);\n        startDir = PERPENDICULAR(startDir);\n\n        if (rightLen < 0.001) {\n          endDir = left;\n        }\n        else{\n          endDir = right;\n        }\n        endDir = normalize(endDir);\n        endDir = PERPENDICULAR(endDir);\n\n        float rotationAngle = acos(clamp(dot(startDir, endDir), -1.0, 1.0));\n        joinDisplacementDir = rotate(startDir, -sign(uv0.y) * subdivisionFactor * rotationAngle);\n      "],["\n        vec2 startDir;\n        vec2 endDir;\n\n        if (leftLen < 0.001) {\n          startDir = right;\n        }\n        else{\n          startDir = left;\n        }\n        startDir = normalize(startDir);\n        startDir = PERPENDICULAR(startDir);\n\n        if (rightLen < 0.001) {\n          endDir = left;\n        }\n        else{\n          endDir = right;\n        }\n        endDir = normalize(endDir);\n        endDir = PERPENDICULAR(endDir);\n\n        float rotationAngle = acos(clamp(dot(startDir, endDir), -1.0, 1.0));\n        joinDisplacementDir = rotate(startDir, -sign(uv0.y) * subdivisionFactor * rotationAngle);\n      "])):g||(g=n.__makeTemplateObject(["\n        // convert to bevel join if miterLimit is exceeded\n        if (leftLen < 0.001) {\n          joinDisplacementDir = right;\n        }\n        else if (rightLen < 0.001) {\n          joinDisplacementDir = left;\n        }\n        else {\n          joinDisplacementDir = isStartVertex ? right : left;\n        }\n        joinDisplacementDir = normalize(joinDisplacementDir);\n        joinDisplacementDir = PERPENDICULAR(joinDisplacementDir);\n  "],["\n        // convert to bevel join if miterLimit is exceeded\n        if (leftLen < 0.001) {\n          joinDisplacementDir = right;\n        }\n        else if (rightLen < 0.001) {\n          joinDisplacementDir = left;\n        }\n        else {\n          joinDisplacementDir = isStartVertex ? right : left;\n        }\n        joinDisplacementDir = normalize(joinDisplacementDir);\n        joinDisplacementDir = PERPENDICULAR(joinDisplacementDir);\n  "])))),t.vertex.code.add(l.glsl(y||(y=n.__makeTemplateObject(["\n        displacementLen = lineWidth;\n      }\n    } else {\n    // CAP handling ---------------------------------------------------\n    if (leftLen < 0.001) {\n      joinDisplacementDir = right;\n    }\n    else if (rightLen < 0.001) {\n      joinDisplacementDir = left;\n    }\n    else {\n      joinDisplacementDir = isStartVertex ? right : left;\n    }\n    joinDisplacementDir = normalize(joinDisplacementDir);\n    joinDisplacementDir = PERPENDICULAR(joinDisplacementDir);\n    displacementLen = lineWidth;\n\n    capDisplacementDir = isStartVertex ? -right : left;\n  "],["\n        displacementLen = lineWidth;\n      }\n    } else {\n    // CAP handling ---------------------------------------------------\n    if (leftLen < 0.001) {\n      joinDisplacementDir = right;\n    }\n    else if (rightLen < 0.001) {\n      joinDisplacementDir = left;\n    }\n    else {\n      joinDisplacementDir = isStartVertex ? right : left;\n    }\n    joinDisplacementDir = normalize(joinDisplacementDir);\n    joinDisplacementDir = PERPENDICULAR(joinDisplacementDir);\n    displacementLen = lineWidth;\n\n    capDisplacementDir = isStartVertex ? -right : left;\n  "])))),t.vertex.code.add(l.glsl(e.roundCaps?b||(b=n.__makeTemplateObject(["\n    float angle = subdivisionFactor*PI*0.5;\n    joinDisplacementDir *= cos(angle);\n    capDisplacementDir *= sin(angle);\n    "],["\n    float angle = subdivisionFactor*PI*0.5;\n    joinDisplacementDir *= cos(angle);\n    capDisplacementDir *= sin(angle);\n    "])):_||(_=n.__makeTemplateObject(["\n    capDisplacementDir *= subdivisionFactor;\n    "],["\n    capDisplacementDir *= subdivisionFactor;\n    "])))),t.vertex.code.add(l.glsl(O||(O=n.__makeTemplateObject(["\n  }\n\n  // Displacement (in pixels) caused by join/or cap\n  vec2 dpos = joinDisplacementDir * sign(uv0.y) * displacementLen + capDisplacementDir * displacementLen;\n\n  ","\n\n  ","\n  ","\n\n  pos.xy += dpos;\n  "],["\n  }\n\n  // Displacement (in pixels) caused by join/or cap\n  vec2 dpos = joinDisplacementDir * sign(uv0.y) * displacementLen + capDisplacementDir * displacementLen;\n\n  ","\n\n  ","\n  ","\n\n  pos.xy += dpos;\n  "])),I||z?l.glsl(x||(x=n.__makeTemplateObject(["float lineDist = lineWidth * sign(uv0.y) * pos.w;"],["float lineDist = lineWidth * sign(uv0.y) * pos.w;"]))):"",z?l.glsl(P||(P=n.__makeTemplateObject(["vLineDistance = lineDist;"],["vLineDistance = lineDist;"]))):"",I?l.glsl(S||(S=n.__makeTemplateObject(["vLineDistanceNorm = lineDist / lineWidth;"],["vLineDistanceNorm = lineDist / lineWidth;"]))):"")),e.stippleEnabled&&(t.vertex.code.add(l.glsl(w||(w=n.__makeTemplateObject(["\n    {\n      // Compute the stipple pattern UV coordinate from the actual position, based on the origin\n      // and direction of the line segment on which the stipple pattern is based.\n\n      // Project the vector from the origin of the segment to the vertex onto the line segment.\n      // Note the 0.5 factor due to projected positions being at twice the screen size scale (see projectAndScale)\n      vec2 posVec = pos.xy - stippleSegmentOrigin;\n\n      float stippleSegmentDirectionLength = length(stippleSegmentDirection);\n    "],["\n    {\n      // Compute the stipple pattern UV coordinate from the actual position, based on the origin\n      // and direction of the line segment on which the stipple pattern is based.\n\n      // Project the vector from the origin of the segment to the vertex onto the line segment.\n      // Note the 0.5 factor due to projected positions being at twice the screen size scale (see projectAndScale)\n      vec2 posVec = pos.xy - stippleSegmentOrigin;\n\n      float stippleSegmentDirectionLength = length(stippleSegmentDirection);\n    "])))),e.stippleIntegerRepeatsEnabled&&t.vertex.code.add(l.glsl(C||(C=n.__makeTemplateObject(["\n      float numberOfPatternRepeats = stippleSegmentDirectionLength * 0.5 * stipplePatternPixelSizeInv;\n      float roundedNumberOfPatternRepeats = max(1.0, floor(numberOfPatternRepeats + 0.5));\n      stipplePatternUvMax = roundedNumberOfPatternRepeats;\n      "],["\n      float numberOfPatternRepeats = stippleSegmentDirectionLength * 0.5 * stipplePatternPixelSizeInv;\n      float roundedNumberOfPatternRepeats = max(1.0, floor(numberOfPatternRepeats + 0.5));\n      stipplePatternUvMax = roundedNumberOfPatternRepeats;\n      "])))),t.vertex.code.add(l.glsl(A||(A=n.__makeTemplateObject(["\n      if (stippleSegmentDirectionLength >= 0.001) {\n        // Project the vertex position onto the line segment.\n        float projectedLength = dot(stippleSegmentDirection, posVec) / stippleSegmentDirectionLength * 0.5;\n     ","\n        stipplePatternUv = projectedLength * wholeNumberOfRepeatsScale * stipplePatternPixelSizeInv * pos.w;\n        } else {\n          stipplePatternUv = 1.0;\n        }\n      }\n    "],["\n      if (stippleSegmentDirectionLength >= 0.001) {\n        // Project the vertex position onto the line segment.\n        float projectedLength = dot(stippleSegmentDirection, posVec) / stippleSegmentDirectionLength * 0.5;\n     ","\n        stipplePatternUv = projectedLength * wholeNumberOfRepeatsScale * stipplePatternPixelSizeInv * pos.w;\n        } else {\n          stipplePatternUv = 1.0;\n        }\n      }\n    "])),e.stippleIntegerRepeatsEnabled?"float wholeNumberOfRepeatsScale = roundedNumberOfPatternRepeats / numberOfPatternRepeats;":"float wholeNumberOfRepeatsScale = 1.0;"))),t.vertex.code.add(l.glsl(D||(D=n.__makeTemplateObject(["\n      // Convert back into NDC\n      pos.xy = pos.xy / screenSize * pos.w;\n\n      vColor = getColor();\n      vColor.a *= coverage;\n\n      gl_Position = pos;\n    }\n  }\n  "],["\n      // Convert back into NDC\n      pos.xy = pos.xy / screenSize * pos.w;\n\n      vColor = getColor();\n      vColor.a *= coverage;\n\n      gl_Position = pos;\n    }\n  }\n  "])))),t.include(r.Slice,e),t.fragment.uniforms.add("intrinsicColor","vec4"),t.fragment.code.add(l.glsl(V||(V=n.__makeTemplateObject(["\n  void main() {\n    discardBySlice(vpos);\n    float stippleAlpha = getStippleAlpha();\n    discardByStippleAlpha(stippleAlpha, STIPPLE_ALPHA_COLOR_DISCARD);\n\n    vec4 color = intrinsicColor * vColor;\n  "],["\n  void main() {\n    discardBySlice(vpos);\n    float stippleAlpha = getStippleAlpha();\n    discardByStippleAlpha(stippleAlpha, STIPPLE_ALPHA_COLOR_DISCARD);\n\n    vec4 color = intrinsicColor * vColor;\n  "])))),e.innerColorEnabled&&(t.fragment.uniforms.add("pixelRatio","float"),t.fragment.code.add(l.glsl(j||(j=n.__makeTemplateObject(["\n    float distToInner = abs(vLineDistance * gl_FragCoord.w) - innerWidth;\n    float innerAA = clamp(0.5 - distToInner, 0.0, 1.0);\n    float innerAlpha = innerColor.a + color.a * (1.0 - innerColor.a);\n    color = mix(color, vec4(innerColor.rgb, innerAlpha), innerAA);\n    "],["\n    float distToInner = abs(vLineDistance * gl_FragCoord.w) - innerWidth;\n    float innerAA = clamp(0.5 - distToInner, 0.0, 1.0);\n    float innerAlpha = innerColor.a + color.a * (1.0 - innerColor.a);\n    color = mix(color, vec4(innerColor.rgb, innerAlpha), innerAA);\n    "]))))),t.fragment.code.add(l.glsl(R||(R=n.__makeTemplateObject(["\n    vec4 finalColor = blendStipple(color, stippleAlpha);\n  "],["\n    vec4 finalColor = blendStipple(color, stippleAlpha);\n  "])))),e.falloffEnabled&&t.fragment.code.add(l.glsl(T||(T=n.__makeTemplateObject(["\n    finalColor.a *= pow(max(0.0, 1.0 - abs(vLineDistanceNorm * gl_FragCoord.w)), falloff);\n    "],["\n    finalColor.a *= pow(max(0.0, 1.0 - abs(vLineDistanceNorm * gl_FragCoord.w)), falloff);\n    "])))),t.fragment.code.add(l.glsl(E||(E=n.__makeTemplateObject(["\n    if (finalColor.a < ",") {\n      discard;\n    }\n\n    ","\n    ","\n  }\n  "],["\n    if (finalColor.a < ",") {\n      discard;\n    }\n\n    ","\n    ","\n  }\n  "])),l.glsl.float(s.symbolAlphaCutoff),0===e.output?l.glsl(L||(L=n.__makeTemplateObject(["gl_FragColor = highlightSlice(finalColor, vpos);"],["gl_FragColor = highlightSlice(finalColor, vpos);"]))):"",4===e.output?l.glsl(M||(M=n.__makeTemplateObject(["gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);"],["gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);"]))):"")),t}}).apply(null,r))||(e.exports=i)},o5p5:function(e,t,n){var r,i;r=[n.dj.c(e.i),t,n("zOht"),n("tUyH"),n("FNtW"),n("LZD4"),n("s6rJ"),n("s6rJ"),n("EiS2")],void 0===(i=(function(e,t,n,r,i,a,o,s,l){"use strict";var c=function(e){function t(t,n){var r=e.call(this,n)||this;return r.supportsEdges=!0,r.techniqueConfig=new l.ColorMaterialTechniqueConfiguration,r.params=s.copyParameters(t,u),r}return n.__extends(t,e),t.prototype.setParameterValues=function(e){o.updateParameters(this.params,e)&&this.parametersChanged()},t.prototype.getParameters=function(){return this.params},t.prototype.getTechniqueConfig=function(e){return this.techniqueConfig.output=e,this.techniqueConfig.cullFace=this.params.cullFace,this.techniqueConfig.vertexColors=this.params.vertexColors,this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled,this.techniqueConfig.transparent=this.params.transparent,this.techniqueConfig.polygonOffset=this.params.polygonOffset,this.techniqueConfig.writeDepth=this.params.writeDepth,this.techniqueConfig.sceneHasOcludees=this.params.sceneHasOcludees,this.techniqueConfig},t.prototype.getPassParameters=function(){return this.params},t.prototype.intersect=function(e,t,n,r,i,a,o){s.intersectTriangleGeometry(e,t,r,i,a,void 0,o)},t.prototype.getGLMaterial=function(e){return 0===e.output||4===e.output?new p(e):void 0},t.prototype.createBufferWriter=function(){return new a.DefaultBufferWriter(a.PositionColorLayout)},t}(i.Material),p=function(e){function t(t){var n=e.call(this,t)||this;return n.updateParameters(),n}return n.__extends(t,e),t.prototype.updateParameters=function(){this.technique=this.techniqueRep.acquireAndReleaseExisting(l.ColorMaterialTechnique,this.material.getTechniqueConfig(this.output),this.technique)},t.prototype.beginSlot=function(e){return 4===this.output?3===e:e===(this.technique.configuration.transparent?this.technique.configuration.writeDepth?5:8:3)},t.prototype._updateOccludeeState=function(e){e.hasOccludees!==this.material.getParameters().sceneHasOcludees&&(this.material.setParameterValues({sceneHasOcludees:e.hasOccludees}),this.updateParameters())},t.prototype.ensureParameters=function(e){0===this.output&&this._updateOccludeeState(e)},t.prototype.bind=function(e,t){e.bindProgram(this.technique.program),this.technique.bindPass(e,this.material.getPassParameters(),t)},t.prototype.getPipelineState=function(e,t){return t?this.technique.opaqueOccludeeState:this.technique.pipeline},t}(r.GLMaterial),u={color:[1,1,1,1],transparent:!1,writeDepth:!0,vertexColors:!1,polygonOffset:!1,slicePlaneEnabled:!1,cullFace:0,sceneHasOcludees:!1};return c}).apply(null,r))||(e.exports=i)},qSzK:function(e,t,n){var r,i;r=[n.dj.c(e.i),t,n("zOht"),n("xoE+"),n("hk44"),n("0W55"),n("7Aei"),n("aExC")],void 0===(i=(function(e,t,n,r,i,a,o,s){"use strict";var l,c,p,u,d,h,f,v,m,g;Object.defineProperty(t,"__esModule",{value:!0}),t.build=t.defaultAngleCutoff=void 0,t.defaultAngleCutoff=r.deg2rad(6),t.build=function(e){var t=new s.ShaderBuilder;return t.extensions.add("GL_OES_standard_derivatives"),t.include(a.ScreenSpacePass),t.include(i.Laserline,e),t.fragment.uniforms.add("angleCutoff","vec2"),t.fragment.uniforms.add("globalAlpha","float"),e.heightManifoldEnabled&&t.fragment.uniforms.add("heightPlane","vec4"),e.pointDistanceEnabled&&t.fragment.uniforms.add("pointDistanceSphere","vec4"),e.lineVerticalPlaneEnabled&&t.fragment.uniforms.add("lineVerticalPlane","vec4").add("lineVerticalStart","vec3").add("lineVerticalEnd","vec3"),(e.heightManifoldEnabled||e.pointDistanceEnabled||e.lineVerticalPlaneEnabled)&&t.fragment.uniforms.add("maxPixelDistance","float"),e.intersectsLineEnabled&&t.fragment.uniforms.add("intersectsLineStart","vec3").add("intersectsLineEnd","vec3").add("intersectsLineDirection","vec3").add("intersectsLineRadius","float").add("perScreenPixelRatio","float"),(e.lineVerticalPlaneEnabled||e.heightManifoldEnabled)&&t.fragment.code.add(o.glsl(l||(l=n.__makeTemplateObject(["\n      float planeDistancePixels(vec4 plane, vec3 pos) {\n        float dist = dot(plane.xyz, pos) + plane.w;\n        float width = fwidth(dist);\n        dist /= min(width, maxPixelDistance);\n        return abs(dist);\n      }"],["\n      float planeDistancePixels(vec4 plane, vec3 pos) {\n        float dist = dot(plane.xyz, pos) + plane.w;\n        float width = fwidth(dist);\n        dist /= min(width, maxPixelDistance);\n        return abs(dist);\n      }"])))),e.pointDistanceEnabled&&t.fragment.code.add(o.glsl(c||(c=n.__makeTemplateObject(["\n    float sphereDistancePixels(vec4 sphere, vec3 pos) {\n      float dist = distance(sphere.xyz, pos) - sphere.w;\n      float width = fwidth(dist);\n      dist /= min(width, maxPixelDistance);\n      return abs(dist);\n    }\n    "],["\n    float sphereDistancePixels(vec4 sphere, vec3 pos) {\n      float dist = distance(sphere.xyz, pos) - sphere.w;\n      float width = fwidth(dist);\n      dist /= min(width, maxPixelDistance);\n      return abs(dist);\n    }\n    "])))),e.intersectsLineEnabled&&t.fragment.code.add(o.glsl(p||(p=n.__makeTemplateObject(["\n    float lineDistancePixels(vec3 start, vec3 dir, float radius, vec3 pos) {\n      float dist = length(cross(dir, pos - start)) / (length(pos) * perScreenPixelRatio);\n      return abs(dist) - radius;\n    }\n    "],["\n    float lineDistancePixels(vec3 start, vec3 dir, float radius, vec3 pos) {\n      float dist = length(cross(dir, pos - start)) / (length(pos) * perScreenPixelRatio);\n      return abs(dist) - radius;\n    }\n    "])))),(e.lineVerticalPlaneEnabled||e.intersectsLineEnabled)&&t.fragment.code.add(o.glsl(u||(u=n.__makeTemplateObject(["\n    bool pointIsWithinLine(vec3 pos, vec3 start, vec3 end) {\n      vec3 dir = end - start;\n      float t2 = dot(dir, pos - start);\n      float l2 = dot(dir, dir);\n      return t2 >= 0.0 && t2 <= l2;\n    }\n    "],["\n    bool pointIsWithinLine(vec3 pos, vec3 start, vec3 end) {\n      vec3 dir = end - start;\n      float t2 = dot(dir, pos - start);\n      float l2 = dot(dir, dir);\n      return t2 >= 0.0 && t2 <= l2;\n    }\n    "])))),t.fragment.code.add(o.glsl(d||(d=n.__makeTemplateObject(["\n  void main() {\n    vec3 pos;\n    vec3 normal;\n    float depthDiscontinuityAlpha;\n\n    if (!laserlineReconstructFromDepth(pos, normal, depthDiscontinuityAlpha)) {\n      discard;\n    }\n\n    vec4 color = vec4(0, 0, 0, 0);\n  "],["\n  void main() {\n    vec3 pos;\n    vec3 normal;\n    float depthDiscontinuityAlpha;\n\n    if (!laserlineReconstructFromDepth(pos, normal, depthDiscontinuityAlpha)) {\n      discard;\n    }\n\n    vec4 color = vec4(0, 0, 0, 0);\n  "])))),e.heightManifoldEnabled&&t.fragment.code.add(o.glsl(h||(h=n.__makeTemplateObject(["\n    {\n      float heightManifoldAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, heightPlane.xyz)));\n      vec4 heightManifoldColor = laserlineProfile(planeDistancePixels(heightPlane, pos));\n      color = max(color, heightManifoldColor * heightManifoldAlpha);\n    }\n    "],["\n    {\n      float heightManifoldAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, heightPlane.xyz)));\n      vec4 heightManifoldColor = laserlineProfile(planeDistancePixels(heightPlane, pos));\n      color = max(color, heightManifoldColor * heightManifoldAlpha);\n    }\n    "])))),e.pointDistanceEnabled&&t.fragment.code.add(o.glsl(f||(f=n.__makeTemplateObject(["\n    {\n      // distance to sphere\n      float pointDistanceSphereDistance = sphereDistancePixels(pointDistanceSphere, pos);\n      vec4 pointDistanceSphereColor = laserlineProfile(pointDistanceSphereDistance);\n      float pointDistanceSphereAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, normalize(pos - pointDistanceSphere.xyz))));\n\n      color = max(color, pointDistanceSphereColor * pointDistanceSphereAlpha);\n    }\n    "],["\n    {\n      // distance to sphere\n      float pointDistanceSphereDistance = sphereDistancePixels(pointDistanceSphere, pos);\n      vec4 pointDistanceSphereColor = laserlineProfile(pointDistanceSphereDistance);\n      float pointDistanceSphereAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, normalize(pos - pointDistanceSphere.xyz))));\n\n      color = max(color, pointDistanceSphereColor * pointDistanceSphereAlpha);\n    }\n    "])))),e.lineVerticalPlaneEnabled&&t.fragment.code.add(o.glsl(v||(v=n.__makeTemplateObject(["\n    {\n      if (pointIsWithinLine(pos, lineVerticalStart, lineVerticalEnd)) {\n        float lineVerticalDistance = planeDistancePixels(lineVerticalPlane, pos);\n\n        vec4 lineVerticalColor = laserlineProfile(lineVerticalDistance);\n        float lineVerticalAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, lineVerticalPlane.xyz)));\n\n        color = max(color, lineVerticalColor * lineVerticalAlpha);\n      }\n    }\n    "],["\n    {\n      if (pointIsWithinLine(pos, lineVerticalStart, lineVerticalEnd)) {\n        float lineVerticalDistance = planeDistancePixels(lineVerticalPlane, pos);\n\n        vec4 lineVerticalColor = laserlineProfile(lineVerticalDistance);\n        float lineVerticalAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, lineVerticalPlane.xyz)));\n\n        color = max(color, lineVerticalColor * lineVerticalAlpha);\n      }\n    }\n    "])))),e.intersectsLineEnabled&&t.fragment.code.add(o.glsl(m||(m=n.__makeTemplateObject(["\n    {\n      if (pointIsWithinLine(pos, intersectsLineStart, intersectsLineEnd)) {\n        float intersectsLineDistance = lineDistancePixels(intersectsLineStart, intersectsLineDirection, intersectsLineRadius, pos);\n        vec4 intersectsLineColor = laserlineProfile(intersectsLineDistance);\n        float intersectsLineAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, 1.0 - abs(dot(normal, intersectsLineDirection)));\n\n        color = max(color, intersectsLineColor * intersectsLineAlpha);\n      }\n    }\n    "],["\n    {\n      if (pointIsWithinLine(pos, intersectsLineStart, intersectsLineEnd)) {\n        float intersectsLineDistance = lineDistancePixels(intersectsLineStart, intersectsLineDirection, intersectsLineRadius, pos);\n        vec4 intersectsLineColor = laserlineProfile(intersectsLineDistance);\n        float intersectsLineAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, 1.0 - abs(dot(normal, intersectsLineDirection)));\n\n        color = max(color, intersectsLineColor * intersectsLineAlpha);\n      }\n    }\n    "])))),t.fragment.code.add(o.glsl(g||(g=n.__makeTemplateObject(["\n    gl_FragColor = laserlineOutput(color * depthDiscontinuityAlpha);\n  }\n  "],["\n    gl_FragColor = laserlineOutput(color * depthDiscontinuityAlpha);\n  }\n  "])))),t}}).apply(null,r))||(e.exports=i)},raiv:function(e,t,n){var r,i;r=[n.dj.c(e.i),t,n("zOht"),n("FXVB"),n("1m5D"),n("W/V4"),n("FQ4r"),n("lBa0"),n("UGy0"),n("G0ER"),n("qbr3"),n("qbr3"),n("2Kdy")],void 0===(i=(function(e,t,r,i,a,o,s,l,c,p,u,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LaserlinePathTechniqueConfiguration=t.LaserlinePathTechnique=void 0;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.initializeProgram=function(e){var n=t.shader.get().build(this.configuration);return new p(e.rctx,n.generateSource("vertex"),n.generateSource("fragment"),t.attributeLocations)},t.prototype.bind=function(e,t,n){this.program.setUniform3fv("innerColor",e.innerColor),this.program.setUniform1f("innerWidth",e.innerWidth*n.pixelRatio),this.program.setUniform3fv("glowColor",e.glowColor),this.program.setUniform1f("glowWidth",e.glowWidth*n.pixelRatio),this.program.setUniform1f("glowFalloff",e.glowFalloff),this.program.setUniform1f("globalAlpha",e.globalAlpha),this.program.setUniform1f("perScreenPixelRatio",n.perScreenPixelRatio),this.program.setUniform2f("pixelToNDC",2/n.fullWidth,2/n.fullHeight),this.program.setUniformMatrix4fv("uProjectionMatrix",n.projectionMatrix),i.mat4.translate(v,n.viewMatrix,t),this.program.setUniformMatrix4fv("uModelViewMatrix",v),this.configuration.contrastControlEnabled&&this.program.setUniform1f("globalAlphaContrastBoost",null!=e.globalAlphaContrastBoost?e.globalAlphaContrastBoost:1)},t.prototype.initializePipeline=function(){return d.makePipelineState({blending:u.simpleBlendingParams(1,771),colorWrite:d.defaultColorWriteParams})},t.prototype.bindPipelineState=function(e){e.setPipelineState(this.pipeline)},t.shader=new o.ReloadableShaderModule(c,(function(){return new Promise((function(e,t){Promise.resolve().then((function(){var t=[n("UGy0")];e.apply(null,t)}).bind(this)).catch(t.bind(this))}))})),t.attributeLocations={start:0,end:1,up:2,extrude:3},t}(s.ShaderTechnique);t.LaserlinePathTechnique=h;var f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.contrastControlEnabled=!1,t}return r.__extends(t,e),r.__decorate([l.parameter()],t.prototype,"contrastControlEnabled",void 0),t}(l.ShaderTechniqueConfiguration);t.LaserlinePathTechniqueConfiguration=f;var v=a.mat4f64.create()}).apply(null,r))||(e.exports=i)},uZGf:function(e,t,n){var r,i;r=[n.dj.c(e.i),t,n("zOht"),n("0LE5"),n("Rdxj"),n("2B1V"),n("tUyH"),n("FNtW"),n("CIy2"),n("LZD4"),n("s6rJ"),n("s6rJ"),n("fQ2U")],void 0===(i=(function(e,t,n,r,i,a,o,s,l,c,p,u,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShadedColorMaterial=void 0;var h=a.newLayout().vec3f(l.VertexAttrConstants.POSITION).vec3f(l.VertexAttrConstants.NORMAL),f=function(e){function t(t,n){var r=e.call(this,n)||this;return r.supportsEdges=!0,r.techniqueConfig=new d.ShadedColorMaterialTechniqueConfiguration,r.params=u.copyParameters(t,m),r}return n.__extends(t,e),t.prototype.setParameterValues=function(e){p.updateParameters(this.params,e)&&this.parametersChanged()},t.prototype.getParameters=function(){return this.params},t.prototype.getTechniqueConfig=function(e){return this.techniqueConfig.output=e,this.techniqueConfig.cullFace=this.params.cullFace,this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled,this.techniqueConfig.transparent=this.params.transparent,this.techniqueConfig.writeDepth=this.params.writeDepth,this.techniqueConfig},t.prototype.getPassParameters=function(){return this.params},t.prototype.intersect=function(e,t,n,r,i,a,o){u.intersectTriangleGeometry(e,t,r,i,a,void 0,o)},t.prototype.getGLMaterial=function(e){return 0===e.output||4===e.output?new v(e):void 0},t.prototype.createBufferWriter=function(){return new c.DefaultBufferWriter(h)},t}(s.Material);t.ShadedColorMaterial=f;var v=function(e){function t(t){var n=e.call(this,t)||this;return n.updateParameters(),n}return n.__extends(t,e),t.prototype.updateParameters=function(){this.technique=this.techniqueRep.acquireAndReleaseExisting(d.ShadedColorMaterialTechnique,this.material.getTechniqueConfig(this.output),this.technique)},t.prototype.beginSlot=function(e){if(4===this.output)return 3===e;var t=3;return this.technique.configuration.transparent&&(t=this.technique.configuration.writeDepth?5:8),e===t},t.prototype.bind=function(e,t){e.bindProgram(this.technique.program),this.technique.bindPass(e,this.material.getPassParameters(),t)},t}(o.GLMaterial),m={color:[1,1,1,1],shadingTint:[0,0,0,.25],shadingDirection:r.vec3.normalize(i.vec3f64.create(),[.5,-.5,-.5]),transparent:!1,writeDepth:!0,slicePlaneEnabled:!1,cullFace:0}}).apply(null,r))||(e.exports=i)},vA3N:function(e,t,n){var r,i;r=[n.dj.c(e.i),t],void 0===(i=(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getElevationAtPoint=void 0,t.getElevationAtPoint=function(e,t,n){return void 0===n&&(n="ground"),e.getElevation(t.x,t.y,t.z||0,t.spatialReference,n)}}).apply(null,r))||(e.exports=i)},woUR:function(e,t,n){var r,i;r=[n.dj.c(e.i),t,n("TMur"),n("pcDC"),n("BcWh"),n("LxLY"),n("jBNx"),n("o2T8"),n("YX1r"),n("51bw"),n("FXVB"),n("1m5D"),n("W9tT"),n("0LE5"),n("Rdxj"),n("jaBu"),n("lRq4"),n("xdO3"),n("vA3N"),n("aWgr"),n("mmEe"),n("JjCO"),n("UidR"),n("RsYQ"),n("ZO6V"),n("ZJC8")],void 0===(i=(function(e,t,n,r,i,a,o,s,l,c,p,u,d,h,f,v,m,g,y,b,_,x,P,S,O,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Manipulator3D=void 0;var C=function(){function e(e){for(var t in this.camera=new S.default,this._elevation={offset:0,override:null},this.collisionType={type:"point"},this.collisionPriority=0,this._renderObjects=[],this.autoScaleRenderObjects=!0,this._available=!0,this._noDisplayCount=0,this._radius=10,this._worldSized=!1,this.focusMultiplier=2,this.touchMultiplier=2.5,this.worldOriented=!1,this._modelTransform=u.mat4f64.create(),this._worldFrame=null,this._renderLocation=f.vec3f64.create(),this._renderLocationDirty=!0,this._location=new n.Point({x:0,y:0,z:0}),this._elevationAlignedLocation=new n.Point,this._elevationAlignedLocationDirty=!0,this.interactive=!0,this.selectable=!1,this.grabbable=!0,this.cursor=null,this._grabbing=!1,this.dragging=!1,this._hovering=!1,this._selected=!1,this._state=0,this._focused=!1,this.events=new i.EventEmitter,this._screenLocation={screenPointArray:o.createScreenPointArray(),renderScreenPointArray:o.createRenderScreenPointArray3(),pixelSize:0},this._screenLocationDirty=!0,this._applyObjectTransform=null,this._engineResourcesAddedToStage=!1,this._engineResources=null,this._attached=!1,this._engineLayerId=null,this._materialIdReferences=null,this._location.spatialReference=e.view.spatialReference,e)this[t]=e[t];this.view.state&&this.view.state.camera&&this.camera.copyFrom(this.view.state.camera)}return e.prototype.destroy=function(){this._removeResourcesFromStage(),this._engineResources=null,this.view=null,this.camera=null},Object.defineProperty(e.prototype,"elevationInfo",{get:function(){return this._elevationInfo},set:function(e){this._elevationInfo=e,this._elevationAlignedLocationDirty=!0,this._renderLocationDirty=!0,this._updateEngineObject()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"renderObjects",{get:function(){return this._renderObjects},set:function(e){this._removeResourcesFromStage(),this._engineResources=null,this._renderObjects=e.slice(),this._updateEngineObject()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"available",{get:function(){return this._available},set:function(e){e!==this._available&&(this._available=e,this._updateEngineObject())},enumerable:!1,configurable:!0}),e.prototype.disableDisplay=function(){var e=this;return this._noDisplayCount++,1===this._noDisplayCount&&this._updateEngineObject(),{remove:s.once((function(){e._noDisplayCount--,0===e._noDisplayCount&&e._updateEngineObject()}))}},Object.defineProperty(e.prototype,"radius",{get:function(){return this._radius},set:function(e){e!==this._radius&&(this._radius=e,this._updateEngineObject())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldSized",{get:function(){return this._worldSized},set:function(e){e!==this._worldSized&&(this._worldSized=e,this._updateEngineObject())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"modelTransform",{get:function(){return this._modelTransform},set:function(e){A(e)&&(this._screenLocationDirty=!0),p.mat4.copy(this._modelTransform,e),this._updateEngineObject()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"renderLocation",{get:function(){return this._renderLocationDirty&&(this._renderLocationDirty=!1,this.view.renderCoordsHelper.toRenderCoords(this.elevationAlignedLocation,this._renderLocation),this.worldOriented?(this._worldFrame||(this._worldFrame=u.mat4f64.create()),_.computeLinearTransformation(this.view.renderSpatialReference,this._renderLocation,this._worldFrame,this.view.renderSpatialReference),this._worldFrame[12]=0,this._worldFrame[13]=0,this._worldFrame[14]=0):this._worldFrame&&(this._worldFrame=null)),this._renderLocation},set:function(e){this.view.renderCoordsHelper.fromRenderCoords(e,this._location),this.elevationAlignedLocation=this._location},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"location",{get:function(){return this._location},set:function(e){g.clonePoint(e,this._location),this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!0,this._updateEngineObject(),this.events.emit("location-update",{location:this._location})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"elevationAlignedLocation",{get:function(){return this._elevationAlignedLocationDirty?(this._evaluateElevationAlignment(),this._updateElevationAlignedLocation(),this._elevationAlignedLocation):this._elevationAlignedLocation},set:function(e){g.clonePoint(e,this._location),this._evaluateElevationAlignment(),this._location.z-=this._elevation.offset,this._updateElevationAlignedLocation(),this._updateEngineObject(),this.events.emit("location-update",{location:this._location})},enumerable:!1,configurable:!0}),e.prototype._updateElevationAlignedLocation=function(){this._elevationAlignedLocation.x=this.location.x,this._elevationAlignedLocation.y=this.location.y;var e=a.isSome(this._elevation.override)?this._elevation.override:this.location.z||0;this._elevationAlignedLocation.z=e+this._elevation.offset,this._elevationAlignedLocation.spatialReference=this.location.spatialReference,this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!1},Object.defineProperty(e.prototype,"grabbing",{get:function(){return this._grabbing},set:function(e){e!==this._grabbing&&(this._grabbing=e,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hovering",{get:function(){return this._hovering},set:function(e){e!==this._hovering&&(this._hovering=e,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selected",{get:function(){return this._selected},set:function(e){e!==this._selected&&(this._selected=e,this._updateEngineObject(),this.events.emit("select-changed",{action:e?"select":"deselect"}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},set:function(e){e!==this._state&&(this._state=e,this._updateEngineObject())},enumerable:!1,configurable:!0}),e.prototype.updateStateEnabled=function(e,t){t?this.state|=e:this.state&=~e},e.prototype._setFocused=function(e){e!==this._focused&&(this._focused=e,this.events.emit("focus-changed",{action:!0===e?"focus":"unfocus"}))},Object.defineProperty(e.prototype,"focused",{get:function(){return this._focused},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"screenLocation",{get:function(){return this.ensureScreenLocation(),this._screenLocation},enumerable:!1,configurable:!0}),e.prototype.ensureScreenLocation=function(){if(this._screenLocationDirty){var e;if(this._screenLocation.pixelSize=this.camera.computeScreenPixelSizeAt(this.renderLocation),this._screenLocationDirty=!1,A(this._modelTransform)){var t=this._calculateModelTransformOffset(U);e=h.vec3.add(t,t,this.renderLocation)}else e=this.renderLocation;this.camera.projectPoint(e,this._screenLocation.renderScreenPointArray),this.camera.renderToScreen(this._screenLocation.renderScreenPointArray,this._screenLocation.screenPointArray)}},Object.defineProperty(e.prototype,"applyObjectTransform",{get:function(){return this._applyObjectTransform},set:function(e){this._applyObjectTransform=e,this._screenLocationDirty=!0,this._updateEngineObject()},enumerable:!1,configurable:!0}),e.prototype.intersectionDistance=function(e,t){var n;if(!this.available)return null;var i=o.screenPointObjectToArray(e,D),a=this._getCollisionRadius(t),s=-1*this.collisionPriority;switch(this.collisionType.type){case"point":if(d.vec2.squaredDistance(this.screenLocation.screenPointArray,i)<a*a)return this.screenLocation.renderScreenPointArray[2]+s;break;case"line":for(var c=this.collisionType.paths,p=this._getWorldToScreenObjectScale(),u=this._calculateObjectTransform(p,L),f=a*this.screenLocation.pixelSize,m=b.ray.fromScreen(this.camera,i,j),g=0,y=c;g<y.length;g++)if(0!==(H=y[g]).length)for(var _=h.vec3.transformMat4(E,H[0],u),P=1;P<H.length;P++){var S=h.vec3.transformMat4(I,H[P],u);if(null!=(X=b.lineSegment.closestRayDistance2(b.lineSegment.fromPoints(_,S,V),m))&&X<f*f){var O=h.vec3.add(x.sv3d.get(),_,S);h.vec3.scale(O,O,.5);var w=o.castRenderScreenPointArray(x.sv3d.get());return this.camera.projectPoint(O,w),w[2]+s}h.vec3.copy(_,S)}break;case"disc":var C=this.collisionType.direction,A=null!==(n=this.collisionType.offset)&&void 0!==n?n:v.ZEROS,T=(p=this._getWorldToScreenObjectScale(),u=this._calculateObjectTransform(p,L),f=a*this.screenLocation.pixelSize,m=b.ray.fromScreen(this.camera,i,j),l.mat3.fromMat4(R,u)),U=h.vec3.transformMat3(N,C,T),q=h.vec3.transformMat4(F,A,u);b.plane.fromPositionAndNormal(q,U,M);var W=z;if(b.plane.intersectRay(M,m,W)&&h.vec3.squaredDistance(W,q)<f*f)return this.screenLocation.renderScreenPointArray[2]+s;break;case"ribbon":var B=this.collisionType;if(c=B.paths,C=B.direction,p=this._getWorldToScreenObjectScale(),u=this._calculateObjectTransform(p,L),f=a*this.camera.computeScreenPixelSizeAt(this.renderLocation),m=b.ray.fromScreen(this.camera,i,j),T=l.mat3.fromMat4(R,u),U=h.vec3.transformMat3(N,C,T),q=this._calculateModelTransformPosition(F),b.plane.fromPositionAndNormal(q,U,M),!b.plane.intersectRay(M,m,W=z))break;for(var G=0,k=c;G<k.length;G++){var H;if(0!==(H=k[G]).length)for(_=h.vec3.transformMat4(E,H[0],u),P=1;P<H.length;P++){var X;if(S=h.vec3.transformMat4(I,H[P],u),null!=(X=b.lineSegment.distance2(b.lineSegment.fromPoints(_,S,V),W))&&X<f*f)return O=h.vec3.add(x.sv3d.get(),_,S),h.vec3.scale(O,O,.5),w=o.castRenderScreenPointArray(x.sv3d.get()),this.camera.projectPoint(O,w),w[2]+s;h.vec3.copy(_,S)}}break;default:r.neverReached(this.collisionType)}return null},e.prototype.attach=function(e){if(void 0===e&&(e={manipulator3D:{}}),this.view._stage){var t=e.manipulator3D;if(this._engineLayerId=t.engineLayerId,a.isNone(this._engineLayerId)){var r=new O("manipulator-3d",{isPickable:!1});this.view._stage.add(0,r),this.view._stage.addToViewContent([r.id]),this._engineLayerId=r.id,t.engineLayerId=r.id}t.engineLayerReferences=(t.engineLayerReferences||0)+1,this._materialIdReferences=t.materialIdReferences,a.isNone(this._materialIdReferences)&&(this._materialIdReferences=new Map,t.materialIdReferences=this._materialIdReferences),this.camera.copyFrom(this.view.state.camera),this._attached=!0,this._updateEngineObject(),_.canProject(this._location.spatialReference,this.view.spatialReference)||(this.location=new n.Point({x:0,y:0,z:0,spatialReference:this.view.spatialReference}))}},e.prototype.detach=function(e){void 0===e&&(e={manipulator3D:{}});var t=e.manipulator3D;t.engineLayerReferences--;var n=0===t.engineLayerReferences;n&&(t.engineLayerId=null),this._removeResourcesFromStage(n),this._engineResources=null,this._engineLayerId=null,this._materialIdReferences=null,this._attached=!1},e.prototype.onViewChange=function(){this.camera.copyFrom(this.view.state.camera),this._screenLocationDirty=!0,this._updateEngineObject()},e.prototype.onElevationChange=function(e){P.pointToPoint(this.location,q,e.spatialReference),m.containsPointObject(e.extent,q)&&(this.location=this._location)},e.prototype._evaluateElevationAlignment=function(e){if(void 0===e&&(e=this.location),a.isNone(this.elevationInfo))return!1;var t=null,n=0,r=a.unwrapOr(this.elevationInfo.offset,0);switch(this.elevationInfo.mode){case"on-the-ground":t=y.getElevationAtPoint(this.view.elevationProvider,e,"ground")||0;break;case"relative-to-ground":n=(y.getElevationAtPoint(this.view.elevationProvider,e,"ground")||0)+r;break;case"relative-to-scene":n=(y.getElevationAtPoint(this.view.elevationProvider,e,"scene")||0)+r;break;case"absolute-height":n=r}return(n!==this._elevation.offset||t!==this._elevation.override)&&(this._elevation.offset=n,this._elevation.override=t,!0)},e.prototype._updateEngineObject=function(){if(this._attached)if(this.available){var e=this._getWorldToScreenObjectScale(),t=L;if(!0===this.autoScaleRenderObjects){var n=this._getFocusedSize(this._radius,this.focused)*e;this._calculateObjectTransform(n,t)}else this._calculateObjectTransform(e,t);for(var r=this._ensureEngineResources().objectsByState,i=(this.focused?2:1)|(this.selected?8:4),a=this._noDisplayCount>0,o=0,s=r;o<s.length;o++){var l=s[o],c=l.stateMask,p=l.objects;if(a)for(var u=0,d=p;u<d.length;u++)(v=d[u]).setVisible(!1);else if(0!=(15&c)&&(i&c)!=(15&c)||0!=(65520&c)&&(this.state&c)!=(65520&c))for(var h=0,f=p;h<f.length;h++){var v;(v=f[h]).setVisible(!1)}else for(var m=0,g=p;m<g.length;m++)(v=g[m]).setVisible(!0),v.objectTransformation=t}}else this._removeResourcesFromStage()},e.prototype._ensureEngineResources=function(){if(a.isNone(this._engineResources)){var e=this.view._stage.getContent(0,a.unwrap(this._engineLayerId)),t=[],n=new Set;this.renderObjects.forEach((function(e){var r=e.material;n.has(r)||(t.push(r),n.add(r))}));var r=new Map;this.renderObjects.forEach((function(e){var t=new w({idHint:"manipulator",castShadow:!1});!function(e,t){var n=t.geometry,r=t.material,i=t.transform;Array.isArray(n)?n.forEach((function(t){return e.addGeometry(t,r,i)})):e.addGeometry(n,r,i)}(t,e);var n=e.stateMask||0,i=r.get(n)||[];i.push(t),r.set(n,i)}));var i=[];r.forEach((function(e,t){i.push({stateMask:t,objects:e})})),this._engineResources={objectsByState:i,layer:e,materials:t}}return this._addResourcesToStage(),this._engineResources},e.prototype._addResourcesToStage=function(){var e=this;if(!this._engineResourcesAddedToStage&&!a.isNone(this._engineResources)){var t=this._engineResources,n=t.objectsByState,r=t.layer;t.materials.forEach((function(t){var n=a.unwrap(e._materialIdReferences),r=n.get(t.id)||0;0===r&&e.view._stage.add(3,t),n.set(t.id,r+1)})),n.forEach((function(t){t.objects.forEach((function(t){r.addObject(t),e.view._stage.add(1,t)}))})),this._engineResourcesAddedToStage=!0}},e.prototype._removeResourcesFromStage=function(e){var t=this;if(void 0===e&&(e=!1),this._engineResourcesAddedToStage&&!a.isNone(this._engineResources)){var n=this._engineResources,r=n.layer,i=n.materials;n.objectsByState.forEach((function(e){e.objects.forEach((function(e){r.removeObject(e),t.view._stage.remove(1,e.id)}))})),i.forEach((function(e){var n=a.unwrap(t._materialIdReferences),r=n.get(e.id);1===r?(t.view._stage.remove(3,e.id),n.delete(e.id)):n.set(e.id,r-1)})),e&&this.view._stage.remove(0,r.id),this._engineResourcesAddedToStage=!1}},e.prototype._getCollisionRadius=function(e){return this._getFocusedSize(this.radius,!0)*("touch"===e?this.touchMultiplier:1)},e.prototype._getFocusedSize=function(e,t){return e*(t?this.focusMultiplier:1)},e.prototype._getWorldToScreenObjectScale=function(){return this._worldSized?1:this.screenLocation.pixelSize},e.prototype._calculateModelTransformPosition=function(e){var t=this._getWorldToScreenObjectScale(),n=this._calculateObjectTransform(t,T);return h.vec3.set(e,n[12],n[13],n[14])},e.prototype._calculateModelTransformOffset=function(e){var t=this._calculateModelTransformPosition(e);return h.vec3.subtract(e,t,this.renderLocation)},e.prototype._calculateObjectTransform=function(e,t){return p.mat4.set(t,e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1),this._worldFrame&&p.mat4.multiply(t,t,this._worldFrame),p.mat4.multiply(t,t,this._modelTransform),t[12]+=this.renderLocation[0],t[13]+=this.renderLocation[1],t[14]+=this.renderLocation[2],t[15]=1,a.isSome(this._applyObjectTransform)&&this._applyObjectTransform(t),t},Object.defineProperty(e.prototype,"test",{get:function(){var e=!1;if(a.isSome(this._engineResources))for(var t in this._engineResources.objectsByState){for(var n=0,r=this._engineResources.objectsByState[t].objects;n<r.length;n++)if(r[n].isVisible){e=!0;break}if(e)break}return{areAnyResourcesVisible:e}},enumerable:!1,configurable:!0}),e}();function A(e){return 0!==e[12]||0!==e[13]||0!==e[14]}t.Manipulator3D=C;var D=o.createScreenPointArray(),V=b.lineSegment.create(),j=b.ray.create(),R=c.mat3f64.create(),T=u.mat4f64.create(),L=u.mat4f64.create(),M=b.plane.create(),E=f.vec3f64.create(),I=f.vec3f64.create(),z=f.vec3f64.create(),N=f.vec3f64.create(),F=f.vec3f64.create(),U=f.vec3f64.create(),q=new n.Point({x:0,y:0,z:0,spatialReference:null})}).apply(null,r))||(e.exports=i)},xdO3:function(e,t,n){var r,i;r=[n.dj.c(e.i),t,n("jZlN"),n("pcDC"),n("rg9i"),n("LxLY"),n("rusB"),n("Lzvl"),n("ZcgO")],void 0===(i=(function(e,t,n,r,i,a,o,s,l){"use strict";function c(e){return"declaredClass"in e}function p(e){return"declaredClass"in e}function u(e){return"declaredClass"in e}function d(e){return a.isNone(e)?null:c(e)?e:s.fromJSON(function(e){var t=e.spatialReference.toJSON();switch(e.type){case"point":return{x:e.x,y:e.y,z:e.z,m:e.m,spatialReference:t};case"polygon":var n=e.hasZ,i=e.hasM;return{rings:h(e.rings),hasZ:n,hasM:i,spatialReference:t};case"polyline":return n=e.hasZ,i=e.hasM,{paths:h(e.paths),hasZ:n,hasM:i,spatialReference:t};case"extent":return{xmin:e.xmin,xmax:e.xmax,ymin:e.ymin,ymax:e.ymax,zmin:e.zmin,zmax:e.zmax,mmin:e.mmin,mmax:e.mmax,hasZ:n=e.hasZ,hasM:i=e.hasM,spatialReference:t};case"multipoint":var a=e.points;return n=e.hasZ,i=e.hasM,{points:v(a)?f(a):a,hasZ:n,hasM:i,spatialReference:t};default:return void r.neverReached(e)}}(e))}function h(e){return function(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];if(0!==r.length)return v(r)}return!1}(e)?e.map((function(e){return f(e)})):e}function f(e){return e.map((function(e){return o.toArray(e)}))}function v(e){return e.length&&(o.isFloat32Array(e[0])||o.isFloat64Array(e[0]))}Object.defineProperty(t,"__esModule",{value:!0}),t.clonePoint=t.hydrateGeometry=t.hydrateGraphic=t.isHydratedGraphic=t.isHydratedPoint=t.isHydratedGeometry=void 0,t.isHydratedGeometry=c,t.isHydratedPoint=p,t.isHydratedGraphic=u,t.hydrateGraphic=function(e,t){if(!e)return null;if(u(e))return e;var r=new n({layer:t,sourceLayer:t});return r.visible=e.visible,r.symbol=i.clone(e.symbol),r.attributes=i.clone(e.attributes),r.geometry=d(e.geometry),r},t.hydrateGeometry=d,t.clonePoint=function(e,t){if(!e)return null;var n;if(p(e)){if(null==t)return e.clone();if(p(t))return t.copy(e)}return null!=t?((n=t).x=e.x,n.y=e.y,n.spatialReference=e.spatialReference,e.hasZ?(n.z=e.z,n.hasZ=e.hasZ):(n.z=null,n.hasZ=!1),e.hasM?(n.m=e.m,n.hasM=!0):(n.m=null,n.hasM=!1)):(n=l.makeDehydratedPoint(e.x,e.y,e.z,e.spatialReference),e.hasM&&(n.m=e.m,n.hasM=!0)),n}}).apply(null,r))||(e.exports=i)}}]);