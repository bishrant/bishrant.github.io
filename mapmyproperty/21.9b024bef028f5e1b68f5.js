(function(){var e={"arcgis-js-api/views/2d/layers/features/support/GraphicsReader":"2btE","esri/symbols/support/defaultsJSON":"35hF","arcgis-js-api/symbols/support/defaultsJSON":"35hF","arcgis-js-api/views/2d/layers/graphics/GraphicStore":"5r4l","arcgis-js-api/views/2d/layers/graphics/GraphicStoreItem":"9gM4","arcgis-js-api/views/2d/layers/graphics/GraphicContainer":"FBzP","esri/layers/support/FieldsIndex":"I90O","arcgis-js-api/layers/support/FieldsIndex":"I90O","arcgis-js-api/views/2d/layers/graphics/GraphicsView2D":"apjU","esri/symbols/support/defaults":"dXKx","arcgis-js-api/symbols/support/defaults":"dXKx","arcgis-js-api/core/MapPool":"loiZ","arcgis-js-api/views/2d/layers/graphics/GraphicProcessingQueue":"vhZU","arcgis-js-api/views/2d/layers/graphics/graphicsUtils":"wjMf","arcgis-js-api/views/layers/GraphicsView":"zRH3"},t=this||window,i=t.webpackJsonp=t.webpackJsonp||[];i.registerAbsMids?i.registerAbsMids(e):(i.absMidsWaiting=i.absMidsWaiting||[]).push(e)})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{"2btE":function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("zOht"),i("Lzvl"),i("+6sX"),i("vwon"),i("ZB9i")],void 0===(n=(function(e,t,i,r,n,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GraphicsReader=void 0;var a=function(e){function t(t,i){return e.call(this,t,i,null)||this}return i.__extends(t,e),t.from=function(e){for(var i=o.FeatureSetReader.createInstance(),s=[],a=0,l=e;a<l.length;a++){var u=l[a],h=r.getJsonType(u.geometry);n.convertFromGraphics(s,[u],h,!1,!1,"uid")}return new t(i,s)},Object.defineProperty(t.prototype,"geometryType",{get:function(){var e=this._current;return e?e.geometryType:null},enumerable:!1,configurable:!0}),t.prototype.readGraphic=function(){return this._current},t.prototype.getCursor=function(){return this.copy()},t.prototype.copy=function(){var e=new t(this.instance,this._features);return this.copyInto(e),e},t}(s.FeatureSetReaderJSON);t.GraphicsReader=a}).apply(null,r))||(e.exports=n)},"35hF":function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorPolygonSymbolJSON=t.errorPolylineSymbolJSON=t.errorPointSymbolJSON=t.defaultTextSymbolJSON=t.defaultPolygonSymbolJSON=t.defaultPolylineSymbolJSON=t.defaultPointSymbolJSON=t.defaultOutlineColor=t.defaultColor=void 0,t.defaultColor=[252,146,31,255],t.defaultOutlineColor=[153,153,153,255],t.defaultPointSymbolJSON={type:"esriSMS",style:"esriSMSCircle",size:6,color:t.defaultColor,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},t.defaultPolylineSymbolJSON={type:"esriSLS",style:"esriSLSSolid",width:.75,color:t.defaultColor},t.defaultPolygonSymbolJSON={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},t.defaultTextSymbolJSON={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},t.errorPointSymbolJSON={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},t.errorPolylineSymbolJSON={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},t.errorPolygonSymbolJSON={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null}}).apply(null,r))||(e.exports=n)},"5r4l":function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("zOht"),i("H1tY"),i("jBNx"),i("8uEs"),i("jEml"),i("lRq4"),i("k1EI"),i("d466"),i("Lzvl"),i("fw2w"),i("9gM4"),i("wjMf")],void 0===(n=(function(e,t,i,r,n,o,s,a,l,u,h,d,p,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g={minX:0,minY:0,maxX:0,maxY:0},y=a.create(),f=[];function m(e,t,i,r,n){return g.minX=t,g.minY=i,g.maxX=r,g.maxY=n,e.search(g)}var _=function(){function e(e,t,i,n,a,l){this._graphics=n,this._onAdd=a,this._onRemove=l,this._index=s(9,r("csp-restrictions")?function(e){return{minX:e.bounds[0],minY:e.bounds[1],maxX:e.bounds[2],maxY:e.bounds[3]}}:[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),this._itemByGraphic=new Map,this._currentLevel=-1/0,this._tileInfoView=e,this._uidFieldName=i;var u=e.getClosestInfoForScale(t);u&&(this._currentLevel=u.level,this._resolution=this._tileInfoView.getTileResolution(u.level)),this._metersPerUnit=o.getMetersPerUnit(e.spatialReference)}return e.prototype.hitTest=function(e,t,i,r,o){e=d.normalizeMapX(e,this._tileInfoView.spatialReference);var s=.5*r*i;y[0]=e-s,y[1]=t-s,y[2]=e+s,y[3]=t+s;var p=.5*r*(i+50),g=m(this._index,e-p,t-p,e+p,t+p);if(!g||0===g.length)return[];for(var f,_={x:e,y:t},v=[],b=0,S=g;b<S.length;b++){var x=S[b];if(x.graphic.visible)switch(h.getJsonType(x.geometry)){case"esriGeometryPoint":if(!(C=x.symbol))continue;var w=x.geometry,M=w.x,G=w.y,P=r*this._metersPerUnit,O=void 0;switch(C.type){case"esriTS":O=c.getTextSymbolBounds(M,G,C,x.size,r,o);break;case"expanded-cim":O=c.getCIMMarkerBounds(M,G,C,r,P,o);break;case"esriSMS":case"esriPMS":O=c.getMarkerSymbolBounds(M,G,C,r,P,o)}l.polygonContainsPoint(O,_)&&v.push(x);break;case"esriGeometryPolyline":if(!(C=x.symbol)||!C.layers.length)continue;f=1.5*r*window.devicePixelRatio*n.pt2px(C.layers[0].width),c.isPointOnPolyline(x.geometry,e,t,f)&&v.push(x);break;case"esriGeometryEnvelope":var I=x.geometry,T=a.fromValues(I.xmin,I.ymin,I.xmax,I.ymax);a.intersects(T,y)&&v.push(x);break;case"esriGeometryPolygon":if(l.polygonContainsPoint(x.geometry,_)){v.push(x);break}var z=u.getPolygonExtent(x.geometry);(Math.abs(z.ymax-z.ymin)<5*r||Math.abs(z.xmax-z.xmin)<5*r)&&(T=a.fromValues(z.xmin,z.ymin,z.xmax,z.ymax),a.intersects(T,y)&&v.push(x));break;case"esriGeometryMultipoint":var C;if(!(C=x.symbol))continue;for(var N=x.geometry.points,U=(O=void 0,0);U<N.length;U++)if(O="esriTS"===C.type?c.getTextSymbolBounds(N[U][0],N[U][1],C,x.size,r,o):c.getMarkerSymbolBounds(N[U][0],N[U][1],C,r,r*this._metersPerUnit,o),l.polygonContainsPoint(O,_)){v.push(x);break}}}return v.sort((function(e,t){var i=c.graphicGeometryToNumber(e.graphic),r=c.graphicGeometryToNumber(t.graphic);return i===r?t.zorder-e.zorder:i-r})),v.map((function(e){return e.graphic}))},e.prototype.getGraphicsData=function(e,t,r){var n=m(this._index,t.bounds[0],t.bounds[1],t.bounds[2],t.bounds[3]);if(0===n.length||0===r.length)return[];n.sort((function(e,t){return e.zorder-t.zorder})),n[0].insertAfter=-1;for(var o=1;o<n.length;o++)n[o].insertAfter=n[o-1].graphic.uid;n.sort((function(e,t){return e.graphic.uid-t.graphic.uid})),r.sort((function(e,t){return e.uid-t.uid}));for(var s,a=0,l=0,u=[],h={originPosition:"upperLeft",scale:[t.resolution,t.resolution],translate:[t.bounds[0],t.bounds[3]]},d=0,c=r;d<c.length;d++){var g=c[d];for(l=-2;a<n.length;)if(s=n[a],a++,g.uid===s.graphic.uid){l=s.insertAfter;break}if(s.geometry&&-2!==l){var y=s.getGeometryQuantized(h),f=i.__assign({},s.graphic.attributes);f[this._uidFieldName]=g.uid,null==s.groupId&&(s.groupId=e.createTemplateGroup(s.symbol,null)),u.push({centroid:p.default.getCentroidQuantized(s,h),geometry:y,attributes:f,symbol:s.symbol,groupId:s.groupId,insertAfter:l})}}return u},e.prototype.getGraphicData=function(e,t,r){var n=this._itemByGraphic.get(r);if(!n)return null;var o=m(this._index,t.bounds[0],t.bounds[1],t.bounds[2],t.bounds[3]);o.sort((function(e,t){return e.zorder-t.zorder}));var s=o.indexOf(n),a=0===s||-1===s?-1:o[s-1].graphic.uid,l={originPosition:"upperLeft",scale:[t.resolution,t.resolution],translate:[t.bounds[0],t.bounds[3]]},u=n.getGeometryQuantized(l),h=i.__assign({},n.graphic.attributes);return h[this._uidFieldName]=r.uid,null==n.groupId&&(n.groupId=e.createTemplateGroup(n.symbol,null)),{centroid:p.default.getCentroidQuantized(n,l),geometry:u,attributes:h,symbol:n.symbol,groupId:n.groupId,insertAfter:a}},e.prototype.queryTileData=function(e,t){var i=a.pad(t.bounds,50*t.resolution,a.create()),r=m(this._index,i[0],i[1],i[2],i[3]),n=[];return this._createTileGraphics(n,e,r,{originPosition:"upperLeft",scale:[t.resolution,t.resolution],translate:[t.bounds[0],t.bounds[3]]}),n},e.prototype.has=function(e){return this._itemByGraphic.has(e)},e.prototype.getBounds=function(e){return this._itemByGraphic.has(e)?this._itemByGraphic.get(e).bounds:null},e.prototype.addOrModify=function(e,t,i){if(e){this.has(e)&&this.remove(e),this._onAdd(e);var r=p.default.acquire(e,t,i,this._resolution,this._resolution*this._metersPerUnit,this._tileInfoView.spatialReference);return this._itemByGraphic.set(e,r),i&&this._index.insert(r),r.bounds}},e.prototype.remove=function(e){if(this._itemByGraphic.has(e)){this._onRemove(e);var t=this._itemByGraphic.get(e);this._index.remove(t),this._itemByGraphic.delete(e)}},e.prototype.updateZ=function(){for(var e,t=this._graphics.items,i=0;i<t.length;i++)(e=this._itemByGraphic.get(t[i]))&&(e.zorder=i)},e.prototype.update=function(e,t,i){var r=this._itemByGraphic.get(e);r.groupId=null;var n=a.clone(r.bounds);return r.size[0]=r.size[1]=0,this._index.remove(r),r.set(e,t,i,this._resolution,this._resolution*this._metersPerUnit,this._tileInfoView.spatialReference),i&&this._index.insert(r),{oldBounds:n,newBounds:r.bounds}},e.prototype.updateLevel=function(e){var t=this;if(this._currentLevel!==e){this._currentLevel=e;var i=this._tileInfoView.getTileResolution(e);this._resolution=i,this._index.clear(),f.length=0,this._itemByGraphic.forEach((function(e){e.updateBounds(t._resolution,t._resolution*t._metersPerUnit,t._tileInfoView.spatialReference),e.geometry&&f.push(e)})),this._index.load(f)}},e.prototype.clear=function(){this._itemByGraphic.clear(),this._index.clear()},e.prototype._createTileGraphics=function(e,t,r,n){var o,s,a,l,u=this._uidFieldName;r.sort((function(e,t){return e.zorder-t.zorder}));for(var h=0;h<r.length;h++){o=(a=r[h]).graphic,s=a.getGeometryQuantized(n),l=0===h?-1:r[h-1].graphic.uid;var d=i.__assign({},a.graphic.attributes);d[u]=o.uid,null==a.groupId&&(a.groupId=t.createTemplateGroup(a.symbol,null)),e.push({centroid:p.default.getCentroidQuantized(a,n),geometry:s,attributes:d,symbol:a.symbol,groupId:a.groupId,insertAfter:l})}},e}();t.default=_}).apply(null,r))||(e.exports=n)},"9gM4":function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("LxLY"),i("lRq4"),i("0FS0"),i("Lzvl"),i("u90+"),i("+6sX"),i("Jvs9"),i("wjMf")],void 0===(n=(function(e,t,i,r,n,o,s,a,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=new l.default,d=new l.default;function p(e){e.coords.length=0,e.lengths.length=0}var c=function(){function e(){this.bounds=r.create(),this.graphic=null,this.size=[0,0,0,0]}return e.acquire=function(t,i,r,n,o,s){var a;return void 0===t&&(t=null),0===e._pool.length?a=new e:(a=e._pool.pop(),this._set.delete(a)),a.acquire(t,i,r,n,o,s),a},e.release=function(e){e&&!this._set.has(e)&&(e.release(),this._pool.push(e),this._set.add(e))},e.getCentroidQuantized=function(e,t){if(o.isPolygon(e.geometry)){var r=e.symbol;if(i.isNone(r))return null;if(u.isMarkerSymbol(r.type)){var a=n.polygonCentroid(e.geometry);return s.quantizePoint(t,{},{x:a[0],y:a[1]},!1,!1)}}return null},e.prototype.acquire=function(e,t,i,r,n,o){void 0===e&&(e=null),e&&this.set(e,t,i,r,n,o)},e.prototype.release=function(){this.graphic=null,this.symbolResource=null,this.geometry=null},Object.defineProperty(e.prototype,"symbol",{get:function(){return this.symbolResource.symbol},enumerable:!1,configurable:!0}),e.prototype.set=function(e,t,i,r,n,o){this.graphic=e,this.geometry=i,this.symbolResource=t,this.updateBounds(r,n,o)},e.prototype.updateBounds=function(e,t,i){u.getBounds(this.bounds,this.size,this.symbolResource,this.geometry,e,t,i)},e.prototype.getGeometryQuantized=function(e){if(o.isPolygon(this.geometry)){var t=this.geometry.rings;if(1===t.length&&2===t[0].length)return s.quantizeGeometry(e,{paths:[[t[0][0],t[0][1]]]})}else if(o.isPolyline(this.geometry))return p(h),p(d),a.convertFromPolyline(h,this.geometry),a.generalizeOptimizedGeometry(d,h,this.geometry.hasZ,this.geometry.hasM,"esriGeometryPolyline",e.scale[0]),a.quantizeOptimizedGeometry(h,d,this.geometry.hasZ,this.geometry.hasM,"esriGeometryPolyline",e),a.convertToPolyline(h,this.geometry.hasZ,this.geometry.hasM);return s.quantizeGeometry(e,this.geometry)},e._pool=[],e._set=new Set,e}();t.default=c}).apply(null,r))||(e.exports=n)},FBzP:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("zOht"),i("N0+q")],void 0===(n=(function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),Object.defineProperty(t.prototype,"hasLabels",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"labelsVisible",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype._renderGraphics=function(e,t){for(var i=0,r=this.children;i<r.length;i++){var n=r[i];n.isReady&&n.hasData&&(n.commitChanges(e),e.context.setStencilFunction(514,n.stencilRef,255),n._displayList.replay(e,n,t))}},t.prototype.renderChildren=function(t){var i=t.painter;if(this.children.some((function(e){return e.hasData}))){e.prototype.renderChildren.call(this,t),this._renderGraphics(t);var r=i.effects.highlight;r.bind(t),this._renderGraphics(t,r.defines),r.draw(t),r.unbind()}},t}(r.FeatureContainer);t.default=n}).apply(null,r))||(e.exports=n)},I90O:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=(function(e,t){"use strict";function i(e){return"date"===e.type||"esriFieldTypeDate"===e.type}function r(e){return e.toLowerCase().trim()}return function(){function e(e){if(this.fields=e,this._fieldsMap=new Map,this._dateFieldsSet=new Set,this.dateFields=[],e){for(var t=[],n=0,o=e;n<o.length;n++){var s=o[n],a=s&&s.name;if(a){var l=r(a);this._fieldsMap.set(a,s),this._fieldsMap.set(l,s),t.push(l),i(s)&&(this.dateFields.push(s),this._dateFieldsSet.add(s))}}t.sort(),this.uid=t.join(",")}}return e.prototype.destroy=function(){this._fieldsMap.clear()},e.prototype.has=function(e){return null!=this.get(e)},e.prototype.get=function(e){return null!=e?this._fieldsMap.get(e)||this._fieldsMap.get(r(e)):void 0},e.prototype.isDateField=function(e){return this._dateFieldsSet.has(this.get(e))},e.prototype.normalizeFieldName=function(e){var t=this.get(e);if(t)return t.name},e}()}).apply(null,r))||(e.exports=n)},apjU:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("zOht"),i("Gtr7"),i("7MDj"),i("H1tY"),i("NfRO"),i("loiZ"),i("R2Zq"),i("LxLY"),i("qMld"),i("qMld"),i("jBNx"),i("Vx27"),i("Vt+U"),i("Z4y+"),i("lRq4"),i("ZPQp"),i("Lzvl"),i("nrlZ"),i("Q2Em"),i("aqXi"),i("dXKx"),i("tI6k"),i("rYkQ"),i("AP+j"),i("bLBh"),i("LCdb"),i("MGRT"),i("2Gaw"),i("493N"),i("lvbU"),i("OgqW"),i("2btE"),i("6kSU"),i("FBzP"),i("vhZU"),i("5r4l"),i("wjMf"),i("zRH3")],void 0===(n=(function(e,t,i,r,n,o,s,a,l,u,h,d,p,c,g,y,f,m,_,v,b,S,x,w,M,G,P,O,I,T,z,C,N,U,A,q,j,R,F,D){"use strict";function k(e,t,i){if(i.has(e))return i.get(e);var r={tile:t,addedOrModified:[],removed:[]};return i.set(e,r),r}Object.defineProperty(t,"__esModule",{value:!0});var B=function(e){function t(t){var i=e.call(this,t)||this;return i._storage=new N.ComputedAttributeStorage,i._displayIds=new Map,i._tiles=new Map,i._graphicStoreUpdate=!1,i._graphicsSet=new Set,i._matcher=h.resolve(null),i._tileUpdateSet=new Set,i._tilesToUpdate=new Map,i._graphicIdToAbortController=new Map,i._attached=!1,i._highlightIds=new Map,i._updatingGraphicsTimer=null,i._processing=!1,i._needsProcessing=!1,i._pendingUpdate={addOrModified:new Set,removed:new Set},i.lastUpdateId=-1,i.updateRequested=!1,i.graphicUpdateHandler=i.graphicUpdateHandler.bind(i),i.addOrUpdateGraphic=i.addOrUpdateGraphic.bind(i),i._processAnalyzedGraphics=i._processAnalyzedGraphics.bind(i),i._graphicsChangeHandler=i._graphicsChangeHandler.bind(i),i}return i.__extends(t,e),t.prototype._createMatcher=function(e,t){if(e){var i=z.createMatcherSchema({indexCount:0,fields:{}},"feature",e);this._matcher=P.createMatcher(i,t,null)}},t.prototype._createDisplayId=function(e){return this._displayIds.has(e)||this._displayIds.set(e,this._storage.createDisplayId()),this._displayIds.get(e)},t.prototype.initialize=function(){var e=this;this._tileStore=new A.default(this.view.featuresTilingScheme),this.container=new q.default(this.view.featuresTilingScheme),this._attributeStore=new C.default({type:"local",initialize:function(t){return h.resolve(e.container.attributeView.initialize(t))},update:function(t){return e.container.attributeView.requestUpdate(t)},render:function(){return e.container.requestRender()}}),this._graphicStore=new R.default(this.view.featuresTilingScheme,this.view.state.scale,this.uid,this.graphics,(function(t){e._createDisplayId(t.uid),e._setFilterState(t.uid,t.visible)}),(function(t){var i=e._displayIds.get(t.uid);e._displayIds.delete(t.uid),e._storage.releaseDisplayId(i)})),this._graphicProcessingQueue=new j.default({process:this.addOrUpdateGraphic});var t=new I.WGLTemplateStore(this.container.getMaterialItems.bind(this.container),!0);this._createMatcher(this.renderer,t),this._meshFactory=new O.WGLMeshFactory(null,this.uid,t),this._templateStore=t,this.watch("renderer",(function(i){return e._createMatcher(i,t)})),this._tileStore.on("update",this._onTileUpdate.bind(this)),this.container.on("attach",(function(){e.graphics.items.length>0&&e._graphicsChangeHandler({target:e.graphics,added:e.graphics.items,removed:[],moved:[]}),e.handles.add(e.graphics.on("change",e._graphicsChangeHandler),"graphics"),e._attached=!0,e.notifyChange("updating")})),this.container.on("detach",(function(){e._graphicProcessingQueue&&e._graphicProcessingQueue.clear()}))},t.prototype.destroy=function(){this._updatingGraphicsTimer&&(clearTimeout(this._updatingGraphicsTimer),this._updatingGraphicsTimer=null,this.notifyChange("updating")),this.container.destroy(),this._set("graphics",null),this._graphicProcessingQueue&&(this._graphicProcessingQueue.destroy(),this._graphicProcessingQueue=null),this._graphicStore.clear(),this._tileStore.destroy(),this._attributeStore=null},Object.defineProperty(t.prototype,"updating",{get:function(){return!this._attached||null!==this._updatingGraphicsTimer||this._graphicProcessingQueue.updating||this._tileUpdateSet.size>0||this._tilesToUpdate.size>0},enumerable:!1,configurable:!0}),t.prototype.hitTest=function(e,t){if(!this.view||!this.view.position)return h.resolve();var i=this.view.toMap(p.createScreenPoint(e,t));return this.searchFeatures(i).then((function(e){return e&&e.length?e[0]:null}))},t.prototype.searchFeatures=function(e,t){var i=this;return void 0===t&&(t=2),h.create((function(r){r(i._graphicStore.hitTest(e.x,e.y,t,i.view.state.resolution,i.view.state.rotation))}))},t.prototype.update=function(e){var t=e.state,i=this.view.featuresTilingScheme.getClosestInfoForScale(t.scale).level;this._graphicStore.updateLevel(i),this._tileStore.setViewState(t),this._graphicStoreUpdate=!0,this.updateRequested=!1},t.prototype.viewChange=function(){this.requestUpdate()},t.prototype.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.requestUpdateCallback())},t.prototype.processUpdate=function(e){this.updateRequested&&(this.updateRequested=!1,this.update(e))},t.prototype.graphicUpdateHandler=function(e){var t=e.newValue,i=e.graphic;switch(e.property){case"attributes":break;case"geometry":case"symbol":this._graphicProcessingQueue.push(i,"update");break;case"visible":this._setFilterState(i.uid,t),this._attributeStore.sendUpdates()}},t.prototype.addHighlight=function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t];if(this._highlightIds.has(r)){var n=this._highlightIds.get(r);this._highlightIds.set(r,n+1)}else this._highlightIds.set(r,1)}this._updateHighlight()},t.prototype.removeHighlight=function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t];if(this._highlightIds.has(r)){var n=this._highlightIds.get(r)-1;0===n?this._highlightIds.delete(r):this._highlightIds.set(r,n)}}this._updateHighlight()},t.prototype._updateHighlight=function(){var e=this,t=l.keysOfMap(this._highlightIds),i=t.map((function(t){return e._displayIds.get(t)}));this._attributeStore.setHighlight(t,i)},t.prototype._getIntersectingTiles=function(e){var t=this._graphicStore.getBounds(e);return t&&0!==f.width(t)&&0!==f.height(t)?this._tileStore.boundsIntersections(t):[]},t.prototype._updateTile=function(e){var t=this,i=e.tile,r=this._getGraphicsData(this._templateStore,i,e.addedOrModified);return this._processGraphics(r).then((function(r){return t._patchTile(i.key,{type:"update",addOrUpdate:r,remove:e.removed,end:!0}),r}))},t.prototype._patchTile=function(e,t){if(this._tiles.has(e)){var i=this._tiles.get(e);this.container.onTileData(i,t),this.container.requestRender()}},t.prototype._graphicsChangeHandler=function(e){for(var t=0,i=e.added;t<i.length;t++){var r=i[t];this._pendingUpdate.addOrModified.add(r)}for(var n=0,o=e.moved;n<o.length;n++)this._pendingUpdate.addOrModified.add(r=o[n]);for(var s=0,a=e.removed;s<a.length;s++)this._pendingUpdate.addOrModified.has(r=a[s])?this._pendingUpdate.addOrModified.delete(r):this._pendingUpdate.removed.add(r);this._processing?this._needsProcessing=!0:this._updateGraphics()},t.prototype._getFeaturesToUpdate=function(){for(var e=this,t={addOrModified:[],removed:[]},i=0,r=this.graphics.items;i<r.length;i++){var n=r[i];this._pendingUpdate.addOrModified.has(n)&&t.addOrModified.push(n)}return this._pendingUpdate.removed.forEach((function(i){e._graphicStore.has(i)&&t.removed.push(i)})),this._pendingUpdate.addOrModified.clear(),this._pendingUpdate.removed.clear(),t},t.prototype._updateGraphics=function(){return i.__awaiter(this,void 0,void 0,(function(){var e,t,r,n,s,a,l,u,d,p,c,g,y,f,m,_,v,b,S,x,w,M,G=this;return i.__generator(this,(function(i){switch(i.label){case 0:this._processing=!0,e=this._getFeaturesToUpdate(),t=e.addOrModified,r=e.removed,n=this._tilesToUpdate,i.label=1;case 1:for(i.trys.push([1,4,,5]),this._graphicStoreUpdate||(a=this.view.featuresTilingScheme.getClosestInfoForScale((s=this.view.state).scale).level,this._graphicStore.updateLevel(a),this._tileStore.setViewState(s)),l=[],u=new Array(t.length),_=0;_<t.length;_++)u[_]=d=t[_],this._graphicsSet.add(d),l.push(this.addGraphic(d));for(p=0,c=r;p<c.length;p++){for(this._abortProcessingGraphic((g=c[p]).uid),v=this._getIntersectingTiles(g),y=0,f=v;y<f.length;y++)k((x=f[y]).key.id,x,n).removed.push(this._displayIds.get(g.uid));this._graphicsSet.delete(g),this._graphicStore.remove(g)}return this._flipUpdatingGraphics(),[4,h.all(l)];case 2:for(i.sent(),m=void 0,_=0;_<u.length;_++)for(v=this._getIntersectingTiles(m=u[_]),b=0,S=v;b<S.length;b++)k((x=S[b]).key.id,x,n).addedOrModified.push(m);return this._graphicStore.updateZ(),w=[],n.forEach((function(e){return w.push(G._updateTile(e))})),[4,h.all(w)];case 3:return i.sent(),[3,5];case 4:return M=i.sent(),o("esri-2d-debug")&&console.debug("Encountered an error when updating graphics:",M),[3,5];case 5:return n.clear(),this.notifyChange("updating"),this._processing=!1,this._needsProcessing&&(this._needsProcessing=!1,this._updateGraphics()),[2]}}))}))},t.prototype._getArcadeInfo=function(e){var t=(e.attributes?Object.keys(e.attributes):[]).map((function(t){return{name:t,alias:t,type:"string"==typeof e.attributes[t]?"esriFieldTypeString":"esriFieldTypeDouble"}}));return u.isNone(e.geometry)?null:{geometryType:_.getJsonType(e.geometry),spatialReference:y.fromJSON(e.geometry.spatialReference),fields:t}},t.prototype._getSymbolForGraphic=function(e,t){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(i){return u.isSome(e.symbol)?[2,e.symbol]:u.isSome(this.renderer)?[2,this.renderer.getSymbolAsync(e,{scale:this.view.scale,abortOptions:t})]:[2,this._getNullSymbol(e)]}))}))},t.prototype._getSymbolResources=function(e,t){return i.__awaiter(this,void 0,void 0,(function(){var r,n,o,s,a,l,u,d;return i.__generator(this,(function(i){switch(i.label){case 0:return this.container.stage?(r=this._getArcadeInfo(e),[4,this._getSymbolForGraphic(e,t)]):[2,h.resolve(null)];case 1:return n=i.sent(),o=z.createSymbolSchema(n),[4,S.expandSymbol(o,r,t)];case 2:if("esriTS"!==(s=i.sent()).type)return[3,4];for(a=[],l=T.bidiText(s.text)[0],u=0;u<l.length;u++)a.push(l.charCodeAt(u));return[4,this.container.getMaterialItems([{symbol:s,id:0,glyphIds:a}])];case 3:return d=i.sent()[0].mosaicItem,[2,{symbol:s,mosaicItem:d}];case 4:return[2,{symbol:s,mosaicItem:null}]}}))}))},t.prototype._projectAndNormalizeGeometry=function(e){return i.__awaiter(this,void 0,void 0,(function(){var t,r=this;return i.__generator(this,(function(i){return u.isNone(e.geometry)?[2,h.resolve(null)]:(_.isPolygon(t=e.geometry)?t.rings=t.rings:_.isPolyline(t)?t.paths=t.paths:_.isExtent(t)&&(t=g.fromExtent(t)),[2,b.checkProjectionSupport(t.spatialReference,this.view.spatialReference).then((function(){var e=F.normalizeCentralMeridian(t),i=b.project(e,t.spatialReference,r.view.spatialReference);return m.closeRingsAndFixWinding(i),i}))])}))}))},t.prototype._onTileUpdate=function(e){var t=v.getInfo(this.view.spatialReference);if(e.added&&e.added.length>0)for(var i=0,r=e.added;i<r.length;i++)this._addNewTile(r[i],t);if(e.removed&&e.removed.length>0)for(var n=0,o=e.removed;n<o.length;n++)this._removeTile(o[n].key)},t.prototype.addOrUpdateGraphic=function(e,t,i){return this._addOrUpdateGraphic(e,t,i)},t.prototype.addGraphic=function(e){var t=this;this._abortProcessingGraphic(e.uid);var i=d.createAbortController();return this._graphicIdToAbortController.set(e.uid,i),this._addOrUpdateGraphic(e,"add",{signal:i.signal}).then((function(){t._graphicIdToAbortController.delete(e.uid)})).catch((function(i){if(t._graphicIdToAbortController.delete(e.uid),!h.isAbortError(i))throw i}))},t.prototype._addOrUpdateGraphic=function(e,t,i){var r=this,n=this._projectAndNormalizeGeometry(e),o=this._getSymbolResources(e,i);return h.all([n,o]).then((function(n){var o=n[0],s=n[1];return"add"===t?r._addProjectedGraphic(e,s,o):r._updateGraphic(e,s,o,i)}))},t.prototype._addProjectedGraphic=function(e,t,i){this._graphicsSet.has(e)&&this._graphicStore.addOrModify(e,t,i)},t.prototype._updateGraphic=function(e,t,i,r){var n=this;if(!this._graphicStore.has(e)||h.isAborted(r))return h.resolve();for(var o=this._graphicStore.update(e,t,i),s=o.oldBounds,l=o.newBounds,u=0===f.width(s)&&0===f.height(s),d=0===f.width(l)&&0===f.height(l),p=u?[]:this._tileStore.boundsIntersections(s),c=d?[]:this._tileStore.boundsIntersections(l),g=a.acquire(),y=0,m=p;y<m.length;y++){var _=m[y];g.set(_.key,{addOrUpdate:null,remove:[this._displayIds.get(e.uid)]})}for(var v=0,b=c;v<b.length;v++){var S=this._getGraphicData(this._templateStore,_=b[v],e);if(g.has(_.key)){var x=g.get(_.key);x.remove.length=0,x.addOrUpdate=S}else g.set(_.key,{addOrUpdate:S,remove:null})}var w=[];return g.forEach((function(e,t){var i=n._processGraphics(e.addOrUpdate,r).then((function(i){n._patchTile(t,{type:"update",addOrUpdate:i,remove:e.remove,end:!0})}));w.push(i)})),a.release(g),h.all(w).then((function(){}))},t.prototype._addTile=function(e,t){var i=f.create();this.view.featuresTilingScheme.getTileBounds(i,e);var r=new G.WGLTile(e,i,!0),n={type:"update",clear:!0,addOrUpdate:t,remove:[],end:!0};this._tiles.set(e,r),this.container.addChild(r),r.setData(n)},t.prototype._addNewTile=function(e,t){var i=this,r=this._graphicStore.queryTileData(this._templateStore,e);if(t)for(var n=Math.round((t.valid[1]-t.valid[0])/e.resolution),o=0,s=r;o<s.length;o++){var a=s[o];a.geometry&&_.isPoint(a.geometry)&&this._wrapPoints(a,n)}var l=e.key;this._tileUpdateSet.add(e.key),this.notifyChange("updating"),this._processGraphics(r).then((function(e){i._addTile(l,e),i._tileUpdateSet.delete(l),i.notifyChange("updating")})).catch((function(e){if(i._tileUpdateSet.delete(l),i.notifyChange("updating"),!h.isAbortError(e))throw e}))},t.prototype._removeTile=function(e){if(this._tiles.has(e)){var t=this._tiles.get(e);this.container.removeChild(t),t.destroy(),this._tiles.delete(e)}},t.prototype._setFilterState=function(e,t){var i=this._displayIds.get(e),r=this._attributeStore.getHighlightFlag(e);this._attributeStore.setData(i,0,0,r|(t?w.FILTER_FLAG_0:0))},t.prototype._getGraphicsData=function(e,t,i){var r=v.getInfo(this.view.spatialReference),n=this._graphicStore.getGraphicsData(e,t,i);if(r)for(var o=Math.round((r.valid[1]-r.valid[0])/t.resolution),s=0,a=n;s<a.length;s++){var l=a[s];l.geometry&&_.isPoint(l.geometry)&&this._wrapPoints(l,o)}return n.sort((function(e,t){return e.insertAfter-t.insertAfter})),n},t.prototype._getGraphicData=function(e,t,i){var r=this._graphicStore.getGraphicData(e,t,i),n=[r],o=v.getInfo(this.view.spatialReference);if(o){var s=Math.round((o.valid[1]-o.valid[0])/t.resolution);r.geometry&&_.isPoint(r.geometry)&&this._wrapPoints(r,s)}return n},t.prototype._wrapPoints=function(e,t){var i=e.geometry;512===t?i.x<20?e.geometry={points:[[i.x,i.y],[t,0]]}:i.x>492&&(e.geometry={points:[[i.x,i.y],[-t,0]]}):i.x<-20?e.geometry={points:[[i.x,i.y],[t,0]]}:i.x>532&&(e.geometry={points:[[i.x,i.y],[-t,0]]})},t.prototype._processGraphics=function(e,t){return i.__awaiter(this,void 0,void 0,(function(){var r,n,o,s;return i.__generator(this,(function(i){switch(i.label){case 0:return e&&e.length&&this._meshFactory?(r=U.GraphicsReader.from(e),o=(n=this._meshFactory).analyzeGraphics,s=[r],[4,this._matcher]):[2,null];case 1:return[4,o.apply(n,s.concat([i.sent(),null,null,t]))];case 2:return i.sent(),this._attributeStore.sendUpdates(),[2,this._processAnalyzedGraphics(r)]}}))}))},t.prototype._processAnalyzedGraphics=function(e){for(var t=this._meshFactory,i=t.createMeshData(e.getApproximateSize()),r=e.getCursor();r.next();){var n=r.readGraphic();n.insertAfter=-1===n.insertAfter?-1:this._displayIds.get(n.insertAfter),n.displayId=this._displayIds.get(n.attributes[this.uid]),t.writeGraphic(i,r)}var o={};return i.encode(o,[]),M.TileData.decode(o)},t.prototype._abortProcessingGraphic=function(e){this._graphicIdToAbortController.has(e)&&this._graphicIdToAbortController.get(e).abort()},t.prototype._getNullSymbol=function(e){var t=e.geometry;return _.isPolyline(t)?x.errorPolylineSymbol2D:_.isPolygon(t)||_.isExtent(t)?x.errorPolygonSymbol2D:x.errorPointSymbol2D},t.prototype._flipUpdatingGraphics=function(){var e=this;this._updatingGraphicsTimer&&clearTimeout(this._updatingGraphicsTimer),this._updatingGraphicsTimer=setTimeout((function(){e._updatingGraphicsTimer=null,e.notifyChange("updating")}),160),this.notifyChange("updating")},i.__decorate([c.property()],t.prototype,"_graphicProcessingQueue",void 0),i.__decorate([c.property({constructOnly:!0})],t.prototype,"requestUpdateCallback",void 0),i.__decorate([c.property({constructOnly:!0})],t.prototype,"graphics",void 0),i.__decorate([c.property({dependsOn:["_graphicProcessingQueue.updating"]})],t.prototype,"updating",null),i.__decorate([c.property()],t.prototype,"view",void 0),i.__decorate([c.property()],t.prototype,"updateRequested",void 0),i.__decorate([c.subclass("esri.views.2d.layers.support.GraphicsView2D")],t)}(D.GraphicsView(n.HandleOwnerMixin(s.IdentifiableMixin(r))));t.default=B}).apply(null,r))||(e.exports=n)},dXKx:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("pcDC"),i("LxLY"),i("x7Wq"),i("CF4u"),i("NsXp"),i("Z91k"),i("35hF")],void 0===(n=(function(e,t,i,r,n,o,s,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorPolygonSymbol2D=t.errorPolylineSymbol2D=t.errorPointSymbol2D=t.getDefaultSymbol2D=t.defaultTextSymbol2D=t.defaultPolygonSymbol2D=t.defaultPolylineSymbol2D=t.defaultPointSymbol2D=void 0,t.defaultPointSymbol2D=s.fromJSON(l.defaultPointSymbolJSON),t.defaultPolylineSymbol2D=o.fromJSON(l.defaultPolylineSymbolJSON),t.defaultPolygonSymbol2D=n.fromJSON(l.defaultPolygonSymbolJSON),t.defaultTextSymbol2D=a.fromJSON(l.defaultTextSymbolJSON),t.getDefaultSymbol2D=function(e){if(r.isNone(e))return null;switch(e.type){case"mesh":return null;case"point":case"multipoint":return t.defaultPointSymbol2D;case"polyline":return t.defaultPolylineSymbol2D;case"polygon":case"extent":return t.defaultPolygonSymbol2D;default:i.neverReached(e)}return null},t.errorPointSymbol2D=s.fromJSON(l.errorPointSymbolJSON),t.errorPolylineSymbol2D=o.fromJSON(l.errorPolylineSymbolJSON),t.errorPolygonSymbol2D=n.fromJSON(l.errorPolygonSymbolJSON)}).apply(null,r))||(e.exports=n)},loiZ:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("SyoC")],void 0===(n=(function(e,t,i){"use strict";var r=function(){function e(e,t){void 0===e&&(e=50),void 0===t&&(t=50),this._pool=new i(Map,void 0,(function(e){return e.clear()}),t,e)}return e.prototype.acquire=function(){return this._pool.acquire()},e.prototype.release=function(e){this._pool.release(e)},e.acquire=function(){return n.acquire()},e.release=function(e){return n.release(e)},e}(),n=new r(100);return r}).apply(null,r))||(e.exports=n)},vhZU:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("zOht"),i("Gtr7"),i("qMld"),i("afW+"),i("Vx27")],void 0===(n=(function(e,t,i,r,n,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){var i=e.call(this,t)||this;return i._queue=new Map,i._queueArray=[],i._onGoingGraphic=null,i._onGoingPromise=null,i._scheduledNextHandle=null,i._next=i._next.bind(i),i._finalize=i._finalize.bind(i),i}return i.__extends(t,e),Object.defineProperty(t.prototype,"length",{get:function(){return this._queueArray.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"updating",{get:function(){return this._queueArray.length>0||null!==this._onGoingPromise},enumerable:!1,configurable:!0}),t.prototype.cancel=function(e){if(this._onGoingGraphic&&this._onGoingGraphic.graphic===e&&(this._ongoingAbortController.abort(),this._onGoingGraphic=this._onGoingPromise=null),this._queue.has(e)){var t=this._queue.get(e);this._queue.delete(e);var i=this._queueArray.indexOf(t);this._queueArray.slice(i,1)}this._scheduleNext(),this.notifyChange("updating")},t.prototype.clear=function(){this._queue.clear(),this._queueArray.length=0,this._onGoingPromise&&(this._ongoingAbortController.abort(),this._onGoingGraphic=this._onGoingPromise=null),this._cancelNext(),this.notifyChange("updating")},t.prototype.has=function(e){return this._queue.has(e)},t.prototype.isOngoing=function(e){return this._onGoingGraphic&&this._onGoingGraphic.graphic===e},t.prototype.push=function(e,t){if(!this._queue.has(e)){var i={graphic:e,addOrUpdate:t};this._queueArray.push(i),this._queue.set(e,i),this._scheduleNext(),this.notifyChange("updating")}},t.prototype.refresh=function(){this.reset()},t.prototype.reset=function(){var e=this._onGoingGraphic;e&&this.push(e.graphic,e.addOrUpdate)},t.prototype._finalize=function(){this._onGoingGraphic=null,this._ongoingAbortController=null,this._onGoingPromise=null,this.notifyChange("updating"),this._scheduleNext()},t.prototype._cancelNext=function(){this._scheduledNextHandle&&(this._scheduledNextHandle.remove(),this._scheduledNextHandle=null)},t.prototype._scheduleNext=function(){this._scheduledNextHandle||0===this._queue.size||null!=this._onGoingGraphic||(this._scheduledNextHandle=o.schedule(this._next))},t.prototype._next=function(){if(null==this._scheduledNextHandle||0===this._queue.size||this._onGoingGraphic)this._scheduledNextHandle=null;else{this._scheduledNextHandle=null;var e=this._peek(),t=e.graphic,i=e.addOrUpdate,r=n.createAbortController();this._queue.delete(t),this._onGoingGraphic=e,this._onGoingPromise=this.process(t,i,{signal:r.signal}),this._ongoingAbortController=r,this._onGoingPromise.then(this._finalize,this._finalize),this.notifyChange("updating")}},t.prototype._peek=function(){return 0===this._queueArray.length?null:this._queueArray.pop()},i.__decorate([s.property({readOnly:!0})],t.prototype,"length",null),i.__decorate([s.property({readOnly:!0})],t.prototype,"updating",null),i.__decorate([s.property({constructOnly:!0})],t.prototype,"process",void 0),i.__decorate([s.subclass("esri.views.2d.layers.graphics.GraphicProcessingQueue")],t)}(r);t.default=a}).apply(null,r))||(e.exports=n)},wjMf:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("H1tY"),i("LxLY"),i("jBNx"),i("aMdW"),i("Zx0K"),i("W9tT"),i("ab6c"),i("Z4y+"),i("lRq4"),i("hBh5"),i("Thzy"),i("Lzvl"),i("fw2w"),i("nrlZ"),i("nrlZ"),i("Ahpp"),i("B+Jm"),i("vsbv"),i("2Gaw")],void 0===(n=(function(e,t,i,r,n,o,s,a,l,u,h,d,p,c,g,y,f,m,_,v,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTextSymbolSize=t.normalizeCentralMeridian=t.getTextSymbolBounds=t.getCIMMarkerBounds=t.getMarkerSymbolBounds=t.isPointOnPolyline=t.graphicGeometryToNumber=t.isMarkerSymbol=t.getBounds=void 0;var S=Math.PI/180,x=s.mat2df32.create(),w=l.vec2f32.create(),M=h.create();t.getBounds=function(e,t,r,n,o,s,a){if(!n||!r.symbol)return e[0]=e[1]=e[2]=e[3]=0,t[0]=t[1]=t[2]=t[3]=0,e;var l=n;if(!c.isPoint(l)){d.getBoundsXY(e,l);var u=t[0];0===u&&(u=function e(t){switch(t.symbol.type){case"esriSFS":case"esriPFS":var r=t.symbol.outline;return r?r.width:0;case"esriSLS":return t.symbol.width;case"esriSMS":return t.symbol.size;case"esriPMS":return Math.max(t.symbol.width,t.symbol.height);case"esriTS":var n=[0,0,0,0];q(n,t.symbol,t.mosaicItem);var o=Math.max(Math.abs(n[0]),Math.abs(n[1]));return Math.max(n[2],n[3])+o;case"expanded-cim":var s=m.CIMSymbolHelper.getEnvelope(t.symbol.data);return Math.sqrt(s.width*s.width+s.height*s.height);case"composite-symbol":return t.symbol.layers.length?e({symbol:t.symbol.layers[t.symbol.layers.length-1],mosaicItem:null}):0;case"label":default:return i("esri-2d-debug")&&console.debug("Resource of type "+t.symbol.type+" not valid for graphics"),0}}(r),t[0]=u);var h=o*u/2;return e[0]-=h,e[1]-=h,e[2]+=h,e[3]+=h,e}var p=l.x,y=l.y;return"esriTS"===r.symbol.type&&0===t[2]&&0===t[3]&&q(t,r.symbol,r.mosaicItem),function(e,t,i,r,n,o,s,a){var l;switch(r.type){case"esriSMS":case"esriPMS":l=N(t,i,r,o,s,0);break;case"esriTS":l=A(t,i,r,n,o,0);break;case"cim":case"CIMSymbolReference":case"expanded-cim":l=U(t,i,r,o,s,0)}for(var u,h=0,d=0;d<l.rings[0].length-1;d++)u=l.rings[0][d],h=Math.max(h,(t-u[0])*(t-u[0])+(i-u[1])*(i-u[1]));h=Math.sqrt(h);var p=g.normalizeMapX(t-h,a),c=g.normalizeMapX(t+h,a);if(p>c){var y=f.getInfo(a);if(y){var m=y.valid;p=m[0],c=m[1]}}e[0]=p,e[1]=i-h,e[2]=c,e[3]=i+h}(e,p,y,r.symbol,t,o,s,a),e},t.isMarkerSymbol=function(e){return"simple-marker"===e||"picture-marker"===e||"text"===e},t.graphicGeometryToNumber=function(e){switch(r.unwrap(e.geometry).type){case"point":case"multipoint":return 0;case"polyline":return 1;case"polygon":case"extent":return 2}return 0};var G=l.vec2f32.create(),P=l.vec2f32.create(),O=l.vec2f32.create(),I=l.vec2f32.create(),T=l.vec2f32.create(),z=l.vec2f32.create(),C=l.vec2f32.create();function N(e,t,i,r,s,l){var u,h,d=n.pt2px(i.xoffset),p=n.pt2px(i.yoffset),c=S*i.angle,g=S*l;switch(i.type){case"esriSMS":u=h=n.pt2px(i.size);break;case"esriPMS":u=n.pt2px(i.width),h=n.pt2px(i.height)}s<.04&&(r=.04*r/s);var y=o.mat2d.identity(x);o.mat2d.translate(y,y,a.vec2.set(w,e,t)),o.mat2d.rotate(y,y,g-c),o.mat2d.scale(y,y,a.vec2.set(w,r,-r)),o.mat2d.translate(y,y,a.vec2.set(w,d,-p));var f=[0,0];a.vec2.transformMat2d(f,a.vec2.set(w,-.5*u,-.5*h),y);var m=[0,0];a.vec2.transformMat2d(m,a.vec2.set(w,-.5*u,.5*h),y);var _=[0,0];a.vec2.transformMat2d(_,a.vec2.set(w,.5*u,-.5*h),y);var v=[0,0];return a.vec2.transformMat2d(v,a.vec2.set(w,.5*u,.5*h),y),{rings:[[f,_,v,m,f]]}}function U(e,t,i,r,s,l){var u=m.CIMSymbolHelper.getEnvelope(i.data);if(!u)return null;s<.04&&(r=.04*r/s);var h=n.pt2px(u.width),d=n.pt2px(u.height),p=n.pt2px(u.x),c=n.pt2px(u.y),g=0*S,y=S*l,f=o.mat2d.identity(x);o.mat2d.translate(f,f,a.vec2.set(w,e,t)),o.mat2d.rotate(f,f,y-g),o.mat2d.scale(f,f,a.vec2.set(w,r,r));var _=[0,0];a.vec2.transformMat2d(_,a.vec2.set(w,p,c+d),f);var v=[0,0];a.vec2.transformMat2d(v,a.vec2.set(w,p,c),f);var b=[0,0];a.vec2.transformMat2d(b,a.vec2.set(w,p+h,c+d),f);var M=[0,0];return a.vec2.transformMat2d(M,a.vec2.set(w,p+h,c),f),{rings:[[_,b,M,v,_]]}}function A(e,t,i,r,s,l){var u=n.pt2px(i.xoffset),h=n.pt2px(i.yoffset),d=S*i.angle,p=S*l,c=o.mat2d.identity(x);o.mat2d.translate(c,c,a.vec2.set(w,e,t)),o.mat2d.rotate(c,c,p),o.mat2d.scale(c,c,a.vec2.set(w,s,-s));var g=r[0]+r[2]/2,y=r[1]+r[3]/2;o.mat2d.translate(c,c,a.vec2.set(w,u,-h)),o.mat2d.translate(c,c,a.vec2.set(w,g,y)),o.mat2d.rotate(c,c,d),o.mat2d.translate(c,c,a.vec2.set(w,-g,-y));var f=[0,0];a.vec2.transformMat2d(f,a.vec2.set(w,r[0],r[1]),c);var m=[0,0];a.vec2.transformMat2d(m,a.vec2.set(w,r[0],r[1]+r[3]),c);var _=[0,0];a.vec2.transformMat2d(_,a.vec2.set(w,r[0]+r[2],r[1]),c);var v=[0,0];return a.vec2.transformMat2d(v,a.vec2.set(w,r[0]+r[2],r[1]+r[3]),c),{rings:[[f,_,v,m,f]]}}function q(e,t,i){if(!i||0===i.glyphMosaicItems.length)return e;var r=b.bidiText(t.text)[1],o=v.shapeGlyphs(i.glyphMosaicItems,r,{scale:n.pt2px(t.font.size)/24,angle:t.angle,xOffset:t.xoffset,yOffset:t.yoffset,hAlign:_.getXAnchorDirection(t.horizontalAlignment||"center"),vAlign:_.getYAnchorDirection(t.verticalAlignment||"baseline"),maxLineWidth:Math.max(32,Math.min(t.lineWidth||512,512)),lineHeight:30*Math.max(.25,Math.min(t.lineHeight||1,4)),decoration:t.font.decoration||"none",isCIM:!1}).bounds;return e[0]=o.x-o.halfWidth,e[1]=o.y-o.halfHeight,e[2]=o.width,e[3]=o.height,e}t.isPointOnPolyline=function(e,t,i,r){a.vec2.set(O,t,i);for(var n,o,s,l,u,h,d,p,c,g=e.paths,y=1/0,f=0;f<g.length;f++){var m=g[f];if(!(m.length<2))for(var _=1;_<m.length;_++)n=m[_-1][0],s=m[_-1][1],o=m[_][0],l=m[_][1],u=Math.min(n,o)-r,h=Math.min(s,l)-r,d=Math.max(n,o)+r,p=Math.max(s,l)+r,t<u||t>d||i<h||i>p||(a.vec2.set(G,n,s),a.vec2.set(P,o,l),a.vec2.subtract(I,P,G),a.vec2.subtract(T,G,O),a.vec2.scale(z,I,a.vec2.dot(I,T)/a.vec2.dot(I,I)),a.vec2.subtract(C,T,z),y>(c=a.vec2.dot(C,C))&&(y=c))}return Math.sqrt(y)<=r},t.getMarkerSymbolBounds=N,t.getCIMMarkerBounds=U,t.getTextSymbolBounds=A,t.normalizeCentralMeridian=function(e){var t,i,r,n,o,s,a,l,u=null;if(!e)return null;if("mesh"===e.type)return e.toJSON();if(!(i=y.getInfo(t=e.spatialReference)))return e.toJSON();r=j[o=t.isWebMercator?102100:4326].maxX,n=j[o].minX,s=j[o].plus180Line,a=j[o].minus180Line;var h=e.toJSON();if(c.isPoint(h))l=B(h,r,n);else if(c.isMultipoint(h))h.points=h.points.map((function(e){return B(e,r,n)})),l=h;else if(c.isExtent(h))l=function(e,t){if(!t)return e;var i=function(e,t){var i,r=[],n=e.ymin,o=e.ymax,s=e.xmax-e.xmin,a=e.xmin,l=e.xmax,u=t.valid,h=u[0],d=u[1],p=(i=F(e.xmin,t)).x,c=i.frameId,g=(i=F(e.xmax,t)).x,y=i.frameId,f=p===g&&s>0;if(s>2*d){var m={xmin:a<l?p:g,ymin:n,xmax:d,ymax:o},_={xmin:h,ymin:n,xmax:a<l?g:p,ymax:o},v={xmin:0,ymin:n,xmax:d,ymax:o},b={xmin:h,ymin:n,xmax:0,ymax:o},S=[],x=[];D(m,v)&&S.push(c),D(m,b)&&x.push(c),D(_,v)&&S.push(y),D(_,b)&&x.push(y);for(var w=c+1;w<y;w++)S.push(w),x.push(w);r.push({extent:m,frameIds:[c]},{extent:_,frameIds:[y]},{extent:v,frameIds:S},{extent:b,frameIds:x})}else p>g||f?r.push({extent:{xmin:p,ymin:n,xmax:d,ymax:o},frameIds:[c]},{extent:{xmin:h,ymin:n,xmax:g,ymax:o},frameIds:[y]}):r.push({extent:{xmin:p,ymin:n,xmax:g,ymax:o},frameIds:[c]});return r}(e,t).map((function(e){return e.extent}));return i.length<2?i[0]||e:i.length>2?(e.xmin=t.valid[0],e.xmax=t.valid[1],e):{rings:i.map((function(e){return[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]}))}}(h,i);else if(c.isPolygon(h)||c.isPolyline(h)){var g=M;d.getBoundsXY(g,h);var f={xmin:g[0],ymin:g[1],xmax:g[2],ymax:g[3]},m=R(f.xmin,n)*(2*r),_=0===m?h:function(e,t){for(var i=0,r=function(e){return c.isPolygon(e)?e.rings:e.paths}(e);i<r.length;i++)for(var n=0,o=r[i];n<o.length;n++)o[n][0]+=t;return e}(h,m);f.xmin+=m,f.xmax+=m,p.extentIntersectsPolyline(f,s)&&f.xmax!==r||p.extentIntersectsPolyline(f,a)&&f.xmin!==n?u=_:l=_}else l=e.clone();return null!==u?(new L).cut(u,r):l},t.getTextSymbolSize=q;var j={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:{paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:u.WebMercator},minus180Line:{paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:u.WebMercator}},4326:{maxX:180,minX:-180,plus180Line:{paths:[[[180,-180],[180,180]]],spatialReference:u.WGS84},minus180Line:{paths:[[[-180,-180],[-180,180]]],spatialReference:u.WGS84}}};function R(e,t){return Math.ceil((e-t)/(2*t))}function F(e,t){var i,r=t.valid,n=r[0],o=r[1],s=2*o,a=0;return e>o?(e-=(i=Math.ceil(Math.abs(e-o)/s))*s,a=i):e<n&&(e+=(i=Math.ceil(Math.abs(e-n)/s))*s,a=-i),{x:e,frameId:a}}function D(e,t){var i=t.xmin,r=t.ymin,n=t.xmax,o=t.ymax;return k(e,i,r)&&k(e,i,o)&&k(e,n,o)&&k(e,n,r)}function k(e,t,i){return t>=e.xmin&&t<=e.xmax&&i>=e.ymin&&i<=e.ymax}function B(e,t,i){var r;if(Array.isArray(e))if((r=e[0])>t){var n=R(r,t);e[0]=r+n*(-2*t)}else r<i&&(n=R(r,i),e[0]=r+n*(-2*i));else(r=e.x)>t?(n=R(r,t),e.x+=n*(-2*t)):r<i&&(n=R(r,i),e.x+=n*(-2*i));return e}var L=function(){function e(){}return e.prototype.cut=function(e,t){var i;if(e.rings)this.closed=!0,i=e.rings,this.minPts=4;else{if(!e.paths)return null;this.closed=!1,i=e.paths,this.minPts=2}for(var r=i.length,n=-2*t,o=0;o<r;o++){var s=i[o];if(s&&s.length>=this.minPts){for(var a=[],l=0,u=s;l<u.length;l++){var h=u[l];a.push([h[0]+n,h[1]])}i.push(a)}}return this.closed?e.rings=i:e.paths=i,e},e}()}).apply(null,r))||(e.exports=n)},zRH3:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("zOht"),i("Vx27")],void 0===(n=(function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GraphicsView=void 0,t.GraphicsView=function(e){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.graphics=null,t.renderer=null,t.view=null,t}return i.__extends(t,e),i.__decorate([r.property()],t.prototype,"graphics",void 0),i.__decorate([r.property()],t.prototype,"renderer",void 0),i.__decorate([r.property()],t.prototype,"updating",void 0),i.__decorate([r.property()],t.prototype,"view",void 0),i.__decorate([r.subclass("esri.views.layers.GraphicsView")],t)}(e)}}).apply(null,r))||(e.exports=n)}}]);