(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{kvvF:function(e,t,i){"use strict";i.r(t),i.d(t,"DirectLineMeasurement3DController",(function(){return g}));var a=i("pO5D"),s=(i("wSAH"),i("srIe")),n=(i("6S2I"),i("zqDF"),i("WbKI")),c=i("04ZG"),r=(i("4EHJ"),i("ju1D"),i("9AIY"),i("/CmD")),o=i("UhwK"),d=i("OKTS"),l=i("Cy1f"),h=i("5DEt"),b=i("r0DZ"),O=i("N5XI"),j=i("9pTf"),p=i("gYg2"),u=i("n4FQ"),m=i("QLbw"),_=i("6lH3"),w=i("9lO2");let g=class extends r.a{constructor(e){super(e),this._tempStartPosition=Object(l.e)(),this._tempEndPosition=Object(l.e)(),this._tempCornerPosition=Object(l.e)(),this._unitNormalizer=new w.a,this._handles=new b.a}initialize(){this._handles.add(Object(O.whenOnce)(this.view,"ready",()=>this._initialize(),!0))}_initialize(){const e=this.view.spatialReference,t=Object(j.g)(e),i=t===j.a?j.d:t;this._sphericalPCPF=i;const a=Object(p.b)(e,i);this._unitNormalizer.spatialReference=a?i:e,this._handles.add([this.dataObject.watch("startPoint",()=>this._updateMeasurement(),!0),this.dataObject.watch("endPoint",()=>this._updateMeasurement(),!0),this.dataObject.watch("settings",()=>this._updateMeasurement(),!0)],"model"),this._updateMeasurement()}_updateMeasurement(){const e=this.dataObject.startPoint,t=this.dataObject.endPoint;if(Object(s.j)(e)||Object(s.j)(t))return void(this.dataObject.measurement=null);const i=this._euclideanDistances(e,t),a=this._exactGeodesicDistanceAndAngle(e,t,i.horizontal.value);this.dataObject.measurement={directDistance:i.direct,horizontalDistance:i.horizontal,verticalDistance:i.vertical,geodesicDistance:a.distance,geodesicAngle:a.angle}}_euclideanDistances(e,t){e.z>t.z&&(e=[e,e=t][0]);const i=e.clone();i.z=t.z;const a=this._tempStartPosition,s=this._tempEndPosition,n=this._tempCornerPosition,c=this.view.spatialReference,r=this._sphericalPCPF,o=Object(p.b)(c,r)?r:c;Object(p.o)(e,a,o),Object(p.o)(t,s,o),Object(p.o)(i,n,o);const d=Object(h.n)(a,s),l=Object(h.n)(n,s),b=Math.abs(t.z-e.z),O=e=>this._unitNormalizer.normalizeDistance(e),j=O(d),m=O(l),_=O(b);return{direct:new u.a(j,"meters"),horizontal:new u.a(m,"meters"),vertical:new u.a(_,"meters")}}_exactGeodesicDistanceAndAngle(e,t,i){const a=e.spatialReference,s=new o.a({paths:[e,t],spatialReference:a}),n=a.isGeographic&&Object(m.g)(a)?Object(m.e)([s],"meters")[0]:a.isWebMercator?Object(_.geodesicLength)(s,"meters"):void 0,{distance:c,angle:r}=n?{distance:n,angle:this._fallbackGeodesicAngle(n,a)}:this._fallbackGeodesicDistance(e,t,i);return{distance:new u.a(c,"meters"),angle:new u.a(r,"degrees")}}_fallbackGeodesicAngle(e,t){return e/Object(j.e)(t).metersPerDegree}_fallbackGeodesicDistance(e,t,i){if(Object(p.p)(e,D)){Object(p.p)(t,f);const e=Object(d.d)(D[0]),i=Object(d.d)(D[1]),a=Object(d.d)(f[0]),s=Object(d.d)(f[1]),n=Math.abs(a-e),c=Object(d.a)(Math.sin(i)*Math.sin(s)+Math.cos(i)*Math.cos(s)*Math.cos(n)),r=Object(d.n)(c),o={distance:0};return Object(m.f)(o,[D[0],D[1]],[f[0],f[1]]),{distance:o.distance,angle:r}}return{distance:i,angle:this._fallbackGeodesicAngle(i,e.spatialReference)}}};Object(a.a)([Object(n.b)()],g.prototype,"view",void 0),Object(a.a)([Object(n.b)()],g.prototype,"dataObject",void 0),g=Object(a.a)([Object(c.a)("esri.views.3d.interactive.graphics.DirectLineMeasurement3D.DirectLineMeasurement3DController")],g);const D=Object(l.e)(),f=Object(l.e)()}}]);