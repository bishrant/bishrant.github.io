(function(){var t={"arcgis-js-api/layers/support/rasterFunctions/pixelUtils":"SAwq","esri/layers/support/rasterFunctions/pixelUtils":"SAwq","arcgis-js-api/layers/support/PixelBlock":"dXLH","esri/layers/support/PixelBlock":"dXLH"},e=this||window,i=e.webpackJsonp=e.webpackJsonp||[];i.registerAbsMids?i.registerAbsMids(t):(i.absMidsWaiting=i.absMidsWaiting||[]).push(t)})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{SAwq:function(t,e,i){var r,a;r=[i.dj.c(t.i),e,i("dXLH")],void 0===(a=(function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.approximateTransform=e.clip=e.resampleByMajority=e.setValidBoundary=e.mosaic=e.mosaicPixelData=e.getClipBounds=e.remapColor=e.lookupPixels=e.stretch=e.createContrastBrightnessLUT=e.createStretchLUT=e.estimateStatisticsFromHistograms=e.estimateStatisticsHistograms=e.colorize=e.createColormapLUT=e.extractBands=void 0;var r=function(t){return t&&"esri.layers.support.PixelBlock"===t.declaredClass&&t.pixels&&t.pixels.length>0};function a(t,e){var i,r,a=Math.min(Math.max(t,-100),100),n=Math.min(Math.max(e,-100),100),s=new Uint8Array(256);for(i=0;i<256;i++)a>0&&a<100?r=(200*i-25500+510*n)/(2*(100-a))+128:a<=0&&a>-100?r=(200*i-25500+510*n)*(100+a)/2e4+128:100===a?r=(r=200*i-25500+256*(100-a)+510*n)>0?255:0:-100===a&&(r=128),s[i]=r>255?255:r<0?0:r;return s}function n(t,e,i,r,a,n,s,o){return{xmin:a<=i*t?0:a<i*t+t?a-i*t:t,ymin:n<=r*e?0:n<r*e+e?n-r*e:e,xmax:a+s<=i*t?0:a+s<i*t+t?a+s-i*t:t,ymax:n+o<=r*e?0:n+o<r*e+e?n+o-r*e:e}}function s(t,e,a,s){var o=t.filter((function(t){return r(t)}))[0];if(null==o)return null;var l,h,u,p,f,c,x,m,d,y,g,v,w,k=s?s.width:e.width,A=s?s.height:e.height,M=o.width,B=o.height,b=e.width/M,U=e.height/B,C=a?a.x:0,T=a?a.y:0,_=o.pixelType,P=i.getPixelArrayConstructor(_),S=o.pixels.length,F=[];for(c=0;c<S;c++){for(h=new P(k*A),x=0;x<U;x++)for(m=0;m<b;m++)if(u=t[x*b+m])for(l=u.pixels[c],d=(g=n(M,B,m,x,C,T,k,A)).ymin;d<g.ymax;d++)for(p=(x*B+d-T)*k+(m*M-C),f=d*M,y=g.xmin;y<g.xmax;y++)h[p+y]=l[f+y];F.push(h)}if(t.some((function(t){return null==t||t.mask&&t.mask.length>0})))for(v=new Uint8Array(k*A),x=0;x<U;x++)for(m=0;m<b;m++)if(w=(u=t[x*b+m])?u.mask:null,g=n(M,B,m,x,C,T,k,A),w)for(d=g.ymin;d<g.ymax;d++)for(p=(x*B+d-T)*k+(m*M-C),f=d*M,y=g.xmin;y<g.xmax;y++)v[p+y]=w[f+y];else if(u)for(d=g.ymin;d<g.ymax;d++)for(p=(x*B+d-T)*k+(m*M-C),f=d*M,y=g.xmin;y<g.xmax;y++)v[p+y]=1;else for(d=g.ymin;d<g.ymax;d++)for(p=(x*B+d-T)*k+(m*M-C),f=d*M,y=g.xmin;y<g.xmax;y++)v[p+y]=0;var j=new i({width:k,height:A,pixels:F,pixelType:_,mask:v});return j.updateStatistics(),j}function o(t){if(!r(t))return null;for(var e=t.clone(),i=t.width,a=t.height,n=t.mask,s=t.pixels[0],o=e.pixels[0],p=2;p<a-1;p++){for(var f=new Map,c=p-2;c<p+2;c++)for(var x=0;x<4;x++)u(f,s[d=c*i+x],n?n[d]:1);o[p*i]=l(f),o[p*i+1]=o[p*i+2]=o[p*i];for(var m=3;m<i-1;m++){var d;u(f,s[d=(p-2)*i+m+1],n?n[d]:1),u(f,s[d=(p-1)*i+m+1],n?n[d]:1),u(f,s[d=p*i+m+1],n?n[d]:1),u(f,s[d=(p+1)*i+m+1],n?n[d]:1),h(f,s[d=(p-2)*i+m-3],n?n[d]:1),h(f,s[d=(p-1)*i+m-3],n?n[d]:1),h(f,s[d=p*i+m-3],n?n[d]:1),h(f,s[d=(p+1)*i+m-3],n?n[d]:1),o[p*i+m]=l(f)}o[p*i+m+1]=o[p*i+m]}for(m=0;m<i;m++)o[m]=o[i+m]=o[2*i+m],o[(a-1)*i+m]=o[(a-2)*i+m];return e.updateStatistics(),e}function l(t){if(0===t.size)return 0;for(var e=0,i=-1,r=0,a=t.keys(),n=a.next();!n.done;)(r=t.get(n.value))>e&&(i=n.value,e=r),n=a.next();return i}function h(t,e,i){if(0!==i){var r=t.get(e);1===r?t.delete(e):t.set(e,r-1)}}function u(t,e,i){0!==i&&t.set(e,t.has(e)?t.get(e)+1:1)}e.extractBands=function(t,e){if(!e||!r(t))return t;var a=t.pixels.length;return e&&e.some((function(t){return t>=a}))||1===a&&1===e.length&&0===e[0]?t:a!==e.length||e.some((function(t,e){return t!==e}))?new i({pixelType:t.pixelType,width:t.width,height:t.height,mask:t.mask,validPixelCount:t.validPixelCount,maskIsAlpha:t.maskIsAlpha,pixels:e.map((function(e){return t.pixels[e]})),statistics:t.statistics&&e.map((function(e){return t.statistics[e]}))}):t},e.createColormapLUT=function(t){if(t){var e=t.colormap;if(e&&0!==e.length){var i=e.sort((function(t,e){return t[0]-e[0]})),r=0;i[0][0]<0&&(r=i[0][0]);var a,n=Math.max(256,i[i.length-1][0]-r+1),s=new Uint8Array(4*n),o=[],l=0,h=0,u=5===i[0].length;if(n>65536)return i.forEach((function(t){o[t[0]-r]=u?t.slice(1):t.slice(1).concat([255])})),{indexed2DColormap:o,offset:r,alphaSpecified:u};if(t.fillUnspecified)for(l=(a=i[h])[0]-r;l<n;l++)s[4*l]=a[1],s[4*l+1]=a[2],s[4*l+2]=a[3],s[4*l+3]=u?a[4]:255,l===a[0]-r&&(a=h===i.length-1?a:i[++h]);else for(l=0;l<i.length;l++)s[h=4*((a=i[l])[0]-r)]=a[1],s[h+1]=a[2],s[h+2]=a[3],s[h+3]=u?a[4]:255;return{indexedColormap:s,offset:r,alphaSpecified:u}}}},e.colorize=function(t,e){if(!r(t))return t;if(!e&&(e.indexedColormap||e.indexed2DColormap))return t;var i=t.clone(),a=i.pixels,n=i.mask,s=i.width*i.height;if(1!==a.length)return t;var o,l=e.indexedColormap,h=e.indexed2DColormap,u=e.offset,p=e.alphaSpecified,f=l.length-1,c=0,x=a[0],m=new Uint8Array(x.length),d=new Uint8Array(x.length),y=new Uint8Array(x.length),g=0;if(l)if(n)for(c=0;c<s;c++)n[c]&&((g=4*(x[c]-u))<u||g>f?n[c]=0:(m[c]=l[g],d[c]=l[g+1],y[c]=l[g+2],n[c]=l[g+3]));else{for(n=new Uint8Array(s),c=0;c<s;c++)(g=4*(x[c]-u))<u||g>f?n[c]=0:(m[c]=l[g],d[c]=l[g+1],y[c]=l[g+2],n[c]=l[g+3]);i.mask=n}else if(n)for(c=0;c<s;c++)n[c]&&(m[c]=(o=h[x[c]])[0],d[c]=o[1],y[c]=o[2],n[c]=o[3]);else{for(n=new Uint8Array(s),c=0;c<s;c++)m[c]=(o=h[x[c]])[0],d[c]=o[1],y[c]=o[2],n[c]=o[3];i.mask=n}return i.pixels=[m,d,y],i.statistics=null,i.pixelType="u8",i.maskIsAlpha=p,i},e.estimateStatisticsHistograms=function(t){if(!r(t))return null;t.statistics||t.updateStatistics();var e,i,a,n,s,o,l,h,u,p,f,c,x,m,d=t.pixels,y=t.mask,g=t.pixelType,v=t.statistics,w=t.width*t.height,k=d.length,A=[],M=[];for(n=0;n<k;n++){if(o=new Uint32Array(256),h=d[n],"u8"===g)if(e=-.5,i=255.5,y)for(s=0;s<w;s++)y[s]&&o[h[s]]++;else for(s=0;s<w;s++)o[h[s]]++;else{if(a=((i=v[n].maxValue)-(e=v[n].minValue))/256,l=new Uint32Array(257),y)for(s=0;s<w;s++)y[s]&&l[Math.floor((h[s]-e)/a)]++;else for(s=0;s<w;s++)l[Math.floor((h[s]-e)/a)]++;for(s=0;s<255;s++)o[s]=l[s];o[255]=l[255]+l[256]}for(A.push({min:e,max:i,size:256,counts:o}),u=0,p=0,x=0,s=0;s<256;s++)u+=o[s],p+=s*o[s];for(m=p/u,s=0;s<256;s++)x+=o[s]*Math.pow(s-m,2);f=(m+.5)*(a=(i-e)/256)+e,c=Math.sqrt(x/(u-1))*a,M.push({min:e,max:i,avg:f,stddev:c})}return{statistics:M,histograms:A}},e.estimateStatisticsFromHistograms=function(t){for(var e=[],i=0;i<t.length;i++){for(var r=t[i],a=r.min,n=r.max,s=r.size,o=r.counts,l=0,h=0,u=0;u<s;u++)l+=o[u],h+=u*o[u];var p=h/l,f=0;for(u=0;u<s;u++)f+=o[u]*Math.pow(u-p,2);var c=(n-a)/s,x=(p+.5)*c+a,m=Math.sqrt(f/(l-1))*c;e.push({min:a,max:n,avg:x,stddev:m})}return e},e.createStretchLUT=function(t){var e=t.minCutOff,i=t.maxCutOff,r=t.gamma,n=t.pixelType,s=t.outMin||0,o=t.outMax||255;if(-1===["u8","u16","s8","s16"].indexOf(n))return null;var l,h,u=e.length,p=0;"s8"===n?p=-127:"s16"===n&&(p=-32767);var f=256;["u16","s16"].indexOf(n)>-1&&(f=65536);var c=[],x=[],m=o-s;for(l=0;l<u;l++)x[l]=i[l]-e[l],c[l]=m/(i[l]-e[l]);var d,y=r&&r.length>=u,g=[];if(y)for(l=0;l<u;l++)g[l]=r[l]>1?r[l]>2?6.5+Math.pow(r[l]-2,2.5):6.5+100*Math.pow(2-r[l],4):1;var v,w,k,A=[];if(y)for(l=0;l<u;l++){for(k=[],h=0;h<f;h++)d=((v=h+p)-e[l])/x[l],w=1,r[l]>1&&(w-=Math.pow(1/m,d*g[l])),k[h]=v<i[l]&&v>e[l]?Math.floor(w*m*Math.pow(d,1/r[l]))+s:v>=i[l]?o:s;A[l]=k}else for(l=0;l<u;l++){for(k=[],h=0;h<f;h++)k[h]=(v=h+p)<=e[l]?s:v>=i[l]?o:Math.floor((v-e[l])/x[l]*m)+s;A[l]=k}if(null!=t.contrastOffset){var M=a(t.contrastOffset,t.brightnessOffset);for(l=0;l<u;l++)for(k=A[l],h=0;h<f;h++)k[h]=M[k[h]]}return{lut:A,offset:p}},e.createContrastBrightnessLUT=a,e.stretch=function(t,e){if(!r(t))return null;var i,a,n,s,o,l=t.clone(),h=l.pixels,u=l.mask,p=e.minCutOff,f=e.maxCutOff,c=e.gamma,x=e.outMin||0,m=e.outMax||255,d=l.width*l.height,y=h.length,g=m-x,v=[],w=[];for(i=0;i<y;i++)w[i]=f[i]-p[i],v[i]=g/(f[i]-p[i]);var k=c&&c.length>=y,A=[];if(k)for(i=0;i<y;i++)A[i]=c[i]>1?c[i]>2?6.5+Math.pow(c[i]-2,2.5):6.5+100*Math.pow(2-c[i],4):1;if(k)if(null!=u){for(a=0;a<d;a++)if(u[a])for(i=0;i<y;i++)o=((n=h[i][a])-p[i])/w[i],s=1,c[i]>1&&(s-=Math.pow(1/g,o*A[i])),h[i][a]=n<f[i]&&n>p[i]?Math.floor(s*g*Math.pow(o,1/c[i]))+x:n>=f[i]?m:x}else for(a=0;a<d;a++)for(i=0;i<y;i++)o=((n=h[i][a])-p[i])/w[i],s=1,c[i]>1&&(s-=Math.pow(1/g,o*A[i])),h[i][a]=n<f[i]&&n>p[i]?Math.floor(s*g*Math.pow(o,1/c[i]))+x:n>=f[i]?m:x;else if(null!=u){for(a=0;a<d;a++)if(u[a])for(i=0;i<y;i++)h[i][a]=(n=h[i][a])<f[i]&&n>p[i]?Math.floor((n-p[i])/w[i]*g)+x:n>=f[i]?m:x}else for(a=0;a<d;a++)for(i=0;i<y;i++)h[i][a]=(n=h[i][a])<f[i]&&n>p[i]?Math.floor((n-p[i])/w[i]*g)+x:n>=f[i]?m:x;return l.pixelType="u8",l.updateStatistics(),l},e.lookupPixels=function(t,e){if(!r(t))return null;var a,n,s=t.pixels,o=t.mask,l=t.width*t.height,h=s.length,u=e.lut,p=e.offset;u&&1===u[0].length&&(u=s.map((function(){return u})));var f,c,x,m=[];if(p)if(null==o)for(a=0;a<h;a++){for(f=s[a],c=u[a],x=new Uint8Array(l),n=0;n<l;n++)x[n]=c[f[n]-p];m.push(x)}else for(a=0;a<h;a++){for(f=s[a],c=u[a],x=new Uint8Array(l),n=0;n<l;n++)o[n]&&(x[n]=c[f[n]-p]);m.push(x)}else if(null==o)for(a=0;a<h;a++){for(f=s[a],c=u[a],x=new Uint8Array(l),n=0;n<l;n++)x[n]=c[f[n]];m.push(x)}else for(a=0;a<h;a++){for(f=s[a],c=u[a],x=new Uint8Array(l),n=0;n<l;n++)o[n]&&(x[n]=c[f[n]]);m.push(x)}var d=new i({width:t.width,height:t.height,pixels:m,mask:o,pixelType:"u8"});return d.updateStatistics(),d},e.remapColor=function(t,e){if(!r(t))return null;var i,a,n,s,o,l,h=t.clone(),u=h.pixels,p=h.width*h.height,f=e.length,c=Math.floor(f/2),x=e[Math.floor(c)],m=u[0],d=!1,y=new Uint8Array(p),g=new Uint8Array(p),v=new Uint8Array(p),w=h.mask,k=4===e[0].mappedColor.length;for(w||((w=new Uint8Array(p)).fill(k?255:1),h.mask=w),o=0;o<p;o++)if(w[o]){for(i=m[o],d=!1,l=c,a=x,n=0,s=f-1;s-n>1;){if(i===a.value){d=!0;break}i>a.value?n=l:s=l,l=Math.floor((n+s)/2),a=e[Math.floor(l)]}d||(i===e[n].value?(a=e[n],d=!0):i===e[s].value?(a=e[s],d=!0):i<e[n].value?(d=!1,a=null):i>e[n].value&&(i<e[s].value?(a=e[n],d=!0):s===f-1?(d=!1,a=null):(a=e[s],d=!0))),d?(y[o]=a.mappedColor[0],g[o]=a.mappedColor[1],v[o]=a.mappedColor[2],w[o]=a.mappedColor[3]):y[o]=g[o]=v[o]=w[o]=0}return h.pixels=[y,g,v],h.mask=w,h.pixelType="u8",h.maskIsAlpha=k,h},e.getClipBounds=n,e.mosaicPixelData=function(t,e){if(!t||0===t.length)return null;var i=t.filter((function(t){return t.pixelBlock}))[0];if(!i)return null;var r=(i.extent.xmax-i.extent.xmin)/i.pixelBlock.width,a=(i.extent.ymax-i.extent.ymin)/i.pixelBlock.height,n=.01*Math.min(r,a),o=t.sort((function(t,e){return Math.abs(t.extent.ymax-e.extent.ymax)>n?e.extent.ymax-t.extent.ymax:Math.abs(t.extent.xmin-e.extent.xmin)>n?t.extent.xmin-e.extent.xmin:0})),l=Math.min.apply(null,o.map((function(t){return t.extent.xmin}))),h=Math.min.apply(null,o.map((function(t){return t.extent.ymin}))),u=Math.max.apply(null,o.map((function(t){return t.extent.xmax}))),p=Math.max.apply(null,o.map((function(t){return t.extent.ymax}))),f={x:Math.round((e.xmin-l)/r),y:Math.round((p-e.ymax)/a)},c={width:Math.round((u-l)/r),height:Math.round((p-h)/a)},x={width:Math.round((e.xmax-e.xmin)/r),height:Math.round((e.ymax-e.ymin)/a)};return Math.round(c.width/i.pixelBlock.width)*Math.round(c.height/i.pixelBlock.height)!==o.length||f.x<0||f.y<0||c.width<x.width||c.height<x.height?null:{extent:e,pixelBlock:s(o.map((function(t){return t.pixelBlock})),c,f,x)}},e.mosaic=s,e.setValidBoundary=function(t,e,i){if(!r(t))return null;var a=t.width,n=t.height,s=e.x,o=e.y,l=i.width+s,h=i.height+o;if(s<0||o<0||l>a||h>n)return t;if(0===s&&0===o&&l===a&&h===n)return t;t.mask||(t.mask=new Uint8Array(a*n));for(var u=t.mask,p=0;p<n;p++)for(var f=p*a,c=0;c<a;c++)u[f+c]=p<o||p>=h||c<s||c>=l?0:1;return t.updateStatistics(),t},e.resampleByMajority=o,e.clip=function(t,e,a){var n=e.x,s=e.y,o=a.width,l=a.height;if(0===n&&0===s&&l===t.height&&o===t.width)return t;var h=t.width,u=t.height,p=Math.max(0,s),f=Math.max(0,n),c=Math.min(n+o,h),x=Math.min(s+l,u);if(c<0||x<0||!r(t))return null;n=Math.max(0,-n),s=Math.max(0,-s);for(var m=t.pixels,d=t.mask,y=o*l,g=m.length,v=[],w=0;w<g;w++){for(var k=m[w],A=i.createEmptyBand(t.pixelType,y),M=p;M<x;M++)for(var B=M*h,b=(M+s)*o+n,U=f;U<c;U++)A[b++]=k[B+U];v.push(A)}var C=new Uint8Array(y);for(M=p;M<x;M++)for(B=M*h,b=(M+s)*o+n,U=f;U<c;U++)C[b++]=d?d[B+U]:1;var T=new i({width:a.width,height:a.height,pixels:v,mask:C});return T.updateStatistics(),T},e.approximateTransform=function(t,e,a,n,s){if(void 0===s&&(s="nearest"),!r(t))return null;"majority"===s&&(t=o(t));for(var l,h,u,p,f,c,x,m=t.pixels,d=t.mask,y=t.pixelType,g=t.width,v=t.height,w=i.getPixelArrayConstructor(y),k=m.length,A=e.width,M=e.height,B=n.cols,b=n.rows,U=Math.ceil(A/B),C=Math.ceil(M/b),T=!1,_=0;_<a.length;_+=3)-1===a[_]&&-1===a[_+1]&&-1===a[_+2]&&(T=!0);var P,S,F=new Float32Array(A*M),j=new Float32Array(A*M),L=0,R="majority"===s?0:.5;for(_=0;_<C;_++)for(var G=0;G<U;G++){h=a[l=12*(_*U+G)],u=a[l+1],p=a[l+2],f=a[l+3],c=a[l+4],x=a[l+5];for(var I=0;I<b;I++){L=(_*b+I)*A+G*B,S=(I+.5)/b;for(var O=0;O<I;O++)P=(O+.5)/B,F[L+O]=Math.round((h*P+u*S+p)*g-R),j[L+O]=Math.round((f*P+c*S+x)*v-R)}for(h=a[l+=6],u=a[l+1],p=a[l+2],f=a[l+3],c=a[l+4],x=a[l+5],I=0;I<b;I++)for(L=(_*b+I)*A+G*B,S=(I+.5)/b,O=I;O<B;O++)P=(O+.5)/B,F[L+O]=Math.round((h*P+u*S+p)*g-R),j[L+O]=Math.round((f*P+c*S+x)*v-R)}for(var V,H=function(t,e){for(var i=0;i<M;i++){l=i*A;for(var r=0;r<A;r++)t[l]=F[l]<0||j[l]<0?0:e[F[l]+j[l]*g],l++}},q=[],D=0;D<k;D++)H(V=new w(A*M),m[D]),q.push(V);var z=new i({width:A,height:M,pixelType:y,pixels:q});if(d)z.mask=new Uint8Array(A*M),H(z.mask,d);else if(T)for(z.mask=new Uint8Array(A*M),_=0;_<A*M;_++)z.mask[_]=F[_]<0||j[_]<0?0:1;return z.updateStatistics(),z}}).apply(null,r))||(t.exports=a)},dXLH:function(t,e,i){var r,a;r=[i.dj.c(t.i),e,i("zOht"),i("pcDC"),i("ma1f"),i("ycL1"),i("rg9i"),i("qsST"),i("LxLY"),i("Vx27")],void 0===(a=(function(t,e,i,r,a,n,s,o,l,h){"use strict";var u=o.getLogger("esri.layers.support.PixelBlock");return function(t){function e(e){var i=t.call(this,e)||this;return i.width=null,i.height=null,i.pixelType="f32",i.validPixelCount=null,i.mask=null,i.maskIsAlpha=!1,i.pixels=null,i.statistics=null,i}var n;return i.__extends(e,t),n=e,e.createEmptyBand=function(t,e){return new(n.getPixelArrayConstructor(t))(e)},e.getPixelArrayConstructor=function(t){var e;switch(t){case"u1":case"u2":case"u4":case"u8":e=Uint8Array;break;case"u16":e=Uint16Array;break;case"u32":e=Uint32Array;break;case"s8":e=Int8Array;break;case"s16":e=Int16Array;break;case"s32":e=Int32Array;break;case"u32":e=Uint32Array;break;case"f32":e=Float32Array;break;case"f64":e=Float64Array;break;case"c64":case"c128":case"unknown":e=Float32Array;break;default:r.neverReached(t)}return e},e.prototype.castPixelType=function(t){if(!t)return"f32";var e=t.toLowerCase();return["u1","u2","u4"].indexOf(e)>-1?e="u8":-1===["unknown","u8","s8","u16","s16","u32","s32","f32","f64"].indexOf(e)&&(e="f32"),e},e.prototype.getPlaneCount=function(){return this.pixels&&this.pixels.length},e.prototype.addData=function(t){if(!t.pixels||t.pixels.length!==this.width*this.height)throw new a("pixelblock:invalid-or-missing-pixels","add data requires valid pixels array that has same length defined by pixel block width * height");this.pixels||(this.pixels=[]),this.statistics||(this.statistics=[]),this.pixels.push(t.pixels),this.statistics.push(t.statistics||{minValue:null,maxValue:null})},e.prototype.getAsRGBA=function(){var t=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case"s8":case"s16":case"u16":case"s32":case"u32":case"f32":case"f64":this._fillFromNon8Bit(t);break;default:this._fillFrom8Bit(t)}return new Uint8ClampedArray(t)},e.prototype.getAsRGBAFloat=function(){var t=new Float32Array(this.width*this.height*4);return this._fillFrom32Bit(t),t},e.prototype.updateStatistics=function(){var t=this;this.statistics=this.pixels.map((function(e){return t._calculateBandStatistics(e,t.mask)}));var e=this.mask,i=0;if(e)for(var r=0;r<e.length;r++)e[r]&&i++;else i=this.width*this.height;this.validPixelCount=i},e.prototype.clamp=function(t){if(t&&"f64"!==t&&"f32"!==t){var e;switch(t){case"u8":e=[0,255];break;case"u16":e=[0,65535];break;case"u32":e=[0,4294967295];break;case"s8":e=[-128,127];break;case"s16":e=[-32768,32767];break;case"s32":e=[-2147483648,2147483647];break;default:e=[-34e38,34e38]}for(var i,r,a,s=e[0],o=e[1],l=this.pixels,h=this.width*this.height,u=l.length,p=[],f=0;f<u;f++){a=n.createEmptyBand(t,h),i=l[f];for(var c=0;c<h;c++)a[c]=(r=i[c])>o?o:r<s?s:r;p.push(a)}this.pixels=p,this.pixelType=t}},e.prototype.extractBands=function(t){var e=this;if(l.isNone(t)||0===t.length||null==this.pixels||0===this.pixels.length)return this;var i=this.pixels.length,r=t.some((function(t){return t>=e.pixels.length})),a=i===t.length&&!t.some((function(t,e){return t!==e}));return r||a?this:new n({pixelType:this.pixelType,width:this.width,height:this.height,mask:this.mask,validPixelCount:this.validPixelCount,maskIsAlpha:this.maskIsAlpha,pixels:t.map((function(t){return e.pixels[t]})),statistics:this.statistics&&t.map((function(t){return e.statistics[t]}))})},e.prototype.clone=function(){var t,e=new n({width:this.width,height:this.height,pixelType:this.pixelType,maskIsAlpha:this.maskIsAlpha,validPixelCount:this.validPixelCount});this.mask&&(e.mask=this.mask instanceof Uint8Array?new Uint8Array(this.mask):this.mask.slice(0));var i=n.getPixelArrayConstructor(this.pixelType);if(this.pixels&&this.pixels.length>0){e.pixels=[];var r=this.pixels[0].slice;for(t=0;t<this.pixels.length;t++)e.pixels[t]=r?this.pixels[t].slice(0,this.pixels[t].length):new i(this.pixels[t])}if(this.statistics)for(e.statistics=[],t=0;t<this.statistics.length;t++)e.statistics[t]=s.clone(this.statistics[t]);return e},e.prototype._fillFrom8Bit=function(t){var e=this.mask,i=this.maskIsAlpha,r=this.pixels;if(t&&r&&r.length){var a,n,s,o;a=n=s=r[0],r.length>=3?(n=r[1],s=r[2]):2===r.length&&(n=r[1]);var l=new Uint32Array(t),h=this.width*this.height;if(a.length===h)if(e&&e.length===h)if(i)for(o=0;o<h;o++)e[o]&&(l[o]=e[o]<<24|s[o]<<16|n[o]<<8|a[o]);else for(o=0;o<h;o++)e[o]&&(l[o]=255<<24|s[o]<<16|n[o]<<8|a[o]);else for(o=0;o<h;o++)l[o]=255<<24|s[o]<<16|n[o]<<8|a[o];else u.error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.")}else u.error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")},e.prototype._fillFromNon8Bit=function(t){var e=this.pixels,i=this.mask,r=this.statistics;if(t&&e&&e.length){var a=this.pixelType,n=1,s=0;if(r&&r.length>0)s=r.map((function(t){return t.minValue})).reduce((function(t,e){return Math.min(t,e)})),n=255/r.map((function(t){return t.maxValue-t.minValue})).reduce((function(t,e){return Math.max(t,e)}));else{var o=255;"s8"===a?(s=-128,o=127):"u16"===a?o=65535:"s16"===a?(s=-32768,o=32767):"u32"===a?o=4294967295:"s32"===a?(s=-2147483648,o=2147483647):"f32"===a?(s=-34e38,o=34e38):"f64"===a&&(s=-Number.MAX_VALUE,o=Number.MAX_VALUE),n=255/(o-s)}var l,h,p,f,c,x=new Uint32Array(t),m=this.width*this.height;if((l=h=p=e[0]).length!==m)return u.error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");if(e.length>=2)if(h=e[1],e.length>=3&&(p=e[2]),i&&i.length===m)for(f=0;f<m;f++)i[f]&&(x[f]=255<<24|(p[f]-s)*n<<16|(h[f]-s)*n<<8|(l[f]-s)*n);else for(f=0;f<m;f++)x[f]=255<<24|(p[f]-s)*n<<16|(h[f]-s)*n<<8|(l[f]-s)*n;else if(i&&i.length===m)for(f=0;f<m;f++)c=(l[f]-s)*n,i[f]&&(x[f]=255<<24|c<<16|c<<8|c);else for(f=0;f<m;f++)x[f]=255<<24|(c=(l[f]-s)*n)<<16|c<<8|c}else u.error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")},e.prototype._fillFrom32Bit=function(t){var e,i,r,a,n=this.pixels,s=this.mask;if(!t||!n||!n.length)return u.error("getAsRGBAFloat()","Unable to convert to RGBA. The input pixel block is empty.");e=i=r=n[0],n.length>=3?(i=n[1],r=n[2]):2===n.length&&(i=n[1]);var o=this.width*this.height;if(e.length!==o)return u.error("getAsRGBAFloat()","Unable to convert to RGBA. The pixelblock is invalid.");var l=0;if(s&&s.length===o)for(a=0;a<o;a++)t[l++]=e[a],t[l++]=i[a],t[l++]=r[a],t[l++]=1&s[a];else for(a=0;a<o;a++)t[l++]=e[a],t[l++]=i[a],t[l++]=r[a],t[l++]=1},e.prototype._calculateBandStatistics=function(t,e){var i,r=1/0,a=-1/0,n=t.length,s=0;if(e)for(i=0;i<n;i++)e[i]&&(r=(s=t[i])<r?s:r,a=s>a?s:a);else for(i=0;i<n;i++)r=(s=t[i])<r?s:r,a=s>a?s:a;return{minValue:r,maxValue:a}},i.__decorate([h.property({json:{write:!0}})],e.prototype,"width",void 0),i.__decorate([h.property({json:{write:!0}})],e.prototype,"height",void 0),i.__decorate([h.property({json:{write:!0}})],e.prototype,"pixelType",void 0),i.__decorate([h.cast("pixelType")],e.prototype,"castPixelType",null),i.__decorate([h.property({json:{write:!0}})],e.prototype,"validPixelCount",void 0),i.__decorate([h.property({json:{write:!0}})],e.prototype,"mask",void 0),i.__decorate([h.property({json:{write:!0}})],e.prototype,"maskIsAlpha",void 0),i.__decorate([h.property({json:{write:!0}})],e.prototype,"pixels",void 0),i.__decorate([h.property({json:{write:!0}})],e.prototype,"statistics",void 0),n=i.__decorate([h.subclass("esri.layers.support.PixelBlock")],e)}(n.JSONSupport)}).apply(null,r))||(t.exports=a)}}]);