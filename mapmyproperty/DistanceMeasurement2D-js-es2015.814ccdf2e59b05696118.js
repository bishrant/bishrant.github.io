(window.webpackJsonp=window.webpackJsonp||[]).push([[37,187],{"6UvW":function(e,t,s){"use strict";s.d(t,"a",(function(){return o})),s.d(t,"b",(function(){return l}));var i=s("srIe"),a=s("OvF4"),n=(s("4GrV"),s("gEht")),r=s("U282");function o(e,t,s,r=new a.a){let o;if("2d"===s.type)o=t*s.resolution;else if("3d"===s.type){const a=s.overlayPixelSizeInMapUnits(e),r=s.basemapSpatialReference;o=Object(i.k)(r)&&!r.equals(s.spatialReference)?Object(n.f)(r)/Object(n.f)(s.spatialReference):t*a}const l=e.x-o,c=e.y-o,u=e.x+o,h=e.y+o,{spatialReference:d}=s;return r.xmin=Math.min(l,u),r.ymin=Math.min(c,h),r.xmax=Math.max(l,u),r.ymax=Math.max(c,h),r.spatialReference=d,r}function l(e,t,s){const a=s.toMap(e);return!Object(i.j)(a)&&o(a,Object(r.a)(),s,c).intersects(t)}const c=new a.a},U282:function(e,t,s){"use strict";function i(e,t){return t?"xoffset"in t&&t.xoffset?Math.max(e,Math.abs(t.xoffset)):"yoffset"in t&&t.yoffset?Math.max(e,Math.abs(t.yoffset||0)):e:e}function a(e,t){return"number"==typeof e?e:e&&e.stops&&e.stops.length?function(e){let t=0,s=0;for(let i=0;i<e.length;i++){const a=e[i].size;"number"==typeof a&&(t+=a,s++)}return t/s}(e.stops):t}function n(e,t){if(!t)return e;const s=t.filter(e=>"size"===e.type).map(t=>{const{maxSize:s,minSize:i}=t;return(a(s,e)+a(i,e))/2});let i=0;const n=s.length;if(0===n)return e;for(let a=0;a<n;a++)i+=s[a];const r=Math.floor(i/n);return Math.max(r,e)}function r(e){const t=e&&e.renderer,s="touch"===(e&&e.event&&e.event.pointerType)?9:6;if(!t)return s;const a="visualVariables"in t?n(s,t.visualVariables):s;if("simple"===t.type)return i(a,t.symbol);if("unique-value"===t.type){let e=a;return t.uniqueValueInfos.forEach(t=>{e=i(e,t.symbol)}),e}if("class-breaks"===t.type){let e=a;return t.classBreakInfos.forEach(t=>{e=i(e,t.symbol)}),e}return a}s.d(t,"a",(function(){return r}))},Yt8Z:function(e,t,s){"use strict";s.r(t);var i=s("pO5D"),a=(s("wSAH"),s("6S2I")),n=(s("zqDF"),s("WbKI")),r=s("Stxv"),o=s("04ZG"),l=(s("4EHJ"),s("ju1D"),s("9AIY"),s("9MzC")),c=s("gEht"),u=(s("cCpn"),s("h1D1")),h=s("dV4Z"),d=s("Jv1m"),p=s("Ehpe"),b=s("r0DZ"),m=s("N5XI"),y=s("Pt/X"),O=s("fqh+"),v=s("WZb1"),j=s("SuVq"),_=s("UhwK"),w=(s("4GrV"),s("IDUf")),g=s("TKwc"),f=s("l4eh"),M=s("YyOG"),D=(s("G48n"),s("Tcmu")),S=s("Ibpv"),L=(s("H9eC"),s("jWBI")),x=s("gYg2"),I=s("aql9"),U=s("QLbw"),k=s("6lH3"),C=s("zgsL"),T=s("VPx4"),A=s("wg3g"),E=s("R3Kl"),R=s("HE3w"),W=s("PN7H");const z=1e5;let V=class extends E.a{constructor(){super(...arguments),this._drawActive=!1,this._handles=new b.a,this._polylineLayer=new C.a,this._manipulatorLayer=new C.a,this._groupLayer=new T.default({layers:[this._polylineLayer,this._manipulatorLayer],listMode:"hide",visible:!1}),this._vertices=[],this.deferCreation=!0,this.geodesicDistanceThreshold=1e5,this.measurement=null,this.measurementLabel=null}initialize(){Object(M.a)("esri/core/t9n/Units").then(e=>{this.messages=e}),this._handles.add(Object(w.c)(async()=>{this.messages=await Object(M.a)("esri/core/t9n/Units")}))}destroy(){this.detach(),this._draw&&(this._draw.destroy(),this._draw=null),this._handles&&(this._handles.destroy(),this._handles=null),this._polylineLayer&&(this._polylineLayer.destroy(),this._polylineLayer=null),this._manipulatorLayer&&(this._manipulatorLayer.destroy(),this._manipulatorLayer=null)}set editable(e){this._set("editable",e),e||this._draw.reset()}activate(){this._drawActive||0!==this._vertices.length||this._startSketch()}onAttach(){const e=this.view;this._draw=new R.a({view:e}),e.map.add(this._groupLayer),e.focus(),this._handles.add([Object(m.init)(this,["unit","geodesicDistanceThreshold","palette","messages"],()=>{this._vertices.length>0&&this._updatePolylines()}),Object(m.init)(this,"view.spatialReference",e=>{P(e)&&!Object(x.g)()&&Object(x.i)()})]),this.create()}onDetach(){const{map:e}=this.view;this._draw.view=null,this._draw.destroy(),this._draw=null,e.remove(this._groupLayer),this._handles.removeAll(),this._polylineLayer.removeAll(),this._manipulatorLayer.removeAll(),this._set("measurement",null),this._set("measurementLabel",null)}onShow(){this._groupLayer.visible=!0}onHide(){this._groupLayer.visible=!1}reset(){this._vertices=[],this._polylineLayer.removeAll(),this._set("measurement",null),this._set("measurementLabel",null),this._draw.reset(),this._drawActive=!1,this._updateSketch([])}onInputEvent(e){"pointer-move"===e.type&&this._updateCursor()}_startSketch(){this._drawActive=!0;const e=this._draw.create("polyline",{mode:"click"});e.on(["vertex-add","vertex-update","vertex-remove","cursor-update","undo","redo"],e=>this._updateSketch(e.vertices)),e.on("draw-complete",()=>{this._stopSketch()})}_stopSketch(){this.manipulators.forEach(e=>{e.manipulator.interactive=!0}),this._drawActive=!1,this.complete()}_updateSketch(e){if(P(this.view.spatialReference)&&!Object(x.g)())return;if(e.length<2)return this._vertices=[],this.manipulators.removeAll(),void this._polylineLayer.removeAll();this.create();const{spatialReference:t}=this.view;for(;this._vertices.length>e.length;){const{manipulatorId:e}=this._vertices.pop();this.manipulators.remove(e)}for(let o=this._vertices.length;o<e.length;o++){const[s,i]=e[o],a=G(new j.a({x:s,y:i,spatialReference:t}),this.view,this._manipulatorLayer,this.palette),n=this.manipulators.add(a);Object(A.e)(a,(e,t)=>{t.next(Object(A.m)(this.view)).next(Object(A.g)(e.graphic)).next(()=>{const t=e.graphic.geometry;this._vertices[o].coord=[t.x,t.y],this._updatePolylines()})}),this._vertices.push({manipulatorId:n,coord:[s,i]})}const s=this._vertices.length-1,i=this._vertices[s],[a,n]=e[s];if(i.coord[0]!==a||i.coord[1]!==n){i.coord=[a,n];const e=new j.a({x:a,y:n,spatialReference:t});this.manipulators.findById(i.manipulatorId).graphic.geometry=e}const r=this._drawActive?this._vertices[s].manipulatorId:null;this.manipulators.forEach(e=>{e.manipulator.interactive=null==r||e.id!==r}),this._updatePolylines()}_updateCursor(){this.cursor=this._drawActive?"crosshair":null}_updatePolylines(){const e=this._vertices.map(e=>e.coord),{measurement:t,drawing:s,original:i}=function(e,t,s){const i=new _.a({paths:[e],spatialReference:t});let a,n;if(t.isGeographic)if(Object(U.g)(t))a=Object(U.e)([i],"meters")[0],n=Object(U.c)(i,z);else{const e=Object(x.j)(i,v.a.WGS84),s=Object(U.c)(e,z);a=Object(U.e)([e],"meters")[0],n=Object(x.j)(s,t)}else if(t.isWebMercator)a=Object(k.geodesicLength)(i,"meters"),n=Object(k.geodesicDensify)(i,z,"meters");else{const e=Object(k.planarLength)(i,"meters");if(e>=s){const e=Object(x.j)(i,v.a.WGS84),s=Object(U.c)(e,z);a=Object(U.e)([e],"meters")[0],n=Object(x.j)(s,t)}else a=e,n=i}return{measurement:{geometry:n,length:a},original:i,drawing:n}}(e,this.view.spatialReference,this.geodesicDistanceThreshold);this._set("measurement",t);const a=function(e,t,s){if(!t||!e)return null;switch(s){case"metric":return Object(I.h)(e,t.length,"meters");case"imperial":return Object(I.e)(e,t.length,"meters");default:return Object(I.b)(e,Object(c.c)(t.length,"meters",s),s)}}(this.messages,t,this.unit);this._set("measurementLabel",a);const{pathPrimaryColor:n,pathSecondaryColor:r,pathWidth:o}=this.palette;this._polylineLayer.removeAll(),this._polylineLayer.addMany([new L.a({geometry:s,symbol:new g.a({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",effects:[{type:"CIMGeometricEffectDashes",dashTemplate:[14,12],lineDashEnding:"FullGap",controlPointEnding:"NoConstraint"}],enable:!0,capStyle:"Butt",joinStyle:"Round",width:o-1.5,color:r},{type:"CIMSolidStroke",enable:!0,capStyle:"Butt",joinStyle:"Round",width:o,color:n}]}}})}),new L.a({geometry:i.extent.center,symbol:new S.a({color:[255,255,255,1],haloColor:[0,0,0,.5],haloSize:2,font:new f.a({size:14,family:"sans-serif"}),text:a})})])}};function G(e,t,s,i){const a=new D.a({style:"circle",color:i.handleColor,size:i.handleWidth,outline:{type:"simple-line",width:0}}),n=new D.a({style:"circle",color:i.handleColor,size:1.5*i.handleWidth,outline:{type:"simple-line",width:0}}),r=new L.a({geometry:e,symbol:a});return new W.a({view:t,layer:s,graphic:r,focusedSymbol:n})}function P(e){if(!e)return!1;const{isGeographic:t,isWebMercator:s,isWGS84:i}=e;return t&&!i&&!Object(U.g)(e)||!t&&!s}Object(i.a)([Object(n.b)()],V.prototype,"cursor",void 0),Object(i.a)([Object(n.b)({value:!0})],V.prototype,"editable",null),Object(i.a)([Object(n.b)({type:Number})],V.prototype,"geodesicDistanceThreshold",void 0),Object(i.a)([Object(n.b)({readOnly:!0})],V.prototype,"measurement",void 0),Object(i.a)([Object(n.b)({readOnly:!0})],V.prototype,"measurementLabel",void 0),Object(i.a)([Object(n.b)()],V.prototype,"messages",void 0),Object(i.a)([Object(n.b)()],V.prototype,"palette",void 0),Object(i.a)([Object(n.b)()],V.prototype,"unit",void 0),Object(i.a)([Object(n.b)({constructOnly:!0})],V.prototype,"view",void 0),V=Object(i.a)([Object(o.a)("esri.widgets.DistanceMeasurement2D.DistanceMeasurement2DTool")],V);var q=V;const B={handleWidth:8,handleColor:[255,128,0,.5],pathWidth:5,pathPrimaryColor:[255,128,0,255],pathSecondaryColor:[255,255,255,255]},H=a.a.getLogger("esri.widgets.DistanceMeasurement2D.DistanceMeasurement2DViewModel");let N=class extends O.a{constructor(e){super(e),this.supportedViewType="2d",this._handles=new b.a,this.geodesicDistanceThreshold=1e5,this.measurement=null,this.measurementLabel=null,this.palette=B,this.tool=null}initialize(){this._handles.add([Object(m.init)(this,["unit","palette","geodesicDistanceThreshold"],(e,t,s)=>{this.tool&&(this.tool[s]=e)})])}destroy(){this._handles&&(this._handles.destroy(),this._handles=null)}get state(){var e,t;return this.isDisabled||null==(t=null==(e=this.view)?void 0:e.spatialReference)||P(t)&&!Object(x.h)()?"disabled":this.tool&&this.measurement?this.tool.active?"measuring":"measured":"ready"}get unit(){return this._validateUnit(this.defaultUnit)}set unit(e){void 0!==e?this._override("unit",this._validateUnit(e)):this._clearOverride("unit")}get unitOptions(){return c.q}set unitOptions(e){void 0!==e?this._override("unitOptions",this._validateUnits(e)):this._clearOverride("unitOptions")}start(){return this.createTool()}clear(){this.removeTool()}createToolParams(){return{toolConstructor:q,constructorArguments:()=>({geodesicDistanceThreshold:this.geodesicDistanceThreshold,palette:this.palette,unit:this.unit})}}logUnsupportedError(){H.error("DistanceMeasurement2D widget is not implemented for SceneView")}logError(...e){H.error(...e)}_validateUnit(e){return-1!==this.unitOptions.indexOf(e)?e:-1!==this.unitOptions.indexOf(this.defaultUnit)?this.defaultUnit:this.unitOptions[0]}_validateUnits(e=[]){const t=e.filter(e=>-1!==c.q.indexOf(e));return 0===t.length?c.q.slice():t}};Object(i.a)([Object(n.b)(y.a)],N.prototype,"defaultUnit",void 0),Object(i.a)([Object(n.b)({type:Number})],N.prototype,"geodesicDistanceThreshold",void 0),Object(i.a)([Object(n.b)({readOnly:!0,aliasOf:"tool.measurement"})],N.prototype,"measurement",void 0),Object(i.a)([Object(n.b)({readOnly:!0,aliasOf:"tool.measurementLabel"})],N.prototype,"measurementLabel",void 0),Object(i.a)([Object(n.b)()],N.prototype,"palette",void 0),Object(i.a)([Object(n.b)({readOnly:!0})],N.prototype,"state",null),Object(i.a)([Object(n.b)({constructOnly:!0,readOnly:!0})],N.prototype,"tool",void 0),Object(i.a)([Object(n.b)({type:String})],N.prototype,"unit",null),Object(i.a)([Object(n.b)({type:[String]})],N.prototype,"unitOptions",null),N=Object(i.a)([Object(o.a)("esri.widgets.DistanceMeasurement2D.DistanceMeasurement2DViewModel")],N);var Z=N;const J="esri-distance-measurement-2d",K={buttonDisabled:"esri-button--disabled",widgetIcon:"esri-icon-measure-line",base:J+" esri-widget esri-widget--panel",container:J+"__container",hint:J+"__hint",hintText:J+"__hint-text",panelError:J+"__panel--error",measurement:J+"__measurement",measurementItem:J+"__measurement-item",measurementItemDisabled:J+"__measurement-item--disabled",measurementItemTitle:J+"__measurement-item-title",measurementItemValue:J+"__measurement-item-value",settings:J+"__settings",units:J+"__units",unitsLabel:J+"__units-label",unitsSelect:J+"__units-select esri-select",unitsSelectWrapper:J+"__units-select-wrapper",actionSection:J+"__actions",newMeasurementButton:J+"__clear-button esri-button esri-button--primary"};let Y=class extends p.a{constructor(e,t){super(e,t),this.iconClass=K.widgetIcon,this.label=void 0,this.messages=null,this.messagesUnits=null,this.unit=null,this.unitOptions=null,this.view=null,this.viewModel=new Z}render(){const{id:e,messages:t,messagesUnits:s,viewModel:i,visible:a}=this,{active:n,isSupported:r,measurementLabel:o,state:l,unit:u,unitOptions:h}=i,p="disabled"===l,b="measuring"===l||"measured"===l,m=n&&"ready"===l?Object(d.a)("section",{key:"hint",class:K.hint},Object(d.a)("p",{class:K.hintText},t.hint)):null,y=r?null:Object(d.a)("section",{key:"unsupported",class:K.panelError},Object(d.a)("p",null,t.unsupported)),O=b?Object(d.a)("section",{key:"measurement",class:K.measurement},((e,t,s)=>t?Object(d.a)("div",{key:s+"-enabled",class:K.measurementItem},Object(d.a)("span",{class:K.measurementItemTitle},e),Object(d.a)("span",{class:K.measurementItemValue},t)):Object(d.a)("div",{key:s+"-disabled",class:this.classes(K.measurementItem,K.measurementItemDisabled),"aria-disabled":"true"},Object(d.a)("span",{class:K.measurementItemTitle},e)))(t.distance,o,"distance")):null,v=e+"-units",j=b?Object(d.a)("section",{key:"units",class:K.units},Object(d.a)("label",{class:K.unitsLabel,for:v},t.unit),Object(d.a)("div",{class:K.unitsSelectWrapper},Object(d.a)("select",{class:K.unitsSelect,id:v,onchange:this._changeUnit,bind:this,value:u},h.map(e=>{var t;return Object(d.a)("option",{key:e,value:e},Object(c.l)(e)?s.systems[e]:null==(t=s.units[e])?void 0:t.pluralCapitalized)})))):null,_=b?Object(d.a)("div",{key:"settings",class:K.settings},j):null,w=!r||n&&!b?null:Object(d.a)("div",{class:K.actionSection},Object(d.a)("button",{disabled:p,class:this.classes(K.newMeasurementButton,p&&K.buttonDisabled),bind:this,onclick:this._newMeasurement,title:t.newMeasurement,"aria-label":t.newMeasurement,type:"button"},t.newMeasurement)),g=a?Object(d.a)("div",{class:K.container},y,m,_,O,w):null;return Object(d.a)("div",{class:K.base},g)}_newMeasurement(){Object(l.l)(this.viewModel.start())}_changeUnit(e){const t=e.target,s=t.options[t.selectedIndex];s&&(this.viewModel.unit=s.value)}};Object(i.a)([Object(r.a)("viewModel.active")],Y.prototype,"active",void 0),Object(i.a)([Object(n.b)()],Y.prototype,"iconClass",void 0),Object(i.a)([Object(n.b)({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],Y.prototype,"label",void 0),Object(i.a)([Object(n.b)(),Object(h.a)("esri/widgets/DistanceMeasurement2D/t9n/DistanceMeasurement2D")],Y.prototype,"messages",void 0),Object(i.a)([Object(n.b)(),Object(h.a)("esri/core/t9n/Units")],Y.prototype,"messagesUnits",void 0),Object(i.a)([Object(r.a)("viewModel.unit")],Y.prototype,"unit",void 0),Object(i.a)([Object(r.a)("viewModel.unitOptions")],Y.prototype,"unitOptions",void 0),Object(i.a)([Object(r.a)("viewModel.view")],Y.prototype,"view",void 0),Object(i.a)([Object(n.b)({type:Z})],Y.prototype,"viewModel",void 0),Object(i.a)([Object(r.a)("viewModel.visible")],Y.prototype,"visible",void 0),Object(i.a)([Object(u.a)()],Y.prototype,"_newMeasurement",null),Object(i.a)([Object(u.a)()],Y.prototype,"_changeUnit",null),Y=Object(i.a)([Object(o.a)("esri.widgets.DistanceMeasurement2D")],Y),t.default=Y}}]);