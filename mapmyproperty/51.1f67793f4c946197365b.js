(function(){var e={"esri/views/2d/engine/vectorTiles/Feature":"0+xL","arcgis-js-api/core/libs/earcut/earcut":"1E+e","esri/core/libs/earcut/earcut":"1E+e","arcgis-js-api/views/2d/engine/vectorTiles/decluttering/config":"2eQy","esri/views/2d/engine/vectorTiles/decluttering/config":"2eQy","esri/views/2d/engine/vectorTiles/CircleBucket":"7CQW","esri/views/2d/engine/vectorTiles/TextShaping":"BWOx","esri/views/2d/engine/vectorTiles/BaseBucket":"Ezhs","esri/views/2d/engine/vectorTiles/IndexMemoryBuffer":"Gc+D","esri/views/2d/engine/vectorTiles/WorkerTileHandler":"OBe7","esri/views/2d/engine/vectorTiles/ScriptUtils":"PB92","esri/views/2d/engine/vectorTiles/VertexMemoryBuffer":"RY7r","esri/views/2d/tiling/enums":"UTXC","arcgis-js-api/views/2d/engine/webgl/GeometryUtils":"VY6u","esri/views/2d/engine/webgl/GeometryUtils":"VY6u","esri/views/2d/engine/vectorTiles/MemoryBuffer":"ahJM","esri/views/2d/engine/vectorTiles/LineBucket":"c0+/","esri/views/2d/engine/vectorTiles/TileParser":"qDf7","esri/views/2d/engine/vectorTiles/FillBucket":"tVEB","esri/views/2d/engine/vectorTiles/WorkerTile":"ujH7","esri/views/2d/engine/vectorTiles/SourceLayerData":"wodO","esri/views/2d/engine/vectorTiles/SymbolBucket":"yaQU","esri/views/2d/engine/vectorTiles/Placement":"zywo"},t=this||window,r=t.webpackJsonp=t.webpackJsonp||[];r.registerAbsMids?r.registerAbsMids(e):(r.absMidsWaiting=r.absMidsWaiting||[]).push(e)})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{"0+xL":function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("6+ni")],void 0===(n=(function(e,t,r){"use strict";return function(){function e(e,t){this.values={};for(var r=t.keys,i=t.values;e.next();)switch(e.tag()){case 1:this.id=e.getUInt64();break;case 2:for(var n=e.getMessage(),a=this.values;!n.empty();){var o=n.getUInt32(),s=n.getUInt32();a[r[o]]=i[s]}n.release();break;case 3:this.type=e.getUInt32();break;case 4:this._pbfGeometry=e.getMessage();break;default:e.skip()}}return e.prototype.getGeometry=function(e){if(void 0!==this._geometry)return this._geometry;if(!this._pbfGeometry)return null;var t,i,n=this._pbfGeometry;this._pbfGeometry=null,e?e.reset(this.type):t=[];for(var a,o=1,s=0,l=0,u=0;!n.empty();){if(0===s){var x=n.getUInt32();o=7&x,s=x>>3}switch(s--,o){case 1:l+=n.getSInt32(),u+=n.getSInt32(),e?e.moveTo(l,u):(i&&t.push(i),(i=[]).push(new r.Point(l,u)));break;case 2:l+=n.getSInt32(),u+=n.getSInt32(),e?e.lineTo(l,u):i.push(new r.Point(l,u));break;case 7:e?e.close():i&&!i[0].equals(l,u)&&i.push(i[0].clone());break;default:throw n.release(),new Error("Invalid path operation")}}return e?a=e.result():(i&&t.push(i),a=t),n.release(),this._geometry=a,a},e}()}).apply(null,i))||(e.exports=n)},"1E+e":function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=(function(e,t){"use strict";function r(e,t,r,i,n){var a;if(n===h(e,t,r,i)>0)for(var o=t;o<r;o+=i)a=s(o,e[o],e[o+1],a);else for(o=r-i;o>=t;o-=i)a=s(o,e[o],e[o+1],a);return a&&_(a,a.next)&&(l(a),a=a.next),a}function i(e,t){if(void 0===t&&(t=e),!e)return e;var r,i=e;do{if(r=!1,i.steiner||!_(i,i.next)&&0!==f(i.prev,i,i.next))i=i.next;else{if(l(i),(i=t=i.prev)===i.next)break;r=!0}}while(r||i!==t);return t}function n(e,t,r,s,u,x,f){if(void 0===f&&(f=0),e){!f&&x&&(e=function e(t,r,i,n){for(var a=void 0;a!==t;a=a.next){if(null===(a=a||t).z&&(a.z=p(a.x,a.y,r,i,n)),a.prev.next!==a||a.next.prev!==a)return a.prev.next=a,a.next.prev=a,e(t,r,i,n);a.prevZ=a.prev,a.nextZ=a.next}return t.prevZ.nextZ=null,t.prevZ=null,function(e){for(var t,r=1;;){var i=e,n=void 0;e=null,t=null;for(var a=0;i;){a++,n=i;for(var o=0;o<r&&n;o++)n=n.nextZ;for(var s=r;o>0||s>0&&n;){var l=void 0;0===o?(l=n,n=n.nextZ,s--):0!==s&&n?i.z<=n.z?(l=i,i=i.nextZ,o--):(l=n,n=n.nextZ,s--):(l=i,i=i.nextZ,o--),t?t.nextZ=l:e=l,l.prevZ=t,t=l}i=n}if(t.nextZ=null,r*=2,a<2)return e}}(t)}(e,s,u,x));for(var c=e;e.prev!==e.next;){var h=e.prev,d=e.next;if(x?o(e,s,u,x):a(e))t.push(h.index/r),t.push(e.index/r),t.push(d.index/r),l(e),e=d.next,c=d.next;else if((e=d)===c){f?1===f?n(e=g(e,t,r),t,r,s,u,x,2):2===f&&m(e,t,r,s,u,x):n(i(e),t,r,s,u,x,1);break}}}}function a(e){var t=e.prev,r=e,i=e.next;if(f(t,r,i)>=0)return!1;for(var n=e.next.next,a=n,o=0;n!==e.prev&&(0===o||n!==a);){if(o++,d(t.x,t.y,r.x,r.y,i.x,i.y,n.x,n.y)&&f(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function o(e,t,r,i){var n=e.prev,a=e,o=e.next;if(f(n,a,o)>=0)return!1;for(var s=n.x>a.x?n.x>o.x?n.x:o.x:a.x>o.x?a.x:o.x,l=n.y>a.y?n.y>o.y?n.y:o.y:a.y>o.y?a.y:o.y,u=p(n.x<a.x?n.x<o.x?n.x:o.x:a.x<o.x?a.x:o.x,n.y<a.y?n.y<o.y?n.y:o.y:a.y<o.y?a.y:o.y,t,r,i),x=p(s,l,t,r,i),c=e.prevZ,h=e.nextZ;c&&c.z>=u&&h&&h.z<=x;){if(c!==e.prev&&c!==e.next&&d(n.x,n.y,a.x,a.y,o.x,o.y,c.x,c.y)&&f(c.prev,c,c.next)>=0)return!1;if(c=c.prevZ,h!==e.prev&&h!==e.next&&d(n.x,n.y,a.x,a.y,o.x,o.y,h.x,h.y)&&f(h.prev,h,h.next)>=0)return!1;h=h.nextZ}for(;c&&c.z>=u;){if(c!==e.prev&&c!==e.next&&d(n.x,n.y,a.x,a.y,o.x,o.y,c.x,c.y)&&f(c.prev,c,c.next)>=0)return!1;c=c.prevZ}for(;h&&h.z<=x;){if(h!==e.prev&&h!==e.next&&d(n.x,n.y,a.x,a.y,o.x,o.y,h.x,h.y)&&f(h.prev,h,h.next)>=0)return!1;h=h.nextZ}return!0}function s(e,t,r,i){var n=new B(e,t,r);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function l(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function u(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function x(e,t){if(t=function(e,t){var r,i=t,n=e.x,a=e.y,o=-1/0;do{if(a<=i.y&&a>=i.next.y&&i.next.y!==i.y){var s=i.x+(a-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(s<=n&&s>o){if(o=s,s===n){if(a===i.y)return i;if(a===i.next.y)return i.next}r=i.x<i.next.x?i:i.next}}i=i.next}while(i!==t);if(!r)return null;if(n===o)return r.prev;var l,u=r,x=r.x,f=r.y,c=1/0;for(i=r.next;i!==u;)n>=i.x&&i.x>=x&&n!==i.x&&d(a<f?n:o,a,x,f,a<f?o:n,a,i.x,i.y)&&((l=Math.abs(a-i.y)/(n-i.x))<c||l===c&&i.x>r.x)&&y(i,e)&&(r=i,c=l),i=i.next;return r}(e,t)){var r=V(t,e);i(r,r.next)}}function f(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function c(e,t,r,i){return!!(_(e,t)&&_(r,i)||_(e,i)&&_(r,t))||f(e,t,r)>0!=f(e,t,i)>0&&f(r,i,e)>0!=f(r,i,t)>0}function h(e,t,r,i){for(var n=0,a=t,o=r-i;a<r;a+=i)n+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return n}function d(e,t,r,i,n,a,o,s){return(n-o)*(t-s)-(e-o)*(a-s)>=0&&(e-o)*(i-s)-(r-o)*(t-s)>=0&&(r-o)*(a-s)-(n-o)*(i-s)>=0}function y(e,t){return f(e.prev,e,e.next)<0?f(e,t,e.next)>=0&&f(e,e.prev,t)>=0:f(e,t,e.prev)<0||f(e,e.next,t)<0}function p(e,t,r,i,n){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*n)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*n)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function _(e,t){return e.x===t.x&&e.y===t.y}function v(e,t){return e.x-t.x}function g(e,t,r){var i=e;do{var n=i.prev,a=i.next.next;!_(n,a)&&c(n,i,i.next,a)&&y(n,a)&&y(a,n)&&(t.push(n.index/r),t.push(i.index/r),t.push(a.index/r),l(i),l(i.next),i=e=a),i=i.next}while(i!==e);return i}function m(e,t,r,a,o,s){var l=e;do{for(var u=l.next.next;u!==l.prev;){if(l.index!==u.index&&I(l,u)){var x=V(l,u);return l=i(l,l.next),x=i(x,x.next),n(l,t,r,a,o,s),void n(x,t,r,a,o,s)}u=u.next}l=l.next}while(l!==e)}function I(e,t){return e.next.index!==t.index&&e.prev.index!==t.index&&!function(e,t){var r=e;do{if(r.index!==e.index&&r.next.index!==e.index&&r.index!==t.index&&r.next.index!==t.index&&c(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&y(e,t)&&y(t,e)&&function(e,t){var r=e,i=!1,n=(e.x+t.x)/2,a=(e.y+t.y)/2;do{r.y>a!=r.next.y>a&&r.next.y!==r.y&&n<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next}while(r!==e);return i}(e,t)}function V(e,t){var r=new B(e.index,e.x,e.y),i=new B(t.index,t.x,t.y),n=e.next,a=t.prev;return e.next=t,t.prev=e,r.next=n,n.prev=r,i.next=r,r.prev=i,a.next=i,i.prev=a,i}Object.defineProperty(t,"__esModule",{value:!0}),t.deviation=t.earcut=void 0,t.earcut=function(e,t,a){var o,s,l,f,c,h=t&&t.length,d=h?t[0]*a:e.length,y=r(e,0,d,a,!0),p=new Array;if(!y||y.next===y.prev)return p;if(h&&(y=function(e,t,n,a){for(var o=new Array,s=0,l=t.length;s<l;s++){var f=r(e,t[s]*a,s<l-1?t[s+1]*a:e.length,a,!1);f===f.next&&(f.steiner=!0),o.push(u(f))}o.sort(v);for(var c=0,h=o;c<h.length;c++)x(h[c],n),n=i(n,n.next);return n}(e,t,y,a)),e.length>80*a){o=l=e[0],s=f=e[1];for(var _=a;_<d;_+=a){var g=e[_],m=e[_+1];o=Math.min(o,g),s=Math.min(s,m),l=Math.max(l,g),f=Math.max(f,m)}c=0!==(c=Math.max(l-o,f-s))?1/c:0}return n(y,p,a,o,s,c),p},t.deviation=function(e,t,r,i){var n=t&&t.length,a=Math.abs(h(e,0,n?t[0]*r:e.length,r));if(n)for(var o=0,s=t.length;o<s;o++)a-=Math.abs(h(e,t[o]*r,o<s-1?t[o+1]*r:e.length,r));var l=0;for(o=0;o<i.length;o+=3){var u=i[o]*r,x=i[o+1]*r,f=i[o+2]*r;l+=Math.abs((e[u]-e[f])*(e[x+1]-e[u+1])-(e[u]-e[x])*(e[f+1]-e[u+1]))}return 0===a&&0===l?0:Math.abs((l-a)/a)};var B=function(e,t,r){this.index=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}}).apply(null,i))||(e.exports=n)},"2eQy":function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FADE_DURATION=t.DECLUTTER_BUDGET=t.COLLISION_GRID_CELL_SIZE=t.DECLUTTER_TILES=void 0,t.DECLUTTER_TILES=!0,t.COLLISION_GRID_CELL_SIZE=32,t.DECLUTTER_BUDGET=1.5,t.FADE_DURATION=200}).apply(null,i))||(e.exports=n)},"7CQW":function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("zOht"),r("Ezhs")],void 0===(n=(function(e,t,r,i){"use strict";return function(e){function t(t,r,i,n){var a=e.call(this,t,r)||this;return a.type=4,a._circleVertexBuffer=i,a._circleIndexBuffer=n,a}return r.__extends(t,e),Object.defineProperty(t.prototype,"circleIndexStart",{get:function(){return this._circleIndexStart},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"circleIndexCount",{get:function(){return this._circleIndexCount},enumerable:!1,configurable:!0}),t.prototype.processFeatures=function(e){var t=this._circleVertexBuffer,r=this._circleIndexBuffer;this._circleIndexStart=3*r.index,this._circleIndexCount=0;var i=this.layer,n=this.zoom;e&&e.setExtent(this.layerExtent);for(var a=1,o=[1,1,1,1],s=1,l=0,u=1,x=[1,1,1,1],f=1,c=0,h=this._features;c<h.length;c++){var d=h[c],y=d.getGeometry(e);if(y){i.hasDataDrivenRadius&&(a=i.getPaintValue("circle-radius",n,d)),i.hasDataDrivenColor&&(o=i.getPaintValue("circle-color",n,d)),i.hasDataDrivenOpacity&&(s=i.getPaintValue("circle-opacity",n,d)),i.hasDataDrivenStrokeWidth&&(u=i.getPaintValue("circle-stroke-width",n,d)),i.hasDataDrivenStrokeColor&&(x=i.getPaintValue("circle-stroke-color",n,d)),i.hasDataDrivenStrokeOpacity&&(f=i.getPaintValue("circle-stroke-opacity",n,d)),i.hasDataDrivenBlur&&(l=i.getPaintValue("circle-blur",n,d));for(var p=0,_=y;p<_.length;p++){var v=_[p];if(v)for(var g=0,m=v;g<m.length;g++){var I=m[g],V=t.index;t.add(I.x,I.y,0,0,a,o,s,l,u,x,f),t.add(I.x,I.y,0,1,a,o,s,l,u,x,f),t.add(I.x,I.y,1,0,a,o,s,l,u,x,f),t.add(I.x,I.y,1,1,a,o,s,l,u,x,f),r.add(V+0,V+1,V+2),r.add(V+1,V+2,V+3),this._circleIndexCount+=6}}}}},t.prototype.serialize=function(){var e=6;e+=this.layerIndices.length,e+=this._circleVertexBuffer.array.length,e+=this._circleIndexBuffer.array.length;var t=0,r=new Uint32Array(e),i=new Int32Array(r.buffer);r[t++]=this.type,r[t++]=this.layerIndices.length;for(var n=0;n<this.layerIndices.length;n++)r[t++]=this.layerIndices[n];r[t++]=this._circleIndexStart,r[t++]=this._circleIndexCount,r[t++]=this._circleVertexBuffer.array.length;for(var a=0;a<this._circleVertexBuffer.array.length;a++)i[t++]=this._circleVertexBuffer.array[a];r[t++]=this._circleIndexBuffer.array.length;for(var o=0;o<this._circleIndexBuffer.array.length;o++)r[t++]=this._circleIndexBuffer.array[o];return r.buffer},t}(i)}).apply(null,i))||(e.exports=n)},BWOx:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("PB92"),r("6cAc")],void 0===(n=(function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextShaping=t.SDF_GLYPH_BASELINE=t.SDF_GLYPH_SIZE=void 0,t.SDF_GLYPH_SIZE=24,t.SDF_GLYPH_BASELINE=17;var n=function(){function e(e,t,r,i,n,a,o){this._glyphItems=e,this._maxWidth=t,this._lineHeight=r,this._letterSpacing=i,this._hAnchor=n,this._vAnchor=a,this._justify=o}return e.prototype.getShaping=function(e,t,i){for(var n=this._letterSpacing,a=this._lineHeight,o=this._justify,s=this._maxWidth,l=[],u=0,x=0,f=0,c=0,h=-1,d=0,y=-1,p=e.length,_=0;_<p;_++){var v=e.charCodeAt(_),g=i&&r.hasVerticalOrientation(v);if(10!==v){for(var m=void 0,I=0,V=this._glyphItems;I<V.length&&!(m=V[I][v]);I++);if(m){if(l.push({codePoint:v,x:u,y:x,vertical:g,glyphMosaicItem:m}),u+=m.metrics.advance+n,s>0&&u>s&&y>=0){var B=y+1;P=l[B].x,d=Math.max(P,d);for(var b=B;b<l.length;b++)t?l[b].y-=a:l[b].y+=a,l[b].x-=P;o&&this._applyJustification(l,c,y),t?x-=a:x+=a,u-=P,++f,c=B,y=-1}++h,32===v&&(y=l.length-1)}}else{if(_===p-1)continue;if(h>=c){var P=(w=l[h]).x+w.glyphMosaicItem.metrics.advance;d=Math.max(P,d),o&&this._applyJustification(l,c,h),c=l.length}t?x-=a:x+=a,u=0,++f}}if(h>=c){var w,D=(w=l[h]).x+w.glyphMosaicItem.metrics.advance;d=Math.max(d,D),o&&this._applyJustification(l,c,h)}if(l.length>0){var E=(o-this._hAnchor)*d,T=(-this._vAnchor*(f+1)+.5)*a;t&&f&&(T+=f*a);for(var M=0,L=l;M<L.length;M++){var S=L[M];S.x+=E,S.y+=T}}return l},e.getTextBox=function(e,r){if(!e.length)return null;for(var i=1/0,n=1/0,a=0,o=0,s=0,l=e;s<l.length;s++){var u=l[s],x=u.x,f=u.y-t.SDF_GLYPH_BASELINE,c=x+u.glyphMosaicItem.metrics.advance,h=f+r;i=Math.min(i,x),a=Math.max(a,c),n=Math.min(n,f),o=Math.max(o,h)}return{x:i,y:n,width:a-i,height:o-n}},e.getBox=function(e){if(!e.length)return null;for(var t=1/0,r=1/0,i=0,n=0,a=0,o=e;a<o.length;a++){var s=o[a],l=s.glyphMosaicItem.metrics,u=l.height,x=l.left,f=l.width,c=s.x,h=s.y-(u-Math.abs(l.top)),d=c+f+x,y=h+u;t=Math.min(t,c),i=Math.max(i,d),r=Math.min(r,h),n=Math.max(n,y)}return{x:t,y:r,width:i-t,height:n-r}},e.addDecoration=function(e,t){var r=e.length;if(0!==r){for(var n=e[0].x+e[0].glyphMosaicItem.metrics.left,a=e[0].y,o=1;o<r;o++){var s=e[o];if(s.y!==a){var l=e[o-1].x+e[o-1].glyphMosaicItem.metrics.left+e[o-1].glyphMosaicItem.metrics.width;e.push({codePoint:0,x:n,y:a+t-3,vertical:!1,glyphMosaicItem:{sdf:!0,rect:new i.default(4,0,4,8),metrics:{width:l-n,height:8,left:0,top:0,advance:0},page:0,code:0}}),a=s.y,n=s.x+s.glyphMosaicItem.metrics.left}}var u=e[r-1].x+e[r-1].glyphMosaicItem.metrics.left+e[r-1].glyphMosaicItem.metrics.width;e.push({codePoint:0,x:n,y:a+t-3,vertical:!1,glyphMosaicItem:{sdf:!0,rect:new i.default(4,0,4,8),metrics:{width:u-n,height:8,left:0,top:0,advance:0},page:0,code:0}})}},e.prototype._applyJustification=function(e,r,i){for(var n=e[i],a=(n.x+(n.vertical?t.SDF_GLYPH_SIZE:n.glyphMosaicItem.metrics.advance))*this._justify,o=r;o<=i;o++)e[o].x-=a},e}();t.TextShaping=n}).apply(null,i))||(e.exports=n)},Ezhs:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=(function(e,t){"use strict";return function(){function e(e,t){this.layerExtent=4096,this._features=[],this.layer=e,this.zoom=t,this._filter=e.getFeatureFilter()}return e.prototype.pushFeature=function(e){this._filter&&!this._filter.filter(e,this.zoom)||this._features.push(e)},e.prototype.hasFeatures=function(){return this._features.length>0},e}()}).apply(null,i))||(e.exports=n)},"Gc+D":function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("zOht"),r("ahJM")],void 0===(n=(function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PointElementMemoryBuffer=t.TriangleIndexBuffer=void 0;var n=function(e){function t(){return e.call(this,12)||this}return r.__extends(t,e),t.prototype.add=function(e,t,r){var i=this.array;i.push(e),i.push(t),i.push(r)},t}(i);t.TriangleIndexBuffer=n;var a=function(e){function t(){return e.call(this,4)||this}return r.__extends(t,e),t.prototype.add=function(e){this.array.push(e)},t}(i);t.PointElementMemoryBuffer=a}).apply(null,i))||(e.exports=n)},OBe7:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("zOht"),r("qMld"),r("ujH7"),r("Am75")],void 0===(n=(function(e,t,r,i,n,a){"use strict";return function(){function e(){this._spriteInfo={},this._glyphInfo={}}return e.prototype.reset=function(){return this._spriteInfo={},this._glyphInfo={},i.resolve()},e.prototype.getLayers=function(){return this._layers},e.prototype.setLayers=function(e){var t=new a(e.style);this._layers=t.layers},e.prototype.createTileAndParse=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var a,o,s,l,u,x,f;return r.__generator(this,(function(r){switch(r.label){case 0:for(a=e.key,o={},s=0,l=Object.keys(e.sourceName2DataAndRefKey);s<l.length;s++)o[u=l[s]]=e.sourceName2DataAndRefKey[u].refKey;x=new n(a,o,this),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,x.parse(e.sourceName2DataAndRefKey,t)];case 2:return[2,r.sent()];case 3:if(f=r.sent(),x.setObsolete(),x.release(),!i.isAbortError(f))throw f;return[2,null];case 4:return[2]}}))}))},e.prototype.updateStyle=function(e){var t=new a(e);this._layers=t.layers},e.prototype.fetchSprites=function(e,t,r){var n=[],a=this._spriteInfo;return e.forEach((function(e){void 0===a[e]&&n.push(e)})),0===n.length?i.resolve():t.invoke("getSprites",n,{signal:r&&r.signal}).then((function(e){for(var t in e)a[t]=e[t]}))},e.prototype.getSpriteItems=function(){return this._spriteInfo},e.prototype.fetchGlyphs=function(e,t,r,n,a){var o=[],s=this._glyphInfo[t];return s?r.forEach((function(e){s[e]||o.push(e)})):(s=this._glyphInfo[t]=[],r.forEach((function(e){return o.push(e)}))),0===o.length?i.resolve():n.invoke("getGlyphs",{tileID:e,font:t,codePoints:o},a).then((function(e){for(var t=0;t<e.length;t++)e[t]&&(s[t]=e[t])}))},e.prototype.getGlyphItems=function(e){return this._glyphInfo[e]},e}()}).apply(null,i))||(e.exports=n)},PB92:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isWhiteSpace=t.hasVerticalOrientation=void 0,t.hasVerticalOrientation=function(e){return 746===e||747===e||!(e<4352)&&(e>=12704&&e<=12735||e>=12544&&e<=12591||e>=65072&&e<=65103&&!(e>=65097&&e<=65103)||e>=63744&&e<=64255||e>=13056&&e<=13311||e>=11904&&e<=12031||e>=12736&&e<=12783||e>=12288&&e<=12351&&!(e>=12296&&e<=12305||e>=12308&&e<=12319||12336===e)||e>=13312&&e<=19903||e>=19968&&e<=40959||e>=12800&&e<=13055||e>=12592&&e<=12687||e>=43360&&e<=43391||e>=55216&&e<=55295||e>=4352&&e<=4607||e>=44032&&e<=55215||e>=12352&&e<=12447||e>=12272&&e<=12287||e>=12688&&e<=12703||e>=12032&&e<=12255||e>=12784&&e<=12799||e>=12448&&e<=12543&&12540!==e||e>=65280&&e<=65519&&!(65288===e||65289===e||65293===e||e>=65306&&e<=65310||65339===e||65341===e||65343===e||e>=65371&&e<=65503||65507===e||e>=65512&&e<=65519)||e>=65104&&e<=65135&&!(e>=65112&&e<=65118||e>=65123&&e<=65126)||e>=5120&&e<=5759||e>=6320&&e<=6399||e>=65040&&e<=65055||e>=19904&&e<=19967||e>=40960&&e<=42127||e>=42128&&e<=42191)},t.isWhiteSpace=function(e){return 32===e}}).apply(null,i))||(e.exports=n)},RY7r:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("zOht"),r("c9QS"),r("ahJM")],void 0===(n=(function(e,t,r,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CircleVertexBuffer=t.SymbolVertexBuffer=t.OutlineVertexBuffer=t.FillVertexBuffer=t.LineVertexBuffer=void 0;var a=new Float32Array(1),o=new Uint32Array(a.buffer),s=function(e){function t(t){var r=e.call(this,t?20:12)||this;return r._isDataDriven=t,r}return r.__extends(t,e),t.prototype.isDataDriven=function(){return this._isDataDriven},t.prototype.add=function(e,t,r,i,s,l,u,x){var f=this.array,c=n.i1616to32(e,t);if(f.push(c),c=n.i8888to32(Math.round(31*r),Math.round(31*i),Math.round(31*s),Math.round(31*l)),f.push(c),c=n.i1616to32(u,0),f.push(c),this._isDataDriven){if(!x)throw new Error("Expecting data driven values.");var h=x.color,d=h[3]*x.opacity*255;f.push(n.i8888to32(h[0]*d,h[1]*d,h[2]*d,d)),a[0]=x.size,f.push(o[0])}},t}(n);t.LineVertexBuffer=s;var l=function(e){function t(t){var r=e.call(this,t?8:4)||this;return r._isDataDriven=t,r}return r.__extends(t,e),t.prototype.isDataDriven=function(){return this._isDataDriven},t.prototype.add=function(e,t,r){var i=this.array;if(i.push(n.i1616to32(e,t)),this._isDataDriven){if(!r)throw new Error("Expecting data driven values.");var a=r.color,o=a[3]*r.opacity*255;i.push(n.i8888to32(a[0]*o,a[1]*o,a[2]*o,o))}},t}(n);t.FillVertexBuffer=l;var u=function(e){function t(t){var r=e.call(this,t?12:8)||this;return r._isDataDriven=t,r}return r.__extends(t,e),t.prototype.isDataDriven=function(){return this._isDataDriven},t.prototype.add=function(e,t,r,i,a,o,s){var l=this.array,u=this.index,x=n.i1616to32(e,t);if(l.push(x),x=n.i8888to32(Math.round(15*r),Math.round(15*i),a,o),l.push(x),this._isDataDriven){if(!s)throw new Error("Expecting data driven values.");var f=s.color,c=f[3]*s.opacity*255;l.push(n.i8888to32(f[0]*c,f[1]*c,f[2]*c,c))}return u},t}(n);t.OutlineVertexBuffer=u;var x=function(e){function t(t){var r=e.call(this,t?24:16)||this;return r._isDataDriven=t,r}return r.__extends(t,e),t.prototype.isDataDriven=function(){return this._isDataDriven},t.prototype.add=function(e,t,r,s,l,u,x,f,c,h,d,y){var p=this.array,_=n.i1616to32(e,t);if(p.push(_),_=n.i1616to32(Math.round(8*r),Math.round(8*s)),p.push(_),_=n.i8888to32(l/4,u/4,f,c),p.push(_),_=n.i8888to32(0,i.radToByte(x),10*h,Math.min(10*d,255)),p.push(_),this._isDataDriven){if(!y)throw new Error("Expecting data driven values.");var v=y.color,g=v[3]*y.opacity*255;p.push(n.i8888to32(v[0]*g,v[1]*g,v[2]*g,g)),a[0]=y.size,p.push(o[0])}},t}(n);t.SymbolVertexBuffer=x;var f=function(e){function t(){return e.call(this,16)||this}return r.__extends(t,e),t.prototype.add=function(e,t,r,i,a,o,s,l,u,x,f){var c=this.array,h=n.i1616to32(2*e+r,2*t+i);c.push(h);var d=o[3]*s*255;h=n.i8888to32(o[0]*d,o[1]*d,o[2]*d,d),c.push(h);var y=x[3]*f*255;h=n.i8888to32(x[0]*y,x[1]*y,x[2]*y,y),c.push(h),h=n.i8888to32(Math.min(32*l,255),Math.min(4*u,255),Math.min(a,255),0),c.push(h)},t}(n);t.CircleVertexBuffer=f}).apply(null,i))||(e.exports=n)},UTXC:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TileStatus=void 0,function(e){e[e.INITIALIZED=0]="INITIALIZED",e[e.NO_DATA=1]="NO_DATA",e[e.READY=2]="READY",e[e.MODIFIED=3]="MODIFIED",e[e.INVALID=4]="INVALID"}(t.TileStatus||(t.TileStatus={}))}).apply(null,i))||(e.exports=n)},VY6u:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.between=t.interpolate=t.sqr=t.log2=t.degToByte=t.radToByte=t.positiveMod=t.C_SQRT2_INV=t.C_SQRT2=t.C_DEG_TO_RAD=t.C_DEG_TO_256=t.C_256_TO_RAD=t.C_RAD_TO_256=t.C_PI_BY_2=t.C_2PI=t.C_PI=t.C_INFINITY=void 0,t.C_INFINITY=Number.POSITIVE_INFINITY,t.C_PI=Math.PI,t.C_2PI=2*t.C_PI,t.C_PI_BY_2=t.C_PI/2,t.C_RAD_TO_256=128/t.C_PI,t.C_256_TO_RAD=t.C_PI/128,t.C_DEG_TO_256=256/360,t.C_DEG_TO_RAD=t.C_PI/180,t.C_SQRT2=1.414213562,t.C_SQRT2_INV=1/t.C_SQRT2;var r=1/Math.LN2;function i(e,t){return(e%=t)>=0?e:e+t}t.positiveMod=i,t.radToByte=function(e){return i(e*t.C_RAD_TO_256,256)},t.degToByte=function(e){return i(e*t.C_DEG_TO_256,256)},t.log2=function(e){return Math.log(e)*r},t.sqr=function(e){return e*e},t.interpolate=function(e,t,r){return e*(1-r)+t*r},t.between=function(e,t,r){return e>=t&&e<=r||e>=r&&e<=t}}).apply(null,i))||(e.exports=n)},ahJM:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=(function(e,t){"use strict";return function(){function e(e){this._array=[],e<=0&&console.error("strideInBytes must be positive!"),this._stride=e}return Object.defineProperty(e.prototype,"array",{get:function(){return this._array},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return 4*this._array.length/this._stride},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"itemSize",{get:function(){return this._stride},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sizeInBytes",{get:function(){return 4*this._array.length},enumerable:!1,configurable:!0}),e.prototype.reset=function(){this.array.length=0},e.prototype.toBuffer=function(){return new Uint32Array(this._array).buffer},e.i1616to32=function(e,t){return 65535&e|t<<16},e.i8888to32=function(e,t,r,i){return 255&e|(255&t)<<8|(255&r)<<16|i<<24},e.i8816to32=function(e,t,r){return 255&e|(255&t)<<8|r<<16},e}()}).apply(null,i))||(e.exports=n)},"c0+/":function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("zOht"),r("H1tY"),r("Ezhs"),r("tBzM"),r("8Lwu")],void 0===(n=(function(e,t,r,i,n,a,o){"use strict";var s=0,l=0,u=0;i("esri-tiles-performance")&&setInterval((function(){console.log("New (VTL)","feat="+u,"secs="+s,"tris="+l,"tris/sec="+Math.round(l/s))}),1e4);var x=function(e){function t(t,r,i,n){var a=e.call(this,t,r)||this;if(a.type=2,a._tessellationOptions={},a.tessellationProperties={_lineVertexBuffer:null,_lineIndexBuffer:null,_hasPattern:null,_ddValues:null,_capType:null,_joinType:null,_miterLimitCosine:null,_roundLimitCosine:null},t.hasDataDrivenLine!==i.isDataDriven())throw new Error("incompatible line buffer");return a.tessellationProperties._lineVertexBuffer=i,a.tessellationProperties._lineIndexBuffer=n,a.tessellationProperties._hasPattern=t.getPaintValue("line-pattern",a.zoom)||t.getPaintValue("line-dasharray",a.zoom).length>0,a._isThinLine=t.isThinLine,a._tessellationCallbacks=a._isThinLine?{vertex:f(a.tessellationProperties),bridge:c(a.tessellationProperties)}:{vertex:h(a.tessellationProperties),bridge:d(a.tessellationProperties)},a}return r.__extends(t,e),Object.defineProperty(t.prototype,"lineIndexStart",{get:function(){return this._lineIndexStart},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineIndexCount",{get:function(){return this._lineIndexCount},enumerable:!1,configurable:!0}),t.prototype.processFeatures=function(e){this._lineIndexStart=3*this.tessellationProperties._lineIndexBuffer.index,this._lineIndexCount=0;var t=this.layer,r=this.zoom,i=t.hasDataDrivenLine;e&&e.setExtent(this.layerExtent);for(var n=[1,1,1,1],s=1,l=1,u=0,x=this._features;u<x.length;u++){var f=x[u];!this.tessellationProperties._hasPattern&&t.hasDataDrivenColor&&(n=t.getPaintValue("line-color",r,f)),t.hasDataDrivenOpacity&&(s=t.getPaintValue("line-opacity",r,f)),t.hasDataDrivenWidth&&(l=t.getPaintValue("line-width",r,f));var c=void 0;if(!i||!((c={color:n,opacity:s,size:Math.max(Math.min(l,256),0)}).size<=0||c.opacity<=0||c.color[3]<=0)){this.tessellationProperties._capType=t.getLayoutValue("line-cap",r,f),this.tessellationProperties._joinType=t.getLayoutValue("line-join",r,f),this.tessellationProperties._miterLimitCosine=o.getLimitCosine(t.getLayoutValue("line-miter-limit",r,f)),this.tessellationProperties._roundLimitCosine=o.getLimitCosine(t.getLayoutValue("line-round-limit",r,f));var h=f.getGeometry(e);this._processFeature(h,c)}}a.cleanup()},t.prototype.serialize=function(){var e=7;e+=this.layerIndices.length,e+=this.tessellationProperties._lineVertexBuffer.array.length,e+=this.tessellationProperties._lineIndexBuffer.array.length;var t=0,r=new Uint32Array(e),i=new Int32Array(r.buffer);r[t++]=this.type,r[t++]=this.layerIndices.length;for(var n=0;n<this.layerIndices.length;n++)r[t++]=this.layerIndices[n];r[t++]=this._lineIndexStart,r[t++]=this._lineIndexCount,r[t++]=this.tessellationProperties._lineVertexBuffer.isDataDriven()?1:0,r[t++]=this.tessellationProperties._lineVertexBuffer.array.length;for(var a=0;a<this.tessellationProperties._lineVertexBuffer.array.length;a++)i[t++]=this.tessellationProperties._lineVertexBuffer.array[a];r[t++]=this.tessellationProperties._lineIndexBuffer.array.length;for(var o=0;o<this.tessellationProperties._lineIndexBuffer.array.length;o++)r[t++]=this.tessellationProperties._lineIndexBuffer.array[o];return r.buffer},t.prototype._processFeature=function(e,t){if(e)for(var r=e.length,i=0;i<r;i++)this._processGeometry(e[i],t)},t.prototype._processGeometry=function(e,t){var r;if(i("esri-tiles-performance")&&(r=performance.now()),!(e.length<2)){for(var n,o,x=e[0],f=1;f<e.length;)(n=e[f].x-x.x)*n+(o=e[f].y-x.y)*o<1e-6?e.splice(f,1):(x=e[f],++f);if(!(e.length<2)){var c=3*this.tessellationProperties._lineIndexBuffer.index;this._tessellationOptions.trackDistance=this.tessellationProperties._hasPattern,this._tessellationOptions.initialDistance=0,this._tessellationOptions.thin=this._isThinLine,this._tessellationOptions.wrapDistance=65535,this._tessellationOptions.outerBisectorAutoSplitThreshold=1/3.8,this._tessellationOptions.enableOuterBisectorSplit=this.tessellationProperties._hasPattern,this._tessellationOptions.innerBisectorAutoSplitThreshold=1/3.8,this._tessellationOptions.enableInnerBisectorSplit=this.tessellationProperties._hasPattern,this.tessellationProperties._ddValues=t,a.tessellate(e,this._tessellationOptions,this._tessellationCallbacks),this._lineIndexCount+=3*this.tessellationProperties._lineIndexBuffer.index-c,i("esri-tiles-performance")&&(s+=(performance.now()-r)/1e3,l+=this.tessellationProperties._lineIndexBuffer.index-c/3,u++)}}},t}(n),f=function(e){return function(t){t.entry0=e._lineVertexBuffer.index,e._lineVertexBuffer.add(t.currentVertex.x,t.currentVertex.y,t.prevNormal.x,t.prevNormal.y,0,-1,t.distance,e._ddValues),t.entry2=e._lineVertexBuffer.index,e._lineVertexBuffer.add(t.currentVertex.x,t.currentVertex.y,-t.prevNormal.x,-t.prevNormal.y,0,1,t.distance,e._ddValues),t.exit0=e._lineVertexBuffer.index,e._lineVertexBuffer.add(t.currentVertex.x,t.currentVertex.y,t.nextNormal.x,t.nextNormal.y,0,-1,t.distance,e._ddValues),t.exit2=e._lineVertexBuffer.index,e._lineVertexBuffer.add(t.currentVertex.x,t.currentVertex.y,-t.nextNormal.x,-t.nextNormal.y,0,1,t.distance,e._ddValues)}},c=function(e){return function(t){e._lineIndexBuffer.add(t.leftExit0,t.rightEntry0,t.leftExit2),e._lineIndexBuffer.add(t.rightEntry0,t.rightEntry2,t.leftExit2)}},h=function(e){return function(t){var r,i=2===e._joinType?e._miterLimitCosine:e._roundLimitCosine,n=t.isCap&&0!==e._capType,o=!1;if(t.cosine>.97?(t.exit0=t.entry0=e._lineVertexBuffer.index,e._lineVertexBuffer.add(t.currentVertex.x,t.currentVertex.y,t.bisector.x/t.cosine,t.bisector.y/t.cosine,0,-1,t.distance,e._ddValues),t.exit2=t.entry2=e._lineVertexBuffer.index,e._lineVertexBuffer.add(t.currentVertex.x,t.currentVertex.y,-t.bisector.x/t.cosine,-t.bisector.y/t.cosine,0,1,t.distance,e._ddValues)):t.cosine<1-.97?(t.entry0=e._lineVertexBuffer.index,e._lineVertexBuffer.add(t.currentVertex.x,t.currentVertex.y,t.prevNormal.x,t.prevNormal.y,0,-1,t.distance,e._ddValues),t.entry2=e._lineVertexBuffer.index,e._lineVertexBuffer.add(t.currentVertex.x,t.currentVertex.y,-t.prevNormal.x,-t.prevNormal.y,0,1,t.distance,e._ddValues),t.exit0=e._lineVertexBuffer.index,e._lineVertexBuffer.add(t.currentVertex.x,t.currentVertex.y,t.nextNormal.x,t.nextNormal.y,0,-1,t.distance,e._ddValues),t.exit2=e._lineVertexBuffer.index,e._lineVertexBuffer.add(t.currentVertex.x,t.currentVertex.y,-t.nextNormal.x,-t.nextNormal.y,0,1,t.distance,e._ddValues)):t.canSplit?(a.splitVertex(),t.sign>0?(t.splitInner?(t.exit0=e._lineVertexBuffer.index,e._lineVertexBuffer.add(t.currentVertex.x,t.currentVertex.y,t.leftInner.x,t.leftInner.y,0,-1,t.distance,e._ddValues),t.entry0=e._lineVertexBuffer.index,e._lineVertexBuffer.add(t.currentVertex.x,t.currentVertex.y,t.rightInner.x,t.rightInner.y,0,-1,t.distance,e._ddValues)):(t.exit0=t.entry0=e._lineVertexBuffer.index,e._lineVertexBuffer.add(t.currentVertex.x,t.currentVertex.y,t.bisector.x/t.cosine,t.bisector.y/t.cosine,0,-1,t.distance,e._ddValues)),t.cosine<i?(o=!t.isCap,t.entry2=e._lineVertexBuffer.index,e._lineVertexBuffer.add(t.currentVertex.x,t.currentVertex.y,-t.prevNormal.x,-t.prevNormal.y,0,1,t.distance,e._ddValues),t.exit2=e._lineVertexBuffer.index,e._lineVertexBuffer.add(t.currentVertex.x,t.currentVertex.y,-t.nextNormal.x,-t.nextNormal.y,0,1,t.distance,e._ddValues)):t.splitOuter?(o=o||t.gapOuter,t.entry2=e._lineVertexBuffer.index,e._lineVertexBuffer.add(t.currentVertex.x,t.currentVertex.y,-t.leftOuter.x,-t.leftOuter.y,0,1,t.distance,e._ddValues),t.exit2=e._lineVertexBuffer.index,e._lineVertexBuffer.add(t.currentVertex.x,t.currentVertex.y,-t.rightOuter.x,-t.rightOuter.y,0,1,t.distance,e._ddValues)):(t.entry2=t.exit2=e._lineVertexBuffer.index,e._lineVertexBuffer.add(t.currentVertex.x,t.currentVertex.y,-t.bisector.x/t.cosine,-t.bisector.y/t.cosine,0,1,t.distance,e._ddValues))):(t.splitInner?(t.exit2=e._lineVertexBuffer.index,e._lineVertexBuffer.add(t.currentVertex.x,t.currentVertex.y,-t.leftInner.x,-t.leftInner.y,0,1,t.distance,e._ddValues),t.entry2=e._lineVertexBuffer.index,e._lineVertexBuffer.add(t.currentVertex.x,t.currentVertex.y,-t.rightInner.x,-t.rightInner.y,0,1,t.distance,e._ddValues)):(t.exit2=t.entry2=e._lineVertexBuffer.index,e._lineVertexBuffer.add(t.currentVertex.x,t.currentVertex.y,-t.bisector.x/t.cosine,-t.bisector.y/t.cosine,0,1,t.distance,e._ddValues)),t.cosine<i?(o=!t.isCap,t.entry0=e._lineVertexBuffer.index,e._lineVertexBuffer.add(t.currentVertex.x,t.currentVertex.y,t.prevNormal.x,t.prevNormal.y,0,-1,t.distance,e._ddValues),t.exit0=e._lineVertexBuffer.index,e._lineVertexBuffer.add(t.currentVertex.x,t.currentVertex.y,t.nextNormal.x,t.nextNormal.y,0,-1,t.distance,e._ddValues)):t.splitOuter?(o=o||t.gapOuter,t.entry0=e._lineVertexBuffer.index,e._lineVertexBuffer.add(t.currentVertex.x,t.currentVertex.y,t.leftOuter.x,t.leftOuter.y,0,-1,t.distance,e._ddValues),t.exit0=e._lineVertexBuffer.index,e._lineVertexBuffer.add(t.currentVertex.x,t.currentVertex.y,t.rightOuter.x,t.rightOuter.y,0,-1,t.distance,e._ddValues)):(t.exit0=t.entry0=e._lineVertexBuffer.index,e._lineVertexBuffer.add(t.currentVertex.x,t.currentVertex.y,t.bisector.x/t.cosine,t.bisector.y/t.cosine,0,-1,t.distance,e._ddValues)))):t.sign>0?(t.exit0=t.entry0=e._lineVertexBuffer.index,e._lineVertexBuffer.add(t.currentVertex.x,t.currentVertex.y,t.bisector.x/t.cosine,t.bisector.y/t.cosine,0,-1,t.distance,e._ddValues),t.cosine<i?(o=!t.isCap,t.entry2=e._lineVertexBuffer.index,e._lineVertexBuffer.add(t.currentVertex.x,t.currentVertex.y,-t.prevNormal.x,-t.prevNormal.y,0,1,t.distance,e._ddValues),t.exit2=e._lineVertexBuffer.index,e._lineVertexBuffer.add(t.currentVertex.x,t.currentVertex.y,-t.nextNormal.x,-t.nextNormal.y,0,1,t.distance,e._ddValues)):(t.entry2=t.exit2=e._lineVertexBuffer.index,e._lineVertexBuffer.add(t.currentVertex.x,t.currentVertex.y,-t.bisector.x/t.cosine,-t.bisector.y/t.cosine,0,1,t.distance,e._ddValues))):(t.exit2=t.entry2=e._lineVertexBuffer.index,e._lineVertexBuffer.add(t.currentVertex.x,t.currentVertex.y,-t.bisector.x/t.cosine,-t.bisector.y/t.cosine,0,1,t.distance,e._ddValues),t.cosine<i?(o=!t.isCap,t.entry0=e._lineVertexBuffer.index,e._lineVertexBuffer.add(t.currentVertex.x,t.currentVertex.y,t.prevNormal.x,t.prevNormal.y,0,-1,t.distance,e._ddValues),t.exit0=e._lineVertexBuffer.index,e._lineVertexBuffer.add(t.currentVertex.x,t.currentVertex.y,t.nextNormal.x,t.nextNormal.y,0,-1,t.distance,e._ddValues)):(t.exit0=t.entry0=e._lineVertexBuffer.index,e._lineVertexBuffer.add(t.currentVertex.x,t.currentVertex.y,t.bisector.x/t.cosine,t.bisector.y/t.cosine,0,-1,t.distance,e._ddValues))),t.canSplit&&(t.splitInner||t.splitOuter)||o||n?(r=t.entry1=t.exit1=e._lineVertexBuffer.index,e._lineVertexBuffer.add(t.currentVertex.x,t.currentVertex.y,0,0,0,0,t.distance,e._ddValues)):r=t.entry1=t.exit1=null,o&&1!==e._joinType)e._lineIndexBuffer.add(r,t.sign>0?t.exit2:t.entry0,t.sign>0?t.entry2:t.exit0);else if(n&&1===e._capType||o&&1===e._joinType){var s,l=void 0,u=void 0,x=void 0,f=void 0,c=void 0,h=void 0;t.isCap?(h=(s=Math.PI)/(c=Math.ceil(s/.8)),t.isFirstVertex?(l=t.prevNormal.x,u=t.prevNormal.y,x=t.entry0,f=t.entry2):t.isLastVertex&&(l=-t.nextNormal.x,u=-t.nextNormal.y,x=t.exit2,f=t.exit0)):(h=(s=2*Math.acos(t.cosine))/(c=Math.ceil(s/.8)),l=t.sign>0?-t.prevNormal.x:t.nextNormal.x,u=t.sign>0?-t.prevNormal.y:t.nextNormal.y,x=t.sign>0?t.entry2:t.exit0,f=t.sign>0?t.exit2:t.entry0);var d=Math.cos(h),y=Math.sin(h),p=y*l+d*u;l=d*l-y*u,u=p;for(var _=void 0,v=void 0,g=0;g<c;++g){_=v,g<c-1&&(t.isCap?(v=e._lineVertexBuffer.index,e._lineVertexBuffer.add(t.currentVertex.x,t.currentVertex.y,l,u,t.isFirstVertex?-1:1,0,t.distance,e._ddValues)):(v=e._lineVertexBuffer.index,e._lineVertexBuffer.add(t.currentVertex.x,t.currentVertex.y,l,u,0,t.sign,t.distance,e._ddValues))),e._lineIndexBuffer.add(0===g?x:_,r,g===c-1?f:v);var m=y*l+d*u;l=d*l-y*u,u=m}}else if(n&&2===e._capType){var I=t.isFirstVertex?1:-1,V=void 0,B=void 0;e._hasPattern?(V=e._lineVertexBuffer.index,e._lineVertexBuffer.add(t.currentVertex.x,t.currentVertex.y,t.prevNormal.x-I*t.inbound.x,t.prevNormal.y-I*t.inbound.y,-I,-1,t.distance,e._ddValues),B=e._lineVertexBuffer.index,e._lineVertexBuffer.add(t.currentVertex.x,t.currentVertex.y,-t.prevNormal.x-I*t.inbound.x,-t.prevNormal.y-I*t.inbound.y,-I,1,t.distance,e._ddValues)):(V=e._lineVertexBuffer.index,e._lineVertexBuffer.add(t.currentVertex.x,t.currentVertex.y,t.prevNormal.x-I*t.inbound.x,t.prevNormal.y-I*t.inbound.y,0,-1,t.distance,e._ddValues),B=e._lineVertexBuffer.index,e._lineVertexBuffer.add(t.currentVertex.x,t.currentVertex.y,-t.prevNormal.x-I*t.inbound.x,-t.prevNormal.y-I*t.inbound.y,0,1,t.distance,e._ddValues)),I>0?(e._lineIndexBuffer.add(r,t.entry2,B),e._lineIndexBuffer.add(r,B,V),e._lineIndexBuffer.add(r,V,t.entry0)):(e._lineIndexBuffer.add(r,B,t.exit2),e._lineIndexBuffer.add(r,V,B),e._lineIndexBuffer.add(r,t.exit0,V))}}},d=function(e){return function(t){e._lineIndexBuffer.add(t.leftExit0,t.rightEntry0,null!=t.leftExit1?t.leftExit1:t.leftExit2),e._lineIndexBuffer.add(t.rightEntry0,null!=t.rightEntry1?t.rightEntry1:t.rightEntry2,null!=t.leftExit1?t.leftExit1:t.leftExit2),null!=t.leftExit1&&null!=t.rightEntry1?(e._lineIndexBuffer.add(t.leftExit1,t.rightEntry1,t.leftExit2),e._lineIndexBuffer.add(t.rightEntry1,t.rightEntry2,t.leftExit2)):null!=t.leftExit1?e._lineIndexBuffer.add(t.leftExit1,t.rightEntry2,t.leftExit2):null!=t.rightEntry1&&e._lineIndexBuffer.add(t.rightEntry1,t.rightEntry2,t.leftExit2)}};return x}).apply(null,i))||(e.exports=n)},qDf7:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("zOht"),r("v7zm"),r("qMld"),r("7CQW"),r("0+xL"),r("tVEB"),r("Gc+D"),r("c0+/"),r("wodO"),r("yaQU"),r("RY7r"),r("GDRe"),r("UTXC")],void 0===(n=(function(e,t,r,i,n,a,o,s,l,u,x,f,c,h,d){"use strict";return function(){function e(e,t,r){this._pbfTiles={},this._tileClippers={},this._client=r,this._tile=t,this._layers=t.getLayers();var n=t.tileKey.split("/").map(parseFloat),a=n[0],o=n[1],s=n[2];this._level=a;for(var l=Math.max(8,Math.round(1*this._level)-8),u=0,x=Object.keys(e);u<x.length;u++){var f=x[u],c=e[f];if(this._pbfTiles[f]=new i(new Uint8Array(c.protobuff),new DataView(c.protobuff)),c.refKey){var d=a-c.refKey.split("/").map(parseFloat)[0];if(d>0){var y=(1<<d)-1;this._tileClippers[f]=new h.TileClipper(d,o&y,s&y,8,l)}}this._tileClippers[f]||(this._tileClippers[f]=new h.SimpleBuilder)}}return e.prototype.parse=function(e){return r.__awaiter(this,void 0,void 0,(function(){var t,i,a,s,l,u,x,f,c,h,y,p,_,v,g,m,I,V,B,b,P,w,D,E,T,M,L,S,C,O,A,N,z,k,F,R,j,G,Z,Y,U,H,W,Q,q,K,J,X;return r.__generator(this,(function(r){for(t=e&&e.signal,i=this._parseTileData(this._pbfTiles),a=this._layers,s=this._level,u=this._tileClippers,x={},f={},c=[],h={},y=new Map,p=a.length-1;p>=0;p--)(l=a[p]).minzoom&&s<Math.floor(l.minzoom)||l.maxzoom&&s>=l.maxzoom||l.layout&&l.layout.visibility&&"none"===l.layout.visibility||0!==l.type&&i[l.source]&&u[l.source]&&(_=u[l.source],(C=i[l.source][v=l.sourceLayer])&&((g=f[l.source])||(g=f[l.source]=new Set),g.add(l.sourceLayer),l.refLayerId?y.set(p,l.refLayerId):(H=this._createBucket(l))&&(H.layerIndices=[p],H.layerExtent=C.extent,H.tileClipper=_,(O=x[l.source])||(O=x[l.source]={}),(m=O[v])||(m=O[v]=[]),m.push(H),c.push(H),h[l.id.toLowerCase()]={layer:l,bucket:H})));for(y.forEach((function(e,t){e=e.toLowerCase(),h[e]&&h[e].bucket.layerIndices.push(t)})),I=10*this._level,V=10*(this._level+1),B=new Set,b={},P=[],w=[],D=function(e){f[e].forEach((function(t){P.push(t),w.push(e)}))},E=0,T=Object.keys(f);E<T.length;E++)D(L=T[E]);for(M=0;M<P.length;M++)if(S=P[M],i[L=w[M]]&&x[L]&&(C=i[L][S],(A=(O=x[L])[S])&&0!==A.length)){if(n.isAborted(t))return[2,void 0];for(N=C.getData();N.nextTag(2);){if(z=N.getMessage(),k=new o(z,C),z.release(),F=k.values){if((R=F._minzoom)&&R>=V)continue;if((j=F._maxzoom)&&j<=I)continue}for(G=0,Z=A;G<Z.length;G++)(H=Z[G]).pushFeature(k)}}for(Y=0,U=c;Y<U.length;Y++)3===(H=U[Y]).type&&H.getResources(H.tileClipper,B,b);if(this._tile.status===d.TileStatus.INVALID)return[2,n.resolve([])];for(J in W=[],Q=this._tile.getWorkerTileHandler(),B.size>0&&(q=Q.fetchSprites(B,this._client,e),W.push(q)),b)(X=b[J]).size>0&&(K=Q.fetchGlyphs(this._tile.tileKey,J,X,this._client,e),W.push(K));return[2,n.all(W).then((function(){for(var e=c.filter((function(e){return e.hasFeatures()})),t=0,r=e;t<r.length;t++){var i=r[t];i.processFeatures(i.tileClipper)}return e.sort((function(e,t){return e.layerIndices[0]-t.layerIndices[0]})),e}))]}))}))},e.prototype._parseTileData=function(e){for(var t={},r=0,i=Object.keys(e);r<i.length;r++){for(var n=i[r],a=e[n],o={};a.next();)switch(a.tag()){case 3:var s=a.getMessage(),l=new x(s);s.release(),o[l.name]=l;break;default:a.skip()}t[n]=o}return t},e.prototype._createBucket=function(e){switch(e.type){case 0:return null;case 1:return this._createFillBucket(e);case 2:return this._createLineBucket(e);case 4:return this._createCircleBucket(e);case 3:return this._createSymbolBucket(e)}},e.prototype._createFillBucket=function(e){return new s(e,this._level,new c.FillVertexBuffer(e.hasDataDrivenFill),new l.TriangleIndexBuffer,new c.OutlineVertexBuffer(e.hasDataDrivenOutline),new l.TriangleIndexBuffer)},e.prototype._createLineBucket=function(e){return new u(e,this._level,new c.LineVertexBuffer(e.hasDataDrivenLine),new l.TriangleIndexBuffer)},e.prototype._createCircleBucket=function(e){return new a(e,this._level,new c.CircleVertexBuffer,new l.TriangleIndexBuffer)},e.prototype._createSymbolBucket=function(e){var t=this._tile;return new f(e,this._level,new c.SymbolVertexBuffer(e.hasDataDrivenIcon),new l.TriangleIndexBuffer,new c.SymbolVertexBuffer(e.hasDataDrivenText),new l.TriangleIndexBuffer,t.placementEngine,t.getWorkerTileHandler())},e}()}).apply(null,i))||(e.exports=n)},tVEB:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("zOht"),r("QVms"),r("1E+e"),r("Ezhs"),r("6+ni")],void 0===(n=(function(e,t,r,i,n,a,o){"use strict";return function(e){function t(t,r,i,n,a,o){var s=e.call(this,t,r)||this;if(s.type=1,t.hasDataDrivenFill!==i.isDataDriven())throw new Error("incompatible fill buffer");if(t.hasDataDrivenOutline!==a.isDataDriven())throw new Error("incompatible outline buffer");return s._fillVertexBuffer=i,s._fillIndexBuffer=n,s._outlineVertexBuffer=a,s._outlineIndexBuffer=o,s}return r.__extends(t,e),Object.defineProperty(t.prototype,"fillIndexStart",{get:function(){return this._fillIndexStart},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fillIndexCount",{get:function(){return this._fillIndexCount},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"outlineIndexStart",{get:function(){return this._outlineIndexStart},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"outlineIndexCount",{get:function(){return this._outlineIndexCount},enumerable:!1,configurable:!0}),t.prototype.processFeatures=function(e){this._fillIndexStart=3*this._fillIndexBuffer.index,this._fillIndexCount=0,this._outlineIndexStart=3*this._outlineIndexBuffer.index,this._outlineIndexCount=0;var t=this.layer,r=this.zoom,i=t.hasDataDrivenFill,n=t.hasDataDrivenOutline;e&&e.setExtent(this.layerExtent);var a=t.getPaintValue("fill-pattern",r),o=t.getPaintValue("fill-antialias",r)&&void 0===a,s=[1,1,1,1],l=[1,1,1,1],u=1;if(t.outlineUsesFillColor){if(o&&!t.hasDataDrivenOpacity){var x=t.getPaintValue("fill-opacity",r),f=t.getPaintValue("fill-opacity",r+1);x<1&&f<1&&(o=!1)}if(o&&!t.hasDataDrivenColor){var c=t.getPaintValue("fill-color",r),h=t.getPaintValue("fill-color",r+1);c[3]<1&&h[3]<1&&(o=!1)}}for(var d=0,y=this._features;d<y.length;d++){var p=y[d];!a&&t.hasDataDrivenColor&&(s=t.getPaintValue("fill-color",r,p)),t.hasDataDrivenOpacity&&(u=t.getPaintValue("fill-opacity",r,p)),!a&&t.hasDataDrivenOutlineColor&&(l=t.getPaintValue("fill-outline-color",r,p));var _=void 0;i&&(_={color:s,opacity:u});var v=void 0;n&&(v={color:t.outlineUsesFillColor?s:l,opacity:u});var g=p.getGeometry(e);this._processFeature(g,o,t.outlineUsesFillColor,_,v)}},t.prototype.serialize=function(){var e=12;e+=this.layerIndices.length,e+=this._fillVertexBuffer.array.length,e+=this._fillIndexBuffer.array.length,e+=this._outlineVertexBuffer.array.length,e+=this._outlineIndexBuffer.array.length;var t=0,r=new Uint32Array(e),i=new Int32Array(r.buffer);r[t++]=this.type,r[t++]=this.layerIndices.length;for(var n=0;n<this.layerIndices.length;n++)r[t++]=this.layerIndices[n];r[t++]=this._fillIndexStart,r[t++]=this._fillIndexCount,r[t++]=this._outlineIndexStart,r[t++]=this._outlineIndexCount,r[t++]=this._fillVertexBuffer.isDataDriven()?1:0,r[t++]=this._outlineVertexBuffer.isDataDriven()?1:0,r[t++]=this._fillVertexBuffer.array.length;for(var a=0;a<this._fillVertexBuffer.array.length;a++)i[t++]=this._fillVertexBuffer.array[a];r[t++]=this._fillIndexBuffer.array.length;for(var o=0;o<this._fillIndexBuffer.array.length;o++)r[t++]=this._fillIndexBuffer.array[o];r[t++]=this._outlineVertexBuffer.array.length;for(var s=0;s<this._outlineVertexBuffer.array.length;s++)i[t++]=this._outlineVertexBuffer.array[s];r[t++]=this._outlineIndexBuffer.array.length;for(var l=0;l<this._outlineIndexBuffer.array.length;l++)r[t++]=this._outlineIndexBuffer.array[l];return r.buffer},t.prototype._processFeature=function(e,r,i,n,a){if(e){var o,s=e.length;if(r&&(!i||!a||a.color[3]*a.opacity==1))for(var l=0;l<s;l++)this._processOutline(e[l],a);for(l=0;l<s;l++){var u=t._area(e[l]);u>128?(void 0!==o&&this._processFill(e,o,n),o=[l]):u<-128&&void 0!==o&&o.push(l)}void 0!==o&&this._processFill(e,o,n)}},t.prototype._processOutline=function(e,t){var r,i,n,a=this._outlineVertexBuffer,s=this._outlineIndexBuffer,l=s.index,u=new o.Point(0,0),x=new o.Point(0,0),f=new o.Point(0,0),c=-1,h=-1,d=-1,y=-1,p=-1,_=!1,v=e.length;if(!(v<2)){for(var g=e[0],m=e[v-1];v&&m.isEqual(g);)m=e[--v-1];if(!(v-0<2)){for(var I=0;I<v;++I){0===I?(n=e[1],u.assignSub(i=e[0],r=e[v-1]),u.normalize(),u.rightPerpendicular()):(r=i,i=n,n=I!==v-1?e[I+1]:e[0],u.assign(x));var V=this._isClipEdge(r,i);-1===y&&(_=V),x.assignSub(n,i),x.normalize(),x.rightPerpendicular();var B=u.x*x.y-u.y*x.x;f.assignAdd(u,x),f.normalize();var b=-f.x*-u.x+-f.y*-u.y,P=Math.abs(0!==b?1/b:1);P>8&&(P=8),B>=0?(d=a.add(i.x,i.y,u.x,u.y,0,1,t),-1===y&&(y=d),c>=0&&h>=0&&d>=0&&!V&&s.add(c,h,d),h=a.add(i.x,i.y,P*-f.x,P*-f.y,0,-1,t),-1===p&&(p=h),c>=0&&h>=0&&d>=0&&!V&&s.add(c,h,d),c=h,h=d,d=a.add(i.x,i.y,f.x,f.y,0,1,t),c>=0&&h>=0&&d>=0&&!V&&s.add(c,h,d),h=a.add(i.x,i.y,x.x,x.y,0,1,t),c>=0&&h>=0&&d>=0&&!V&&s.add(c,h,d)):(d=a.add(i.x,i.y,P*f.x,P*f.y,0,1,t),-1===y&&(y=d),c>=0&&h>=0&&d>=0&&!V&&s.add(c,h,d),h=a.add(i.x,i.y,-u.x,-u.y,0,-1,t),-1===p&&(p=h),c>=0&&h>=0&&d>=0&&!V&&s.add(c,h,d),c=h,h=d,d=a.add(i.x,i.y,-f.x,-f.y,0,-1,t),c>=0&&h>=0&&d>=0&&!V&&s.add(c,h,d),(c=a.add(i.x,i.y,-x.x,-x.y,0,-1,t))>=0&&h>=0&&d>=0&&!V&&s.add(c,h,d))}c>=0&&h>=0&&y>=0&&!_&&s.add(c,h,y),c>=0&&y>=0&&p>=0&&!_&&s.add(c,p,y),this._outlineIndexCount+=3*(s.index-l)}}},t.prototype._processFill=function(e,t,r){var a;t.length>1&&(a=[]);for(var o=0,s=0,l=t;s<l.length;s++){var u=l[s];0!==o&&a.push(o),o+=e[u].length}for(var x=2*o,f=i.acquire(),c=0,h=t;c<h.length;c++)for(var d=e[u=h[c]],y=d.length,p=0;p<y;++p)f.push(d[p].x),f.push(d[p].y);var _=n.earcut(f,a,2),v=_.length;if(v>0){for(var g=this._fillVertexBuffer.index,m=0;m<x;)this._fillVertexBuffer.add(f[m++],f[m++],r);for(var I=0;I<v;)this._fillIndexBuffer.add(g+_[I++],g+_[I++],g+_[I++]);this._fillIndexCount+=v}i.release(f)},t.prototype._isClipEdge=function(e,t){return e.x===t.x?e.x<=-64||e.x>=4160:e.y===t.y&&(e.y<=-64||e.y>=4160)},t._area=function(e){for(var t=0,r=e.length-1,i=0;i<r;i++)t+=(e[i].x-e[i+1].x)*(e[i].y+e[i+1].y);return.5*(t+(e[r].x-e[0].x)*(e[r].y+e[0].y))},t}(a)}).apply(null,i))||(e.exports=n)},ujH7:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("zOht"),r("LxLY"),r("zywo"),r("qDf7"),r("UTXC")],void 0===(n=(function(e,t,r,i,n,a,o){"use strict";return function(){function e(e,t,r){this.status=o.TileStatus.INITIALIZED,this.placementEngine=new n.PlacementEngine,this.tileKey=e,this.refKeys=t,this._workerTileHandler=r}return e.prototype.release=function(){this.tileKey="",this.refKeys=null,this.status=o.TileStatus.INITIALIZED,this._workerTileHandler=null},e.prototype.parse=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n,a,s,l,u=this;return r.__generator(this,(function(r){switch(r.label){case 0:return i.isSome(n=t&&t.signal)&&(a=function(){n.removeEventListener("abort",a),u.status=o.TileStatus.INVALID},n.addEventListener("abort",a)),[4,this._parse(e,t)];case 1:return s=r.sent(),this.status=o.TileStatus.READY,[2,{result:l={buckets:s.map((function(e){return e.serialize()}))},transferList:l.buckets}]}}))}))},e.prototype.setObsolete=function(){this.status=o.TileStatus.INVALID},e.prototype.getLayers=function(){return this._workerTileHandler.getLayers()},e.prototype.getWorkerTileHandler=function(){return this._workerTileHandler},e.prototype._parse=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(r){return 0===Object.keys(e).length?[2,[]]:(this.status=o.TileStatus.MODIFIED,[2,new a(e,this,t.client).parse(t)])}))}))},e}()}).apply(null,i))||(e.exports=n)},wodO:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=(function(e,t){"use strict";return function(){function e(t){for(this.extent=4096,this.keys=[],this.values=[],this._pbfLayer=t.clone();t.next();)switch(t.tag()){case 1:this.name=t.getString();break;case 3:this.keys.push(t.getString());break;case 4:this.values.push(t.processMessage(e._parseValue));break;case 5:this.extent=t.getUInt32();break;default:t.skip()}}return e.prototype.getData=function(){return this._pbfLayer},e._parseValue=function(e){for(;e.next();)switch(e.tag()){case 1:return e.getString();case 2:return e.getFloat();case 3:return e.getDouble();case 4:return e.getInt64();case 5:return e.getUInt64();case 6:return e.getSInt64();case 7:return e.getBool();default:e.skip()}return null},e}()}).apply(null,i))||(e.exports=n)},yaQU:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("zOht"),r("uhzp"),r("nRUF"),r("Ezhs"),r("c9QS"),r("zywo"),r("BWOx"),r("UXHw"),r("6+ni")],void 0===(n=(function(e,t,r,i,n,a,o,s,l,u,x){"use strict";function f(e,t){return e.iconMosaicItem&&t.iconMosaicItem?e.iconMosaicItem.page===t.iconMosaicItem.page?0:e.iconMosaicItem.page-t.iconMosaicItem.page:e.iconMosaicItem&&!t.iconMosaicItem?1:!e.iconMosaicItem&&t.iconMosaicItem?-1:0}return function(e){function t(t,r,i,n,a,o,s,l){var u=e.call(this,t,r)||this;if(u.type=3,u._markerMap=new Map,u._glyphMap=new Map,u._glyphBufferDataStorage=new Map,u._isIconSDF=!1,t.hasDataDrivenIcon!==i.isDataDriven())throw new Error("incompatible icon buffer");if(t.hasDataDrivenText!==a.isDataDriven())throw new Error("incompatible text buffer");return u._iconVertexBuffer=i,u._iconIndexBuffer=n,u._textVertexBuffer=a,u._textIndexBuffer=o,u._placementEngine=s,u._workerTileHandler=l,u}return r.__extends(t,e),Object.defineProperty(t.prototype,"markerPageMap",{get:function(){return this._markerMap},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"glyphsPageMap",{get:function(){return this._glyphMap},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"symbolInstances",{get:function(){return this._symbolInstances},enumerable:!1,configurable:!0}),t.prototype.getResources=function(e,r,i){var a=this.layer,o=this.zoom,s=a.hasDataDrivenIcon,l=a.hasDataDrivenText;e&&e.setExtent(this.layerExtent);for(var u,x,f,c,h,d,y,p,_,v=a.getLayoutProperty("icon-image"),g=a.getLayoutProperty("text-field"),m=[],I=[1,1,1,1],V=1,B=1,b=[1,1,1,1],P=1,w=1,D=0,E=this._features;D<E.length;D++){var T=E[D],M=T.getGeometry(e);if(M&&0!==M.length){var L=void 0;v&&(L=a.getLayoutValue("icon-image",o,T),v.isDataDriven||(L=this._replaceKeys(L,T.values)),L&&(r.add(L),u=a.getLayoutValue("icon-rotate",o,T),x=a.getLayoutValue("icon-offset",o,T)));var S=void 0,C=!1;if(g&&((S=a.getLayoutValue("text-field",o,T))&&!g.isDataDriven&&(S=this._replaceKeys(S,T.values)),S)){switch(S=S.replace(/\\n/g,"\n"),a.getLayoutValue("text-transform",o,T)){case 2:S=S.toLowerCase();break;case 1:S=S.toUpperCase()}var O;t._bidiEngine.hasBidiChar(S)&&(O="rtl"===t._bidiEngine.checkContextual(S)?"IDNNN":"ICNNN",S=t._bidiEngine.bidiTransform(S,O,"VLYSN"),C=!0);var A=S.length;if(A>0){for(var N=0,z=_=a.getLayoutValue("text-font",o,T);N<z.length;N++){var k=z[N],F=i[k];F||(F=i[k]=new Set);for(var R=0;R<A;R++){var j=S.charCodeAt(R);F.add(j)}}f=a.getLayoutValue("text-rotate",o,T),c=a.getLayoutValue("text-anchor",o,T),h=a.getLayoutValue("text-offset",o,T),d=a.getLayoutValue("text-justify",o,T),y=a.getLayoutValue("text-letter-spacing",o,T),p=a.getLayoutValue("text-max-width",o,T)}}if(L||S){var G=a.getLayoutValue("icon-size",o,T),Z=a.getLayoutValue("text-size",o,T);a.hasDataDrivenIconColor&&(I=a.getPaintValue("icon-color",o,T)),a.hasDataDrivenIconOpacity&&(V=a.getPaintValue("icon-opacity",o,T)),a.hasDataDrivenIconSize&&(B=G),a.hasDataDrivenTextColor&&(b=a.getPaintValue("text-color",o,T)),a.hasDataDrivenTextOpacity&&(P=a.getPaintValue("text-opacity",o,T)),a.hasDataDrivenTextSize&&(w=Z);var Y=a.getLayoutValue("symbol-sort-key",o,T),U={sprite:L,label:S,rtl:C,type:T.type,geometry:M,hash:(S?n.numericHash(S):0)^(L?n.numericHash(L):0),priority:Y,iconSize:G,iconRotate:u,ddIconValues:s?{color:I,opacity:V,size:B}:null,iconOffset:x,textSize:Z,textRotate:f,ddTextValues:l?{color:b,opacity:P,size:w}:null,textAnchor:c,textOffset:h,textJustify:d,textLetterSpacing:y,textMaxWidth:p,textFontArray:_};m.push(U)}}}this._symbolFeatures=m},t.prototype.processFeatures=function(e){e&&e.setExtent(this.layerExtent);var r,i=this.layer,n=this.zoom,a=1===i.getLayoutValue("symbol-placement",n),x=i.getLayoutValue("symbol-spacing",n)*s.TILE_PIXEL_RATIO,c=i.getLayoutProperty("icon-image"),h=i.getLayoutProperty("text-field"),d=c?new u.IconLayout(i,n,a):null,y=h?new u.TextLayout(i,n,a):null,p=this._workerTileHandler;c&&(r=p.getSpriteItems()),this._iconIndexStart=3*this._iconIndexBuffer.index,this._textIndexStart=3*this._textIndexBuffer.index,this._iconIndexCount=0,this._textIndexCount=0,this._markerMap.clear(),this._glyphMap.clear();var _=[],v=1;y&&y.size&&(v=y.size/l.SDF_GLYPH_SIZE);for(var g=y?y.maxAngle*o.C_DEG_TO_RAD:0,m=y?y.size*s.TILE_PIXEL_RATIO:0,I=0,V=this._symbolFeatures;I<V.length;I++){var B=V[I],b=void 0;d&&r&&B.sprite&&(b=r[B.sprite])&&b.sdf&&(this._isIconSDF=!0),b&&(d.size=B.iconSize,d.rotate=B.iconRotate,d.offset=B.iconOffset);var P=void 0,w=0,D=B.label;if(D){y.size=B.textSize,y.rotate=B.textRotate,y.anchor=B.textAnchor,y.fontArray=B.textFontArray,y.justify=B.textJustify,y.letterSpacing=B.textLetterSpacing,y.maxWidth=B.textMaxWidth,y.offset=B.textOffset;var E=a?y.keepUpright:y.writingMode&&y.writingMode.indexOf(1)>=0,T=.5;switch(y.anchor){case 5:case 1:case 7:T=0;break;case 6:case 2:case 8:T=1}var M=.5;switch(y.anchor){case 5:case 3:case 6:M=0;break;case 7:case 4:case 8:M=1}var L=.5;switch(y.justify){case 0:L=T;break;case 1:L=0;break;case 3:L=1}var S,C=y.letterSpacing*l.SDF_GLYPH_SIZE,O=a?0:y.maxWidth*l.SDF_GLYPH_SIZE,A=y.lineHeight*l.SDF_GLYPH_SIZE;if(S=y.fontArray.map((function(e){return p.getGlyphItems(e)})),(P=new l.TextShaping(S,O,A,C,T,M,L).getShaping(D,B.rtl,E))&&P.length>0){for(var N=1e30,z=-1e30,k=0,F=P;k<F.length;k++){var R=F[k];N=Math.min(N,R.x),z=Math.max(z,R.x)}w=(z-N+2*l.SDF_GLYPH_SIZE)*v*s.TILE_PIXEL_RATIO}}for(var j=0,G=B.geometry;j<G.length;j++){var Z=G[j],Y=void 0;if(a){if(P&&P.length>0&&y&&y.size){var U=y.size*s.TILE_PIXEL_RATIO*(2+Math.min(2,4*Math.abs(y.offset[1])));Z=t._smoothVertices(Z,U)}Y=t._findAnchors(Z,x,w)}else Y=3===B.type?t._findCentroid(Z):[new s.Anchor(Z[0].x,Z[0].y)];for(var H=0,W=Y;H<W.length;H++){var Q=W[H];if(!(Q.x<0||Q.x>s.TILE_COORD_SIZE||Q.y<0||Q.y>s.TILE_COORD_SIZE)&&(!(a&&w>0&&0===y.rotationAlignment)||t._honorsTextMaxAngle(Z,Q,w,g,m))){var q={shaping:P,line:Z,iconMosaicItem:b,anchor:Q,symbolFeature:B,textColliders:[],iconColliders:[],textVertexRanges:[],iconVertexRanges:[]};_.push(q),this._processFeature(q,d,y)}}}}_.sort(f),this._addPlacedGlyphs(),this._symbolInstances=_},t.prototype.serialize=function(){var e=13;e+=this.layerIndices.length,e+=3*this.markerPageMap.size,e+=3*this.glyphsPageMap.size,e+=t.symbolsSerializationLength(this._symbolInstances),e+=this._iconVertexBuffer.array.length,e+=this._iconIndexBuffer.array.length,e+=this._textVertexBuffer.array.length,e+=this._textIndexBuffer.array.length;var r=0,i=new Uint32Array(e),n=new Int32Array(i.buffer),a=new Float32Array(i.buffer);i[r++]=this.type,i[r++]=this.layerIndices.length;for(var o=0;o<this.layerIndices.length;o++)i[r++]=this.layerIndices[o];i[r++]=this._isIconSDF?1:0,i[r++]=this._iconVertexBuffer.isDataDriven()?1:0,i[r++]=this._textVertexBuffer.isDataDriven()?1:0,i[r++]=this.markerPageMap.size,this.markerPageMap.forEach((function(e,t){var n=e[0],a=e[1];i[r++]=t,i[r++]=n,i[r++]=a})),i[r++]=this.glyphsPageMap.size,this.glyphsPageMap.forEach((function(e,t){var n=e[0],a=e[1];i[r++]=t,i[r++]=n,i[r++]=a})),i[r++]=this._iconVertexBuffer.index/4,i[r++]=this._textVertexBuffer.index/4,r=t.serializeSymbols(i,n,a,r,this._symbolInstances),i[r++]=this._iconVertexBuffer.array.length;for(var s=0;s<this._iconVertexBuffer.array.length;s++)n[r++]=this._iconVertexBuffer.array[s];i[r++]=this._iconIndexBuffer.array.length;for(var l=0;l<this._iconIndexBuffer.array.length;l++)i[r++]=this._iconIndexBuffer.array[l];i[r++]=this._textVertexBuffer.array.length;for(var u=0;u<this._textVertexBuffer.array.length;u++)n[r++]=this._textVertexBuffer.array[u];i[r++]=this._textIndexBuffer.array.length;for(var x=0;x<this._textIndexBuffer.array.length;x++)i[r++]=this._textIndexBuffer.array[x];return i.buffer},t.symbolsSerializationLength=function(e){var t=0;t+=1;for(var r=0,i=e;r<i.length;r++){var n=i[r];t+=4,t+=1;for(var a=0,o=n.textColliders;a<o.length;a++)t+=10;for(var s=0,l=n.iconColliders;s<l.length;s++)t+=10;t+=1,t+=2*n.textVertexRanges.length,t+=1,t+=2*n.iconVertexRanges.length}return t},t.serializeSymbols=function(e,t,r,i,n){t[i++]=n.length;for(var a=0,o=n;a<o.length;a++){var s=o[a];t[i++]=s.anchor.x,t[i++]=s.anchor.y,t[i++]=s.symbolFeature.hash,t[i++]=s.symbolFeature.priority,t[i++]=s.textColliders.length+s.iconColliders.length;for(var l=0,u=s.textColliders;l<u.length;l++){var x=u[l];t[i++]=x.xTile,t[i++]=x.yTile,t[i++]=x.dxPixels,t[i++]=x.dyPixels,t[i++]=x.hard?1:0,t[i++]=x.partIndex,r[i++]=x.minLod,r[i++]=x.maxLod,t[i++]=x.width,t[i++]=x.height}for(var f=0,c=s.iconColliders;f<c.length;f++)t[i++]=(x=c[f]).xTile,t[i++]=x.yTile,t[i++]=x.dxPixels,t[i++]=x.dyPixels,t[i++]=x.hard?1:0,t[i++]=x.partIndex,r[i++]=x.minLod,r[i++]=x.maxLod,t[i++]=x.width,t[i++]=x.height;t[i++]=s.textVertexRanges.length;for(var h=0,d=s.textVertexRanges;h<d.length;h++){var y=d[h],p=y[0],_=y[1];t[i++]=p,t[i++]=_}t[i++]=s.iconVertexRanges.length;for(var v=0,g=s.iconVertexRanges;v<g.length;v++){var m=g[v];_=m[1],t[i++]=p=m[0],t[i++]=_}}return i},t.prototype._replaceKeys=function(e,t){return e.replace(/{([^{}]+)}/g,(function(e,r){return r in t?t[r]:""}))},t.prototype._processFeature=function(e,t,r){var i=e.line,n=e.iconMosaicItem,a=e.shaping,s=e.anchor,l=!!n,u=!0;l&&(u=t.optional||!n);var x,f,c=a&&a.length>0,h=!0;if(c&&(h=r.optional||!a||0===a.length),l&&(x=this._placementEngine.getIconPlacement(s,n,t)),(x||u)&&(c&&(f=this._placementEngine.getTextPlacement(s,a,i,r)),f||h)){if(x&&f||(h||u?h||f?u||x||(f=null):x=null:(x=null,f=null)),f&&(this._storePlacedGlyphs(e,f.shapes,this.zoom,r.rotationAlignment),f.textColliders)){e.textColliders=f.textColliders;for(var d=0,y=f.textColliders;d<y.length;d++)if((S=y[d]).minLod=Math.max(this.zoom+o.log2(S.minLod),0),S.maxLod=Math.min(this.zoom+o.log2(S.maxLod),25),C=S.angle){var p=Math.cos(C),_=Math.sin(C),v=S.dxPixels*p-S.dyPixels*_,g=S.dxPixels*_+S.dyPixels*p,m=(S.dxPixels+S.width)*p-S.dyPixels*_,I=(S.dxPixels+S.width)*_+S.dyPixels*p,V=S.dxPixels*p-(S.dyPixels+S.height)*_,B=S.dxPixels*_+(S.dyPixels+S.height)*p,b=(S.dxPixels+S.width)*p-(S.dyPixels+S.height)*_,P=(S.dxPixels+S.width)*_+(S.dyPixels+S.height)*p,w=Math.min(v,m,V,b),D=Math.max(v,m,V,b),E=Math.min(g,I,B,P),T=Math.max(g,I,B,P);S.dxPixels=w,S.dyPixels=E,S.width=D-w,S.height=T-E}}if(x&&(this._addPlacedIcons(e,x.shapes,this.zoom,n.page,1===t.rotationAlignment),x.iconColliders)){e.iconColliders=x.iconColliders;for(var M=0,L=x.iconColliders;M<L.length;M++){var S,C;(S=L[M]).minLod=Math.max(this.zoom+o.log2(S.minLod),0),S.maxLod=Math.min(this.zoom+o.log2(S.maxLod),25),(C=S.angle)&&(p=Math.cos(C),_=Math.sin(C),v=S.dxPixels*p-S.dyPixels*_,g=S.dxPixels*_+S.dyPixels*p,m=(S.dxPixels+S.width)*p-S.dyPixels*_,I=(S.dxPixels+S.width)*_+S.dyPixels*p,V=S.dxPixels*p-(S.dyPixels+S.height)*_,B=S.dxPixels*_+(S.dyPixels+S.height)*p,b=(S.dxPixels+S.width)*p-(S.dyPixels+S.height)*_,P=(S.dxPixels+S.width)*_+(S.dyPixels+S.height)*p,w=Math.min(v,m,V,b),D=Math.max(v,m,V,b),E=Math.min(g,I,B,P),T=Math.max(g,I,B,P),S.dxPixels=w,S.dyPixels=E,S.width=D-w,S.height=T-E)}}}},t.prototype._addPlacedIcons=function(e,t,r,i,n){for(var a=e.symbolFeature.ddIconValues,s=Math.max(r-1,0),l=this._iconVertexBuffer,u=this._iconIndexBuffer,x=this._markerMap,f=0,c=t;f<c.length;f++){var h=c[f],d=n?0:Math.max(r+o.log2(h.minzoom),s),y=n?25:Math.min(r+o.log2(h.maxzoom),25);if(!(y<=d)){var p=h.tl,_=h.tr,v=h.bl,g=h.br,m=h.mosaicRect,I=h.labelAngle,V=h.minAngle,B=h.maxAngle,b=h.anchor,P=l.index,w=m.x,D=m.y,E=w+m.width,T=D+m.height,M=l.index;l.add(b.x,b.y,p.x,p.y,w,D,I,V,B,d,y,a),l.add(b.x,b.y,_.x,_.y,E,D,I,V,B,d,y,a),l.add(b.x,b.y,v.x,v.y,w,T,I,V,B,d,y,a),l.add(b.x,b.y,g.x,g.y,E,T,I,V,B,d,y,a),e.iconVertexRanges.length>0&&e.iconVertexRanges[0][0]+e.iconVertexRanges[0][1]===M?e.iconVertexRanges[0][1]+=4:e.iconVertexRanges.push([M,4]),u.add(P+0,P+1,P+2),u.add(P+1,P+2,P+3),x.has(i)?x.get(i)[1]+=6:x.set(i,[this._iconIndexStart+this._iconIndexCount,6]),this._iconIndexCount+=6}}},t.prototype._addPlacedGlyphs=function(){var e=this,t=this._textVertexBuffer,r=this._textIndexBuffer,i=this._glyphMap;this._glyphBufferDataStorage.forEach((function(n,a){for(var o=0,s=n;o<s.length;o++){var l=s[o],u=t.index,x=l.symbolInstance,f=x.symbolFeature.ddTextValues,c=t.index;t.add(l.glyphAnchor[0],l.glyphAnchor[1],l.tl[0],l.tl[1],l.xmin,l.ymin,l.labelAngle,l.minAngle,l.maxAngle,l.minLod,l.maxLod,f),t.add(l.glyphAnchor[0],l.glyphAnchor[1],l.tr[0],l.tr[1],l.xmax,l.ymin,l.labelAngle,l.minAngle,l.maxAngle,l.minLod,l.maxLod,f),t.add(l.glyphAnchor[0],l.glyphAnchor[1],l.bl[0],l.bl[1],l.xmin,l.ymax,l.labelAngle,l.minAngle,l.maxAngle,l.minLod,l.maxLod,f),t.add(l.glyphAnchor[0],l.glyphAnchor[1],l.br[0],l.br[1],l.xmax,l.ymax,l.labelAngle,l.minAngle,l.maxAngle,l.minLod,l.maxLod,f),x.textVertexRanges.length>0&&x.textVertexRanges[0][0]+x.textVertexRanges[0][1]===c?x.textVertexRanges[0][1]+=4:x.textVertexRanges.push([c,4]),r.add(u+0,u+1,u+2),r.add(u+1,u+2,u+3),i.has(a)?i.get(a)[1]+=6:i.set(a,[e._textIndexStart+e._textIndexCount,6]),e._textIndexCount+=6}})),this._glyphBufferDataStorage.clear()},t.prototype._storePlacedGlyphs=function(e,t,r,i){for(var n,a,s,l,u,x,f,c,h,d,y,p=Math.max(r-1,0),_=1===i,v=0,g=t;v<g.length;v++){var m=g[v];n=_?0:Math.max(r+o.log2(m.minzoom),p),(a=_?25:Math.min(r+o.log2(m.maxzoom),25))<=n||(s=m.tl,l=m.tr,u=m.bl,x=m.br,f=m.labelAngle,c=m.minAngle,h=m.maxAngle,d=m.anchor,y=m.mosaicRect,this._glyphBufferDataStorage.has(m.page)||this._glyphBufferDataStorage.set(m.page,[]),this._glyphBufferDataStorage.get(m.page).push({glyphAnchor:[d.x,d.y],tl:[s.x,s.y],tr:[l.x,l.y],bl:[u.x,u.y],br:[x.x,x.y],xmin:y.x,ymin:y.y,xmax:y.x+y.width,ymax:y.y+y.height,labelAngle:f,minAngle:c,maxAngle:h,minLod:n,maxLod:a,placementLod:p,symbolInstance:e}))}},t._findAnchors=function(e,t,r){t+=r;for(var i=0,n=e.length-1,a=0;a<n;a++)i+=x.Point.distance(e[a],e[a+1]);var l=r||t;if(i<=(l*=.5))return[];var u=l/i,f=0,c=-(t=i/Math.max(Math.round(i/t),1))/2,h=[],d=e.length-1;for(a=0;a<d;a++){for(var y=e[a],p=e[a+1],_=p.x-y.x,v=p.y-y.y,g=Math.sqrt(_*_+v*v),m=void 0;c+t<f+g;){var I=((c+=t)-f)/g,V=o.interpolate(y.x,p.x,I),B=o.interpolate(y.y,p.y,I);void 0===m&&(m=Math.atan2(v,_)),h.push(new s.Anchor(V,B,m,a,u))}f+=g}return h},t._deviation=function(e,t,r){return Math.atan2((t.x-e.x)*(r.y-t.y)-(t.y-e.y)*(r.x-t.x),(t.x-e.x)*(r.x-t.x)+(t.y-e.y)*(r.y-t.y))},t._honorsTextMaxAngle=function(e,t,r,i,n){for(var a=0,o=r/2,s=new x.Point(t.x,t.y),l=t.segment+1;a>-o;){if(--l<0)return!1;a-=x.Point.distance(e[l],s),s=e[l]}a+=x.Point.distance(e[l],e[l+1]);for(var u=[],f=0,c=e.length;a<o;){var h=e[l],d=l,y=void 0;do{if(++d===c)return!1;y=e[d]}while(y.isEqual(h));var p=d,_=void 0;do{if(++p===c)return!1;_=e[p]}while(_.isEqual(y));var v=this._deviation(h,y,_);for(u.push({deviation:v,distToAnchor:a}),f+=v;a-u[0].distToAnchor>n;)f-=u.shift().deviation;if(Math.abs(f)>i)return!1;a+=x.Point.distance(y,_),l=d}return!0},t._smoothVertices=function(e,t){if(t<=0)return e;var r=e.length;if(r<3)return e;var i=[],n=0,a=0;i.push(0);for(var o=1;o<r;o++)(g=x.Point.distance(e[o],e[o-1]))>0&&(i.push(n+=g),++a!==o&&(e[a]=e[o]));if((r=a+1)<3)return e;t=Math.min(t,.2*n);var s=e[0].x,l=e[0].y,u=e[r-1].x,f=e[r-1].y,c=x.Point.sub(e[0],e[1]);c.normalize(),e[0].x+=t*c.x,e[0].y+=t*c.y,c.assignSub(e[r-1],e[r-2]),c.normalize(),e[r-1].x+=t*c.x,e[r-1].y+=t*c.y,i[0]-=t,i[r-1]+=t;var h=[];h.push(new x.Point(s,l));var d=.5*t;for(o=1;o<r-1;o++){for(var y=0,p=0,_=0,v=o-1;v>=0&&!((P=d+i[v+1]-i[o])<0);v--){var g=i[v+1]-i[v];if((w=i[o]-i[v]<d?1:P/g)<1e-6)break;var m=w*P-.5*(D=w*w)*g,I=w*g/t,V=e[v+1],B=e[v].x-V.x,b=e[v].y-V.y;y+=I/m*(V.x*w*P+.5*D*(P*B-g*V.x)-D*w*g*B/3),p+=I/m*(V.y*w*P+.5*D*(P*b-g*V.y)-D*w*g*b/3),_+=I}for(v=o+1;v<r;v++){var P,w,D;if((P=d-i[v-1]+i[o])<0)break;if(g=i[v]-i[v-1],(w=i[v]-i[o]<d?1:P/g)<1e-6)break;y+=(I=w*g/t)/(m=w*P-.5*(D=w*w)*g)*((V=e[v-1]).x*w*P+.5*D*(P*(B=e[v].x-V.x)-g*V.x)-D*w*g*B/3),p+=I/m*(V.y*w*P+.5*D*(P*(b=e[v].y-V.y)-g*V.y)-D*w*g*b/3),_+=I}h.push(new x.Point(y/_,p/_))}return h.push(new x.Point(u,f)),e[0].x=s,e[0].y=l,e[r-1].x=u,e[r-1].y=f,h},t._findCentroid=function(e){var t=e.length-1,r=0,i=0,n=0,a=e[0].x,o=e[0].y;a>4096&&(a=4096),a<0&&(a=0),o>4096&&(o=4096),o<0&&(o=0);for(var l=1;l<t;l++){var u=e[l].x,x=e[l].y,f=e[l+1].x,c=e[l+1].y;u>4096&&(u=4096),u<0&&(u=0),x>4096&&(x=4096),x<0&&(x=0),f>4096&&(f=4096),f<0&&(f=0),c>4096&&(c=4096),c<0&&(c=0);var h=(u-a)*(c-o)-(f-a)*(x-o);r+=h*(a+u+f),i+=h*(o+x+c),n+=h}return r/=3*n,i/=3*n,isNaN(r)||isNaN(i)?[]:[new s.Anchor(r,i)]},t._bidiEngine=new i.default,t}(a)}).apply(null,i))||(e.exports=n)},zywo:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("c9QS"),r("BWOx"),r("2eQy"),r("6+ni")],void 0===(n=(function(e,t,r,i,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlacementEngine=t.Placement=t.PlacedSymbol=t.Anchor=t.TILE_PIXEL_RATIO=t.TILE_PIXEL_SIZE=t.TILE_COORD_SIZE=void 0,t.TILE_COORD_SIZE=4096,t.TILE_PIXEL_SIZE=512,t.TILE_PIXEL_RATIO=8,t.Anchor=function(e,t,r,i,n){void 0===r&&(r=0),void 0===i&&(i=-1),void 0===n&&(n=.5),this.x=e,this.y=t,this.angle=r,this.segment=i,this.minzoom=n};var o=function(e,t,i,n,a,o,s){void 0===o&&(o=.5),void 0===s&&(s=r.C_INFINITY),this.anchor=e,this.labelAngle=t,this.glyphAngle=i,this.page=n,this.alternateVerticalGlyph=a,this.minzoom=o,this.maxzoom=s},s=function(e,t,r,i,n,a,o,s,l,u,x,f){this.tl=e,this.tr=t,this.bl=r,this.br=i,this.mosaicRect=n,this.labelAngle=a,this.minAngle=o,this.maxAngle=s,this.anchor=l,this.minzoom=u,this.maxzoom=x,this.page=f};t.PlacedSymbol=s;var l=function(e){this.shapes=e};t.Placement=l;var u=function(){function e(){}return e.prototype.getIconPlacement=function(e,t,i){var o=t.width/t.pixelRatio,u=t.height/t.pixelRatio,x=i.offset[0]-o/2,f=i.offset[1]-u/2,c=t.rect,h=2/t.pixelRatio,d=x-h,y=f-h,p=d+c.width/t.pixelRatio,_=y+c.height/t.pixelRatio,v=new a.Point(d,y),g=new a.Point(p,_),m=new a.Point(d,_),I=new a.Point(p,y),V=i.rotate*r.C_DEG_TO_RAD;if(e.segment>=0&&!(1===i.rotationAlignment)&&(V+=e.angle),0!==V){var B=Math.cos(V),b=Math.sin(V);v.rotate(B,b),g.rotate(B,b),m.rotate(B,b),I.rotate(B,b)}var P=new a.Point(e.x,e.y),w=new s(v,I,m,g,c,0,0,256,P,.5,r.C_INFINITY,0),D=new l([w]);if((!i.allowOverlap||!i.ignorePlacement)&&n.DECLUTTER_TILES){var E=i.size,T=i.padding;D.iconColliders=[{xTile:e.x,yTile:e.y,dxPixels:x*E-T,dyPixels:f*E-T,hard:!i.optional,partIndex:0,width:o*E+2*T,height:u*E+2*T,angle:V,minLod:.5,maxLod:r.C_INFINITY}]}return D},e.prototype.getTextPlacement=function(e,n,u,x){for(var f=new a.Point(e.x,e.y),c=x.rotate*r.C_DEG_TO_RAD,h=0===x.rotationAlignment,d=x.keepUpright,y=x.padding,p=.5,_=h?e.angle:0,v=e.segment>=0&&h,g=x.allowOverlap&&x.ignorePlacement?null:[],m=[],I=!v,V=Number.POSITIVE_INFINITY,B=Number.NEGATIVE_INFINITY,b=V,P=B,w=(v||h)&&d,D=x.size/i.SDF_GLYPH_SIZE,E=!1,T=0,M=n;T<M.length;T++)if((k=M[T]).vertical){E=!0;break}var L,S,C=0,O=0;if(!v&&E){var A=i.TextShaping.getTextBox(n,x.lineHeight*i.SDF_GLYPH_SIZE);switch(x.anchor){case 1:C=A.height/2,O=-A.width/2;break;case 2:C=-A.height/2,O=A.width/2;break;case 3:C=A.height/2,O=A.width/2;break;case 4:C=-A.height/2,O=-A.width/2;break;case 5:C=A.height;break;case 7:O=-A.width;break;case 6:O=A.width;break;case 8:C=-A.height}}C+=x.offset[0]*i.SDF_GLYPH_SIZE,O+=x.offset[1]*i.SDF_GLYPH_SIZE;for(var N=0,z=n;N<z.length;N++){var k,F=(k=z[N]).glyphMosaicItem;if(F&&!F.rect.isEmpty){var R=F.rect,j=F.metrics,G=F.page;if(g&&I){if(void 0!==L&&L!==k.y){var Z=void 0,Y=void 0,U=void 0,H=void 0;E?(Z=-P+C,Y=V+O,U=P-b,H=B-V):(Z=V+C,Y=b+O,U=B-V,H=P-b);var W={xTile:e.x,yTile:e.y,dxPixels:Z*D-y,dyPixels:Y*D-y,hard:!x.optional,partIndex:1,width:U*D+2*y,height:H*D+2*y,angle:c,minLod:.5,maxLod:r.C_INFINITY};g.push(W),b=V=Number.POSITIVE_INFINITY,P=B=Number.NEGATIVE_INFINITY}L=k.y}var Q=[];if(v){var q=(k.x+j.left-4+.5*F.metrics.width)*D*t.TILE_PIXEL_RATIO;if(p=this._placeGlyph(e,p,q,u,e.segment,1,k.vertical,G,Q),d&&(p=this._placeGlyph(e,p,q,u,e.segment,-1,k.vertical,G,Q)),p>=2)break}else Q.push(new o(f,_,_,G,!1)),h&&d&&Q.push(new o(f,_+r.C_PI,_+r.C_PI,G,!1));var K=k.x+j.left,J=k.y-i.SDF_GLYPH_BASELINE-j.top,X=K+j.width,$=J+j.height,ee=void 0,te=void 0,re=void 0,ie=void 0;if(!v&&E)if(k.vertical){var ne=(K+X)/2-j.height/2,ae=(J+$)/2+j.width/2;ee=new a.Point(-ae-4+C,ne-4+O),te=new a.Point(ee.x+R.width,ee.y+R.height),re=new a.Point(ee.x,te.y),ie=new a.Point(te.x,ee.y)}else ee=new a.Point(4-J+C,K-4+O),te=new a.Point(ee.x-R.height,ee.y+R.width),re=new a.Point(te.x,ee.y),ie=new a.Point(ee.x,te.y);else ee=new a.Point(K-4+C,J-4+O),te=new a.Point(ee.x+R.width,ee.y+R.height),re=new a.Point(ee.x,te.y),ie=new a.Point(te.x,ee.y);for(var oe=void 0,se=void 0,le=void 0,ue=void 0,xe=0,fe=Q;xe<fe.length;xe++){var ce=fe[xe],he=void 0,de=void 0,ye=void 0,pe=void 0;ce.alternateVerticalGlyph?(oe||(oe=new a.Point((ne=(K+X)/2+C)-j.height/2-4,(ae=(J+$)/2+O)+j.width/2+4),se=new a.Point(oe.x+R.height,oe.y-R.width),le=new a.Point(se.x,oe.y),ue=new a.Point(oe.x,se.y)),he=oe,de=le,ye=ue,pe=se):(he=ee,de=re,ye=ie,pe=te);var _e=J,ve=$,ge=ce.glyphAngle+c;if(0!==ge){var me=Math.cos(ge),Ie=Math.sin(ge);he=he.clone(),de=de.clone(),ye=ye.clone(),pe=pe.clone(),he.rotate(me,Ie),pe.rotate(me,Ie),de.rotate(me,Ie),ye.rotate(me,Ie)}var Ve=0,Be=256;v&&E?k.vertical?ce.alternateVerticalGlyph?(Ve=32,Be=96):(Ve=224,Be=32):(Ve=224,Be=96):(Ve=192,Be=64),m.push(new s(he,ye,de,pe,R,ce.labelAngle,Ve,Be,ce.anchor,ce.minzoom,ce.maxzoom,ce.page)),!g||w&&!this._legible(ce.labelAngle)||(I?(K<V&&(V=K),_e<b&&(b=_e),X>B&&(B=X),ve>P&&(P=ve)):ce.minzoom<2&&g.push(W={xTile:e.x,yTile:e.y,dxPixels:(K+C)*D-y,dyPixels:(_e+C)*D-y,hard:!x.optional,partIndex:1,width:(X-K)*D+2*y,height:(ve-_e)*D+2*y,angle:ge,minLod:ce.minzoom,maxLod:ce.maxzoom}))}}}if(p>=2)return null;g&&I&&(Z=void 0,U=void 0,H=void 0,E?(Z=-P+C,S=V+O,U=P-b,H=B-V):(Z=V+C,S=b+O,U=B-V,H=P-b),g.push(W={xTile:e.x,yTile:e.y,dxPixels:Z*D-y,dyPixels:S*D-y,hard:!x.optional,partIndex:1,width:U*D+2*y,height:H*D+2*y,angle:c,minLod:.5,maxLod:r.C_INFINITY}));var be=new l(m);return g&&g.length>0&&(be.textColliders=g),be},e.prototype._legible=function(e){var t=r.radToByte(e);return t<65||t>=193},e.prototype._placeGlyph=function(e,t,i,n,s,l,u,x,f){var c=l,h=c<0?r.positiveMod(e.angle+r.C_PI,r.C_2PI):e.angle,d=0;i<0&&(c*=-1,i*=-1,d=r.C_PI),c>0&&++s;var y=new a.Point(e.x,e.y),p=n[s],_=r.C_INFINITY;if(n.length<=s)return _;for(;;){var v=p.x-y.x,g=p.y-y.y,m=Math.sqrt(v*v+g*g),I=Math.max(i/m,t),V=r.positiveMod(Math.atan2(g/m,v/m)+d,r.C_2PI);if(f.push(new o(y,h,V,x,!1,I,_)),u&&f.push(new o(y,h,V,x,!0,I,_)),I<=t)return I;y=p.clone();do{if(n.length<=(s+=c)||s<0)return I;p=n[s]}while(y.isEqual(p));var B=p.x-y.x,b=p.y-y.y,P=Math.sqrt(B*B+b*b);b*=m/P,y.x-=B*=m/P,y.y-=b,_=I}},e}();t.PlacementEngine=u}).apply(null,i))||(e.exports=n)}}]);