!function(){function e(t,n){return(e=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(t,n)}function t(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,a=r(e);if(t){var o=r(this).constructor;i=Reflect.construct(a,arguments,o)}else i=a.apply(this,arguments);return n(this,i)}}function n(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function o(e,t,n,r,i,a,o){try{var u=e[a](o),s=u.value}catch(c){return void n(c)}u.done?t(s):Promise.resolve(s).then(r,i)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function u(e){o(a,r,i,u,s,"next",e)}function s(e){o(a,r,i,u,s,"throw",e)}u(void 0)}))}}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==n)return;var r,i,a=[],o=!0,u=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(s){u=!0,i=s}finally{try{o||null==n.return||n.return()}finally{if(u)throw i}}return a}(e,t)||l(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=l(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){u=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(u)throw a}}}}function l(e,t){if(e){if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[117],{"1kEK":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={convertToGEGeometry:function(e,t){return null==t?null:e.convertJSONToGeometry(t)},exportPoint:function(e,t,n){var r=new i(e.getPointX(t),e.getPointY(t),n),a=e.hasZ(t),o=e.hasM(t);return a&&(r.z=e.getPointZ(t)),o&&(r.m=e.getPointM(t)),r},exportPolygon:function(e,t,n){return new a(e.exportPaths(t),n,e.hasZ(t),e.hasM(t))},exportPolyline:function(e,t,n){return new o(e.exportPaths(t),n,e.hasZ(t),e.hasM(t))},exportMultipoint:function(e,t,n){return new u(e.exportPoints(t),n,e.hasZ(t),e.hasM(t))},exportExtent:function(e,t,n){var r=e.hasZ(t),i=e.hasM(t),a=new s(e.getXMin(t),e.getYMin(t),e.getXMax(t),e.getYMax(t),n);if(r){var o=e.getZExtent(t);a.zmin=o.vmin,a.zmax=o.vmax}if(i){var u=e.getMExtent(t);a.mmin=u.vmin,a.mmax=u.vmax}return a}},i=function e(t,n,r){h(this,e),this.x=t,this.y=n,this.spatialReference=r,this.z=void 0,this.m=void 0},a=function e(t,n,r,i){h(this,e),this.rings=t,this.spatialReference=n,this.hasZ=void 0,this.hasM=void 0,r&&(this.hasZ=r),i&&(this.hasM=i)},o=function e(t,n,r,i){h(this,e),this.paths=t,this.spatialReference=n,this.hasZ=void 0,this.hasM=void 0,r&&(this.hasZ=r),i&&(this.hasM=i)},u=function e(t,n,r,i){h(this,e),this.points=t,this.spatialReference=n,this.hasZ=void 0,this.hasM=void 0,r&&(this.hasZ=r),i&&(this.hasM=i)},s=function e(t,n,r,i,a){h(this,e),this.xmin=t,this.ymin=n,this.xmax=r,this.ymax=i,this.spatialReference=a,this.zmin=void 0,this.zmax=void 0,this.mmin=void 0,this.mmax=void 0}},"2X7Z":function(e,t,n){"use strict";function r(e,t){return e?t?4:3:t?3:2}function i(e,t,n,i,u){if(!t||!t.lengths.length)return null;var s="upperLeft"===(null==u?void 0:u.originPosition)?-1:1;e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0);var l,f=e.coords,h=[],p=n?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],m=t.lengths,d=t.coords,v=r(n,i),y=0,x=c(m);try{for(x.s();!(l=x.n()).done;){var b=l.value,g=a(p,d,y,b,n,i,s);g&&h.push(g),y+=b*v}}catch(I){x.e(I)}finally{x.f()}if(h.sort((function(e,t){var r=s*e[2]-s*t[2];return 0===r&&n&&(r=e[4]-t[4]),r})),h.length){var O=6*h[0][2];f[0]=h[0][0]/O,f[1]=h[0][1]/O,n&&(O=6*h[0][4],f[2]=0!==O?h[0][3]/O:0),(f[0]<p[0]||f[0]>p[1]||f[1]<p[2]||f[1]>p[3]||n&&(f[2]<p[4]||f[2]>p[5]))&&(f.length=0)}if(!f.length){var j=t.lengths[0]?o(d,0,m[0],n,i):null;if(!j)return null;f[0]=j[0],f[1]=j[1],n&&j.length>2&&(f[2]=j[2])}return e}function a(e,t,n,i,a,o){for(var u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,s=r(a,o),c=n,l=n+s,f=0,h=0,p=0,m=0,d=0,v=0,y=i-1;v<y;v++,c+=s,l+=s){var x=t[c],b=t[c+1],g=t[c+2],O=t[l],j=t[l+1],I=t[l+2],w=x*j-O*b;m+=w,f+=(x+O)*w,h+=(b+j)*w,a&&(p+=(g+I)*(w=x*I-O*g),d+=w),x<e[0]&&(e[0]=x),x>e[1]&&(e[1]=x),b<e[2]&&(e[2]=b),b>e[3]&&(e[3]=b),a&&(g<e[4]&&(e[4]=g),g>e[5]&&(e[5]=g))}if(m*u>0&&(m*=-1),d*u>0&&(d*=-1),!m)return null;var k=[f,h,.5*m];return a&&(k[3]=p,k[4]=.5*d),k}function o(e,t,n,i,a){for(var o=r(i,a),c=t,h=t+o,p=0,m=0,d=0,v=0,y=0,x=n-1;y<x;y++,c+=o,h+=o){var b=e[c],g=e[c+1],O=e[c+2],j=e[h],I=e[h+1],w=e[h+2],k=i?s(b,g,O,j,I,w):u(b,g,j,I);if(k)if(p+=k,i){var S=f(b,g,O,j,I,w);m+=k*S[0],d+=k*S[1],v+=k*S[2]}else{var M=l(b,g,j,I);m+=k*M[0],d+=k*M[1]}}return p>0?i?[m/p,d/p,v/p]:[m/p,d/p]:n>0?i?[e[t],e[t+1],e[t+2]]:[e[t],e[t+1]]:null}function u(e,t,n,r){var i=n-e,a=r-t;return Math.sqrt(i*i+a*a)}function s(e,t,n,r,i,a){var o=r-e,u=i-t,s=a-n;return Math.sqrt(o*o+u*u+s*s)}function l(e,t,n,r){return[e+.5*(n-e),t+.5*(r-t)]}function f(e,t,n,r,i,a){return[e+.5*(r-e),t+.5*(i-t),n+.5*(a-n)]}n.d(t,"a",(function(){return i}))},HsO1:function(e,t,n){"use strict";n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return g})),n.d(t,"c",(function(){return j}));var r=n("f4Nx"),i=n("l4ZG"),o=n("gYg2"),l=n("1kEK"),f=[0,0];function p(e,t){if(!t)return null;if("x"in t){var n,r={x:0,y:0};return n=s(e(t.x,t.y,f),2),r.x=n[0],r.y=n[1],null!=t.z&&(r.z=t.z),null!=t.m&&(r.m=t.m),r}if("xmin"in t){var i,a,o={xmin:0,ymin:0,xmax:0,ymax:0};return i=s(e(t.xmin,t.ymin,f),2),o.xmin=i[0],o.ymin=i[1],a=s(e(t.xmax,t.ymax,f),2),o.xmax=a[0],o.ymax=a[1],t.hasZ&&(o.zmin=t.zmin,o.zmax=t.zmax,o.hasZ=!0),t.hasM&&(o.mmin=t.mmin,o.mmax=t.mmax,o.hasM=!0),o}return"rings"in t?{rings:m(t.rings,e),hasM:t.hasM,hasZ:t.hasZ}:"paths"in t?{paths:m(t.paths,e),hasM:t.hasM,hasZ:t.hasZ}:"points"in t?{points:d(t.points,e),hasM:t.hasM,hasZ:t.hasZ}:void 0}function m(e,t){var n,r=[],i=c(e);try{for(i.s();!(n=i.n()).done;){var a=n.value;r.push(d(a,t))}}catch(o){i.e(o)}finally{i.f()}return r}function d(e,t){var n,r=[],i=c(e);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=t(a[0],a[1],[0,0]);r.push(o),a.length>2&&o.push(a[2]),a.length>3&&o.push(a[3])}}catch(u){i.e(u)}finally{i.f()}return r}function v(e,t){return y.apply(this,arguments)}function y(){return(y=u(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:return r=Array.isArray(t)?t.map((function(e){var t;return null==(t=e.geometry)?void 0:t.spatialReference})):[t],e.next=5,Object(o.f)(r.map((function(e){return{source:e,dest:n}})));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var x=p.bind(null,i.c),b=p.bind(null,i.f);function g(e,t,n){return e?(n||(n=t,t=e.spatialReference),Object(r.i)(t)&&Object(r.i)(n)&&!Object(r.c)(t,n)?Object(i.a)(t,n)?Object(r.m)(n)?x(e):b(e):Object(o.m)(l.a,[e],t,n,null)[0]:e):e}var O=new(function(){function e(){h(this,e),this._jobs=[],this._timer=null,this._process=this._process.bind(this)}var t;return a(e,[{key:"push",value:(t=u(regeneratorRuntime.mark((function e(t,n,i){var a,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!t||!t.length||!n||!i||Object(r.c)(n,i),a={geometries:t,inSpatialReference:n,outSpatialReference:i,resolve:null},e.abrupt("return",(this._jobs.push(a),new Promise((function(e){a.resolve=e,null===o._timer&&(o._timer=setTimeout(o._process,10))}))));case 3:case"end":return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})},{key:"_process",value:function(){this._timer=null;var e=this._jobs.shift();if(e){var t=e.geometries,n=e.inSpatialReference,a=e.outSpatialReference,u=e.resolve;Object(i.a)(n,a)?Object(r.m)(a)?u(t.map(x)):u(t.map(b)):u(Object(o.m)(l.a,t,n,a,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}}}]),e}());function j(e,t,n){return I.apply(this,arguments)}function I(){return(I=u(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",O.push(t,n,r));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},RXWn:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n("f4Nx"),i=n("PNY3"),o=n("KLE9"),u=n("qatw"),l=n("kYAx"),f=n("9w8m");function p(e){if(!e)return null;if("mesh"===e.type)return e.toJSON();var t=null,n=e.spatialReference,a=Object(r.d)(n);if(!a)return e.toJSON();var s,l=n.isWebMercator?102100:4326,h=f.a[l].maxX,p=f.a[l].minX,v=f.a[l].plus180Line,y=f.a[l].minus180Line,x=e.toJSON();if(Object(u.f)(x))s=d(x,h,p);else if(Object(u.e)(x))x.points=x.points.map((function(e){return d(e,h,p)})),s=x;else if(Object(u.d)(x))s=m(x,a);else if(Object(u.g)(x)||Object(u.h)(x)){var O=g;Object(o.a)(O,x);var j={xmin:O[0],ymin:O[1],xmax:O[2],ymax:O[3]},I=Object(f.d)(j.xmin,p)*(2*h),w=0===I?x:function(e,t){var n,r=c(Object(f.b)(e));try{for(r.s();!(n=r.n()).done;){var i,a=c(n.value);try{for(a.s();!(i=a.n()).done;){i.value[0]+=t}}catch(o){a.e(o)}finally{a.f()}}}catch(o){r.e(o)}finally{r.f()}return e}(x,I);j.xmin+=I,j.xmax+=I,Object(i.a)(j,v)&&j.xmax!==h||Object(i.a)(j,y)&&j.xmin!==p?t=w:s=w}else s=e.toJSON();return null!==t?(new b).cut(t,h):s}function m(e,t){if(!t)return e;var n=function(e,t){var n,r=[],i=e.ymin,a=e.ymax,o=e.xmax-e.xmin,u=e.xmin,c=e.xmax,l=s(t.valid,2),f=l[0],h=l[1],p=(n=v(e.xmin,t)).x,m=n.frameId,d=(n=v(e.xmax,t)).x,x=n.frameId,b=p===d&&o>0;if(o>2*h){var g={xmin:u<c?p:d,ymin:i,xmax:h,ymax:a},O={xmin:f,ymin:i,xmax:u<c?d:p,ymax:a},j={xmin:0,ymin:i,xmax:h,ymax:a},I={xmin:f,ymin:i,xmax:0,ymax:a},w=[],k=[];y(g,j)&&w.push(m),y(g,I)&&k.push(m),y(O,j)&&w.push(x),y(O,I)&&k.push(x);for(var S=m+1;S<x;S++)w.push(S),k.push(S);r.push({extent:g,frameIds:[m]},{extent:O,frameIds:[x]},{extent:j,frameIds:w},{extent:I,frameIds:k})}else p>d||b?r.push({extent:{xmin:p,ymin:i,xmax:h,ymax:a},frameIds:[m]},{extent:{xmin:f,ymin:i,xmax:d,ymax:a},frameIds:[x]}):r.push({extent:{xmin:p,ymin:i,xmax:d,ymax:a},frameIds:[m]});return r}(e,t).map((function(e){return e.extent}));return n.length<2?n[0]||e:n.length>2?(e.xmin=t.valid[0],e.xmax=t.valid[1],e):{rings:n.map((function(e){return[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]}))}}function d(e,t,n){if(Array.isArray(e)){var r=e[0];if(r>t){var i=Object(f.d)(r,t);e[0]=r+i*(-2*t)}else if(r<n){var a=Object(f.d)(r,n);e[0]=r+a*(-2*n)}}else{var o=e.x;if(o>t){var u=Object(f.d)(o,t);e.x+=u*(-2*t)}else if(o<n){var s=Object(f.d)(o,n);e.x+=s*(-2*n)}}return e}function v(e,t){var n,r=s(t.valid,2),i=r[0],a=r[1],o=2*a,u=0;return e>a?(e-=(n=Math.ceil(Math.abs(e-a)/o))*o,u=n):e<i&&(e+=(n=Math.ceil(Math.abs(e-i)/o))*o,u=-n),{x:e,frameId:u}}function y(e,t){var n=t.xmin,r=t.ymin,i=t.xmax,a=t.ymax;return x(e,n,r)&&x(e,n,a)&&x(e,i,a)&&x(e,i,r)}function x(e,t,n){return t>=e.xmin&&t<=e.xmax&&n>=e.ymin&&n<=e.ymax}var b=function(){function e(){h(this,e)}return a(e,[{key:"cut",value:function(e,t){var n;if(e.rings)this.closed=!0,n=e.rings,this.minPts=4;else{if(!e.paths)return null;this.closed=!1,n=e.paths,this.minPts=2}for(var r=n.length,i=-2*t,a=0;a<r;a++){var o=n[a];if(o&&o.length>=this.minPts){var u,s=[],l=c(o);try{for(l.s();!(u=l.n()).done;){var f=u.value;s.push([f[0]+i,f[1]])}}catch(h){l.e(h)}finally{l.f()}n.push(s)}}return this.closed?e.rings=n:e.paths=n,e}}]),e}(),g=Object(l.g)()},RjdO:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("X2wA"),i=Object(r.b)((function(e){var t;void 0!==(t=function(){function e(n,r,i,a,o){for(;a>i;){if(a-i>600){var u=a-i+1,s=r-i+1,c=Math.log(u),l=.5*Math.exp(2*c/3),f=.5*Math.sqrt(c*l*(u-l)/u)*(s-u/2<0?-1:1);e(n,r,Math.max(i,Math.floor(r-s*l/u+f)),Math.min(a,Math.floor(r+(u-s)*l/u+f)),o)}var h=n[r],p=i,m=a;for(t(n,i,r),o(n[a],h)>0&&t(n,i,a);p<m;){for(t(n,p,m),p++,m--;o(n[p],h)<0;)p++;for(;o(n[m],h)>0;)m--}0===o(n[i],h)?t(n,i,m):t(n,++m,a),m<=r&&(i=m+1),r<=m&&(a=m-1)}}function t(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function n(e,t){return e<t?-1:e>t?1:0}return function(t,r,i,a,o){e(t,r,i||0,a||t.length-1,o||n)}}())&&(e.exports=t)}))},sjSM:function(n,r,i){"use strict";i.r(r),i.d(r,"GraphicsSnappingSource",(function(){return R}));var o=i("pO5D"),l=(i("wSAH"),i("srIe")),f=(i("6S2I"),i("zqDF"),i("WbKI")),p=i("04ZG"),m=(i("4EHJ"),i("ju1D"),i("9AIY"),i("tQ+6")),d=i("9MzC"),v=i("/CmD"),y=i("SuVq"),x=i("Ehki"),b=i("dOLD"),g=i("gYg2"),O=i("k5I3"),j=i("ZlUD"),I=i("kJYu"),w=i("ZwYu"),k=i("RXWn"),S=i("ZRfE"),M=i("ZBG3"),N=i("Wf2p"),R=function(n){!function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&e(t,n)}(o,n);var r,i=t(o);function o(e){var t;return h(this,o),(t=i.call(this,e)).availability=1,t.sources={multipoint:null,point:null,polygon:null,polyline:null},t.loadedWkids=new Set,t.loadedWkts=new Set,t.pendingAdds=[],t}return a(o,[{key:"updating",get:function(){return this.updatingHandles.updating}},{key:"layer",get:function(){return this.layerSource.layer}},{key:"destroy",value:function(){var e=this,t=this.pendingAdds;this.pendingAdds.length=0;var n,r=c(t);try{for(r.s();!(n=r.n()).done;){n.value.task.abort()}}catch(i){r.e(i)}finally{r.f()}this.mapSources((function(t){return e.destroySource(t)}))}},{key:"initialize",value:function(){var e=this;this.handles.add([this.layer.on("graphic-update",(function(t){return e.onGraphicUpdate(t)})),this.updatingHandles.addOnCollectionChange(this.layer.graphics,(function(t){return e.onGraphicsChanged(t)}))]),this.addMany(this.layer.graphics.toArray())}},{key:"fetchCandidates",value:(r=u(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(d.k)(this.mapSources((function(e){return e.queryEngine.executeQueryForSnapping({point:t.coordinateHelper.toPoint(t.point,new y.a).toJSON(),distance:t.distance,types:t.types,query:Object(l.k)(t.filter)?t.filter.createQuery().toJSON():{where:"1=1"}},n).then((function(e){return e.candidates}))})));case 2:return r=e.sent.flat().map((function(e){return Object(N.a)(e,t.coordinateHelper)})),e.abrupt("return",(Object(w.e)(t.point,r),{candidates:r}));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"refresh",value:function(){}},{key:"onGraphicUpdate",value:function(e){switch(e.property){case"geometry":case"visible":this.remove(e.graphic),this.addMany([e.graphic])}}},{key:"onGraphicsChanged",value:function(e){var t,n=c(e.removed);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.remove(r)}}catch(i){n.e(i)}finally{n.f()}this.addMany(e.added)}},{key:"addMany",value:function(e){var t,n=[],r=new Map,i=c(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;Object(l.j)(a.geometry)||(this.needsInitializeProjection(a.geometry.spatialReference)?(n.push(a.geometry.spatialReference),r.set(a.uid,a)):this.add(a))}}catch(o){i.e(o)}finally{i.f()}this.createPendingAdd(n,r)}},{key:"createPendingAdd",value:function(e,t){var n=this;if(e.length){var r=Object(d.h)(function(){var r=u(regeneratorRuntime.mark((function r(i){var a,o,u,l;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(g.f)(e.map((function(e){return{source:e,dest:n.spatialReference}})),{signal:i});case 2:n.markLoadedSpatialReferences(e),a=c(t);try{for(a.s();!(o=a.n()).done;)u=s(o.value,2),l=u[1],n.add(l)}catch(f){a.e(f)}finally{a.f()}case 5:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}());this.updatingHandles.addPromise(r.promise);var i={task:r,graphics:t},a=function(){return Object(m.j)(n.pendingAdds,i)};r.promise.then(a,a),this.pendingAdds.push(i)}}},{key:"markLoadedSpatialReferences",value:function(e){var t,n=c(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;null!=r.wkid&&this.loadedWkids.add(r.wkid),null!=r.wkt&&this.loadedWkts.add(r.wkt)}}catch(i){n.e(i)}finally{n.f()}}},{key:"add",value:function(e){if(!Object(l.j)(e.geometry)&&e.visible){var t=e.geometry;if("mesh"!==t.type){"extent"===t.type&&(t=x.a.fromExtent(t));var n=this.ensureSource(t.type);if(!Object(l.j)(n)){var r=this.createOptimizedFeature(e.uid,t);Object(l.k)(r)&&n.featureStore.add(r)}}}}},{key:"needsInitializeProjection",value:function(e){return!(null!=e.wkid&&this.loadedWkids.has(e.wkid)||null!=e.wkt&&this.loadedWkts.has(e.wkt)||Object(g.b)(e,this.spatialReference))}},{key:"createOptimizedFeature",value:function(e,t){var n,r,i,a=Object(g.j)(Object(k.a)(t),this.spatialReference);return a?new O.a(Object(j.d)(a,!1,!1),(i=e,(r=P)in(n={})?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,n),null,e):null}},{key:"ensureSource",value:function(e){var t=this.sources[e];if(Object(l.k)(t))return t;var n=this.createSource(e);return this.sources[e]=n,n}},{key:"createSource",value:function(e){var t=b.a.toJSON(e),n=new S.a({geometryType:t,hasZ:!1,hasM:!1});return{featureStore:n,queryEngine:new M.a({featureStore:n,fields:[{name:P,type:"esriFieldTypeOID",alias:P}],geometryType:t,hasM:!1,hasZ:!1,objectIdField:P,spatialReference:this.spatialReference,scheduler:Object(l.k)(this.view)&&"3d"===this.view.type?this.view.resourceController.scheduler:null}),type:e}}},{key:"remove",value:function(e){var t=this;this.mapSources((function(n){return t.removeFromSource(n,e)}));var n,r=c(this.pendingAdds);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.graphics.delete(e.uid),0===i.graphics.size&&i.task.abort()}}catch(a){r.e(a)}finally{r.f()}}},{key:"removeFromSource",value:function(e,t){e.featureStore.has(t.uid)&&e.featureStore.removeById(t.uid)}},{key:"destroySource",value:function(e){e.queryEngine.destroy(),this.sources[e.type]=null}},{key:"mapSources",value:function(e){var t=this.sources,n=t.point,r=t.polygon,i=t.polyline,a=t.multipoint,o=[];return Object(l.k)(n)&&o.push(e(n)),Object(l.k)(r)&&o.push(e(r)),Object(l.k)(i)&&o.push(e(i)),Object(l.k)(a)&&o.push(e(a)),o}}]),o}(Object(I.b)(v.a));Object(o.a)([Object(f.b)({constructOnly:!0})],R.prototype,"spatialReference",void 0),Object(o.a)([Object(f.b)({constructOnly:!0})],R.prototype,"layerSource",void 0),Object(o.a)([Object(f.b)({constructOnly:!0})],R.prototype,"view",void 0),Object(o.a)([Object(f.b)({readOnly:!0})],R.prototype,"updating",null),Object(o.a)([Object(f.b)({readOnly:!0})],R.prototype,"availability",void 0),R=Object(o.a)([Object(p.a)("esri.views.interactive.snapping.featureSources.GraphicsSnappingSource")],R);var P="OBJECTID"}}])}();