(window.webpackJsonp=window.webpackJsonp||[]).push([[161],{YKPD:function(e,t,a){"use strict";a.r(t),a.d(t,"previewSymbol2D",(function(){return p}));var l=a("zlDU"),n=a("nvBr"),s=a("qRWG"),o=a("zdBc"),i=a("IAPW"),c=a("S60b");const u="picture-fill",r=120,m=document.createElement("canvas");function h(e,t){const a=m.getContext("2d"),l=[];return t&&(t.weight&&l.push(t.weight),t.size&&l.push(t.size+"px"),t.family&&l.push(t.family)),a.font=l.join(" "),a.measureText(e).width}function p(e,t){var a,m;const p=null!=(null==t?void 0:t.size)?Object(s.h)(t.size):null,d=null!=(null==t?void 0:t.maxSize)?Object(s.h)(t.maxSize):null,f=null!=(null==t?void 0:t.opacity)?t.opacity:null,v=null!=(null==t?void 0:t.rotation)?t.rotation:"angle"in e?e.angle:null,y=Object(o.b)(e);let b=Object(o.d)(e);if(y&&!b){const e="type"in y?null:new n.a(y);"#ffffff"===(e?e.toHex():null)&&(b={color:"#bdc3c7",width:.75})}const w={shape:null,fill:null,stroke:b,offset:[0,0]};null!=(a=b)&&a.width&&(b.width=Math.min(b.width,80));const g=(null==(m=b)?void 0:m.width)||0;let M=null!=p&&(null==(null==t?void 0:t.scale)||(null==t?void 0:t.scale)),k=0,j=0,x=!1;switch(e.type){case"simple-marker":{const t=e.style,a=Math.min(null!=p?p:Object(s.h)(e.size),d||r);switch(k=a,j=a,t){case"circle":w.shape={type:"circle",cx:0,cy:0,r:.5*a},M||(k+=g,j+=g);break;case"cross":w.shape={type:"path",path:[{command:"M",values:[0,.5*j]},{command:"L",values:[k,.5*j]},{command:"M",values:[.5*k,0]},{command:"L",values:[.5*k,j]}]};break;case"diamond":w.shape={type:"path",path:[{command:"M",values:[0,.5*j]},{command:"L",values:[.5*k,0]},{command:"L",values:[k,.5*j]},{command:"L",values:[.5*k,j]},{command:"Z",values:[]}]},M||(k+=g,j+=g);break;case"square":w.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[k,0]},{command:"L",values:[k,j]},{command:"L",values:[0,j]},{command:"Z",values:[]}]},M||(k+=g,j+=g),v&&(x=!0);break;case"triangle":w.shape={type:"path",path:[{command:"M",values:[.5*k,0]},{command:"L",values:[k,j]},{command:"L",values:[0,j]},{command:"Z",values:[]}]},M||(k+=g,j+=g),v&&(x=!0);break;case"x":w.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[k,j]},{command:"M",values:[k,0]},{command:"L",values:[0,j]}]},v&&(x=!0);break;case"path":w.shape={type:"path",path:e.path||""},M||(k+=g,j+=g),v&&(x=!0),M=!0}break}case"simple-line":{const e=Math.min(null!=p?p:g,d||80),t=e>22?2*e:40;b.width=e,k=t,j=e,w.shape={type:"path",path:[{command:"M",values:[0,j]},{command:"L",values:[k,j]}]};break}case u:case"simple-fill":k=Math.min(null!=p?p:22,d||r)+g,j=k,M=!0,w.shape="object"==typeof(null==t?void 0:t.symbolConfig)&&null!=t&&t.symbolConfig.isSquareFill?i.l.squareFill[0]:i.l.fill[0];break;case"picture-marker":{let t=Object(s.h)(e.width),a=Object(s.h)(e.height);const l=Math.max(t,a),n=t/a;t=n<=1?Math.ceil(l*n):l,a=n<=1?l:Math.ceil(l/n),k=Math.min(null!=p?p:t,d||r),j=Math.min(null!=p?p:a,d||r),w.shape={type:"image",x:-Math.round(k/2),y:-Math.round(j/2),width:k,height:j,src:e.url||""},v&&(x=!0);break}case"text":{const t=e,a=t.text||"Aa",l=t.font,n=Math.min(null!=p?p:Object(s.h)(l.size),d||r),o=h(a,{weight:l.weight,size:n,family:l.family}),i=/[\uE600-\uE6FF]/.test(a);k=i?n:o,j=n;let c=.25*function(e){if(0===e.length)return 0;if(e.length>2){const t=Object(s.i)(1),a=parseFloat(e);switch(e.slice(-2)){case"px":return a;case"pt":return a*t;case"in":return 72*a*t;case"pc":return 12*a*t;case"mm":return 2.8346456692913384*a*t;case"cm":return 28.346456692913385*a*t}}return parseFloat(e)}((l?n:0).toString());i&&(c+=5),w.shape={type:"text",text:a,x:0,y:c,align:"middle",decoration:l&&l.decoration,rotated:t.rotated,kerning:t.kerning},w.font=l&&{size:n,style:l.style,decoration:l.decoration,weight:l.weight,family:l.family};break}}if(!w.shape)return Promise.reject(new l.a("symbolPreview: renderPreviewHTML2D","symbol not supported."));const L=y,z=e.color;let O=null;return L&&"pattern"===L.type&&z&&e.type!==u?O=Object(o.c)(L.src,z.toCss(!0)).then(e=>(L.src=e,w.fill=L,w)):(w.fill=y,O=Promise.resolve(w)),O.then(e=>{const a=[[e]];if("object"==typeof(null==t?void 0:t.symbolConfig)&&null!=t&&t.symbolConfig.applyColorModulation){const t=.6*k;a.unshift([{...e,offset:[-t,0],fill:Object(i.a)(y,-.3)}]),a.push([{...e,offset:[t,0],fill:Object(i.a)(y,.3)}]),k+=2*t}return Object(c.a)(a,[k,j],{node:t&&t.node,scale:M,opacity:f,rotation:v,useRotationSize:x})})}}}]);