(function(){(this||window).webpackJsonp.registerAbsMids({"esri/layers/graphics/data/timeSupport":"/61J","arcgis-js-api/layers/graphics/data/timeSupport":"/61J","esri/layers/graphics/data/BoundsStore":"2xGR","esri/layers/graphics/data/AttributesBuilder":"700l","arcgis-js-api/layers/graphics/centroid":"Fzzg","esri/layers/graphics/data/spatialQuerySupport":"V1i6","arcgis-js-api/layers/graphics/data/spatialQuerySupport":"V1i6","arcgis-js-api/layers/graphics/data/attributeSupport":"Ytki","esri/layers/graphics/data/attributeSupport":"Ytki","esri/layers/graphics/data/executeTileQuery":"ZGAQ","arcgis-js-api/core/ItemCache":"ZHL0","esri/core/ItemCache":"ZHL0","arcgis-js-api/layers/graphics/data/QueryEngine":"ZooB","esri/layers/graphics/data/QueryEngine":"ZooB","esri/layers/graphics/data/QueryEngineResult":"d81A","arcgis-js-api/layers/graphics/contains":"gT/q","arcgis-js-api/layers/graphics/data/FeatureStore":"rfv1","esri/layers/graphics/data/FeatureStore":"rfv1","esri/layers/support/PromiseQueue":"tZaU","esri/layers/graphics/data/optimizedFeatureQueryEngineAdapter":"yLD6","arcgis-js-api/layers/graphics/data/optimizedFeatureQueryEngineAdapter":"yLD6","esri/layers/graphics/data/utils":"zDti","arcgis-js-api/layers/graphics/data/utils":"zDti","esri/core/sql/WhereClauseCache":"ztx9"})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{"/61J":function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getTimeExtent=function(e,t){if(!e)return null;var r=t.featureAdapter,i=e.startTimeField,n=e.endTimeField,s=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY;if(i&&n)t.forEach((function(e){var t=r.getAttribute(e,i),a=r.getAttribute(e,n);null==t||isNaN(t)||(s=Math.min(s,t)),null==a||isNaN(a)||(o=Math.max(o,a))}));else{var a=i||n;t.forEach((function(e){var t=r.getAttribute(e,a);null==t||isNaN(t)||(s=Math.min(s,t),o=Math.max(o,t))}))}return{start:s,end:o}},t.getTimeOperator=function(e,t,r){if(!t||!e)return null;var i=e.startTimeField,n=e.endTimeField;if(!i&&!n)return null;var s=t.start,o=t.end;return null==s&&null==o?null:i&&n?function(e,t,r,i,n){if(null!=i&&null!=n&&i===n){var s=i;return function(i){return s>=e.getAttribute(i,t)&&s<=e.getAttribute(i,r)}}return null!=i&&null!=n?function(s){return function(e,t,r,i){return!(r>t||i<e)}(i,n,e.getAttribute(s,t),e.getAttribute(s,r))}:null!=i?function(t){return!(e.getAttribute(t,r)<i)}:null!=n?function(r){return!(e.getAttribute(r,t)>n)}:void 0}(r,i,n,s,o):function(e,t,r,i){return null!=r&&null!=i&&r===i?function(i){return e.getAttribute(i,t)===r}:null!=r&&null!=i?function(n){return e.getAttribute(n,t)>=r&&e.getAttribute(n,t)<=i}:null!=r?function(i){return e.getAttribute(i,t)>=r}:null!=i?function(r){return e.getAttribute(r,t)<=i}:void 0}(r,i||n,s,o)}}).apply(null,i))||(e.exports=n)},"2xGR":function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("H1tY"),r("jEml"),r("2Kdy")],void 0===(n=(function(e,t,r,i){Object.defineProperty(t,"__esModule",{value:!0});var n={minX:0,minY:0,maxX:0,maxY:0},s=function(){function e(){var e=this;this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=i(9,r("csp-restrictions")?function(e){return{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}}:["[0]","[1]","[2]","[3]"]),this._loadIndex=function(){if(e._indexInvalid){var t=new Array(e._idByBounds.size),r=0;e._idByBounds.forEach((function(e,i){t[r++]=i})),e._indexInvalid=!1,e._index.clear(),e._index.load(t)}else e._boundsToLoad.length&&(e._index.load(e._boundsToLoad.filter((function(t){return e._idByBounds.has(t)}))),e._boundsToLoad.length=0)}}return e.prototype.clear=function(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()},e.prototype.delete=function(e){var t=this._boundsById.get(e);this._boundsById.delete(e),t&&(this._idByBounds.delete(t),this._indexInvalid||this._index.remove(t))},e.prototype.forEachInBounds=function(e,t){this._loadIndex();for(var r=0,i=function(e,t){return n.minX=t[0],n.minY=t[1],n.maxX=t[2],n.maxY=t[3],e.search(n)}(this._index,e);r<i.length;r++)t(this._idByBounds.get(i[r]))},e.prototype.get=function(e){return this._boundsById.get(e)},e.prototype.has=function(e){return this._boundsById.has(e)},e.prototype.invalidateIndex=function(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)},e.prototype.set=function(e,t){if(!this._indexInvalid){var r=this._boundsById.get(e);r&&(this._index.remove(r),this._idByBounds.delete(r))}this._boundsById.set(e,t),t&&(this._idByBounds.set(t,e),this._indexInvalid||this._boundsToLoad.push(t))},e}();t.BoundsStore=s}).apply(null,i))||(e.exports=n)},"700l":function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("LxLY"),r("Ytki")],void 0===(n=(function(e,t,r,i){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,r){this._fieldDataCache=new Map,this._returnDistinctMap=new Map,this.returnDistinctValues=e.returnDistinctValues,this.fieldsIndex=r,this.featureAdapter=t;var n=e.outFields;if(n&&-1===n.indexOf("*")){this.outFields=n;for(var s=0,o=0,a=n;o<a.length;o++){var u=a[o],l=i.getExpressionFromFieldName(u),c=this.fieldsIndex.get(l),h=c?null:i.getWhereClause(l,r),d=c?c.name:i.getAliasFromFieldName(u)||"FIELD_EXP_"+s++;this._fieldDataCache.set(u,{alias:d,clause:h})}}}return e.prototype.getAttributes=function(e){var t=this._processAttributesForOutFields(e);return this._processAttributesForDistinctValues(t)},e.prototype.getFieldValue=function(e,t,r){var n=r?r.name:t,s=null;return this._fieldDataCache.has(n)?s=this._fieldDataCache.get(n).clause:r||(s=i.getWhereClause(t,this.fieldsIndex),this._fieldDataCache.set(n,{alias:n,clause:s})),r?this.featureAdapter.getAttribute(e,n):s.calculateValue(e,this.featureAdapter)},e.prototype.validateItem=function(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:i.getWhereClause(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testFeature(e,this.featureAdapter)},e.prototype.validateItems=function(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:i.getWhereClause(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testSet(e,this.featureAdapter)},e.prototype._processAttributesForOutFields=function(e){var t=this.outFields;if(!t||!t.length)return this.featureAdapter.getAttributes(e);for(var r={},i=0,n=t;i<n.length;i++){var s=this._fieldDataCache.get(n[i]),o=s.alias,a=s.clause;r[o]=a?a.calculateValue(e,this.featureAdapter):this.featureAdapter.getAttribute(e,o)}return r},e.prototype._processAttributesForDistinctValues=function(e){if(r.isNone(e)||!this.returnDistinctValues)return e;var t=this.outFields,i=[];if(t)for(var n=0,s=t;n<s.length;n++){var o=this._fieldDataCache.get(s[n]).alias;i.push(e[o])}else for(var o in e)i.push(e[o]);var a=(t||["*"]).join(",")+"="+i.join(","),u=this._returnDistinctMap.get(a)||0;return this._returnDistinctMap.set(a,++u),u>1?null:e},e}();t.default=n}).apply(null,i))||(e.exports=n)},Fzzg:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=(function(e,t){function r(e,t){return e?t?4:3:t?3:2}function i(e,t,i,n,s,o){for(var a=r(s,o),u=i,l=i+a,c=0,h=0,d=0,f=0,p=0,y=0,m=n-1;y<m;y++,u+=a,l+=a){var g=t[u],v=t[u+1],_=t[u+2],I=t[l],b=t[l+1],x=t[l+2],S=g*b-I*v;f+=S,c+=(g+I)*S,h+=(v+b)*S,s&&(d+=(_+x)*(S=g*x-I*_),p+=S),g<e[0]&&(e[0]=g),g>e[1]&&(e[1]=g),v<e[2]&&(e[2]=v),v>e[3]&&(e[3]=v),s&&(_<e[4]&&(e[4]=_),_>e[5]&&(e[5]=_))}if(f>0&&(f*=-1),p>0&&(p*=-1),!f)return null;var F=[c,h,.5*f];return s&&(F[3]=d,F[4]=.5*p),F}function n(e,t,i,n,l){for(var c=r(n,l),h=t,d=t+c,f=0,p=0,y=0,m=0,g=0,v=i-1;g<v;g++,h+=c,d+=c){var _=e[h],I=e[h+1],b=e[h+2],x=e[d],S=e[d+1],F=e[d+2],T=n?o(_,I,b,x,S,F):s(_,I,x,S);if(T)if(f+=T,n)p+=T*(E=u(_,I,b,x,S,F))[0],y+=T*E[1],m+=T*E[2];else{var E;p+=T*(E=a(_,I,x,S))[0],y+=T*E[1]}}return f>0?n?[p/f,y/f,m/f]:[p/f,y/f]:i>0?n?[e[t],e[t+1],e[t+2]]:[e[t],e[t+1]]:null}function s(e,t,r,i){var n=r-e,s=i-t;return Math.sqrt(n*n+s*s)}function o(e,t,r,i,n,s){var o=i-e,a=n-t,u=s-r;return Math.sqrt(o*o+a*a+u*u)}function a(e,t,r,i){return[e+.5*(r-e),t+.5*(i-t)]}function u(e,t,r,i,n,s){return[e+.5*(i-e),t+.5*(n-t),r+.5*(s-r)]}Object.defineProperty(t,"__esModule",{value:!0}),t.getCentroidOptimizedGeometry=function(e,t,s,o){if(!t||!t.lengths.length)return null;e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0);for(var a=e.coords,u=[],l=s?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],c=t.lengths,h=t.coords,d=r(s,o),f=0,p=0,y=c;p<y.length;p++){var m=y[p],g=i(l,h,f,m,s,o);g&&u.push(g),f+=m*d}if(u.sort((function(e,t){var r=e[2]-t[2];return 0===r&&s&&(r=e[4]-t[4]),r})),u.length){var v=6*u[0][2];a[0]=u[0][0]/v,a[1]=u[0][1]/v,s&&(a[2]=0!=(v=6*u[0][4])?u[0][3]/v:0),(a[0]<l[0]||a[0]>l[1]||a[1]<l[2]||a[1]>l[3]||s&&(a[2]<l[4]||a[2]>l[5]))&&(a.length=0)}if(!a.length){var _=t.lengths[0]?n(h,0,c[0],s,o):null;if(!_)return null;a[0]=_[0],a[1]=_[1],s&&_.length>2&&(a[2]=_[2])}return e},t.lineCentroid=n}).apply(null,i))||(e.exports=n)},V1i6:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("Q2wQ"),r("HZ3d"),r("ma1f"),r("qMld"),r("k1EI"),r("Thzy"),r("Lzvl"),r("nrlZ"),r("gT/q"),r("+6sX"),r("Jvs9"),r("Q2Em"),r("zDti")],void 0===(n=(function(e,t,i,n,s,o,a,u,l,c,h,d,f,p,y){function m(){return o.create((function(e){return Promise.resolve().then((function(){var t=[r("21p4")];e.apply(null,t)}).bind(this)).catch(r.oe)}))}Object.defineProperty(t,"__esModule",{value:!0});var g="feature-store:unsupported-query",v={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},_={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},I={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},b={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};t.importGeometryEngine=m,t.getGeodesicBufferOperator=function(){return m().then((function(e){return e.geodesicBuffer}))},t.getSpatialQueryOperator=function(e,t,r){if(l.isPolygon(t)&&"esriGeometryPoint"===r.geometryType&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e)){var i=d.convertFromPolygon(new f.default,t,!1,!1);return o.resolve((function(e){return h.polygonContainsPoint(i,!1,!1,e)}))}if(l.isPolygon(t)&&"esriGeometryMultipoint"===r.geometryType){var n=d.convertFromPolygon(new f.default,t,!1,!1);if("esriSpatialRelContains"===e)return o.resolve((function(e){return h.polygonContainsMultipoint(n,!1,!1,e,r.hasZ,r.hasM)}))}if(l.isExtent(t)&&"esriGeometryPoint"===r.geometryType&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e))return o.resolve((function(e){return a.extentContainsPoint(t,y.getGeometry(r,e))}));if(l.isExtent(t)&&"esriGeometryMultipoint"===r.geometryType&&"esriSpatialRelContains"===e)return o.resolve((function(e){return a.extentContainsMultipoint(t,y.getGeometry(r,e))}));if(l.isExtent(t)&&"esriSpatialRelIntersects"===e){var s=u.getExtentIntersector(r.geometryType);return o.resolve((function(e){return s(t,y.getGeometry(r,e))}))}return m().then((function(i){var n=i[v[e]].bind(null,t);return function(e){return n(y.getGeometry(r,e))}}))},t.checkSpatialQuerySupport=function(e,t,r){return n(this,void 0,void 0,(function(){var n,o;return i(this,(function(i){if(n=e.spatialRel,!(o=e.geometry))return[2];if(!function(e){return!0===_[e]}(n))throw new s(g,"Unsupported query spatial relationship",{query:e});if(!c.isValid(o.spatialReference)||!c.isValid(r))return[2];if(!function(e){return!0===I[l.getJsonType(e)]}(o))throw new s(g,"Unsupported query geometry type",{query:e});if(!function(e){return!0===b[e]}(t))throw new s(g,"Unsupported layer geometry type",{query:e});return e.outSR?[2,p.checkProjectionSupport(e.geometry&&e.geometry.spatialReference,e.outSR)]:[2]}))}))},t.canQueryWithRBush=function(e){if(l.isExtent(e))return!0;if(l.isPolygon(e)){for(var t=0,r=e.rings;t<r.length;t++){var i=r[t];if(5!==i.length)return!1;if(i[0][0]!==i[1][0]||i[0][0]!==i[4][0]||i[2][0]!==i[3][0]||i[0][1]!==i[3][1]||i[0][1]!==i[4][1]||i[1][1]!==i[2][1])return!1}return!0}return!1}}).apply(null,i))||(e.exports=n)},Ytki:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("2Atf"),r("ma1f"),r("9sIV"),r("ztx9")],void 0===(n=(function(e,t,r,i,n,s){function o(e,t){return e?l.get(e,t):null}function a(e,t,r,n){void 0===n&&(n=!0);for(var s=[],l=0,h=t;l<h.length;l++){var d=h[l];if("*"!==d&&!e.has(d))if(n){var f=u(d);try{var p=o(f,e);if(!p)throw new i(c,"invalid SQL expression",{where:f});if(!p.isStandardized)throw new i(c,"expression is not standard",{clause:p});a(e,p.fieldNames,"expression contains missing fields")}catch(e){var y=e&&e.details;if(y&&(y.clause||y.where))throw e;y&&y.missingFields?s.push.apply(s,y.missingFields):s.push(d)}}else s.push(d)}if(s.length)throw new i(c,r,{missingFields:s})}function u(e){return e.split(h)[0]}Object.defineProperty(t,"__esModule",{value:!0});var l=new s.WhereClauseCache(50,500),c="feature-store:unsupported-query",h=" as ",d=n.createSetFromValues(["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong","esriFieldTypeDate"]);t.validateWhere=function(e,t){if(!t)return!0;var r=l.get(t,e);if(!r)throw new i(c,"invalid SQL expression",{where:t});if(!r.isStandardized)throw new i(c,"where clause is not standard",{where:t});return a(e,r.fieldNames,"where clause contains missing fields"),!0},t.validateHaving=function(e,t,r){if(!t)return!0;var n=l.get(t,e);if(!n)throw new i(c,"invalid SQL expression",{having:t});if(!n.isAggregate)throw new i(c,"having does not contain a valid aggregate function",{having:t});if(a(e,n.fieldNames,"having contains missing fields"),!n.getExpressions().every((function(t){var i=t.aggregateType,n=t.field,s=e.has(n)&&e.get(n).name;return r.some((function(t){var r=t.onStatisticField,n=t.statisticType;return(e.has(r)&&e.get(r).name)===s&&n.toLowerCase().trim()===i}))})))throw new i(c,"expressions in having should also exist in outStatistics",{having:t});return!0},t.getWhereClause=o,t.validateFields=a,t.getExpressionFromFieldName=u,t.getAliasFromFieldName=function(e){return e.split(h)[1]},t.hasInvalidFieldType=function(e,t){var r=t.get(e);return!!r&&!d.has(r.type)}}).apply(null,i))||(e.exports=n)},ZGAQ:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("2Atf"),r("Q2wQ"),r("HZ3d"),r("lRq4"),r("+6sX"),r("Jvs9"),r("ZooB"),r("zDti")],void 0===(n=(function(e,t,r,i,n,s,o,a,u,l){function c(e,t,r,i,n){if(!t.has(r.objectId)){var s=l.getCentroid(i,r,n),o=r.attributes;s&&(t.add(r.objectId),e.push(new u.Feature(o,r.localId,null,s)))}}function h(e,t,r,i,n,s,o,a){if(!t.has(r.objectId)){var l=r.attributes,c=i(f(p,r.geometry,n,s,a,o),!1,!1);c&&(t.add(r.objectId),e.push(new u.Feature(l,r.localId,c,null)))}}function d(e,t,r,i,n,s,o,a,c){if(!t.has(r.objectId)){var h=l.getCentroid(i,r,n),d=r.attributes,y=s(f(p,r.geometry,o,a,c,n),!1,!1);y&&h&&(t.add(r.objectId),e.push(new u.Feature(d,r.localId,y,h)))}}function f(e,t,r,i,n,s){if(e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0),!t||!t.coords.length)return null;var a=t.coords,u=t.lengths;if(!u.length)return e.coords[0]=o.quantizeX(s,a[0]),e.coords[1]=o.quantizeY(s,a[1]),e.coords.length=r,e;for(var l,c,h,d,f=0,p=0,y=p,m=0,g=u;m<g.length;m++){var v=g[m];if(!(v<i)){p=y,h=l=o.quantizeX(s,a[f]),d=c=o.quantizeY(s,a[f+1]),e.coords[p]=h,e.coords[p+1]=d;var _=(h=o.quantizeX(s,a[f+=r]))-l,I=(d=o.quantizeY(s,a[f+1]))-c,b=I/_;e.coords[p+=2]=_,e.coords[p+1]=I,l=h,c=d,f+=r;for(var x=2;x<v;x++){if(h=o.quantizeX(s,a[f]),d=o.quantizeY(s,a[f+1]),h!==l||d!==c){var S=h-l,F=d-c,T=F/S;b!==T&&(isFinite(b)||isFinite(T))||!(n||(I>=0&&F>=0||I<=0&&F<=0)&&(_>=0&&S>=0||_<=0&&S<=0))?(_=S,I=F,p+=2):(_+=S,I+=F),e.coords[p]=_,e.coords[p+1]=I,b=T,l=h,c=d}f+=r}var E=(p+2-y)/2;E>=i&&(e.lengths.push(E),y=p+2)}}return e.coords.length>y&&(e.coords.length=y),e.coords.length?e:null}Object.defineProperty(t,"__esModule",{value:!0});var p=new a.default,y={esriGeometryPoint:o.convertToPoint,esriGeometryPolyline:o.convertToPolyline,esriGeometryPolygon:o.convertToPolygon,esriGeometryMultipoint:o.convertToMultipoint};t.executeTileQueryForIds=function(e,t,r){var i=s.pad(t.bounds,r.pixelBuffer*t.resolution,s.create()),n=[];return e.featureStore.forEachInBounds(i,(function(t){return n.push(e.featureAdapter.getObjectId(t))})),n},t.createTileFeatures=function(e,t,r,i,n,s,o,a,u){var l=y[r.geometryType],f=m[r.geometryType],p="esriGeometryPolygon"===r.geometryType&&!a,g=r.hasZ?r.hasM?4:3:r.hasM?3:2;i.forEachInBounds(n,o&&!s?function(i){return c(e,t,i,r,u)}:s&&!o?function(r){return h(e,t,r,l,g,f,u,p)}:function(i){return d(e,t,i,r,u,l,g,f,p)})};var m={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0};t.quantizeOptimizedGeometryForDisplay=f}).apply(null,i))||(e.exports=n)},ZHL0:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("r7jh")],void 0===(n=(function(e,t,r){return function(){function e(e,t){this._storage=new r.MemCacheStorage,this._storage.maxSize=e,t&&this._storage.registerRemoveFunc("",t)}return e.prototype.put=function(e,t){this._storage.put(e,t,1,1)},e.prototype.pop=function(e){return this._storage.pop(e)},e.prototype.get=function(e){return this._storage.get(e)},e.prototype.clear=function(){this._storage.clearAll()},e.prototype.destroy=function(){this._storage.clearAll()},e}()}).apply(null,i))||(e.exports=n)},ZooB:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("2Atf"),r("Q2wQ"),r("HZ3d"),r("ma1f"),r("9sIV"),r("rg9i"),r("qsST"),r("r7jh"),r("qMld"),r("8uEs"),r("WRgd"),r("lRq4"),r("hBh5"),r("Lzvl"),r("nrlZ"),r("Ytki"),r("Q2Em"),r("4/qq"),r("d81A"),r("V1i6"),r("/61J"),r("zDti"),r("I90O"),r("tZaU")],void 0===(n=(function(e,t,r,i,n,s,o,a,u,l,c,h,d,f,p,y,m,g,v,_,I,b,x,S,F,T){Object.defineProperty(t,"__esModule",{value:!0});var E=u.getLogger("esri.layers.graphics.data.QueryEngine");t.Feature=function(e,t,r,i,n){void 0===t&&(t=null),this.attributes=e,this.geometry=r,this.centroid=i,this.filterFlags=n,this.groupId=-1,this.localId=t};var R=new Set,w=new l.MemCacheStorage(2e6),Q=0,G=function(){function e(e){var t=this;this.capabilities={query:_.queryCapabilities},this.geometryType=e.geometryType,this.hasM=e.hasM,this.hasZ=e.hasZ,this.objectIdField=e.objectIdField,this.spatialReference=e.spatialReference,this.definitionExpression=e.definitionExpression,this.cacheSpatialQueries=e.cacheSpatialQueries||!1,this.featureStore=e.featureStore,this._changeHandle=this.featureStore.events.on("changed",(function(){return t.clearCache()})),this.timeInfo=e.timeInfo,this.cacheSpatialQueries&&(this._geometryQueryCache=new l.MemCache(Q+++"$$",w)),this.fieldsIndex=new F(e.fields),e.scheduler&&e.task&&(this._frameQueue=new T.PromiseQueue,this._frameTask=e.scheduler.registerTask(e.task,(function(e){return t._update(e)}),(function(){return t._frameQueue.length>0})))}return e.prototype.destroy=function(){this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._frameQueue.cancelAll(),this._frameQueue=null),this.clearCache(),this._geometryQueryCache&&this._geometryQueryCache.destroy(),this._changeHandle&&(this._changeHandle.remove(),this._changeHandle=null),this.fieldsIndex.destroy()},Object.defineProperty(e.prototype,"featureAdapter",{get:function(){return this.featureStore.featureAdapter},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fullExtent",{get:function(){var e=this.featureStore.fullBounds;return e?{xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:S.cleanFromGeometryEngine(this.spatialReference)}:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timeExtent",{get:function(){return this.timeInfo?this._timeExtent?this._timeExtent:(this._timeExtent=x.getTimeExtent(this.timeInfo,this.featureStore),this._timeExtent):null},enumerable:!0,configurable:!0}),e.prototype.clearCache=function(){this._geometryQueryCache&&this._geometryQueryCache.clear(),this._allItems=null,this._timeExtent=null},e.prototype.executeQuery=function(e,t){return void 0===e&&(e={}),n(this,void 0,void 0,(function(){var t,r,n;return i(this,(function(i){switch(i.label){case 0:t=a.clone(e),i.label=1;case 1:return i.trys.push([1,14,,15]),[4,this._schedule()];case 2:return i.sent(),[4,S.normalizeQuery(t,this.definitionExpression,this.spatialReference)];case 3:return t=i.sent(),[4,this._reschedule()];case 4:return i.sent(),[4,this._checkQuerySupport(t)];case 5:return t=i.sent(),[4,this._reschedule()];case 6:return i.sent(),[4,this._executeGeometryQuery(t)];case 7:return r=i.sent(),[4,this._reschedule()];case 8:return i.sent(),[4,r.executeObjectIdsQuery(t)];case 9:return r=i.sent(),[4,this._reschedule()];case 10:return i.sent(),[4,r.executeTimeQuery(t)];case 11:return r=i.sent(),[4,this._reschedule()];case 12:return i.sent(),[4,r.executeAttributesQuery(t)];case 13:return r=i.sent(),[3,15];case 14:if((n=i.sent())!==S.QUERY_ENGINE_EMPTY_RESULT)throw n;return r=new I.default([],null,this),[3,15];case 15:return[2,r.createQueryResponse(t)]}}))}))},e.prototype.executeQueryForCount=function(e,t){return void 0===e&&(e={}),n(this,void 0,void 0,(function(){var t,r,n;return i(this,(function(i){switch(i.label){case 0:(t=a.clone(e)).returnGeometry=!1,t.returnCentroid=!1,t.outSR=null,i.label=1;case 1:return i.trys.push([1,14,,15]),[4,this._schedule()];case 2:return i.sent(),[4,S.normalizeQuery(t,this.definitionExpression,this.spatialReference)];case 3:return t=i.sent(),[4,this._reschedule()];case 4:return i.sent(),[4,this._checkQuerySupport(t)];case 5:return t=i.sent(),[4,this._reschedule()];case 6:return i.sent(),[4,this._executeGeometryQuery(t)];case 7:return r=i.sent(),[4,this._reschedule()];case 8:return i.sent(),[4,r.executeObjectIdsQuery(t)];case 9:return r=i.sent(),[4,this._reschedule()];case 10:return i.sent(),[4,r.executeTimeQuery(t)];case 11:return r=i.sent(),[4,this._reschedule()];case 12:return i.sent(),[4,r.executeAttributesQuery(t)];case 13:return[2,(r=i.sent()).size];case 14:if((n=i.sent())!==S.QUERY_ENGINE_EMPTY_RESULT)throw n;return[2,0];case 15:return[2]}}))}))},e.prototype.executeQueryForExtent=function(e,t){return void 0===e&&(e={}),n(this,void 0,void 0,(function(){var t,r,n,s,o,u,l,c;return i(this,(function(i){switch(i.label){case 0:t=a.clone(e),n=t.outSR,i.label=1;case 1:return i.trys.push([1,14,,15]),[4,this._schedule()];case 2:return i.sent(),[4,S.normalizeQuery(t,this.definitionExpression,this.spatialReference)];case 3:return t=i.sent(),[4,this._reschedule()];case 4:return i.sent(),[4,this._checkQuerySupport(t)];case 5:return(t=i.sent()).returnGeometry=!0,t.returnCentroid=!1,t.outSR=null,[4,this._reschedule()];case 6:return i.sent(),[4,this._executeGeometryQuery(t)];case 7:return r=i.sent(),[4,this._reschedule()];case 8:return i.sent(),[4,r.executeObjectIdsQuery(t)];case 9:return r=i.sent(),[4,this._reschedule()];case 10:return i.sent(),[4,r.executeTimeQuery(t)];case 11:return r=i.sent(),[4,this._reschedule()];case 12:return i.sent(),[4,r.executeAttributesQuery(t)];case 13:return r=i.sent(),(s=r.size)?(d.set(N,d.NEGATIVE_INFINITY),this.featureStore.forEachBounds(r.items,(function(e){return d.expand(N,e)}),M),o={xmin:N[0],ymin:N[1],xmax:N[3],ymax:N[4],spatialReference:S.cleanFromGeometryEngine(this.spatialReference)},this.hasZ&&isFinite(N[2])&&isFinite(N[5])&&(o.zmin=N[2],o.zmax=N[5]),(u=v.project(o,r.spatialReference,n)).spatialReference=S.cleanFromGeometryEngine(n||this.spatialReference),u.xmax-u.xmin==0&&(l=h.getMetersPerUnitForSR(u.spatialReference),u.xmin-=l,u.xmax+=l),u.ymax-u.ymin==0&&(l=h.getMetersPerUnitForSR(u.spatialReference),u.ymin-=l,u.ymax+=l),this.hasZ&&null!=u.zmin&&null!=u.zmax&&u.zmax-u.zmin==0&&(l=h.getMetersPerUnitForSR(u.spatialReference),u.zmin-=l,u.zmax+=l),[2,{count:s,extent:u}]):[2,{count:s,extent:null}];case 14:if((c=i.sent())===S.QUERY_ENGINE_EMPTY_RESULT)return[2,{count:0,extent:null}];throw c;case 15:return[2]}}))}))},e.prototype.executeQueryForIds=function(e,t){return void 0===e&&(e={}),n(this,void 0,void 0,(function(){return i(this,(function(r){return[2,this.executeQueryForIdSet(e,t).then((function(e){return o.valuesOfSet(e)}))]}))}))},e.prototype.executeQueryForIdSet=function(e,t){return void 0===e&&(e={}),n(this,void 0,void 0,(function(){var t,r,n,s,o,u,l;return i(this,(function(i){switch(i.label){case 0:(t=a.clone(e)).returnGeometry=!1,t.returnCentroid=!1,t.outSR=null,i.label=1;case 1:return i.trys.push([1,13,,14]),[4,this._schedule()];case 2:return i.sent(),[4,S.normalizeQuery(t,this.definitionExpression,this.spatialReference)];case 3:return t=i.sent(),[4,this._reschedule()];case 4:return i.sent(),[4,this._executeGeometryQuery(t)];case 5:return r=i.sent(),[4,this._reschedule()];case 6:return i.sent(),[4,r.executeObjectIdsQuery(t)];case 7:return r=i.sent(),[4,this._reschedule()];case 8:return i.sent(),[4,r.executeTimeQuery(t)];case 9:return r=i.sent(),[4,this._reschedule()];case 10:return i.sent(),[4,r.executeAttributesQuery(t)];case 11:return r=i.sent(),[4,this._reschedule()];case 12:for(i.sent(),n=r.items,s=new Set,o=0,u=n;o<u.length;o++)s.add(r.featureAdapter.getObjectId(u[o]));return[2,s];case 13:if((l=i.sent())===S.QUERY_ENGINE_EMPTY_RESULT)return[2,new Set];throw l;case 14:return[2]}}))}))},e.prototype.executeQueryForLatestObservations=function(e,t){var r=this;return this.timeInfo?this.executeQuery(e,t).then((function(e){return r._filterLatest(e,r.timeInfo)})):void E.error(new s("invalid-query","Unable to make time-based query as the underlying service does include TimeInfo"))},e.prototype._schedule=function(e){return n(this,void 0,void 0,(function(){return i(this,(function(t){return this._frameQueue?[2,this._frameQueue.push(e).then((function(e){return e}))]:[2,e]}))}))},e.prototype._reschedule=function(e){return n(this,void 0,void 0,(function(){return i(this,(function(t){return this._frameQueue?[2,this._frameQueue.unshift(e).then((function(e){return e}))]:[2,e]}))}))},e.prototype._update=function(e){for(this._budget=e;!e.done&&this._frameQueue&&this._frameQueue.process();)e.madeProgress();this._budget=null},e.prototype._filterLatest=function(e,t){for(var i=t.trackIdField,n=t.endTimeField||t.startTimeField,s=new Map,o=[],a=0,u=e.features;a<u.length;a++){var l=u[a],c=l.attributes[i],h=l.attributes[n];(!s.has(c)||s.get(c).attributes[n]<h)&&s.set(c,l)}return s.forEach((function(e){return o.push(e)})),r({},e,{features:o})},e.prototype._getAll=function(){if(!this._allItems){var e=[];this.featureStore.forEach((function(t){return e.push(t)})),this._allItems=new I.default(e,null,this)}return this._allItems},e.prototype._executeGeometryQuery=function(e){return n(this,void 0,void 0,(function(){var t,r,s,o,a,u,l,c,h,d,f,p,y,g,v,_,x,S,F,T,E,R=this;return i(this,(function(w){switch(w.label){case 0:if(t=e.geometry,s=e.spatialRel,o=m.isValid(r=e.outSR)&&!m.equals(this.spatialReference,r),(a=this.cacheSpatialQueries?o?JSON.stringify({geometry:t,spatialRelationship:s,outSpatialReference:r}):JSON.stringify({geometry:t,spatialRelationship:s}):null)&&void 0!==(u=this._geometryQueryCache.get(a)))return[2,u];if(l=function(t){return n(R,void 0,void 0,(function(){var n;return i(this,(function(i){switch(i.label){case 0:return o&&(e.returnGeometry||e.returnCentroid)?[4,t.project(r)]:[3,2];case 1:return n=i.sent(),a&&this._geometryQueryCache.put(a,n,n.size||1),[2,n];case 2:return a&&this._geometryQueryCache.put(a,t,t.size||1),[2,t]}}))}))},!t)return[2,l(this._getAll())];if(c=this.featureAdapter,"esriSpatialRelDisjoint"!==s)return[3,5];if(!(h=this._searchFeatures(this._getQueryBBoxes(t))).length)return[2,l(this._getAll())];for(p=new Set,y=0,g=h;y<g.length;y++)p.add(c.getObjectId(g[y]));return[4,this._reschedule(p)];case 1:return p=w.sent(),v=0,d=new Array(p.size),this.featureStore.forEach((function(e){return d[v++]=e})),f=p,[4,this._reschedule()];case 2:return w.sent(),[4,b.getSpatialQueryOperator(s,t,this)];case 3:return _=w.sent(),x=I.default.bind,[4,this._runSpatialFilter(d,(function(e){return!f.has(c.getObjectId(e))||_(c.getGeometry(e))}))];case 4:return F=new(x.apply(I.default,[void 0,w.sent(),t,this])),[2,l(F)];case 5:return(S=this._searchFeatures(this._getQueryBBoxes(t))).length?this._canExecuteSoloPass(t,e)?[2,l(new I.default(S,t,this))]:[4,b.getSpatialQueryOperator(s,t,this)]:(F=new I.default([],t,this),a&&this._geometryQueryCache.put(a,F,F.size||1),[2,F]);case 6:return T=w.sent(),[4,this._runSpatialFilter(S,(function(e){return T(c.getGeometry(e))}))];case 7:return E=w.sent(),[2,l(new I.default(E,t,this))]}}))}))},e.prototype._runSpatialFilter=function(e,t){return n(this,void 0,void 0,(function(){var r,s,o,a=this;return i(this,(function(u){return t?this._budget?(r=0,s=new Array,o=function(){return n(a,void 0,void 0,(function(){var n;return i(this,(function(i){switch(i.label){case 0:return r<e.length?(t(n=e[r])&&s.push(n),this._budget.done?[4,this._reschedule()]:[3,2]):[3,3];case 1:return i.sent(),[2,o()];case 2:return++r,[3,0];case 3:return[2]}}))}))},[2,this._reschedule().then((function(){return o()})).then((function(){return s}))]):[2,e.filter((function(e){return t(e)}))]:[2,e]}))}))},e.prototype._canExecuteSoloPass=function(e,t){var r=this.geometryType,i=t.spatialRel;return b.canQueryWithRBush(e)&&("esriSpatialRelEnvelopeIntersects"===i||"esriGeometryPoint"===r&&("esriSpatialRelIntersects"===i||"esriSpatialRelContains"===i||"esriSpatialRelWithin"===i))},e.prototype._getQueryBBoxes=function(e){if(b.canQueryWithRBush(e)){if(y.isExtent(e))return[f.fromValues(e.xmin,e.ymin,e.xmax,e.ymax)];if(y.isPolygon(e))return e.rings.map((function(e){return f.fromValues(Math.min(e[0][0],e[2][0]),Math.min(e[0][1],e[2][1]),Math.max(e[0][0],e[2][0]),Math.max(e[0][1],e[2][1]))}))}return[p.getBoundsXY(f.create(),e)]},e.prototype._searchFeatures=function(e){for(var t=0,r=e;t<r.length;t++)this.featureStore.forEachInBounds(r[t],(function(e){R.add(e)}));var i=new Array(R.size),n=0;return R.forEach((function(e){return i[n++]=e})),R.clear(),i},e.prototype._checkQuerySupport=function(e){return n(this,void 0,void 0,(function(){return i(this,(function(t){if(e.distance<0||null!=e.geometryPrecision||e.multipatchOption||e.pixelSize||e.relationParam||e.text)throw new s("feature-store:unsupported-query","Unsupported query options",{query:e});return[2,c.all([this._checkAttributesQuerySupport(e),this._checkStatisticsQuerySupport(e),b.checkSpatialQuerySupport(e,this.geometryType,this.spatialReference),v.checkProjectionSupport(this.spatialReference,e.outSR)]).then((function(){return e}))]}))}))},e.prototype._checkAttributesQuerySupport=function(e){var t=e.outFields,r=e.orderByFields,i=e.returnDistinctValues;if(r&&r.length>0){var n=r.map((function(e){return e.indexOf(" ASC")>-1?e.split(" ASC")[0]:e.indexOf(" DESC")>-1?e.split(" DESC")[0]:e}));g.validateFields(this.fieldsIndex,n,"orderByFields contains missing fields")}if(t&&t.length>0)g.validateFields(this.fieldsIndex,t,"outFields contains missing fields");else if(i)throw new s("feature-store:unsupported-query","outFields should be specified for returnDistinctValues",{query:e});g.validateWhere(this.fieldsIndex,e.where)},e.prototype._checkStatisticsQuerySupport=function(e){return n(this,void 0,void 0,(function(){var t,r,n,o,a,u,l,c,h,d,f;return i(this,(function(i){if(o=(r=e.groupByFieldsForStatistics)&&r.length,a=(t=e.outStatistics)&&t.length,n=e.having){if(!o||!a)throw new s("feature-store:unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:e});g.validateHaving(this.fieldsIndex,n,t)}if(a){if(t.some((function(e){return"exceedslimit"===e.statisticType})))return[2];for(u=t.map((function(e){return e.onStatisticField})),g.validateFields(this.fieldsIndex,u,"onStatisticFields contains missing fields"),o&&g.validateFields(this.fieldsIndex,r,"groupByFieldsForStatistics contains missing fields"),l=0,c=t;l<c.length;l++)if(d=(h=c[l]).onStatisticField,f=h.statisticType,(!o||"count"!==f)&&d&&g.hasInvalidFieldType(d,this.fieldsIndex))throw new s("feature-store:unsupported-query","outStatistics contains non-numeric fields",{definition:h,query:e})}return[2]}))}))},e}();t.default=G;var M=d.create(),N=d.create()}).apply(null,i))||(e.exports=n)},d81A:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("2Atf"),r("Q2wQ"),r("HZ3d"),r("9sIV"),r("LxLY"),r("qMld"),r("u90+"),r("nrlZ"),r("+6sX"),r("700l"),r("Ytki"),r("Q2Em"),r("/61J"),r("zDti")],void 0===(n=(function(e,t,r,i,n,s,o,a,u,l,c,h,d,f,p,y){Object.defineProperty(t,"__esModule",{value:!0});var m=function(){function e(e,t,r){this.items=e,this.queryGeometry=t,this.definitionExpression=r.definitionExpression,this.geometryType=r.geometryType,this.hasM=r.hasM,this.hasZ=r.hasZ,this.objectIdField=r.objectIdField,this.spatialReference=r.spatialReference,this.fieldsIndex=r.fieldsIndex,this.timeInfo=r.timeInfo,this.featureAdapter=r.featureAdapter}return Object.defineProperty(e.prototype,"size",{get:function(){return this.items.length},enumerable:!0,configurable:!0}),e.prototype.createQueryResponse=function(e){var t;return t=e.outStatistics?e.outStatistics.some((function(e){return"exceedslimit"===e.statisticType}))?this._createExceedsLimitQueryResponse(e):this._createStatisticsQueryResponse(e):this._createFeatureQueryResponse(e),e.returnQueryGeometry&&(t.queryGeometry=l.isValid(e.outSR)&&!l.equals(this.queryGeometry.spatialReference,e.outSR)?y.cleanFromGeometryEngine(r({spatialReference:e.outSR},f.project(this.queryGeometry,this.queryGeometry.spatialReference,e.outSR))):y.cleanFromGeometryEngine(r({spatialReference:e.outSR},this.queryGeometry))),t},e.prototype.executeAttributesQuery=function(t){var r=d.getWhereClause(t.where,this.fieldsIndex);if(!r)return a.resolve(this);if(r.isStandardized){for(var i=0,n=[],s=0,o=this.items;s<o.length;s++){var u=o[s];r.testFeature(u,this.featureAdapter)&&(n[i++]=u)}var l=new e(n,this.queryGeometry,this);return l.definitionExpression=t.where,a.resolve(l)}return a.reject(new TypeError("Where clause is not standardized"))},e.prototype.executeObjectIdsQuery=function(t){if(!t.objectIds||!t.objectIds.length)return a.resolve(this);var r=s.createSetFromValues(t.objectIds),i=this.featureAdapter.getObjectId;return a.resolve(new e(this.items.filter((function(e){return r.has(i(e))})),this.queryGeometry,this))},e.prototype.executeTimeQuery=function(t){var r=p.getTimeOperator(this.timeInfo,t.timeExtent,this.featureAdapter);if(!o.isSome(r))return a.resolve(this);var i=this.items.filter(r);return a.resolve(new e(i,this.queryGeometry,this))},e.prototype.project=function(t){return n(this,void 0,void 0,(function(){var r,n=this;return i(this,(function(i){switch(i.label){case 0:return!t||l.equals(this.spatialReference,t)?[2,this]:(r=this.featureAdapter,[4,f.projectMany(this.items.map((function(e){return y.getGeometry(n,r.getGeometry(e))})),this.spatialReference,t)]);case 1:return[2,new e(i.sent().map((function(e,t){return r.cloneWithGeometry(n.items[t],c.convertFromGeometry(e,n.hasZ,n.hasM))})),this.queryGeometry,{definitionExpression:this.definitionExpression,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:t,fieldsIndex:this.fieldsIndex,timeInfo:this.timeInfo,featureAdapter:this.featureAdapter})]}}))}))},e.prototype._createFeatureQueryResponse=function(e){var t=this,r=this.items,i=this,n=i.geometryType,s=i.hasM,o=i.hasZ,a=i.objectIdField,l=i.spatialReference,c=e.outFields,h=e.outSR,d=e.quantizationParameters,f=e.resultRecordCount,p=e.resultOffset,m=e.returnZ,g=e.returnM,v=!1;if(null!=f&&null!=p){var _=p+f;v=r.length>_,r=r.slice(p,Math.min(r.length,_))}return{exceededTransferLimit:v,features:this._createFeatures(e,r),fields:c&&c.map((function(e){return t.fieldsIndex.get(e)})),geometryType:n,hasM:s&&g,hasZ:o&&m,objectIdFieldName:a,spatialReference:y.cleanFromGeometryEngine(h||l),transform:d&&u.toQuantizationTransform(d)||null}},e.prototype._createFeatures=function(e,t){var r=new h.default(e,this.featureAdapter,this.fieldsIndex),i=e.orderByFields,n=e.quantizationParameters,s=e.returnGeometry,o=e.returnCentroid,a=e.maxAllowableOffset,l=e.returnZ,c=e.returnM,d=this.hasZ&&void 0!==l&&l,f=this.hasM&&void 0!==c&&c,p=[],m=0;if(t.length&&i&&i.length){var g=i[0].split(" "),v=g[0],_=this.fieldsIndex.get(v),I="DESC"===g[1];t.sort((function(e,t){var i=r.getFieldValue(e,v,_),n=r.getFieldValue(t,v,_);if("number"==typeof i&&"number"==typeof n)return I?n-i:i-n;if("string"==typeof i&&"string"==typeof n){var s=i.toUpperCase(),o=n.toUpperCase();return(I?s>o:s<o)?-1:(I?s<o:s>o)?1:0}}))}if(s||o){var b=u.toQuantizationTransform(n);if(s&&!o)for(var x=0,S=t;x<S.length;x++)p[m++]={attributes:r.getAttributes(G=S[x]),geometry:y.getGeometry(this,this.featureAdapter.getGeometry(G),a,b,d,f)};else if(!s&&o)for(var F=0,T=t;F<T.length;F++)p[m++]={attributes:r.getAttributes(G=T[F]),centroid:y.transformCentroid(this,this.featureAdapter.getCentroid(G,this),b)};else for(var E=0,R=t;E<R.length;E++)p[m++]={attributes:r.getAttributes(G=R[E]),centroid:y.transformCentroid(this,this.featureAdapter.getCentroid(G,this),b),geometry:y.getGeometry(this,this.featureAdapter.getGeometry(G),a,b,d,f)}}else for(var w=0,Q=t;w<Q.length;w++){var G,M=r.getAttributes(G=Q[w]);M&&(p[m++]={attributes:M})}return p},e.prototype._createExceedsLimitQueryResponse=function(e){for(var t=!1,r=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,s=0,o=e.outStatistics;s<o.length;s++){var a=o[s];if("exceedslimit"===a.statisticType){r=null!=a.maxPointCount?a.maxPointCount:Number.POSITIVE_INFINITY,i=null!=a.maxRecordCount?a.maxRecordCount:Number.POSITIVE_INFINITY,n=null!=a.maxVertexCount?a.maxVertexCount:Number.POSITIVE_INFINITY;break}}if("esriGeometryPoint"===this.geometryType)t=this.items.length>r;else if(this.items.length>i)t=!0;else{var u=this.hasZ?this.hasM?4:3:this.hasM?3:2,l=this.featureAdapter;t=this.items.reduce((function(e,t){var r=l.getGeometry(t);return e+(r&&r.coords.length||0)}),0)/u>n}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(t)}}]}},e.prototype._createStatisticsQueryResponse=function(e){for(var t=new h.default(e,this.featureAdapter,this.fieldsIndex),r=e.outStatistics,i=[],n=[],s=e.groupByFieldsForStatistics,o=e.having,a=s&&s.length,u=a&&s[0],l=this.fieldsIndex.get(u),c=!l,d={},f={},p={},y={attributes:{}},m=0,g=r;m<g.length;m++){var v=g[m],_=v.outStatisticFieldName,I=v.statisticType,b="exceedslimit"!==I?v.onStatisticField:void 0,x=this.fieldsIndex.get(b),S=a&&(b===u||c)&&"count"===I;if(a){d[b]||(d[b]=this._calculateUniqueValues(t,u,l));var F=d[b];for(var T in F){var E=F[T],R=E.count,w=E.data,Q=E.items;if(!o||t.validateItems(Q,o)){var G,M=f[w]||{attributes:{}};G=S?R:this._calculateStatistics(Q,t,b,x)["var"===I?"variance":I],M.attributes[_]=G,M.attributes[c?"EXPR_1":u]=w,f[w]=M}}}else p[b]||(p[b]=this._calculateStatistics(this.items,t,b,x)),y.attributes[_]=p[b]["var"===I?"variance":I];n.push({name:_,alias:_,type:"esriFieldTypeDouble"})}if(a)for(var N in f)i.push(f[N]);else i.push(y);return{fields:n,features:i}},e.prototype._calculateStatistics=function(e,t,r,i){for(var n=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY,o=null,a=null,u=null,l=null,c=[],h=0,d=0;d<e.length;d++)"string"==typeof(m=t.getFieldValue(e[d],r,i))?h++:null==m||isNaN(m)||(o+=m,n=Math.min(n,m),s=Math.max(s,m),c.push(m),h++);if(h){a=o/h;for(var f=0,p=0,y=c;p<y.length;p++){var m=y[p];f+=Math.pow(m-a,2)}l=h>1?f/(h-1):0,u=Math.sqrt(l)}else n=null,s=null;return{avg:a,count:h,max:s,min:n,stddev:u,sum:o,variance:l}},e.prototype._calculateUniqueValues=function(e,t,r){for(var i={},n=0,s=this.items;n<s.length;n++){var o=s[n],a=e.getFieldValue(o,t,r);(null==a||"string"==typeof a&&""===a.trim())&&(a=null),null==i[a]?i[a]={count:1,data:a,items:[o]}:(i[a].count++,i[a].items.push(o))}return i},e}();t.default=m}).apply(null,i))||(e.exports=n)},"gT/q":function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=(function(e,t){function r(e,t){return e?t?4:3:t?3:2}function i(e,t,i,s,o){if(!e)return!1;for(var a=r(t,i),u=e.coords,l=!1,c=0,h=0,d=e.lengths;h<d.length;h++){var f=d[h];l=n(l,u,a,c,f,s,o),c+=f*a}return l}function n(e,t,r,i,n,s,o){for(var a=e,u=i,l=i,c=i+n*r;l<c;l+=r){(u=l+r)===c&&(u=i);var h=t[l],d=t[l+1],f=t[u+1];(d<o&&f>=o||f<o&&d>=o)&&h+(o-d)/(f-d)*(t[u]-h)<s&&(a=!a)}return a}Object.defineProperty(t,"__esModule",{value:!0}),t.polygonContainsPoint=function(e,t,r,n){return i(e,t,r,n.coords[0],n.coords[1])},t.polygonContainsMultipoint=function(e,t,n,s,o,a){var u=r(o,a),l=s.coords,c=s.lengths;if(!c)return!1;for(var h=0,d=0;h<c.length;h++,d+=u)if(!i(e,t,n,l[d],l[d+1]))return!1;return!0},t.polygonContainsCoords=i}).apply(null,i))||(e.exports=n)},rfv1:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("Q2wQ"),r("HZ3d"),r("9opi"),r("qKT0"),r("ma1f"),r("BcWh"),r("qsST"),r("LxLY"),r("WRgd"),r("lRq4"),r("nrlZ"),r("+6sX"),r("2xGR"),r("ZGAQ"),r("yLD6")],void 0===(n=(function(e,t,r,i,n,s,o,a,u,l,c,h,d,f,p,y,m){Object.defineProperty(t,"__esModule",{value:!0});var g=u.getLogger("esri.layers.graphics.data.FeatureStore"),v=function(){function e(e){this.geometryInfo=e,this._boundsStore=new p.BoundsStore,this._featuresById=new Map,this._markedIds=new Set,this.events=new a,this.featureAdapter=m.optimizedFeatureQueryEngineAdapter}return Object.defineProperty(e.prototype,"geometryType",{get:function(){return this.geometryInfo.geometryType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasM",{get:function(){return this.geometryInfo.hasM},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasZ",{get:function(){return this.geometryInfo.hasZ},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numFeatures",{get:function(){return this._featuresById.size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fullBounds",{get:function(){var e=this;if(!this.numFeatures)return null;var t=h.create(h.NEGATIVE_INFINITY);return this._featuresById.forEach((function(r){var i=e._boundsStore.get(r.objectId);i&&(t[0]=Math.min(i[0],t[0]),t[1]=Math.min(i[1],t[1]),t[2]=Math.max(i[2],t[2]),t[3]=Math.max(i[3],t[3]))})),t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"storeStatistics",{get:function(){var e=0;return this._featuresById.forEach((function(t){t.geometry&&t.geometry.coords&&(e+=t.geometry.coords.length)})),{featureCount:this._featuresById.size,vertexCount:e/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}},enumerable:!0,configurable:!0}),e.prototype.add=function(e){this._add(e),this._emitChanged()},e.prototype.addMany=function(e){for(var t=0,r=e;t<r.length;t++)this._add(r[t]);this._emitChanged()},e.prototype.clear=function(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged()},e.prototype.removeById=function(e){var t=this._featuresById.get(e);return t?(this._remove(t),this._emitChanged(),t):null},e.prototype.removeManyById=function(e){this._boundsStore.invalidateIndex();for(var t=0,r=e;t<r.length;t++){var i=this._featuresById.get(r[t]);i&&this._remove(i)}this._emitChanged()},e.prototype.forEachBounds=function(e,t,r){for(var i=0,n=e;i<n.length;i++){var s=this._boundsStore.get(n[i].objectId);s&&t(c.fromRect(r,s))}},e.prototype.getFeature=function(e){return this._featuresById.get(e)},e.prototype.has=function(e){return this._featuresById.has(e)},e.prototype.forEach=function(e){this._featuresById.forEach((function(t){return e(t)}))},e.prototype.forEachInBounds=function(e,t){var r=this;this._boundsStore.forEachInBounds(e,(function(e){t(r._featuresById.get(e))}))},e.prototype.startMarkingUsedFeatures=function(){this._boundsStore.invalidateIndex(),this._markedIds.clear()},e.prototype.sweep=function(){var e=this,t=!1;this._featuresById.forEach((function(r,i){e._markedIds.has(i)||(t=!0,e._remove(r))})),this._markedIds.clear(),t&&this._emitChanged()},e.prototype.executeTileQuery=function(e,t,n){return i(this,void 0,void 0,(function(){var i,s,o,a,u,l,c,f,p,m,g,v,_,I;return r(this,(function(r){return i=n.returnGeometry,s=n.returnCentroid,o=n.returnOutline,a=n.pixelBuffer,u=new Set,l=[],f=h.pad(e.bounds,c=a*e.resolution,h.create()),y.createTileFeatures(l,u,this.geometryInfo,this,f,i,s,o,{originPosition:"upperLeft",scale:[e.resolution,e.resolution],translate:[e.bounds[0],e.bounds[3]]}),("esriGeometryPoint"===this.geometryType||s)&&(p=d.getInfo(t))&&(v=(m=p.valid)[1],f[0]<(g=m[0])&&(_=h.fromValues(v-c,f[1],v,f[3]),y.createTileFeatures(l,u,this.geometryInfo,this,_,i,s,o,{originPosition:"upperLeft",scale:[e.resolution,e.resolution],translate:[v,e.bounds[3]]})),f[2]>v&&(I=h.fromValues(g,f[1],g+c,f[3]),y.createTileFeatures(l,u,this.geometryInfo,this,I,i,s,o,{originPosition:"upperLeft",scale:[e.resolution,e.resolution],translate:[g-v+e.bounds[0],e.bounds[3]]}))),l.sort((function(e,t){return e.localId-t.localId})),[2,{features:l,objectIds:u}]}))}))},e.prototype._emitChanged=function(){this.events.emit("changed",void 0)},e.prototype._add=function(e){if(e){var t=e.objectId;if(null==t)return void g.error(new o("featurestore:invalid-feature","feature id is missing",{feature:e}));var r,i=this._featuresById.get(t);if(this._markedIds.add(t),i?(e.localId=i.localId,r=this._boundsStore.get(t),this._boundsStore.delete(t)):l.isSome(this.onFeatureAdd)&&this.onFeatureAdd(e),!e.geometry||!e.geometry.coords||!e.geometry.coords.length)return this._boundsStore.set(t,null),void this._featuresById.set(t,e);r=f.getBoundsOptimizedGeometry(r||h.create(),e.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),this._boundsStore.set(t,r),this._featuresById.set(t,e)}},e.prototype._remove=function(e){return l.isSome(this.onFeatureRemove)&&this.onFeatureRemove(e),this._markedIds.delete(e.objectId),this._boundsStore.delete(e.objectId),this._featuresById.delete(e.objectId),e},e}();t.default=v}).apply(null,i))||(e.exports=n)},tZaU:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("qMld")],void 0===(n=(function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this._deferreds=[],this._values=[]}return e.prototype.push=function(e){var t=this;return r.create((function(r,i){t._deferreds.push({resolve:r,reject:i}),t._values.push(e)}))},e.prototype.unshift=function(e){var t=this;return r.create((function(r,i){t._deferreds.unshift({resolve:r,reject:i}),t._values.unshift(e)}))},Object.defineProperty(e.prototype,"length",{get:function(){return this._deferreds.length},enumerable:!0,configurable:!0}),e.prototype.process=function(){return 0!==this.length&&(this._deferreds.shift().resolve(this._values.shift()),!0)},e.prototype.cancelAll=function(){for(var e=r.createAbortError(),t=0,i=this._deferreds;t<i.length;t++)i[t].reject(e);this._deferreds.length=0,this._values.length=0},e}();t.PromiseQueue=i}).apply(null,i))||(e.exports=n)},yLD6:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("Fzzg"),r("/COu"),r("Jvs9")],void 0===(n=(function(e,t,r,i,n){Object.defineProperty(t,"__esModule",{value:!0}),t.optimizedFeatureQueryEngineAdapter={getObjectId:function(e){return e.objectId},getAttributes:function(e){return e.attributes},getAttribute:function(e,t){return e.attributes[t]},cloneWithGeometry:function(e,t){return new i.default(t,e.attributes,null,e.objectId)},getGeometry:function(e){return e.geometry},getCentroid:function(e,t){return e.centroid||(e.centroid=r.getCentroidOptimizedGeometry(new n.default,e.geometry,t.hasZ,t.hasM)),e.centroid}},t.default=t.optimizedFeatureQueryEngineAdapter}).apply(null,i))||(e.exports=n)},zDti:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("Q2wQ"),r("HZ3d"),r("ImIS"),r("LxLY"),r("qMld"),r("8uEs"),r("d466"),r("Lzvl"),r("fw2w"),r("nrlZ"),r("Fzzg"),r("+6sX"),r("Jvs9"),r("Q2Em"),r("V1i6")],void 0===(n=(function(e,t,r,i,n,s,o,a,u,l,c,h,d,f,p,y,m){function g(e,t,r,i,n){void 0===i&&(i=e.hasZ),void 0===n&&(n=e.hasM);var s=e.hasZ&&i,o=e.hasM&&n;if(r){var a=f.quantizeOptimizedGeometry(S,t,e.hasZ,e.hasM,"esriGeometryPoint",r,i,n);return f.convertToPoint(a,s,o)}return f.convertToPoint(t,s,o)}function v(e,n,o){return i(this,void 0,void 0,(function(){var i,a,h,d,f,p;return r(this,(function(r){switch(r.label){case 0:return e?(e.where=i=(i=e.where)&&i.trim(),(!i||/^1 *= *1$/.test(i)||n&&n===i)&&(e.where=null),e.geometry?[4,_(e)]:[2,e]):[2,null];case 1:return a=r.sent(),e.distance=0,e.units=null,"esriSpatialRelEnvelopeIntersects"===e.spatialRel&&(h=e.geometry.spatialReference,(a=u.getGeometryExtent(a)).spatialReference=h),e.geometry=a,[4,y.checkProjectionSupport(a.spatialReference,o)];case 2:return r.sent(),[4,c.normalizeCentralMeridian(l.fromJSON(a))];case 3:if(d=r.sent()[0],s.isNone(d))throw t.QUERY_ENGINE_EMPTY_RESULT;return f=d.toJSON(),[4,y.project(f,f.spatialReference,o)];case 4:if(!(p=r.sent()))throw t.QUERY_ENGINE_EMPTY_RESULT;return p.spatialReference=o,e.geometry=p,[2,e]}}))}))}function _(e){return i(this,void 0,void 0,(function(){var t,i,n,s,u,l,c,d,f;return r(this,(function(r){switch(r.label){case 0:return t=e.geometry,n=e.units,null==(i=e.distance)?[2,o.resolve(t)]:(s=t.spatialReference,u=n&&I.fromJSON(n)||a.getUnitString(s),s&&(h.isGeographic(s)||h.isWebMercator(s))?(c=t,[3,3]):[3,1]);case 1:return[4,y.checkProjectionSupport(s,h.WGS84).then((function(){return y.project(t,h.WGS84)}))];case 2:c=r.sent(),r.label=3;case 3:return l=c,[4,m.getGeodesicBufferOperator()];case 4:return d=r.sent(),[2,(f=d(l,i,u))?f.toJSON():null]}}))}))}Object.defineProperty(t,"__esModule",{value:!0});var I=new n.default({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});t.QUERY_ENGINE_EMPTY_RESULT=Object.freeze({});var b=new p.default,x=new p.default,S=new p.default,F={esriGeometryPoint:f.convertToPoint,esriGeometryPolyline:f.convertToPolyline,esriGeometryPolygon:f.convertToPolygon,esriGeometryMultipoint:f.convertToMultipoint};t.transformCentroid=g,t.getCentroid=function(e,t,r){return"esriGeometryPolygon"===e.geometryType&&t&&(t.centroid||t.geometry)?(t.centroid||(t.centroid=d.getCentroidOptimizedGeometry(new p.default,t.geometry,e.hasZ,e.hasM)),g(e,t.centroid,r)):null},t.getGeometry=function(e,t,r,i,n,s){void 0===n&&(n=e.hasZ),void 0===s&&(s=e.hasM);var o=e.hasZ&&n,a=e.hasM&&s,u=t?"coords"in t?t:t.geometry:null;if(!u)return null;if(r){var l=f.generalizeOptimizedGeometry(x,u,e.hasZ,e.hasM,e.geometryType,r,n,s);return i&&(l=f.quantizeOptimizedGeometry(S,l,o,a,e.geometryType,i)),F[e.geometryType](l,o,a)}return i?(l=f.quantizeOptimizedGeometry(S,u,e.hasZ,e.hasM,e.geometryType,i,n,s),F[e.geometryType](l,o,a)):(f.removeZMValues(b,u,e.hasZ,e.hasM,n,s),F[e.geometryType](b,o,a))},t.normalizeQuery=function(e,t,n){return i(this,void 0,void 0,(function(){var i,s,o,a,u;return r(this,(function(r){if(s=e.orderByFields,o=e.groupByFieldsForStatistics,a=e.outStatistics,i=e.outFields)for(u=0;u<i.length;u++)i[u]=i[u].trim();if(s)for(u=0;u<s.length;u++)s[u]=s[u].trim();if(o)for(u=0;u<o.length;u++)o[u]=o[u].trim();if(a)for(u=0;u<a.length;u++)a[u].onStatisticField&&(a[u].onStatisticField=a[u].onStatisticField.trim());return e.geometry&&!e.outSR&&(e.outSR=e.geometry.spatialReference),[2,v(e,t,n)]}))}))},t.normalizeFilter=function(e,t,n){return i(this,void 0,void 0,(function(){return r(this,(function(r){return[2,v(e,t,n)]}))}))},t.normalizeQueryLike=v,t.cleanFromGeometryEngine=function(e){return e&&T in e?JSON.parse(JSON.stringify(e,E)):e};var T="_geVersion",E=function(e,t){return e!==T?t:void 0}}).apply(null,i))||(e.exports=n)},ztx9:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r("ZHL0"),r("1eyA")],void 0===(n=(function(e,t,r,i){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this._cache=new r(e),this._invalidCache=new r(t)}return e.prototype.get=function(e,t){var r=t.uid+":"+e,n=this._cache.get(r);if(n)return n;if(void 0!==this._invalidCache.get(r))return null;try{var s=i.WhereClause.create(e,t);return this._cache.put(r,s),s}catch(e){return this._invalidCache.put(r,null),null}},e}();t.WhereClauseCache=n}).apply(null,i))||(e.exports=n)}}]);