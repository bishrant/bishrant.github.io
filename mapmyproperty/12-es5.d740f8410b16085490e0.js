!function(){var e,t,i,r,n,a,s,o,c,h;function u(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,r)}return i}function l(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?u(Object(i),!0).forEach(function(t){f(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):u(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function f(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var i,r=y(e);if(t){var n=y(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return p(this,i)}}function p(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return g(e,t)}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return s=e.done,e},e:function(e){o=!0,a=e},f:function(){try{s||null==i.return||i.return()}finally{if(o)throw a}}}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}function j(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function w(e,t,i){return t&&O(e.prototype,t),i&&O(e,i),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{FxzD:function(e,t,i){"use strict";var r=i("srIe"),n=i("OKTS"),a=i("qRWG"),s=i("Cy1f"),o=i("5DEt"),c=i("aAs6"),h=i("15Hh"),u=i("r+FG"),l=i("AvGH"),f=i("D8Ta"),d=i("M0lq"),v=i("dXfX"),b=i("IEcw"),p=i("0Kx6"),y=i("EVMh"),_=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;m(this,e),this._viewUp=Object(s.e)(),this._viewForward=Object(s.e)(),this._viewRight=Object(s.e)(),this._ray=p.f.createWrapper(),this._viewport=Object(f.d)(0,0,1,1),this._padding=Object(f.d)(0,0,0,0),this._fov=55/180*Math.PI,this._nearFar=Object(l.e)(1,1e3),this._viewDirty=!0,this._viewMatrix=Object(u.b)(),this._projectionDirty=!0,this._projectionMatrix=Object(u.b)(),this._viewProjectionDirty=!0,this._viewProjectionMatrix=Object(u.b)(),this._viewInverseTransposeMatrixDirty=!0,this._viewInverseTransposeMatrix=Object(u.b)(),this._frustumDirty=!0,this._frustum=p.c.create(),this._fullViewport=Object(f.c)(),this.pixelRatio=1,this.relativeElevation=0,this._eye=Object(r.k)(t)?Object(s.d)(t):Object(s.e)(),this._center=Object(r.k)(i)?Object(s.d)(i):Object(s.e)(),this._up=Object(r.k)(n)?Object(s.d)(n):Object(s.g)(0,0,1)}return w(e,[{key:"eye",get:function(){return this._eye},set:function(e){this._compareAndSetView(e,this._eye)}},{key:"center",get:function(){return this._center},set:function(e){this._compareAndSetView(e,this._center)}},{key:"ray",get:function(){return this._ray.origin=this.eye,this._ray.direction||(this._ray.direction=Object(s.e)()),Object(o.i)(this._ray.direction,this.center,this.eye),this._ray}},{key:"up",get:function(){return this._up},set:function(e){this._compareAndSetView(e,this._up)}},{key:"viewMatrix",get:function(){return this._ensureViewClean(),this._viewMatrix},set:function(e){Object(h.c)(this._viewMatrix,e),this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}},{key:"viewForward",get:function(){return this._ensureViewClean(),this._viewForward}},{key:"viewUp",get:function(){return this._ensureViewClean(),this._viewUp}},{key:"viewRight",get:function(){return this._ensureViewClean(),this._viewRight}},{key:"nearFar",get:function(){return this._nearFar}},{key:"near",get:function(){return this._nearFar[0]},set:function(e){this._nearFar[0]!==e&&(this._nearFar[0]=e,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}},{key:"far",get:function(){return this._nearFar[1]},set:function(e){this._nearFar[1]!==e&&(this._nearFar[1]=e,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}},{key:"viewport",get:function(){return this._viewport},set:function(e){this.x=e[0],this.y=e[1],this.width=e[2],this.height=e[3]}},{key:"x",get:function(){return this._viewport[0]},set:function(e){this._viewport[0]!==(e+=this._padding[3])&&(this._viewport[0]=e,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}},{key:"y",get:function(){return this._viewport[1]},set:function(e){this._viewport[1]!==(e+=this._padding[2])&&(this._viewport[1]=e,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}},{key:"width",get:function(){return this._viewport[2]},set:function(e){this._viewport[2]!==e&&(this._viewport[2]=e,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}},{key:"height",get:function(){return this._viewport[3]},set:function(e){this._viewport[3]!==e&&(this._viewport[3]=e,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}},{key:"fullWidth",get:function(){return this._viewport[2]+this._padding[1]+this._padding[3]},set:function(e){this.width=e-(this._padding[1]+this._padding[3])}},{key:"fullHeight",get:function(){return this._viewport[3]+this._padding[0]+this._padding[2]},set:function(e){this.height=e-(this._padding[0]+this._padding[2])}},{key:"fullViewport",get:function(){return this._fullViewport[0]=this._viewport[0]-this._padding[3],this._fullViewport[1]=this._viewport[1]-this._padding[2],this._fullViewport[2]=this.fullWidth,this._fullViewport[3]=this.fullHeight,this._fullViewport}},{key:"aspect",get:function(){return this.width/this.height}},{key:"padding",get:function(){return this._padding},set:function(e){this._padding[0]===e[0]&&this._padding[1]===e[1]&&this._padding[2]===e[2]&&this._padding[3]===e[3]||(this._viewport[0]+=e[3]-this._padding[3],this._viewport[1]+=e[2]-this._padding[2],this._viewport[2]-=e[1]+e[3]-(this._padding[1]+this._padding[3]),this._viewport[3]-=e[0]+e[2]-(this._padding[0]+this._padding[2]),Object(v.c)(this._padding,e),this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}},{key:"viewProjectionMatrix",get:function(){return this._viewProjectionDirty&&(Object(h.l)(this._viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),this._viewProjectionDirty=!1),this._viewProjectionMatrix}},{key:"projectionMatrix",get:function(){if(this._projectionDirty){var e=this.width,t=this.height,i=this.near*Math.tan(this.fovY/2),r=i*this.aspect;Object(h.h)(this._projectionMatrix,-r*(1+2*this._padding[3]/e),r*(1+2*this._padding[1]/e),-i*(1+2*this._padding[2]/t),i*(1+2*this._padding[0]/t),this.near,this.far),this._projectionDirty=!1}return this._projectionMatrix},set:function(e){Object(h.c)(this._projectionMatrix,e),this._projectionDirty=!1,this._viewProjectionDirty=!0,this._frustumDirty=!0}},{key:"fov",get:function(){return this._fov},set:function(e){this._fov=e,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}},{key:"fovX",get:function(){return Object(y.b)(this._fov,this.width,this.height)},set:function(e){this._fov=Object(y.d)(e,this.width,this.height),this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}},{key:"fovY",get:function(){return Object(y.c)(this._fov,this.width,this.height)},set:function(e){this._fov=Object(y.e)(e,this.width,this.height),this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}},{key:"distance",get:function(){return Object(o.n)(this._center,this._eye)}},{key:"frustum",get:function(){return this._recomputeFrustum(),this._frustum}},{key:"viewInverseTransposeMatrix",get:function(){return(this._viewInverseTransposeMatrixDirty||this._viewDirty)&&(Object(h.a)(this._viewInverseTransposeMatrix,this.viewMatrix),Object(h.b)(this._viewInverseTransposeMatrix,this._viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=!1),this._viewInverseTransposeMatrix}},{key:"depthNDCToWorld",value:function(e){return 2*this.near*this.far/(this.far+this.near-(2*e-1)*(this.far-this.near))}},{key:"perRenderPixelRatio",get:function(){return Math.tan(this.fovX/2)/(this.width/2)}},{key:"perScreenPixelRatio",get:function(){return this.perRenderPixelRatio*this.pixelRatio}},{key:"aboveGround",get:function(){return this.relativeElevation&&this.relativeElevation>=0}},{key:"copyFrom",value:function(e){var t=e;return Object(o.j)(this._eye,t._eye),Object(o.j)(this._center,t._center),Object(o.j)(this._up,t._up),Object(v.c)(this._viewport,t._viewport),Object(v.c)(this._padding,t._padding),Object(d.c)(this._nearFar,t._nearFar),this._fov=t._fov,this.relativeElevation=e.relativeElevation,this._viewDirty=t._viewDirty,this._viewDirty||(Object(h.c)(this._viewMatrix,t._viewMatrix),Object(o.j)(this._viewRight,t._viewRight),Object(o.j)(this._viewUp,t._viewUp),Object(o.j)(this._viewForward,t._viewForward)),t._projectionDirty?this._projectionDirty=!0:(Object(h.c)(this._projectionMatrix,t._projectionMatrix),this._projectionDirty=!1),this._viewProjectionDirty=!0,this._frustumDirty=t._frustumDirty,this._frustumDirty||(p.c.copy(t._frustum,this._frustum),this._frustumDirty=!1),t._viewInverseTransposeMatrixDirty?this._viewInverseTransposeMatrixDirty=!0:(Object(h.c)(this._viewInverseTransposeMatrix,t._viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=!1),Object(v.c)(this._fullViewport,t._fullViewport),this.pixelRatio=e.pixelRatio,this}},{key:"copyViewFrom",value:function(e){this.eye=e.eye,this.center=e.center,this.up=e.up}},{key:"clone",value:function(){return(new e).copyFrom(this)}},{key:"equals",value:function(e){return Object(o.p)(this._eye,e._eye)&&Object(o.p)(this._center,e._center)&&Object(o.p)(this._up,e._up)&&Object(v.g)(this._viewport,e._viewport)&&Object(v.g)(this._padding,e._padding)&&Object(d.k)(this._nearFar,e._nearFar)&&this._fov===e._fov&&this.pixelRatio===e.pixelRatio&&this.relativeElevation===e.relativeElevation}},{key:"almostEquals",value:function(e){if(this.pixelRatio!==e.pixelRatio||Math.abs(e.fov-this._fov)>=.001)return!1;var t=5e-4;Object(o.u)(O,e.eye,e.center),Object(o.u)(k,this._eye,this._center);var i=Object(o.g)(O,k),r=Object(o.x)(O),n=Object(o.x)(k);return i*i>=(1-1e-10)*r*n&&Object(o.y)(e.eye,this._eye)<Math.max(r,n)*t*t&&Object(v.i)(e.padding,this._padding)<.5&&Object(v.i)(e.viewport,this._viewport)<.5}},{key:"markViewDirty",value:function(){this._viewDirty=!0,this._frustumDirty=!0,this._viewProjectionDirty=!0}},{key:"computeRenderPixelSizeAt",value:function(e){return this.computeRenderPixelSizeAtDist(this.viewDirectionDistance(e))}},{key:"computeRenderPixelSizeAtDist",value:function(e){return e*this.perRenderPixelRatio}},{key:"computeScreenPixelSizeAt",value:function(e){return this.computeScreenPixelSizeAtDist(this.viewDirectionDistance(e))}},{key:"viewDirectionDistance",value:function(e){return Math.abs(Object(b.c)(this.viewForward,Object(o.i)(O,e,this._eye)))}},{key:"computeScreenPixelSizeAtDist",value:function(e){return e*this.perScreenPixelRatio}},{key:"computeDistanceFromRadius",value:function(e,t){return e/Math.tan(Math.min(this.fovX,this.fovY)/(2*(t||1)))}},{key:"getScreenCenter",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(a.g)();return e[0]=(this.padding[3]+this.width/2)/this.pixelRatio,e[1]=(this.padding[0]+this.height/2)/this.pixelRatio,e}},{key:"getRenderCenter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5;return e||(e=Object(a.e)()),e[0]=this.padding[3]+this.width*t,e[1]=this.padding[2]+this.height*i,e.length>2&&(e[2]=.5),e}},{key:"setGLViewport",value:function(e){var t=this.viewport,i=this.padding;e.setViewport(t[0]-i[3],t[1]-i[2],t[2]+i[1]+i[3],t[3]+i[0]+i[2])}},{key:"applyProjection",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e!==g&&Object(o.j)(g,e),g[3]=1,i&&(t[2]=-g[2]),Object(v.m)(g,g,this.projectionMatrix),Object(o.d)(g,g,1/Math.abs(g[3]));var r=this.fullViewport;return t[0]=Object(n.i)(0,r[0]+r[2],.5+.5*g[0]),t[1]=Object(n.i)(0,r[1]+r[3],.5+.5*g[1]),i||(t[2]=.5*(g[2]+1)),t}},{key:"projectToScreen",value:function(e,t){return this.projectToRenderScreen(e,S),this.renderToScreen(S,t)}},{key:"projectToRenderScreen",value:function(e,t){if(g[0]=e[0],g[1]=e[1],g[2]=e[2],g[3]=1,Object(v.m)(g,g,this.viewProjectionMatrix),0===g[3])return null;Object(o.d)(g,g,1/Math.abs(g[3]));var i=this.fullViewport;return"x"in t?(t.x=Object(n.i)(0,i[0]+i[2],.5+.5*g[0]),t.y=Object(n.i)(0,i[1]+i[3],.5+.5*g[1])):(t[0]=Object(n.i)(0,i[0]+i[2],.5+.5*g[0]),t[1]=Object(n.i)(0,i[1]+i[3],.5+.5*g[1]),t.length>2&&(t[2]=.5*(g[2]+1))),t}},{key:"unprojectFromScreen",value:function(e,t){return this.unprojectFromRenderScreen(this.screenToRender(e,S),t)}},{key:"unprojectFromRenderScreen",value:function(e,t){if(Object(h.l)(j,this.projectionMatrix,this.viewMatrix),!Object(h.a)(j,j))return null;var i=this.fullViewport;return g[0]=2*(e[0]-i[0])/i[2]-1,g[1]=2*(e[1]-i[1])/i[3]-1,g[2]=2*e[2]-1,g[3]=1,Object(v.m)(g,g,j),0===g[3]?null:(t[0]=g[0]/g[3],t[1]=g[1]/g[3],t[2]=g[2]/g[3],t)}},{key:"constrainWindowSize",value:function(e,t,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,n=e*this.pixelRatio,a=t*this.pixelRatio,s=Math.max(n-i*r/2,0),o=Math.max(this.fullHeight-a-i/2,0),c=-Math.min(n-i*r/2,0),h=-Math.min(this.fullHeight-a-i/2,0);return[s,o,i*r-c- -Math.min(this.fullWidth-n-i*r/2,0),i-h- -Math.min(a-i/2,0)]}},{key:"computeUp",value:function(e){1===e?this.computeUpGlobal():this.computeUpLocal()}},{key:"screenToRender",value:function(e,t){var i=this.fullHeight-e[1]*this.pixelRatio;return t[0]=e[0]*this.pixelRatio,t[1]=i,t}},{key:"renderToScreen",value:function(e,t){var i=(this.fullHeight-e[1])/this.pixelRatio;return t[0]=e[0]/this.pixelRatio,t[1]=i,t}},{key:"computeUpGlobal",value:function(){Object(o.i)(O,this.center,this.eye);var e=Object(o.o)(this.center);e<1?(Object(o.v)(this.up,0,0,1),this.markViewDirty()):Math.abs(Object(o.g)(O,this.center))>.9999*Object(o.o)(O)*e||(Object(o.f)(this.up,O,this.center),Object(o.f)(this.up,this.up,O),Object(o.q)(this.up,this.up),this.markViewDirty())}},{key:"computeUpLocal",value:function(){Object(c.d)(O,this.eye,this.center),Math.abs(O[2])<=.9999&&(Object(o.d)(O,O,O[2]),Object(o.v)(this.up,-O[0],-O[1],1-O[2]),Object(o.q)(this.up,this.up),this.markViewDirty())}},{key:"_compareAndSetView",value:function(e,t){Object(o.p)(e,t)||(Object(o.j)(t,e),this._viewDirty=!0,this._frustumDirty=!0,this._viewProjectionDirty=!0)}},{key:"_recomputeFrustum",value:function(){this._frustumDirty&&(p.c.fromMatrix(this.viewMatrix,this.projectionMatrix,this._frustum),this._frustumDirty=!1)}},{key:"_ensureViewClean",value:function(){this._viewDirty&&(Object(h.k)(this._viewMatrix,this._eye,this._center,this._up),Object(o.v)(this._viewForward,-this._viewMatrix[2],-this._viewMatrix[6],-this._viewMatrix[10]),Object(o.v)(this._viewUp,this._viewMatrix[1],this._viewMatrix[5],this._viewMatrix[9]),Object(o.v)(this._viewRight,this._viewMatrix[0],this._viewMatrix[4],this._viewMatrix[8]),this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0)}}]),e}(),g=Object(f.c)(),j=Object(u.b)(),O=Object(s.e)(),k=Object(s.e)(),S=Object(a.e)();t.a=_},IlJQ:function(t,i,r){"use strict";r.d(i,"a",function(){return n});var n,a=r("OIYi");!function(t){t.builder=function(t,i){t.vertex.uniforms.add("camPos","vec3").add("perScreenPixelRatio","float").add("screenSize","float"),t.vertex.code.add(a.a(e||(e=j(["\n    float computeRenderPixelSizeAt( vec3 pWorld ){\n      vec3 viewForward = - vec3(view[0][2], view[1][2], view[2][2]);\n      float viewDirectionDistance = abs(dot(viewForward, pWorld - camPos));\n      return viewDirectionDistance*perScreenPixelRatio;\n    }\n\n    vec3 screenSizeScaling(vec3 position, vec3 anchor){\n      return position * screenSize * computeRenderPixelSizeAt(anchor) + anchor;\n    }\n  "]))))},t.bindPassUniforms=function(e,t,i){e.setUniform1f("perScreenPixelRatio",i.camera.perScreenPixelRatio),e.setUniform1f("screenSize",t.screenSize)}}(n||(n={}))},TnN0:function(e,t,i){"use strict";i.d(t,"a",function(){return E});var r=i("bJda"),n=i("srIe"),a=i("TDcG"),s=i("SuVq"),o=(i("4GrV"),i("zm0L")),c=i("OKTS"),h=i("qRWG"),u=i("Cy1f"),l=i("5DEt"),f=i("9pTf"),d=i("15Hh"),v=i("kYAx"),b=i("gYg2"),p=i("2uVf"),y=i("r+FG"),g=i("HJJS"),j=i("M0lq"),O=i("DLk3"),k=i("8JEK"),S=i("0Kx6"),x=i("WiJz"),D=i("FxzD"),T=i("08/N"),P=i("dI/Q"),E=function(){function e(t){for(var i in m(this,e),this.idHint=0,this.camera=new D.a,this._elevation={offset:0,override:null},this.collisionType={type:"point"},this.collisionPriority=0,this._renderObjects=[],this.autoScaleRenderObjects=!0,this._available=!0,this._noDisplayCount=0,this._radius=10,this._worldSized=!1,this.focusMultiplier=2,this.touchMultiplier=2.5,this.worldOriented=!1,this._modelTransform=Object(y.b)(),this._worldFrame=null,this._renderLocation=Object(u.e)(),this._renderLocationDirty=!0,this._location=new s.a({x:0,y:0,z:0}),this._elevationAlignedLocation=new s.a,this._elevationAlignedLocationDirty=!0,this.interactive=!0,this.selectable=!1,this.grabbable=!0,this.cursor=null,this._grabbing=!1,this.dragging=!1,this._hovering=!1,this._selected=!1,this._state=0,this._focused=!1,this.events=new o.a.EventEmitter,this._screenLocation={screenPointArray:Object(h.g)(),renderScreenPointArray:Object(h.e)(),pixelSize:0},this._screenLocationDirty=!0,this._applyObjectTransform=null,this._engineResourcesAddedToStage=!1,this._engineResources=null,this._attached=!1,this._engineLayer=null,this._materialIdReferences=null,this._location.spatialReference=t.view.spatialReference,t)this[i]=t[i];this.view.state&&this.view.state.camera&&this.camera.copyFrom(this.view.state.camera)}return w(e,[{key:"destroy",value:function(){this._removeResourcesFromStage(),this._engineResources=null,this.view=null,this.camera=null}},{key:"elevationInfo",get:function(){return this._elevationInfo},set:function(e){this._elevationInfo=e,this._elevationAlignedLocationDirty=!0,this._renderLocationDirty=!0,this._updateEngineObject()}},{key:"renderObjects",get:function(){return this._renderObjects},set:function(e){this._removeResourcesFromStage(),this._engineResources=null,this._renderObjects=e.slice(),this._updateEngineObject()}},{key:"available",get:function(){return this._available},set:function(e){e!==this._available&&(this._available=e,this._updateEngineObject())}},{key:"disableDisplay",value:function(){var e=this;return this._noDisplayCount++,1===this._noDisplayCount&&this._updateEngineObject(),{remove:Object(a.d)(function(){e._noDisplayCount--,0===e._noDisplayCount&&e._updateEngineObject()})}}},{key:"radius",get:function(){return this._radius},set:function(e){e!==this._radius&&(this._radius=e,this._updateEngineObject())}},{key:"worldSized",get:function(){return this._worldSized},set:function(e){e!==this._worldSized&&(this._worldSized=e,this._updateEngineObject())}},{key:"modelTransform",get:function(){return this._modelTransform},set:function(e){R(e)&&(this._screenLocationDirty=!0),Object(d.c)(this._modelTransform,e),this._updateEngineObject()}},{key:"renderLocation",get:function(){return this._renderLocationDirty&&(this._renderLocationDirty=!1,this.view.renderCoordsHelper.toRenderCoords(this.elevationAlignedLocation,this._renderLocation),this.worldOriented?(this._worldFrame||(this._worldFrame=Object(y.b)()),function(e,t,i){switch(e.viewingMode){case"local":return Object(d.i)(i),!0;case"global":var r=Object(f.e)(e.renderCoordsHelper.spatialReference);Object(b.t)(t,0,q,0,r.radius),Object(b.c)(Object(c.d)(q[1]),Object(c.d)(q[0]),i)}}(this.view,this._renderLocation,this._worldFrame)):this._worldFrame&&(this._worldFrame=null)),this._renderLocation},set:function(e){this.view.renderCoordsHelper.fromRenderCoords(e,this._location),this.elevationAlignedLocation=this._location}},{key:"location",get:function(){return this._location},set:function(e){Object(T.a)(e,this._location),this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!0,this._updateEngineObject(),this.events.emit("location-update",{location:this._location})}},{key:"elevationAlignedLocation",get:function(){return this._elevationAlignedLocationDirty?(this._evaluateElevationAlignment(),this._updateElevationAlignedLocation(),this._elevationAlignedLocation):this._elevationAlignedLocation},set:function(e){Object(T.a)(e,this._location),this._evaluateElevationAlignment(),this._location.z-=this._elevation.offset,this._updateElevationAlignedLocation(),this._updateEngineObject(),this.events.emit("location-update",{location:this._location})}},{key:"_updateElevationAlignedLocation",value:function(){this._elevationAlignedLocation.x=this.location.x,this._elevationAlignedLocation.y=this.location.y;var e=Object(n.k)(this._elevation.override)?this._elevation.override:this.location.z||0;this._elevationAlignedLocation.z=e+this._elevation.offset,this._elevationAlignedLocation.spatialReference=this.location.spatialReference,this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!1}},{key:"grabbableForEvent",value:function(){return!0}},{key:"grabbing",get:function(){return this._grabbing},set:function(e){e!==this._grabbing&&(this._grabbing=e,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}},{key:"hovering",get:function(){return this._hovering},set:function(e){e!==this._hovering&&(this._hovering=e,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}},{key:"selected",get:function(){return this._selected},set:function(e){e!==this._selected&&(this._selected=e,this._updateEngineObject(),this.events.emit("select-changed",{action:e?"select":"deselect"}))}},{key:"state",get:function(){return this._state},set:function(e){e!==this._state&&(this._state=e,this._updateEngineObject())}},{key:"updateStateEnabled",value:function(e,t){t?this.state|=e:this.state&=~e}},{key:"_setFocused",value:function(e){e!==this._focused&&(this._focused=e,this.events.emit("focus-changed",{action:!0===e?"focus":"unfocus"}))}},{key:"focused",get:function(){return this._focused}},{key:"screenLocation",get:function(){return this.ensureScreenLocation(),this._screenLocation}},{key:"ensureScreenLocation",value:function(){if(this._screenLocationDirty){var e;if(this._screenLocation.pixelSize=this.camera.computeScreenPixelSizeAt(this.renderLocation),this._screenLocationDirty=!1,R(this._modelTransform)){var t=this._calculateModelTransformOffset(W);e=Object(l.e)(t,t,this.renderLocation)}else e=this.renderLocation;this.camera.projectToRenderScreen(e,this._screenLocation.renderScreenPointArray),this.camera.renderToScreen(this._screenLocation.renderScreenPointArray,this._screenLocation.screenPointArray)}}},{key:"applyObjectTransform",get:function(){return this._applyObjectTransform},set:function(e){this._applyObjectTransform=e,this._screenLocationDirty=!0,this._updateEngineObject()}},{key:"intersectionDistance",value:function(e,t){if(!this.available)return null;var i=Object(h.j)(e,L),a=this._getCollisionRadius(t),s=-1*this.collisionPriority;switch(this.collisionType.type){case"point":if(Object(j.j)(this.screenLocation.screenPointArray,i)<a*a)return this.screenLocation.renderScreenPointArray[2]+s;break;case"line":var o=this.collisionType.paths,c=this._getWorldToScreenObjectScale(),f=this._calculateObjectTransform(c,I),d=a*this.screenLocation.pixelSize,v=S.f.fromScreen(this.camera,i,A);if(Object(n.j)(v))return null;var b,p=_(o);try{for(p.s();!(b=p.n()).done;){var y=b.value;if(0!==y.length)for(var m=Object(l.l)(q,y[0],f),O=1;O<y.length;O++){var w=Object(l.l)(C,y[O],f),x=S.d.closestRayDistance2(S.d.fromPoints(m,w,M),v);if(null!=x&&x<d*d){var D=Object(l.e)(k.d.get(),m,w);Object(l.d)(D,D,.5);var T=Object(h.a)(k.d.get());return this.camera.projectToRenderScreen(D,T),T[2]+s}Object(l.j)(m,w)}}}catch(ye){p.e(ye)}finally{p.f()}break;case"disc":var P,E=this.collisionType.direction,R=null!=(P=this.collisionType.offset)?P:u.b,F=this._getWorldToScreenObjectScale(),W=this._calculateObjectTransform(F,I),H=a*this.screenLocation.pixelSize,B=S.f.fromScreen(this.camera,i,A);if(Object(n.j)(B))return null;var J=Object(g.d)(z,W),K=Object(l.w)(U,E,J),X=Object(l.l)(N,R,W);S.e.fromPositionAndNormal(X,K,V);var Y=G;if(S.e.intersectRay(V,B,Y)&&Object(l.k)(Y,X)<H*H)return this.screenLocation.renderScreenPointArray[2]+s;break;case"ribbon":var Q=this.collisionType,Z=Q.paths,$=Q.direction,ee=this._getWorldToScreenObjectScale(),te=this._calculateObjectTransform(ee,I),ie=a*this.camera.computeScreenPixelSizeAt(this.renderLocation),re=S.f.fromScreen(this.camera,i,A);if(Object(n.j)(re))return null;var ne=Object(g.d)(z,te),ae=Object(l.w)(U,$,ne),se=this._calculateModelTransformPosition(N);S.e.fromPositionAndNormal(se,ae,V);var oe=G;if(!S.e.intersectRay(V,re,oe))break;var ce,he=_(Z);try{for(he.s();!(ce=he.n()).done;){var ue=ce.value;if(0!==ue.length)for(var le=Object(l.l)(q,ue[0],te),fe=1;fe<ue.length;fe++){var de=Object(l.l)(C,ue[fe],te),ve=S.d.distance2(S.d.fromPoints(le,de,M),oe);if(null!=ve&&ve<ie*ie){var be=Object(l.e)(k.d.get(),le,de);Object(l.d)(be,be,.5);var pe=Object(h.a)(k.d.get());return this.camera.projectToRenderScreen(be,pe),pe[2]+s}Object(l.j)(le,de)}}}catch(ye){he.e(ye)}finally{he.f()}break;default:Object(r.a)(this.collisionType)}return null}},{key:"attach",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{manipulator3D:{}};if(this.view._stage){var i=t.manipulator3D;if(Object(n.j)(i.engineLayerId)){var r=new P.a({isPickable:!1});this.view._stage.add(r),i.engineLayerId=r.id,this._engineLayer=r}else null!=(e=this.view._stage)&&e.getObject&&(this._engineLayer=this.view._stage.getObject(i.engineLayerId));i.engineLayerReferences=(i.engineLayerReferences||0)+1,this._materialIdReferences=i.materialIdReferences,Object(n.j)(this._materialIdReferences)&&(this._materialIdReferences=new Map,i.materialIdReferences=this._materialIdReferences),this.camera.copyFrom(this.view.state.camera),this._attached=!0,this._updateEngineObject(),Object(b.b)(this._location.spatialReference,this.view.spatialReference)||(this.location=new s.a({x:0,y:0,z:0,spatialReference:this.view.spatialReference}))}}},{key:"detach",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{manipulator3D:{}},t=e.manipulator3D;t.engineLayerReferences--;var i=0===t.engineLayerReferences;i&&(t.engineLayerId=null),this._removeResourcesFromStage(i),this._engineResources=null,this._engineLayer=null,this._materialIdReferences=null,this._attached=!1}},{key:"onViewChange",value:function(){this.camera.copyFrom(this.view.state.camera),this._screenLocationDirty=!0,this._updateEngineObject()}},{key:"onElevationChange",value:function(e){Object(b.n)(this.location,H,e.spatialReference),Object(v.e)(e.extent,H)&&(this.location=this._location)}},{key:"_evaluateElevationAlignment",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.location;if(Object(n.j)(this.elevationInfo))return!1;var t=null,i=0,r=Object(n.r)(this.elevationInfo.offset,0);switch(this.elevationInfo.mode){case"on-the-ground":t=Object(n.r)(Object(O.a)(this.view.elevationProvider,e,"ground"),0);break;case"relative-to-ground":i=Object(n.r)(Object(O.a)(this.view.elevationProvider,e,"ground"),0)+r;break;case"relative-to-scene":i=Object(n.r)(Object(O.a)(this.view.elevationProvider,e,"scene"),0)+r;break;case"absolute-height":i=r}return(i!==this._elevation.offset||t!==this._elevation.override)&&(this._elevation.offset=i,this._elevation.override=t,!0)}},{key:"_updateEngineObject",value:function(){if(this._attached)if(this.available){var e=this._getWorldToScreenObjectScale(),t=I;if(!0===this.autoScaleRenderObjects){var i=this._getFocusedSize(this._radius,this.focused)*e;this._calculateObjectTransform(i,t)}else this._calculateObjectTransform(e,t);var r,a=this._ensureEngineResources().objectsByState,s=(this.focused?2:1)|(this.selected?8:4),o=this._noDisplayCount>0,c=_(a);try{for(c.s();!(r=c.n()).done;){var h=r.value,u=h.stateMask,l=h.objects;if(o){var f,d=_(l);try{for(d.s();!(f=d.n()).done;){f.value.setVisible(!1)}}catch(m){d.e(m)}finally{d.f()}}else{var v=!(0!=(65520&u))||(this.state&u)==(65520&u);if(0!=(15&u)&&(s&u)!=(15&u)||!v){var b,p=_(l);try{for(p.s();!(b=p.n()).done;){b.value.setVisible(!1)}}catch(m){p.e(m)}finally{p.f()}}else{var y,g=_(l);try{for(g.s();!(y=g.n()).done;){var j=y.value;j.setVisible(!0),j.transformation=t}}catch(m){g.e(m)}finally{g.f()}}}}}catch(m){c.e(m)}finally{c.f()}Object(n.k)(this._engineLayer)&&this._engineLayer.commit()}else this._removeResourcesFromStage()}},{key:"_ensureEngineResources",value:function(){if(Object(n.j)(this._engineResources)){var e=Object(n.q)(this._engineLayer),t=[],i=new Set;this.renderObjects.forEach(function(e){var r=e.material;i.has(r)||(t.push(r),i.add(r))});var r=new Map;this._renderObjects.forEach(function(e){var t=new x.a({castShadow:!1});!function(e,t){var i=t.geometry,r=t.material,n=t.transform;Array.isArray(i)?i.forEach(function(t){return e.addGeometry(t,r,n)}):e.addGeometry(i,r,n)}(t,e);var i=e.stateMask||0,n=r.get(i)||[];n.push(t),r.set(i,n)});var a=[];r.forEach(function(e,t){return a.push({stateMask:t,objects:e})}),this._engineResources={objectsByState:a,layer:e,materials:t}}return this._addResourcesToStage(),this._engineResources}},{key:"_addResourcesToStage",value:function(){var e=this;if(!this._engineResourcesAddedToStage&&!Object(n.j)(this._engineResources)){var t=this._engineResources,i=t.objectsByState,r=t.layer;t.materials.forEach(function(t){var i=Object(n.q)(e._materialIdReferences),r=i.get(t.id)||0;0===r&&e.view._stage.add(t),i.set(t.id,r+1)}),i.forEach(function(t){return t.objects.forEach(function(t){r.add(t),e.view._stage.add(t)})}),this._engineResourcesAddedToStage=!0}}},{key:"_removeResourcesFromStage",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._engineResourcesAddedToStage&&!Object(n.j)(this._engineResources)){var i=this._engineResources,r=i.objectsByState,a=i.layer,s=i.materials;r.forEach(function(t){var i=t.objects;a.removeMany(i),e.view._stage.removeMany(i)}),s.forEach(function(t){var i=Object(n.q)(e._materialIdReferences),r=i.get(t.id);1===r?(e.view._stage.remove(t),i.delete(t.id)):i.set(t.id,r-1)}),t&&this.view._stage.remove(a),this._engineResourcesAddedToStage=!1}}},{key:"_getCollisionRadius",value:function(e){return this._getFocusedSize(this.radius,!0)*("touch"===e?this.touchMultiplier:1)}},{key:"_getFocusedSize",value:function(e,t){return e*(t?this.focusMultiplier:1)}},{key:"_getWorldToScreenObjectScale",value:function(){return this._worldSized?1:this.screenLocation.pixelSize}},{key:"_calculateModelTransformPosition",value:function(e){var t=this._getWorldToScreenObjectScale(),i=this._calculateObjectTransform(t,F);return Object(l.v)(e,i[12],i[13],i[14])}},{key:"_calculateModelTransformOffset",value:function(e){var t=this._calculateModelTransformPosition(e);return Object(l.i)(e,t,this.renderLocation)}},{key:"_calculateObjectTransform",value:function(e,t){return Object(d.d)(t,e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1),this._worldFrame&&Object(d.l)(t,t,this._worldFrame),Object(d.l)(t,t,this._modelTransform),t[12]+=this.renderLocation[0],t[13]+=this.renderLocation[1],t[14]+=this.renderLocation[2],t[15]=1,Object(n.k)(this._applyObjectTransform)&&this._applyObjectTransform(t),t}},{key:"test",get:function(){var e=!1;if(Object(n.k)(this._engineResources))for(var t in this._engineResources.objectsByState){var i,r=_(this._engineResources.objectsByState[t].objects);try{for(r.s();!(i=r.n()).done;){if(i.value.isVisible){e=!0;break}}}catch(a){r.e(a)}finally{r.f()}if(e)break}return{areAnyResourcesVisible:e}}}]),e}();function R(e){return 0!==e[12]||0!==e[13]||0!==e[14]}var L=Object(h.g)(),M=S.d.create(),A=S.f.create(),z=Object(p.a)(),F=Object(y.b)(),I=Object(y.b)(),V=S.e.create(),q=Object(u.e)(),C=Object(u.e)(),G=Object(u.e)(),U=Object(u.e)(),N=Object(u.e)(),W=Object(u.e)(),H=new s.a({x:0,y:0,z:0,spatialReference:null})},"aS/U":function(e,u,l){"use strict";l.d(u,"a",function(){return w}),l.d(u,"b",function(){return O});var f=l("OIYi"),d=l("Tbkp"),v=l("aQrP"),b=l("Q3fD"),p=l("0nJL"),y=l("0Ect"),_=l("69UF"),g=l("xtdb"),m=l("IlJQ");function O(e){var u=new v.a;return u.include(d.a,{linearDepth:!1}),u.include(m.a.builder,{}),u.include(p.a,e),u.fragment.include(b.a),u.vertex.uniforms.add("proj","mat4").add("view","mat4"),u.fragment.uniforms.add("color","vec4"),u.attributes.add("position","vec3"),u.varyings.add("vWorldPosition","vec3"),e.multipassTerrainEnabled&&u.varyings.add("depth","float"),e.screenSizeEnabled&&u.attributes.add("offset","vec3"),e.shadingEnabled&&(u.vertex.uniforms.add("viewNormal","mat4"),u.fragment.uniforms.add("shadedColor","vec4").add("shadingDirection","vec3"),u.attributes.add("normal","vec3"),u.varyings.add("vViewNormal","vec3")),u.vertex.code.add(f.a(t||(t=j(["\n    void main(void) {\n      vWorldPosition = ",";\n  "])),e.screenSizeEnabled?"screenSizeScaling(offset, position)":"position")),e.shadingEnabled&&u.vertex.code.add(f.a(i||(i=j(["\n      vec3 worldNormal = normal;\n      vViewNormal = (viewNormal * vec4(worldNormal, 1)).xyz;\n    "])))),u.vertex.code.add(f.a(r||(r=j(["\n    ","\n    gl_Position = transformPosition(proj, view, vWorldPosition);\n  }\n  "])),e.multipassTerrainEnabled?"depth = (view * vec4(vWorldPosition, 1.0)).z;":"")),e.multipassTerrainEnabled&&(u.fragment.include(y.a),u.include(g.b,e)),u.fragment.code.add(f.a(n||(n=j(["\n    void main() {\n      discardBySlice(vWorldPosition);\n      ","\n    "])),e.multipassTerrainEnabled?"terrainDepthTest(gl_FragCoord, depth);":"")),u.fragment.code.add(e.shadingEnabled?f.a(a||(a=j(["\n      vec3 viewNormalNorm = normalize(vViewNormal);\n      float shadingFactor = 1.0 - clamp(-dot(viewNormalNorm, shadingDirection), 0.0, 1.0);\n      vec4 finalColor = mix(color, shadedColor, shadingFactor);\n    "]))):f.a(s||(s=j(["\n      vec4 finalColor = color;\n    "])))),u.fragment.code.add(f.a(o||(o=j(["\n      if (finalColor.a < ",") {\n        discard;\n      }\n      ","\n\n      ","\n    }\n    "])),f.a.float(_.c),7===e.output?f.a(c||(c=j(["gl_FragColor = vec4(finalColor.a);"]))):"",0===e.output?f.a(h||(h=j(["gl_FragColor = highlightSlice(finalColor, vWorldPosition); ",""])),e.OITEnabled?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""):"")),u}var w=Object.freeze({__proto__:null,build:O})},"dK/y":function(e,t,i){"use strict";i.d(t,"a",function(){return y}),i.d(t,"b",function(){return _}),i.d(t,"c",function(){return v}),i.d(t,"d",function(){return b}),i.d(t,"e",function(){return p}),i.d(t,"f",function(){return g}),i.d(t,"g",function(){return j});var r=i("srIe"),n=i("5DEt"),a=i("15Hh"),s=i("D8Ta"),o=i("8JEK"),c=i("yvcr"),h=i("08/N"),u=i("uljd"),l=i("024p"),f=i("TnN0"),d=i("k2DL");function v(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,i=Object(s.d)(e[0],e[1],e[2],e.length>3?e[3]:1);return new d.a({color:i,transparent:e[3]<1,writeDepth:!0,cullFace:2,renderOccluded:t})}function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,i=Object(s.d)(e[0],e[1],e[2],4===e.length?e[3]:1);return new l.a({color:i,transparent:!0,writeDepth:!0,cullFace:1,renderOccluded:t})}function p(e,t,i){return new f.a({view:e,renderObjects:[{geometry:c.a.createSphereGeometry(1,32,32),material:v(Object(s.d)(t[0],t[1],t[2],null!=i?i:1))}]})}function y(e,t,i,r){var s=Object(n.i)(o.d.get(),e,i),c=_(s,Object(n.f)(o.d.get(),r,s),i,o.a.get());Object(a.a)(c,c);var h=Object(n.l)(o.d.get(),t,c);return Math.atan2(h[1],h[0])}function _(e,t,i,r){var a=Object(n.q)(o.d.get(),e),s=Object(n.q)(o.d.get(),t),c=Object(n.f)(o.d.get(),a,s);return r[0]=a[0],r[1]=a[1],r[2]=a[2],r[3]=0,r[4]=s[0],r[5]=s[1],r[6]=s[2],r[7]=0,r[8]=c[0],r[9]=c[1],r[10]=c[2],r[11]=0,r[12]=i[0],r[13]=i[1],r[14]=i[2],r[15]=1,r}function g(e,t){var i=e.getViewForGraphic(t);return Object(r.k)(i)&&"computeAttachmentOrigin"in i?i.computeAttachmentOrigin(t,e.spatialReference):null}function j(e,t,i){var n=g(e,i);Object(r.k)(n)?t.elevationAlignedLocation=n:function(e,t){if(!Object(r.j)(t)){var i=Object(u.a)(t);Object(r.j)(i)||(e.location=Object(h.b)(i))}}(t,i.geometry)}},k2DL:function(e,t,i){"use strict";i.d(t,"a",function(){return z});var r=i("Cy1f"),n=i("5DEt"),a=i("VeZB"),s=i("QmHG"),o=i("/ADo"),c=i("EVMh"),h=i("1/dN"),u=i("fFEv"),f=i("NbNv"),v=i("WVfK"),p=i("pO5D"),y=i("D8Ta"),_=i("w6Td"),g=i("ypgp"),j=i("2jVe"),O=i("jjdI"),k=i("GJyJ"),S=i("jpeq"),x=i("0nJL"),D=i("dDjh"),T=i("xtdb"),P=i("IlJQ"),E=i("aS/U"),R=function(e){d(i,e);var t=b(i);function i(){return m(this,i),t.apply(this,arguments)}return w(i,[{key:"initializeProgram",value:function(e){var t=i.shader.get(),r=this.configuration,n=t.build({output:r.output,slicePlaneEnabled:r.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,screenSizeEnabled:r.screenSizeEnabled,shadingEnabled:r.shadingEnabled,OITEnabled:0===r.transparencyPassType,multipassTerrainEnabled:r.multipassTerrainEnabled,cullAboveGround:r.cullAboveGround});return new O.a(e.rctx,n.generateSource("vertex"),n.generateSource("fragment"),M)}},{key:"bindPass",value:function(e,t,i){var r=this.configuration,n=r.screenSizeEnabled,a=r.shadingEnabled,s=t.color,o=t.shadingTint,c=t.shadingDirection;S.a.bindProjectionMatrix(this.program,i.camera.projectionMatrix),this.program.setUniform4fv("color",s),i.multipassTerrainEnabled&&(this.program.setUniform2fv("cameraNearFar",i.camera.nearFar),this.program.setUniform2fv("inverseViewport",i.inverseViewport),Object(T.a)(this.program,e,i)),a&&(this.program.setUniform4fv("shadedColor",this.blendColor(A,o,s)),this.program.setUniform3fv("shadingDirection",c),this.program.setUniformMatrix4fv("viewNormal",i.camera.viewInverseTransposeMatrix)),n&&P.a.bindPassUniforms(this.program,t,i)}},{key:"blendColor",value:function(e,t,i){var r=1-t[3],n=t[3]+i[3]*r;return 0===n?(e[3]=n,e):(e[0]=(t[0]*t[3]+i[0]*i[3]*r)/n,e[1]=(t[1]*t[3]+i[1]*i[3]*r)/n,e[2]=(t[2]*t[3]+i[2]*i[3]*r)/n,e[3]=i[3],e)}},{key:"bindDraw",value:function(e){S.a.bindView(this.program,e),S.a.bindCamPosition(this.program,e.origin,e.camera.viewInverseTransposeMatrix),x.a.bindUniformsWithOrigin(this.program,this.configuration,e)}},{key:"setPipelineState",value:function(e){var t=this.configuration,i=3===e,r=2===e;return Object(k.d)({blending:0!==t.output&&7!==t.output||!t.transparent?null:i?D.f:Object(D.a)(e),culling:function(e){return 0!==e&&{face:1===e?1028:1029,mode:2305}}(t.cullFace),depthTest:{func:r?513:t.shadingEnabled?515:513},depthWrite:i?t.writeDepth&&k.c:Object(D.c)(e),colorWrite:k.b,polygonOffset:i||r?null:D.d})}},{key:"initializePipeline",value:function(){return this.setPipelineState(this.configuration.transparencyPassType)}}]),i}(g.a);R.shader=new _.a(E.a,function(){return i.e(181).then(i.bind(null,"yqaz"))});var L=function(e){d(i,e);var t=b(i);function i(){var e;return m(this,i),(e=t.apply(this,arguments)).output=0,e.cullFace=0,e.slicePlaneEnabled=!1,e.transparent=!1,e.writeDepth=!0,e.screenSizeEnabled=!0,e.shadingEnabled=!0,e.transparencyPassType=3,e.multipassTerrainEnabled=!1,e.cullAboveGround=!0,e}return i}(j.a);Object(p.a)([Object(j.b)({count:8})],L.prototype,"output",void 0),Object(p.a)([Object(j.b)({count:3})],L.prototype,"cullFace",void 0),Object(p.a)([Object(j.b)()],L.prototype,"slicePlaneEnabled",void 0),Object(p.a)([Object(j.b)()],L.prototype,"transparent",void 0),Object(p.a)([Object(j.b)()],L.prototype,"writeDepth",void 0),Object(p.a)([Object(j.b)()],L.prototype,"screenSizeEnabled",void 0),Object(p.a)([Object(j.b)()],L.prototype,"shadingEnabled",void 0),Object(p.a)([Object(j.b)({count:4})],L.prototype,"transparencyPassType",void 0),Object(p.a)([Object(j.b)()],L.prototype,"multipassTerrainEnabled",void 0),Object(p.a)([Object(j.b)()],L.prototype,"cullAboveGround",void 0);var M={position:0,normal:1,offset:2},A=Object(y.c)(),z=function(e){d(i,e);var t=b(i);function i(e){var r;return m(this,i),(r=t.call(this,e,I)).supportsEdges=!0,r.techniqueConfig=new L,r._vertexAttributeLocations=M,r}return w(i,[{key:"getTechniqueConfig",value:function(e,t){return this.techniqueConfig.output=e,this.techniqueConfig.cullFace=this.params.cullFace,this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled,this.techniqueConfig.transparent=this.params.transparent,this.techniqueConfig.writeDepth=this.params.writeDepth,this.techniqueConfig.screenSizeEnabled=this.params.screenSizeEnabled,this.techniqueConfig.shadingEnabled=this.params.shadingEnabled,this.techniqueConfig.transparencyPassType=t?t.transparencyPassType:3,this.techniqueConfig.multipassTerrainEnabled=!!t&&t.multipassTerrainEnabled,this.techniqueConfig.cullAboveGround=!t||t.cullAboveGround,this.techniqueConfig}},{key:"getPassParameters",value:function(){return this.params}},{key:"intersect",value:function(e,t,i,r,a,o,c){var h=this;if(this.params.screenSizeEnabled){var l=e.vertexAttributes.get("offset"),f={applyToVertex:function(e,t,i,a){var s=Object(n.v)(q,l.data[3*a+0],l.data[3*a+1],l.data[3*a+2]),o=Object(n.v)(C,e,t,i);return Object(n.d)(s,s,h.params.screenSize*r.camera.computeRenderPixelSizeAt(s)),Object(n.e)(o,o,s),[o[0],o[1],o[2]]},applyToAabb:function(e){var t=Object(s.b)(e,q);return Object(s.p)(e,h.params.screenSize*r.camera.computeRenderPixelSizeAt(t))}};Object(u.e)(e,t,r,a,o,f,c)}else Object(u.e)(e,t,r,a,o,void 0,c)}},{key:"getGLMaterial",value:function(e){return 0===e.output||7===e.output||4===e.output?new F(e):void 0}},{key:"createBufferWriter",value:function(){return new V(this.params.screenSizeEnabled)}}]),i}(f.a),F=function(e){d(i,e);var t=b(i);function i(e){var r;return m(this,i),(r=t.call(this,e)).updateParameters(),r}return w(i,[{key:"updateParameters",value:function(e){this.technique=this.techniqueRep.acquireAndReleaseExisting(R,this.material.getTechniqueConfig(this.output,e),this.technique)}},{key:"beginSlot",value:function(e){if(4===this.output)return 3===e;var t=3;return this.technique.configuration.transparent&&(t=this.technique.configuration.writeDepth?5:8),e===t}},{key:"ensureParameters",value:function(e){this.updateParameters(e)}},{key:"bind",value:function(e,t){e.bindProgram(this.technique.program),this.technique.bindPass(e,this.material.getPassParameters(),t)}}]),i}(h.a),I=l({color:[1,1,1,1],shadingTint:[0,0,0,.25],shadingDirection:Object(n.q)(Object(r.e)(),[.5,-.5,-.5]),transparent:!1,writeDepth:!0,slicePlaneEnabled:!1,cullFace:0,screenSizeEnabled:!1,screenSize:14,shadingEnabled:!0},f.b),V=function(){function e(t){m(this,e),this.screenSizeEnabled=t;var i=Object(o.a)().vec3f("position").vec3f("normal");this.screenSizeEnabled&&i.vec3f("offset"),this.vertexBufferLayout=i}return w(e,[{key:"allocate",value:function(e){return this.vertexBufferLayout.createBuffer(e)}},{key:"elementCount",value:function(e){return e.indices.get("position").length}},{key:"write",value:function(e,t,i,r){if(Object(v.c)(t,this.vertexBufferLayout,e.transformation,e.invTranspTransformation,i,r),this.screenSizeEnabled){if(!t.vertexAttributes.has("offset"))throw new Error("offset vertex attribute required for screenSizeEnabled ShadedColorMaterial");var n=t.vertexAttributes.get("offset"),s=t.indices.get("offset");Object(c.a)(3===n.size);var o=i.getField("offset",a.u);if(!o)throw new Error("unable to acquire view for offset");Object(v.e)(s,n.data,e.invTranspTransformation,o,r)}}}]),e}(),q=Object(r.e)(),C=Object(r.e)()},klA5:function(e,t,i){"use strict";i.d(t,"a",function(){return l}),i("wSAH");var r=i("srIe"),n=i("Cy1f"),a=i("5DEt"),s=i("r+FG"),o=i("0Kx6"),c=i("tiP8"),h=i("qXiY"),u=1e-5,l=function(){function e(t){m(this,e),this.options=new h.a,this.results=new h.c,this.transform=new h.d,this.performanceInfo={queryDuration:0,numObjectsTested:0},this.tolerance=u,this.verticalOffset=null,this._ray={origin:Object(n.e)(),direction:Object(n.e)()},this._rayEndPoint=Object(n.e)(),this._rayStartPointTransformed=Object(n.e)(),this._rayEndPointTransformed=Object(n.e)(),this.viewingMode=null==t?1:t}return w(e,[{key:"ray",get:function(){return this._ray}},{key:"rayBeginPoint",get:function(){return this._ray.origin}},{key:"rayEndPoint",get:function(){return this._rayEndPoint}},{key:"reset",value:function(e,t){this.resetWithRay(o.f.fromPoints(e,t,this._ray))}},{key:"resetWithRay",value:function(e){e!==this._ray&&o.f.copy(e,this._ray),0!==this.options.verticalOffset?2===this.viewingMode?this._ray.origin[2]-=this.options.verticalOffset:this.verticalOffset=this.options.verticalOffset:this.verticalOffset=null,Object(a.e)(this._rayEndPoint,this._ray.origin,this._ray.direction),this._numObjectsTested=0,this.results.init(this._ray)}},{key:"intersect",value:function(e,t,i,n,a,s){var o=this;this.point=t,this.camera=i,this.filterPredicate=a,this.tolerance=null==n?u:n;var c=Object(h.f)(this.verticalOffset),l=s?function(e){s(e)&&o.intersectObject(e)}:function(e){o.intersectObject(e)};if(e&&e.length>0){var f,d=_(e);try{for(d.s();!(f=d.n()).done;){var v=f.value,b=v.getSpatialQueryAccelerator&&v.getSpatialQueryAccelerator();Object(r.k)(b)?(Object(r.k)(c)?b.forEachAlongRayWithVerticalOffset(this._ray.origin,this._ray.direction,l,c):b.forEachAlongRay(this._ray.origin,this._ray.direction,l),this.options.selectionMode&&this.options.hud&&b.forEachDegenerateObject(l)):v.getObjects().forAll(function(e){return l(e)})}}catch(p){d.e(p)}finally{d.f()}}this.sortResults()}},{key:"intersectObject",value:function(e){var t=this;this._numObjectsTested++;var i=e.geometryRecords;if(i){var n,o,u=e.id,l=e.transformation,f=Object(h.f)(this.verticalOffset),d=_(i);try{var v=function(){var i=o.value,d=i.geometry,v=i.material,b=i.instanceParameters;if(Object(c.d)(b))return"continue";n=d.id,t.transform.setAndInvalidateLazyTransforms(l,i.getShaderTransformation()),Object(a.l)(t._rayStartPointTransformed,t._ray.origin,t.transform.inverse),Object(a.l)(t._rayEndPointTransformed,t._rayEndPoint,t.transform.inverse);var p=t.transform.transform;Object(r.k)(f)&&(f.objectTransform=t.transform),v.intersect(d,b,t.transform.transform,t,t._rayStartPointTransformed,t._rayEndPointTransformed,function(i,a,o,c,l,f){if(i>=0){if(Object(r.k)(t.filterPredicate)&&!t.filterPredicate(t._ray.origin,t._rayEndPoint,i))return;var d="Object3D ".concat(u);if(l)return void((null==t.results.hud.dist||i<t.results.hud.dist)&&t.results.hud.set(e,d,i,a,s.a,c,f,n,o));var v=function(t){return t.set(e,d,i,a,p,c,null,n,o)};if((null==t.results.min.drapedLayerOrder||c>=t.results.min.drapedLayerOrder)&&(null==t.results.min.dist||i<t.results.min.dist)&&v(t.results.min),0!==t.options.store&&(null==t.results.max.drapedLayerOrder||c<t.results.max.drapedLayerOrder)&&(null==t.results.max.dist||i>t.results.max.dist)&&v(t.results.max),2===t.options.store){var b=new h.b(t._ray);v(b),t.results.all.push(b)}}},i.shaderTransformation)};for(d.s();!(o=d.n()).done;)v()}catch(b){d.e(b)}finally{d.f()}}}},{key:"sortResults",value:function(){this.results.all.sort(function(e,t){return e.dist!==t.dist?e.dist-t.dist:e.drapedLayerOrder!==t.drapedLayerOrder?(void 0!==e.drapedLayerOrder?e.drapedLayerOrder:Number.MAX_VALUE)-(void 0!==t.drapedLayerOrder?t.drapedLayerOrder:Number.MAX_VALUE):(void 0!==t.drapedLayerGraphicOrder?t.drapedLayerGraphicOrder:Number.MIN_VALUE)-(void 0!==e.drapedLayerGraphicOrder?e.drapedLayerGraphicOrder:Number.MIN_VALUE)})}}]),e}();l.DEFAULT_TOLERANCE=u},qXiY:function(e,t,i){"use strict";i.d(t,"a",function(){return _}),i.d(t,"b",function(){return k}),i.d(t,"c",function(){return O}),i.d(t,"d",function(){return g}),i.d(t,"e",function(){return P}),i.d(t,"f",function(){return T});var r=i("srIe"),n=i("Cy1f"),a=i("5DEt"),s=i("15Hh"),o=i("2uVf"),c=i("r+FG"),h=i("sTkM"),u=i("D8Ta"),l=i("HJJS"),f=i("dXfX"),d=i("BPBZ"),v=i("R/jG"),b=i("+JUG"),p=(i("DZ/s"),i("0Kx6")),y=i("WiJz"),_=function e(){m(this,e),this.verticalOffset=0,this.selectionMode=!1,this.hud=!0,this.selectOpaqueTerrainOnly=!0,this.invisibleTerrain=!1,this.backfacesTerrain=!0,this.isFiltered=!1,this.store=2},g=function(){function e(){m(this,e),this._transform=Object(c.b)(),this._transformInverse=new j({value:this._transform},s.a,c.b),this._transformInverseTranspose=new j(this._transformInverse,s.b,c.b),this._transformTranspose=new j({value:this._transform},s.b,c.b),this._transformInverseRotation=new j({value:this._transform},l.b,o.a)}return w(e,[{key:"invalidateLazyTransforms",value:function(){this._transformInverse.invalidate(),this._transformInverseTranspose.invalidate(),this._transformTranspose.invalidate(),this._transformInverseRotation.invalidate()}},{key:"transform",get:function(){return this._transform}},{key:"inverse",get:function(){return this._transformInverse.value}},{key:"inverseTranspose",get:function(){return this._transformInverseTranspose.value}},{key:"inverseRotation",get:function(){return this._transformInverseRotation.value}},{key:"transpose",get:function(){return this._transformTranspose.value}},{key:"setTransformMatrix",value:function(e){Object(s.c)(this._transform,e)}},{key:"multiplyTransform",value:function(e){Object(s.l)(this._transform,this._transform,e)}},{key:"set",value:function(e){Object(s.c)(this._transform,e),this.invalidateLazyTransforms()}},{key:"setAndInvalidateLazyTransforms",value:function(e,t){this.setTransformMatrix(e),this.multiplyTransform(t),this.invalidateLazyTransforms()}}]),e}(),j=function(){function e(t,i,r){m(this,e),this.original=t,this.update=i,this.dirty=!0,this.transform=r()}return w(e,[{key:"invalidate",value:function(){this.dirty=!0}},{key:"value",get:function(){return this.dirty&&(this.update(this.transform,this.original.value),this.dirty=!1),this.transform}}]),e}(),O=function(){function e(){m(this,e),this.min=new k,this.max=new k,this.hud=new k,this.ground=new k}return w(e,[{key:"init",value:function(e){this.min.init(e),this.max.init(e),this.hud.init(e),this.ground.init(e),this.all=[]}}]),e}(),k=function(){function e(t){m(this,e),this.normal=Object(n.e)(),this.transformation=Object(c.b)(),this._ray=p.f.create(),this.init(t)}return w(e,[{key:"ray",get:function(){return this._ray}},{key:"hasIntersectionPoint",get:function(){return null!=this.dist}},{key:"distanceInRenderSpace",get:function(){if(null!=this.dist)return Object(a.d)(E,this.ray.direction,this.dist),Object(a.o)(E)}},{key:"getIntersectionPoint",value:function(e){return!!this.hasIntersectionPoint&&(Object(a.d)(E,this.ray.direction,this.dist),Object(a.e)(e,this.ray.origin,E),!0)}},{key:"getTransformedNormal",value:function(e){return Object(a.j)(R,this.normal),R[3]=0,Object(f.m)(R,R,this.transformation),Object(a.j)(e,R),Object(a.q)(e,e),e}},{key:"init",value:function(e){this.dist=void 0,this.target=void 0,this.name=void 0,this.drapedLayerOrder=void 0,this.drapedLayerGraphicOrder=void 0,this.center=null,this.geometryId=null,this.triangleNr=null,this.intersector="Stage",e?p.f.copy(e,this._ray):this._ray=p.f.create()}},{key:"set",value:function(e,t,i,r,o,c,h,u,l,f){e instanceof y.a&&(e={type:"stage",obj:e}),this.dist=i,Object(a.j)(this.normal,r),Object(s.c)(this.transformation,o),this.target=e,this.name=t,this.drapedLayerOrder=c,this.center=h?Object(n.d)(h):null,this.geometryId=u,this.triangleNr=l,this.drapedLayerGraphicOrder=f}},{key:"copyFrom",value:function(e){p.f.copy(e._ray,this._ray),this.dist=e.dist,this.target=e.target,this.name=e.name,this.drapedLayerOrder=e.drapedLayerOrder,this.center=e.center?Object(n.d)(e.center):null,this.geometryId=e.geometryId,this.triangleNr=e.triangleNr,this.intersector=e.intersector,this.drapedLayerGraphicOrder=e.drapedLayerGraphicOrder,Object(a.j)(this.normal,e.normal),Object(s.c)(this.transformation,e.transformation)}},{key:"toOwner",value:function(e){if(!this.target)return null;switch(this.target.type){case"stage":return S(this.target.obj.metadata,e);case"external":switch(this.intersector){case"PointRenderer":return function(e,t){var i=e.metadata.layerUid;return null!=i?t.map.findLayerByUid(i):null}(this.target,e);case"I3S":case"IM":case"LodRenderer":case"OverlayRenderer":return S(this.target.metadata,e);case"TerrainRenderer":return e.map&&e.map.ground}}return null}},{key:"toGraphic",value:function(e){if(!this.target)return null;switch(this.target.type){case"stage":return x(this.target.obj.metadata,e);case"external":switch(this.intersector){case"PointRenderer":return function(e){return e.metadata.createGraphic()}(this.target);case"I3S":case"IM":case"LodRenderer":case"OverlayRenderer":return x(this.target.metadata,e)}}return null}}]),e}();function S(e,t){return Object(r.j)(e)||null==e.layerUid?null:Object(r.k)(t.graphicsView)&&e.layerUid===t.graphicsView.graphics3d.layer.id?t.graphics:t.map.findLayerByUid(e.layerUid)}function x(e,t){if(Object(r.j)(e))return null;var i=S(e,t);if(Object(r.j)(i))return null;if(i===t.graphics)return Object(r.k)(t.graphicsView)?Object(r.q)(t.graphicsView.getGraphicFromGraphicUid(e.graphicUid)):null;var n,a,s=t.allLayerViews.find(function(e){return e.layer===i});return s?(a=e,!(n=s)||n.suspended?null:"getGraphicFromIntersectorMetadata"in n&&a?n.getGraphicFromIntersectorMetadata(a):"getGraphicFromGraphicUid"in n&&null!=a.graphicUid?n.getGraphicFromGraphicUid(a.graphicUid):null):null}var D=new(function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;m(this,e),this.offset=t,this.sphere=Object(b.b)(),this.tmpVertex=Object(n.e)()}return w(e,[{key:"applyToVertex",value:function(e,t,i){var r=this.objectTransform.transform,n=r[0]*e+r[4]*t+r[8]*i+r[12],a=r[1]*e+r[5]*t+r[9]*i+r[13],s=r[2]*e+r[6]*t+r[10]*i+r[14],o=this.offset/Math.sqrt(n*n+a*a+s*s);n+=n*o,a+=a*o,s+=s*o;var c=this.objectTransform.inverse;return this.tmpVertex[0]=c[0]*n+c[4]*a+c[8]*s+c[12],this.tmpVertex[1]=c[1]*n+c[5]*a+c[9]*s+c[13],this.tmpVertex[2]=c[2]*n+c[6]*a+c[10]*s+c[14],this.tmpVertex}},{key:"applyToMinMax",value:function(e,t){var i=this.offset/Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]+=e[0]*i,e[1]+=e[1]*i,e[2]+=e[2]*i;var r=this.offset/Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]+=t[0]*r,t[1]+=t[1]*r,t[2]+=t[2]*r}},{key:"applyToAabb",value:function(e){var t=this.offset/Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]+=e[0]*t,e[1]+=e[1]*t,e[2]+=e[2]*t;var i=this.offset/Math.sqrt(e[3]*e[3]+e[4]*e[4]+e[5]*e[5]);return e[3]+=e[3]*i,e[4]+=e[4]*i,e[5]+=e[5]*i,e}},{key:"applyToBoundingSphere",value:function(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]),i=this.offset/t;return this.sphere[0]=e[0]+e[0]*i,this.sphere[1]=e[1]+e[1]*i,this.sphere[2]=e[2]+e[2]*i,this.sphere[3]=e[3]+e[3]*this.offset/t,this.sphere}}]),e}());function T(e){return Object(r.k)(e)?(D.offset=e,D):null}new(function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;m(this,e),this.offset=t,this.componentLocalOriginLength=0,this.tmpVertex=Object(n.e)(),this.mbs=Object(u.c)(),this.obb={center:Object(n.e)(),halfSize:Object(v.b)(),quaternion:null}}return w(e,[{key:"localOrigin",set:function(e){this.componentLocalOriginLength=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2])}},{key:"applyToVertex",value:function(e,t,i){var r=e,n=t,a=i+this.componentLocalOriginLength,s=this.offset/Math.sqrt(r*r+n*n+a*a);return this.tmpVertex[0]=e+r*s,this.tmpVertex[1]=t+n*s,this.tmpVertex[2]=i+a*s,this.tmpVertex}},{key:"applyToAabb",value:function(e){var t=e[0],i=e[1],r=e[2]+this.componentLocalOriginLength,n=e[3],a=e[4],s=e[5]+this.componentLocalOriginLength,o=this.offset/Math.sqrt(t*t+i*i+r*r);e[0]+=t*o,e[1]+=i*o,e[2]+=r*o;var c=this.offset/Math.sqrt(n*n+a*a+s*s);return e[3]+=n*c,e[4]+=a*c,e[5]+=s*c,e}},{key:"applyToMbs",value:function(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]),i=this.offset/t;return this.mbs[0]=e[0]+e[0]*i,this.mbs[1]=e[1]+e[1]*i,this.mbs[2]=e[2]+e[2]*i,this.mbs[3]=e[3]+e[3]*this.offset/t,this.mbs}},{key:"applyToObb",value:function(e){var t=e.center,i=this.offset/Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);this.obb.center[0]=t[0]+t[0]*i,this.obb.center[1]=t[1]+t[1]*i,this.obb.center[2]=t[2]+t[2]*i,Object(a.t)(this.obb.halfSize,e.halfSize,e.quaternion),Object(a.e)(this.obb.halfSize,this.obb.halfSize,e.center);var r=this.offset/Math.sqrt(this.obb.halfSize[0]*this.obb.halfSize[0]+this.obb.halfSize[1]*this.obb.halfSize[1]+this.obb.halfSize[2]*this.obb.halfSize[2]);return this.obb.halfSize[0]+=this.obb.halfSize[0]*r,this.obb.halfSize[1]+=this.obb.halfSize[1]*r,this.obb.halfSize[2]+=this.obb.halfSize[2]*r,Object(a.i)(this.obb.halfSize,this.obb.halfSize,e.center),Object(d.a)(L,e.quaternion),Object(a.t)(this.obb.halfSize,this.obb.halfSize,L),this.obb.halfSize[0]*=this.obb.halfSize[0]<0?-1:1,this.obb.halfSize[1]*=this.obb.halfSize[1]<0?-1:1,this.obb.halfSize[2]*=this.obb.halfSize[2]<0?-1:1,this.obb.quaternion=e.quaternion,this.obb}}]),e}()),new(function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;m(this,e),this.offset=t,this.tmpVertex=Object(n.e)()}return w(e,[{key:"applyToVertex",value:function(e,t,i){var r=e+this.localOrigin[0],n=t+this.localOrigin[1],a=i+this.localOrigin[2],s=this.offset/Math.sqrt(r*r+n*n+a*a);return this.tmpVertex[0]=e+r*s,this.tmpVertex[1]=t+n*s,this.tmpVertex[2]=i+a*s,this.tmpVertex}},{key:"applyToAabb",value:function(e){var t=e[0]+this.localOrigin[0],i=e[1]+this.localOrigin[1],r=e[2]+this.localOrigin[2],n=e[3]+this.localOrigin[0],a=e[4]+this.localOrigin[1],s=e[5]+this.localOrigin[2],o=this.offset/Math.sqrt(t*t+i*i+r*r);e[0]+=t*o,e[1]+=i*o,e[2]+=r*o;var c=this.offset/Math.sqrt(n*n+a*a+s*s);return e[3]+=n*c,e[4]+=a*c,e[5]+=s*c,e}}]),e}());var P="terrain",E=(Object(n.e)(),Object(n.e)()),R=Object(u.c)(),L=Object(h.a)()},tKWm:function(e,t,i){"use strict";i.d(t,"a",function(){return m}),i.d(t,"b",function(){return O}),i.d(t,"c",function(){return y}),i.d(t,"d",function(){return g}),i.d(t,"e",function(){return _}),i.d(t,"f",function(){return p}),i.d(t,"g",function(){return j});var r=i("srIe"),n=i("OKTS"),a=i("qRWG"),s=i("Cy1f"),o=i("5DEt"),c=i("gYg2"),h=i("9AiD"),u=i("8JEK"),f=i("0Kx6"),d=i("qXiY"),v=i("klA5"),b=i("wg3g");function p(e,t){var i=Object(s.e)(),n=Object(s.e)(),o=!1;return function(s){if("start"===s.action){var c=Object(a.j)(s.screenStart,Object(a.c)(u.c.get())),h=f.f.fromScreen(e.state.camera,c,S);Object(r.k)(h)&&(o=f.e.intersectRay(t,h,i))}if(!o)return null;var d=Object(a.j)(s.screenEnd,Object(a.c)(u.c.get())),v=f.f.fromScreen(e.state.camera,d,S);return Object(r.j)(v)?null:f.e.intersectRay(t,v,n)?l(l({},s),{},{renderStart:i,renderEnd:n,plane:t,ray:v}):null}}function y(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=null;return function(h){if("start"===h.action&&(o=e.sceneIntersectionHelper.intersectElevationFromScreen(Object(a.g)(h.screenStart.x,h.screenStart.y),t,i,s),Object(r.k)(o)&&Object(r.k)(n)&&!Object(c.n)(o,o,n)))return null;if(Object(r.j)(o))return null;var u=e.sceneIntersectionHelper.intersectElevationFromScreen(Object(a.g)(h.screenEnd.x,h.screenEnd.y),t,i,s);return Object(r.k)(u)?Object(r.k)(n)&&!Object(c.n)(u,u,n)?null:l(l({},h),{},{mapStart:o,mapEnd:u}):null}}(e,i,Object(h.f)(t,e,i),n,s)}function _(e,t,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return y(e,i,Object(h.d)(t),r,n)}function g(e,t,i,n){var a=t.toMap(e.screenStart,{include:[i]});return Object(r.k)(a)?_(t,i,a,n):null}function j(e,t,i){var a=null,c=new b.a;return c.next(p(e,function(e,t){var i=w,r=k,n=f.e.create();e.renderCoordsHelper.worldUpAtPosition(t,i);var a=Object(o.f)(n,i,Object(o.i)(r,t,e.state.camera.eye));return Object(o.f)(a,a,i),f.e.fromPositionAndNormal(t,a,n)}(e,t))).next(function(e,t){var i=Object(s.e)(),r=Object(o.o)(t);e.renderCoordsHelper.worldUpAtPosition(t,i);var a=Object(s.e)(),c=Object(s.e)(),h=function(a){return Object(o.i)(a,a,t),f.h.projectPoint(i,a,a),"global"===e.viewingMode&&Object(o.o)(a)*Object(n.o)(Object(o.g)(i,a))<.001-r&&Object(o.i)(a,Object(o.d)(a,i,.001),t),Object(o.e)(a,a,t),a};return function(e){return e.renderStart=h(Object(o.j)(a,e.renderStart)),e.renderEnd=h(Object(o.j)(c,e.renderEnd)),e}}(e,t)).next(function(e,t){var i=e.renderCoordsHelper;return function(e){var n=i.fromRenderCoords(e.renderStart,t),a=i.fromRenderCoords(e.renderEnd,t);return Object(r.k)(n)&&Object(r.k)(a)?l(l({},e),{},{mapStart:n,mapEnd:a}):null}}(e,i)).next(function(e){e.mapEnd.x=e.mapStart.x,e.mapEnd.y=e.mapStart.y,a=e}),function(e){return a=null,c.execute(e),a}}function m(e){var t=null;return function(i){switch(i.action){case"start":t=e.disableDisplay();break;case"end":case"cancel":Object(r.k)(t)&&(t.remove(),t=null)}return i}}function O(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=new v.a(e.state.mode);i.options.selectionMode=!0,i.options.store=0;var n,o=Object(a.g)(),c={requiresGroundFeedback:!0,enableDraped:!0,exclude:new Set},h=Object(s.e)(),u=Object(r.r)(t,e.spatialReference),f=function(t){e.map.ground&&e.map.ground.opacity<1?c.exclude.add(d.e):c.exclude.delete(d.e),e.sceneIntersectionHelper.intersectIntersectorScreen(Object(a.j)(t,o),i,c);var r,n=i.results.min;if(n.getIntersectionPoint(h))r="TerrainRenderer"===n.intersector?0:1;else{if(!i.results.ground.getIntersectionPoint(h))return null;r=0}return{location:e.renderCoordsHelper.fromRenderCoords(h,u),surfaceType:r}};return function(e){if("start"===e.action){var t=f(e.screenStart);n=Object(r.k)(t)?t.location:null}if(Object(r.j)(n))return null;var i=f(e.screenEnd);return Object(r.k)(i)&&Object(r.k)(i.location)?l(l({},e),{},{mapStart:n,mapEnd:i.location,surfaceType:i.surfaceType}):null}}var w=Object(s.e)(),k=Object(s.e)(),S=f.f.create()}}])}();