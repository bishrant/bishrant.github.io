(function(){var e={"arcgis-js-api/views/2d/layers/graphics/GraphicStore":"5r4l","esri/views/2d/layers/features/support/TileStore":"6kSU","arcgis-js-api/views/2d/layers/features/support/TileStore":"6kSU","arcgis-js-api/views/2d/layers/graphics/GraphicStoreItem":"9gM4","arcgis-js-api/views/2d/layers/graphics/GraphicContainer":"FBzP","arcgis-js-api/core/libs/quickselect/quickselect":"FT4I","arcgis-js-api/views/2d/engine/FeatureContainer":"N0+q","arcgis-js-api/views/2d/layers/graphics/GraphicsView2D":"apjU","esri/views/2d/layers/features/support/Tile":"fUL3","esri/core/libs/rbush/rbush":"jEml","arcgis-js-api/core/libs/rbush/rbush":"jEml","arcgis-js-api/core/MapPool":"loiZ","arcgis-js-api/views/2d/layers/graphics/GraphicProcessingQueue":"vhZU","esri/views/2d/layers/graphics/graphicsUtils":"wjMf","arcgis-js-api/views/2d/layers/graphics/graphicsUtils":"wjMf","arcgis-js-api/views/layers/GraphicsView":"zRH3"},t=this||window,i=t.webpackJsonp=t.webpackJsonp||[];i.registerAbsMids?i.registerAbsMids(e):(i.absMidsWaiting=i.absMidsWaiting||[]).push(e)})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"5r4l":function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("zOht"),i("H1tY"),i("jBNx"),i("8uEs"),i("jEml"),i("lRq4"),i("k1EI"),i("d466"),i("Lzvl"),i("fw2w"),i("9gM4"),i("wjMf")],void 0===(n=(function(e,t,i,r,n,a,o,s,h,l,u,c,p,d){Object.defineProperty(t,"__esModule",{value:!0});var f={minX:0,minY:0,maxX:0,maxY:0},g=s.create(),m=[];function y(e,t,i,r,n){return f.minX=t,f.minY=i,f.maxX=r,f.maxY=n,e.search(f)}var v=function(){function e(e,t,i,n,s,h){this._graphics=n,this._onAdd=s,this._onRemove=h,this._index=o(9,r("csp-restrictions")?function(e){return{minX:e.bounds[0],minY:e.bounds[1],maxX:e.bounds[2],maxY:e.bounds[3]}}:[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),this._itemByGraphic=new Map,this._currentLevel=-1/0,this._tileInfoView=e,this._uidFieldName=i;var l=e.getClosestInfoForScale(t);l&&(this._currentLevel=l.level,this._resolution=this._tileInfoView.getTileResolution(l.level)),this._metersPerUnit=a.getMetersPerUnit(e.spatialReference)}return e.prototype.hitTest=function(e,t,i,r,a){e=c.normalizeMapX(e,this._tileInfoView.spatialReference);var o=.5*r*i;g[0]=e-o,g[1]=t-o,g[2]=e+o,g[3]=t+o;var p=.5*r*(i+50),f=y(this._index,e-p,t-p,e+p,t+p);if(!f||0===f.length)return[];for(var m,v={x:e,y:t},_=[],x=0,b=f;x<b.length;x++){var w=b[x];if(w.graphic.visible)switch(u.getJsonType(w.geometry)){case"esriGeometryPoint":var M=w.symbol;if(!M)continue;var G=w.geometry,S=void 0;switch(M.type){case"text":S=d.getTextSymbolBounds(G.x,G.y,M,w.size,r,a);break;case"cim":case"expanded-cim":S=d.getCIMMarkerBounds(G.x,G.y,M,r,r*this._metersPerUnit,a);break;default:S=d.getMarkerSymbolBounds(G.x,G.y,M,r,r*this._metersPerUnit,a)}h.polygonContainsPoint(S,v)&&_.push(w);break;case"esriGeometryPolyline":var I=w.symbol;if(!I)continue;m=1.5*r*window.devicePixelRatio*n.pt2px(I.width),d.isPointOnPolyline(w.geometry,e,t,m)&&_.push(w);break;case"esriGeometryEnvelope":var P=w.geometry,T=s.fromValues(P.xmin,P.ymin,P.xmax,P.ymax);s.intersects(T,g)&&_.push(w);break;case"esriGeometryPolygon":if(h.polygonContainsPoint(w.geometry,v)){_.push(w);break}var B=l.getPolygonExtent(w.geometry);if(Math.abs(B.ymax-B.ymin)<5*r||Math.abs(B.xmax-B.xmin)<5*r){var O=s.fromValues(B.xmin,B.ymin,B.xmax,B.ymax);s.intersects(O,g)&&_.push(w)}break;case"esriGeometryMultipoint":var z=w.symbol;if(!z)continue;for(var C=w.geometry.points,k=void 0,q=0;q<C.length;q++)if(k="text"===z.type?d.getTextSymbolBounds(C[q][0],C[q][1],z,w.size,r,a):d.getMarkerSymbolBounds(C[q][0],C[q][1],z,r,r*this._metersPerUnit,a),h.polygonContainsPoint(k,v)){_.push(w);break}}}return _.sort((function(e,t){var i=d.graphicGeometryToNumber(e.graphic),r=d.graphicGeometryToNumber(t.graphic);return i===r?t.zorder-e.zorder:i-r})),_.map((function(e){return e.graphic}))},e.prototype.getGraphicsData=function(e,t,r){var n=y(this._index,t.bounds[0],t.bounds[1],t.bounds[2],t.bounds[3]);if(0===n.length||0===r.length)return[];n.sort((function(e,t){return e.zorder-t.zorder})),n[0].insertAfter=-1;for(var a=1;a<n.length;a++)n[a].insertAfter=n[a-1].graphic.uid;n.sort((function(e,t){return e.graphic.uid-t.graphic.uid})),r.sort((function(e,t){return e.uid-t.uid}));for(var o,s=0,h=0,l=[],u={originPosition:"upperLeft",scale:[t.resolution,t.resolution],translate:[t.bounds[0],t.bounds[3]]},c=0,d=r;c<d.length;c++){var f=d[c];for(h=-2;s<n.length;)if(o=n[s],s++,f.uid===o.graphic.uid){h=o.insertAfter;break}if(o.geometry&&-2!==h){var g=o.getGeometryQuantized(u),m=i.__assign({},o.graphic.attributes);m[this._uidFieldName]=f.uid,null==o.groupId&&(o.groupId=e.createTemplateGroup(o.symbol,null,null)),l.push({centroid:p.default.getCentroidQuantized(o,u),geometry:g,attributes:m,symbol:o.symbol,groupId:o.groupId,insertAfter:h})}}return l},e.prototype.getGraphicData=function(e,t,r){var n=this._itemByGraphic.get(r);if(!n)return null;var a=y(this._index,t.bounds[0],t.bounds[1],t.bounds[2],t.bounds[3]);a.sort((function(e,t){return e.zorder-t.zorder}));var o=a.indexOf(n),s=0===o||-1===o?-1:a[o-1].graphic.uid,h={originPosition:"upperLeft",scale:[t.resolution,t.resolution],translate:[t.bounds[0],t.bounds[3]]},l=n.getGeometryQuantized(h),u=i.__assign({},n.graphic.attributes);return u[this._uidFieldName]=r.uid,null==n.groupId&&(n.groupId=e.createTemplateGroup(n.symbol,null,null)),{centroid:p.default.getCentroidQuantized(n,h),geometry:l,attributes:u,symbol:n.symbol,groupId:n.groupId,insertAfter:s}},e.prototype.queryTileData=function(e,t){var i=s.pad(t.bounds,50*t.resolution,s.create()),r=y(this._index,i[0],i[1],i[2],i[3]),n=[];return this._createTileGraphics(n,e,r,{originPosition:"upperLeft",scale:[t.resolution,t.resolution],translate:[t.bounds[0],t.bounds[3]]}),n},e.prototype.has=function(e){return this._itemByGraphic.has(e)},e.prototype.getBounds=function(e){return this._itemByGraphic.has(e)?this._itemByGraphic.get(e).bounds:null},e.prototype.add=function(e,t,i){if(e){this._onAdd(e);var r=p.default.acquire(e,t,i,this._resolution,this._resolution*this._metersPerUnit,this._tileInfoView.spatialReference);return this._itemByGraphic.set(e,r),i&&this._index.insert(r),r.bounds}},e.prototype.remove=function(e){if(this._itemByGraphic.has(e)){this._onRemove(e);var t=this._itemByGraphic.get(e);this._index.remove(t),this._itemByGraphic.delete(e)}},e.prototype.updateZ=function(){for(var e,t=this._graphics.items,i=0;i<t.length;i++)(e=this._itemByGraphic.get(t[i]))&&(e.zorder=i)},e.prototype.update=function(e,t,i){var r=this._itemByGraphic.get(e);r.groupId=null;var n=s.clone(r.bounds);return r.size[0]=r.size[1]=0,this._index.remove(r),r.set(e,t,i,this._resolution,this._resolution*this._metersPerUnit,this._tileInfoView.spatialReference),i&&this._index.insert(r),{oldBounds:n,newBounds:r.bounds}},e.prototype.updateLevel=function(e){var t=this;if(this._currentLevel!==e){this._currentLevel=e;var i=this._tileInfoView.getTileResolution(e);this._resolution=i,this._index.clear(),m.length=0,this._itemByGraphic.forEach((function(e){e.updateBounds(t._resolution,t._resolution*t._metersPerUnit,t._tileInfoView.spatialReference),e.geometry&&m.push(e)})),this._index.load(m)}},e.prototype.clear=function(){this._itemByGraphic.clear(),this._index.clear()},e.prototype._createTileGraphics=function(e,t,r,n){var a,o,s,h,l=this._uidFieldName;r.sort((function(e,t){return e.zorder-t.zorder}));for(var u=0;u<r.length;u++){a=(s=r[u]).graphic,o=s.getGeometryQuantized(n),h=0===u?-1:r[u-1].graphic.uid;var c=i.__assign({},s.graphic.attributes);c[l]=a.uid,null==s.groupId&&(s.groupId=t.createTemplateGroup(s.symbol,null,null)),e.push({centroid:p.default.getCentroidQuantized(s,n),geometry:o,attributes:c,symbol:s.symbol,groupId:s.groupId,insertAfter:h})}},e}();t.default=v}).apply(null,r))||(e.exports=n)},"6kSU":function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("zOht"),i("BcWh"),i("H1tY"),i("jEml"),i("fUL3"),i("7Lgj"),i("f3JK")],void 0===(n=(function(e,t,i,r,n,a,o,s,h){Object.defineProperty(t,"__esModule",{value:!0});var l={added:[],removed:[]},u=new Set,c=new h(0,0,0,0),p=function(e){function t(t){var i=e.call(this)||this;return i._tiles=new Map,i._index=a(9,n("csp-restrictions")?function(e){return{minX:e.bounds[0],minY:e.bounds[1],maxX:e.bounds[2],maxY:e.bounds[3]}}:[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),i.tiles=[],i.tileScheme=t,i}return i.__extends(t,e),t.prototype.destroy=function(){this._tiles.clear()},t.prototype.clear=function(){this._tiles.clear(),this._index.clear()},t.prototype.has=function(e){return this._tiles.has(e)},t.prototype.get=function(e){return this._tiles.get(e)},t.prototype.findByKey=function(e){return this._tiles.get(e.id)},t.prototype.intersections=function(e,t){var i="string"==typeof e?this.get(e):e;if(!i)return[];for(var r=t*i.resolution,n=i.bounds[0]-r,a=i.bounds[1]-r,o=i.bounds[2]+r,s=i.bounds[3]+r,h=[],l=0,u=this._index.search({minX:n,minY:a,maxX:o,maxY:s});l<u.length;l++){var c=u[l],p=c.bounds.slice();p[0]=Math.max(p[0],n),p[1]=Math.max(p[1],a),p[2]=Math.min(p[2],o),p[3]=Math.min(p[3],s),p[2]-p[0]>0&&p[3]-p[1]>0&&h.push({bounds:p,tile:c})}return h},t.prototype.boundsIntersections=function(e){return this._index.search({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]})},t.prototype.setViewState=function(e){var t=this.tileScheme.getTileCoverage(e,0);if(t){var i=t.spans,r=t.lodInfo,n=r.level;if(i.length>0)for(var a=0,h=i;a<h.length;a++)for(var p=h[a],d=p.row,f=p.colTo,g=p.colFrom;g<=f;g++){var m=c.set(n,d,r.normalizeCol(g),r.getWorldForColumn(g)).id;if(u.add(m),!this.has(m)){var y=new o.default(this.tileScheme,m);this._tiles.set(m,y),this._index.insert(y),this.tiles.push(y),l.added.push(y)}}for(var v=this.tiles.length-1;v>=0;v--)u.has((y=this.tiles[v]).id)||(this._tiles.delete(y.id),this.tiles.splice(v,1),this._index.remove(y),l.removed.push(y));(l.added.length||l.removed.length)&&this.emit("update",l),s.pool.release(t),u.clear(),l.added.length=0,l.removed.length=0}},t}(r);t.default=p}).apply(null,r))||(e.exports=n)},"9gM4":function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("LxLY"),i("lRq4"),i("0FS0"),i("Lzvl"),i("u90+"),i("+6sX"),i("Jvs9"),i("wjMf")],void 0===(n=(function(e,t,i,r,n,a,o,s,h,l){Object.defineProperty(t,"__esModule",{value:!0});var u=new h.default,c=new h.default;function p(e){e.coords.length=0,e.lengths.length=0}var d=function(){function e(){this.bounds=r.create(),this.graphic=null,this.size=[0,0,0,0]}return e.acquire=function(t,i,r,n,a,o){var s;return void 0===t&&(t=null),0===e._pool.length?s=new e:(s=e._pool.pop(),this._set.delete(s)),s.acquire(t,i,r,n,a,o),s},e.release=function(e){e&&!this._set.has(e)&&(e.release(),this._pool.push(e),this._set.add(e))},e.getCentroidQuantized=function(e,t){if(a.isPolygon(e.geometry)){var r=e.symbol;if(i.isNone(r))return null;if(l.isMarkerSymbol(r.type)){var s=n.polygonCentroid(e.geometry);return o.quantizePoint(t,{},{x:s[0],y:s[1]},!1,!1)}}return null},e.prototype.acquire=function(e,t,i,r,n,a){void 0===e&&(e=null),e&&this.set(e,t,i,r,n,a)},e.prototype.release=function(){this.graphic=null,this.symbolResource=null,this.geometry=null},Object.defineProperty(e.prototype,"symbol",{get:function(){return this.symbolResource.symbol},enumerable:!0,configurable:!0}),e.prototype.set=function(e,t,i,r,n,a){this.graphic=e,this.geometry=i,this.symbolResource=t,this.updateBounds(r,n,a)},e.prototype.updateBounds=function(e,t,i){l.getBounds(this.bounds,this.size,this.symbolResource,this.geometry,e,t,i)},e.prototype.getGeometryQuantized=function(e){if(a.isPolygon(this.geometry)){var t=this.geometry.rings;if(1===t.length&&2===t[0].length)return o.quantizeGeometry(e,{paths:[[t[0][0],t[0][1]]]})}else if(a.isPolyline(this.geometry))return p(u),p(c),s.convertFromPolyline(u,this.geometry),s.generalizeOptimizedGeometry(c,u,this.geometry.hasZ,this.geometry.hasM,"esriGeometryPolyline",e.scale[0]),s.quantizeOptimizedGeometry(u,c,this.geometry.hasZ,this.geometry.hasM,"esriGeometryPolyline",e),s.convertToPolyline(u,this.geometry.hasZ,this.geometry.hasM);return o.quantizeGeometry(e,this.geometry)},e._pool=[],e._set=new Set,e}();t.default=d}).apply(null,r))||(e.exports=n)},FBzP:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("zOht"),i("N0+q")],void 0===(n=(function(e,t,i,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),Object.defineProperty(t.prototype,"hasLabels",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"labelsVisible",{get:function(){return!1},enumerable:!0,configurable:!0}),t.prototype._renderGraphics=function(e,t){for(var i=0,r=this.children;i<r.length;i++){var n=r[i];n.isReady&&n.hasData&&(n.commitChanges(),e.context.setStencilFunction(514,n.stencilRef,255),n._displayList.replay(e,n,t))}},t.prototype.renderChildren=function(t){var i=t.painter;if(this.children.some((function(e){return e.hasData}))){e.prototype.renderChildren.call(this,t),this._renderGraphics(t);var r=i.effects.highlight;r.bind(t),this._renderGraphics(t,r.defines),r.draw(t),r.unbind()}},t}(r.FeatureContainer);t.default=n}).apply(null,r))||(e.exports=n)},FT4I:function(e,t,i){var r;void 0===(r=(function(){"use strict";function e(e,t,i){var r=e[t];e[t]=e[i],e[i]=r}function t(e,t){return e<t?-1:e>t?1:0}return function(i,r,n,a,o){!function t(i,r,n,a,o){for(;a>n;){if(a-n>600){var s=a-n+1,h=r-n+1,l=Math.log(s),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(s-u)/s)*(h-s/2<0?-1:1);t(i,r,Math.max(n,Math.floor(r-h*u/s+c)),Math.min(a,Math.floor(r+(s-h)*u/s+c)),o)}var p=i[r],d=n,f=a;for(e(i,n,r),o(i[a],p)>0&&e(i,n,a);d<f;){for(e(i,d,f),d++,f--;o(i[d],p)<0;)d++;for(;o(i[f],p)>0;)f--}0===o(i[n],p)?e(i,n,f):e(i,++f,a),f<=r&&(n=f+1),r<=f&&(a=f-1)}}(i,r,n||0,a||i.length-1,o||t)}}).apply(null,[]))||(e.exports=r)},"N0+q":function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("zOht"),i("qMld"),i("qMld"),i("lRq4"),i("YaB4")],void 0===(n=(function(e,t,i,r,n,a,o){Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(t){var i=e.call(this,t)||this;return i._rendererInfo=new o.WGLRendererInfo,i._attachedResolver=r.createResolver(),i.attributeView=new o.AttributeStoreView,i}return i.__extends(t,e),t.prototype.destroy=function(){this.removeAllChildren(),this.children.forEach((function(e){return e.destroy()})),this.attributeView.destroy()},t.prototype.whenAttached=function(){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(e){switch(e.label){case 0:return[4,this._attachedResolver.promise];case 1:return e.sent(),[2]}}))}))},t.prototype.setRendererInfo=function(e,t,i){this._rendererInfo.setInfo(e,t,i),this.requestRender()},t.prototype.getMaterialItems=function(e,t){return i.__awaiter(this,void 0,void 0,(function(){var r,a;return i.__generator(this,(function(i){switch(i.label){case 0:return e&&0!==e.length?[4,this.whenAttached()]:[2,null];case 1:return i.sent(),r=this.stage.painter.textureManager,a=e.map((function(e){return r.rasterizeItem(e.symbol,e.glyphIds,t)})),[4,n.all(a)];case 2:return[2,i.sent().map((function(t,i){return{id:e[i].id,mosaicItem:t}}))]}}))}))},t.prototype.onTileData=function(e,t){if(t.addOrUpdate&&"tileDisplayData"in t.addOrUpdate)e.setData(t,this.hasLabels,this.labelsVisible);else{var r=t.addOrUpdate&&o.TileData.decode(t.addOrUpdate),n=i.__assign(i.__assign({},t),{addOrUpdate:r});e.setData(n,this.hasLabels,this.labelsVisible)}this.contains(e)||this.addChild(e),this.requestRender()},t.prototype.onTileError=function(e){e.clear(),this.contains(e)||this.addChild(e)},t.prototype.renderChildren=function(t){this._rendererInfo.update(t.state),this.attributeView.bindTextures(this.stage.context),e.prototype.renderChildren.call(this,t)},t.prototype.createTile=function(e){var t=this._tileInfoView.getTileBounds(a.create(),e);return new o.WGLTile(e,t)},t.prototype.destroyTile=function(e){this.removeChild(e),e.destroy()},t.prototype.createRenderParams=function(t){return i.__assign(i.__assign({},e.prototype.createRenderParams.call(this,t)),{rendererInfo:this._rendererInfo,attributeView:this.attributeView})},t.prototype.onAttach=function(){e.prototype.onAttach.call(this),this._attachedResolver()},t.prototype.onDetach=function(){e.prototype.onDetach.call(this),this._attachedResolver=r.createResolver()},t}(o.TileContainer);t.FeatureContainer=s}).apply(null,r))||(e.exports=n)},apjU:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("zOht"),i("Gtr7"),i("7MDj"),i("NfRO"),i("loiZ"),i("R2Zq"),i("LxLY"),i("qMld"),i("qMld"),i("jBNx"),i("Vx27"),i("Vt+U"),i("Z4y+"),i("lRq4"),i("ZPQp"),i("Lzvl"),i("nrlZ"),i("Q2Em"),i("aqXi"),i("dXKx"),i("YaB4"),i("tI6k"),i("lvbU"),i("6kSU"),i("FBzP"),i("vhZU"),i("5r4l"),i("wjMf"),i("zRH3")],void 0===(n=(function(e,t,i,r,n,a,o,s,h,l,u,c,p,d,f,g,m,y,v,_,x,b,w,M,G,S,I,P,T,B,O){function z(e,t,i){if(i.has(e))return i.get(e);var r={tile:t,addedOrModified:[],removed:[]};return i.set(e,r),r}Object.defineProperty(t,"__esModule",{value:!0});var C=function(e){function t(t){var i=e.call(this,t)||this;return i._tiles=new Map,i._graphicStoreUpdate=!1,i._graphicsSet=new Set,i._matcher=l.resolve(null),i._tileUpdateSet=new Set,i._tilesToUpdate=new Map,i._graphicIdToAbortController=new Map,i._attached=!1,i._highlightIds=new Map,i._updatingGraphicsTimer=null,i.lastUpdateId=-1,i.updateRequested=!1,i.graphicUpdateHandler=i.graphicUpdateHandler.bind(i),i.addOrUpdateGraphic=i.addOrUpdateGraphic.bind(i),i._processAnalyzedGraphics=i._processAnalyzedGraphics.bind(i),i._graphicsChangeHandler=i._graphicsChangeHandler.bind(i),i}return i.__extends(t,e),t.prototype.initialize=function(){var e=this;this._tileStore=new S.default(this.view.featuresTilingScheme),this.container=new I.default(this.view.featuresTilingScheme),this._attributeStore=new G.default({type:"local",initialize:function(t){return l.resolve(e.container.attributeView.initialize(t))},update:function(t){return e.container.attributeView.requestUpdate(t)},render:function(){return e.container.requestRender()}}),this._graphicStore=new T.default(this.view.featuresTilingScheme,this.view.state.scale,this.uid,this.graphics,(function(t){e._attributeStore.createLocalId(t.uid),e._setFilterState(t.uid,t.visible)}),(function(t){e._attributeStore.freeLocalId(t.uid)})),this._graphicProcessingQueue=new P.default({process:this.addOrUpdateGraphic});var t=new w.WGLTemplateStore(this.container.getMaterialItems.bind(this.container),!0);this._matcher=h.isSome(this.renderer)?w.createMatcher(t,null,this.renderer):w.createMatcher(t,null),this._meshFactory=new w.WGLMeshFactory(null,this.uid,null,t),this._templateStore=t,this.watch("renderer",(function(i){i&&(e._matcher=h.isSome(e.renderer)?w.createMatcher(t,null,e.renderer):w.createMatcher(t,null))})),this._tileStore.on("update",this._onTileUpdate.bind(this)),this.container.on("attach",(function(){e.graphics.items.length>0&&e._graphicsChangeHandler({target:e.graphics,added:e.graphics.items,removed:[],moved:[]}),e.handles.add(e.graphics.on("change",e._graphicsChangeHandler),"graphics"),e._attached=!0,e.notifyChange("updating")})),this.container.on("detach",(function(){e._graphicProcessingQueue&&e._graphicProcessingQueue.clear()}))},t.prototype.destroy=function(){this._updatingGraphicsTimer&&(clearTimeout(this._updatingGraphicsTimer),this._updatingGraphicsTimer=null,this.notifyChange("updating")),this.container.destroy(),this._set("graphics",null),this._graphicProcessingQueue&&(this._graphicProcessingQueue.destroy(),this._graphicProcessingQueue=null),this._graphicStore.clear(),this._tileStore.destroy(),this._attributeStore=null},Object.defineProperty(t.prototype,"updating",{get:function(){return!this._attached||null!==this._updatingGraphicsTimer||this._graphicProcessingQueue.updating||this._tileUpdateSet.size>0||this._tilesToUpdate.size>0},enumerable:!0,configurable:!0}),t.prototype.hitTest=function(e,t){if(!this.view||!this.view.position)return l.resolve();var i=this.view.toMap(c.createScreenPoint(e,t));return this.searchFeatures(i).then((function(e){return e&&e.length?e[0]:null}))},t.prototype.searchFeatures=function(e,t){var i=this;return void 0===t&&(t=2),l.create((function(r){r(i._graphicStore.hitTest(e.x,e.y,t,i.view.state.resolution,i.view.state.rotation))}))},t.prototype.update=function(e){var t=e.state,i=this.view.featuresTilingScheme.getClosestInfoForScale(t.scale).level;this._graphicStore.updateLevel(i),this._tileStore.setViewState(t),this._graphicStoreUpdate=!0,this.updateRequested=!1},t.prototype.viewChange=function(){this.requestUpdate()},t.prototype.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.requestUpdateCallback())},t.prototype.processUpdate=function(e){this.updateRequested&&(this.updateRequested=!1,this.update(e))},t.prototype.graphicUpdateHandler=function(e){var t=e.newValue,i=e.graphic;switch(e.property){case"attributes":break;case"geometry":case"symbol":this._graphicProcessingQueue.push(i,"update");break;case"visible":this._setFilterState(i.uid,t),this._attributeStore.sendUpdates()}},t.prototype.addHighlight=function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t];if(this._highlightIds.has(r)){var n=this._highlightIds.get(r);this._highlightIds.set(r,n+1)}else this._highlightIds.set(r,1)}this._updateHighlight()},t.prototype.removeHighlight=function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t];if(this._highlightIds.has(r)){var n=this._highlightIds.get(r)-1;0===n?this._highlightIds.delete(r):this._highlightIds.set(r,n)}}this._updateHighlight()},t.prototype._updateHighlight=function(){this._attributeStore.setHighlight(s.keysOfMap(this._highlightIds))},t.prototype._getIntersectingTiles=function(e){var t=this._graphicStore.getBounds(e);return t&&0!==g.width(t)&&0!==g.height(t)?this._tileStore.boundsIntersections(t):[]},t.prototype._updateTile=function(e){var t=this,i=e.tile,r=this._getGraphicsData(this._templateStore,i,e.addedOrModified);return this._processGraphics(i.key,r).then((function(r){return t._patchTile(i.key,{addOrUpdate:r,remove:e.removed}),r}))},t.prototype._patchTile=function(e,t){if(this._tiles.has(e)){var i=this._tiles.get(e);this.container.onTileData(i,t),this.container.requestRender()}},t.prototype._graphicsChangeHandler=function(e){var t=this;if(!this._graphicStoreUpdate){var i=this.view.state,r=this.view.featuresTilingScheme.getClosestInfoForScale(i.scale).level;this._graphicStore.updateLevel(r),this._tileStore.setViewState(i)}for(var n=e.added,a=e.removed,o=e.moved,s=this._tilesToUpdate,h=[],u=new Array(n.length),c=0;c<n.length;c++){var p=n[c];u[c]=p,this._graphicsSet.add(p),h.push(this.addGraphic(p))}for(var d=0,f=a;d<f.length;d++){var g=f[d];this._abortProcessingGraphic(g.uid);for(var m=0,y=this._getIntersectingTiles(g);m<y.length;m++){var v=y[m];z(v.key.id,v,s).removed.push(this._attributeStore.getLocalId(g.uid))}this._graphicsSet.delete(g),this._graphicStore.remove(g)}for(var _=0,x=o;_<x.length;_++)for(var b=x[_],w=0,M=this._getIntersectingTiles(b);w<M.length;w++)z((v=M[w]).key.id,v,s).addedOrModified.push(b);this._flipUpdatingGraphics(),l.all(h).then((function(){for(var e,i=0;i<u.length;i++)for(var r=0,n=t._getIntersectingTiles(e=u[i]);r<n.length;r++){var a=n[r];z(a.key.id,a,s).addedOrModified.push(e)}t._graphicStore.updateZ();var o=[];return s.forEach((function(e){return o.push(t._updateTile(e))})),l.all(o).then((function(){s.clear(),t.notifyChange("updating")}))})).catch((function(){s.clear(),t.notifyChange("updating")}))},t.prototype._getArcadeInfo=function(e){var t=(e.attributes?Object.keys(e.attributes):[]).map((function(t){return{name:t,alias:t,type:"string"==typeof e.attributes[t]?"esriFieldTypeString":"esriFieldTypeDouble"}}));return h.isNone(e.geometry)?null:{geometryType:y.getJsonType(e.geometry),spatialReference:f.fromJSON(e.geometry.spatialReference),fields:t}},t.prototype._getSymbolForGraphic=function(e,t){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(i){return h.isSome(e.symbol)?[2,e.symbol]:h.isSome(this.renderer)?[2,this.renderer.getSymbolAsync(e,{scale:this.view.scale,abortOptions:t})]:[2,this._getNullSymbol(e)]}))}))},t.prototype._getSymbolResources=function(e,t){return i.__awaiter(this,void 0,void 0,(function(){var r,n,a,o,s,h,u,c;return i.__generator(this,(function(i){switch(i.label){case 0:return this.container.stage?(r=this._getArcadeInfo(e),a=x.expandSymbol,[4,this._getSymbolForGraphic(e,t)]):[2,l.resolve(null)];case 1:return[4,a.apply(void 0,[i.sent(),r,t])];case 2:if("text"!==(n=i.sent()).type)return[3,4];for(o=[],s=w.bidiText(n.text)[0],h=0;h<s.length;h++)o.push(s.charCodeAt(h));return u={symbol:n.toJSON(),id:0,glyphIds:o},[4,this.container.getMaterialItems([u])];case 3:return c=i.sent()[0].mosaicItem,[2,{symbol:n,mosaicItem:c}];case 4:return[2,{symbol:n,mosaicItem:null}]}}))}))},t.prototype._projectAndNormalizeGeometry=function(e){return i.__awaiter(this,void 0,void 0,(function(){var t,r=this;return i.__generator(this,(function(i){return h.isNone(e.geometry)?[2,l.resolve(null)]:(y.isPolygon(t=e.geometry)?t.rings=t.rings:y.isPolyline(t)?t.paths=t.paths:y.isExtent(t)&&(t=d.fromExtent(t)),[2,_.checkProjectionSupport(t.spatialReference,this.view.spatialReference).then((function(){var e=B.normalizeCentralMeridian(t),i=_.project(e,t.spatialReference,r.view.spatialReference);return m.closeRingsAndFixWinding(i),i}))])}))}))},t.prototype._onTileUpdate=function(e){var t=v.getInfo(this.view.spatialReference);if(e.added&&e.added.length>0)for(var i=0,r=e.added;i<r.length;i++)this._addNewTile(r[i],t);if(e.removed&&e.removed.length>0)for(var n=0,a=e.removed;n<a.length;n++)this._removeTile(a[n].key)},t.prototype.addOrUpdateGraphic=function(e,t,i){return this._addOrUpdateGraphic(e,t,i)},t.prototype.addGraphic=function(e){var t=this;this._abortProcessingGraphic(e.uid);var i=u.createAbortController();return this._graphicIdToAbortController.set(e.uid,i),this._addOrUpdateGraphic(e,"add",{signal:i.signal}).then((function(){t._graphicIdToAbortController.delete(e.uid)})).catch((function(i){if(t._graphicIdToAbortController.delete(e.uid),!l.isAbortError(i))throw i}))},t.prototype._addOrUpdateGraphic=function(e,t,i){var r=this,n=this._projectAndNormalizeGeometry(e),a=this._getSymbolResources(e,i);return l.all([n,a]).then((function(n){var a=n[0],o=n[1];return"add"===t?r._addProjectedGraphic(e,o,a):r._updateGraphic(e,o,a,i)}))},t.prototype._addProjectedGraphic=function(e,t,i){this._graphicsSet.has(e)&&this._graphicStore.add(e,t,i)},t.prototype._updateGraphic=function(e,t,i,r){var n=this;if(!this._graphicStore.has(e)||l.isAborted(r))return l.resolve();for(var a=this._graphicStore.update(e,t,i),s=a.oldBounds,h=a.newBounds,u=0===g.width(s)&&0===g.height(s),c=0===g.width(h)&&0===g.height(h),p=u?[]:this._tileStore.boundsIntersections(s),d=c?[]:this._tileStore.boundsIntersections(h),f=o.acquire(),m=0,y=p;m<y.length;m++){var v=y[m];f.set(v.key,{addOrUpdate:null,remove:[this._attributeStore.getLocalId(e.uid)]})}for(var _=0,x=d;_<x.length;_++){var b=this._getGraphicData(this._templateStore,v=x[_],e);if(f.has(v.key)){var w=f.get(v.key);w.remove.length=0,w.addOrUpdate=b}else f.set(v.key,{addOrUpdate:b,remove:null})}var M=[];return f.forEach((function(e,t){var i=n._processGraphics(t,e.addOrUpdate,r).then((function(i){n._patchTile(t,{addOrUpdate:i,remove:e.remove})}));M.push(i)})),o.release(f),l.all(M).then((function(){}))},t.prototype._addTile=function(e,t){var i=g.create();this.view.featuresTilingScheme.getTileBounds(i,e);var r=new w.WGLTile(e,i,!0),n={clear:!0,addOrUpdate:t,remove:[]};this._tiles.set(e,r),this.container.addChild(r),r.setData(n,!1,!1)},t.prototype._addNewTile=function(e,t){var i=this,r=this._graphicStore.queryTileData(this._templateStore,e);if(t)for(var n=Math.round((t.valid[1]-t.valid[0])/e.resolution),a=0,o=r;a<o.length;a++){var s=o[a];s.geometry&&y.isPoint(s.geometry)&&this._wrapPoints(s,n)}var h=e.key;this._tileUpdateSet.add(e.key),this.notifyChange("updating"),this._processGraphics(h,r).then((function(e){i._addTile(h,e),i._tileUpdateSet.delete(h),i.notifyChange("updating")})).catch((function(e){if(i._tileUpdateSet.delete(h),i.notifyChange("updating"),!l.isAbortError(e))throw e}))},t.prototype._removeTile=function(e){if(this._tiles.has(e)){var t=this._tiles.get(e);this.container.removeChild(t),t.destroy(),this._tiles.delete(e)}},t.prototype._setFilterState=function(e,t){var i=this._attributeStore.getLocalId(e),r=this._attributeStore.getHighlightFlag(e);this._attributeStore.setData(i,0,0,r|(t?M.FILTER_FLAG_0:0))},t.prototype._getGraphicsData=function(e,t,i){var r=v.getInfo(this.view.spatialReference),n=this._graphicStore.getGraphicsData(e,t,i);if(r)for(var a=Math.round((r.valid[1]-r.valid[0])/t.resolution),o=0,s=n;o<s.length;o++){var h=s[o];h.geometry&&y.isPoint(h.geometry)&&this._wrapPoints(h,a)}return n.sort((function(e,t){return e.insertAfter-t.insertAfter})),n},t.prototype._getGraphicData=function(e,t,i){var r=this._graphicStore.getGraphicData(e,t,i),n=[r],a=v.getInfo(this.view.spatialReference);if(a){var o=Math.round((a.valid[1]-a.valid[0])/t.resolution);r.geometry&&y.isPoint(r.geometry)&&this._wrapPoints(r,o)}return n},t.prototype._wrapPoints=function(e,t){var i=e.geometry;512===t?i.x<20?e.geometry={points:[[i.x,i.y],[t,0]]}:i.x>492&&(e.geometry={points:[[i.x,i.y],[-t,0]]}):i.x<-20?e.geometry={points:[[i.x,i.y],[t,0]]}:i.x>532&&(e.geometry={points:[[i.x,i.y],[-t,0]]})},t.prototype._processGraphics=function(e,t,r){return i.__awaiter(this,void 0,void 0,(function(){var n,a;return i.__generator(this,(function(i){switch(i.label){case 0:return t&&t.length&&this._meshFactory?(n=this._meshFactory,[4,this._matcher.then((function(e){return n.analyze(t,e,null,null,r)}))]):[2,null];case 1:return a=i.sent(),this._attributeStore.sendUpdates(),[2,this._processAnalyzedGraphics(e,a)]}}))}))},t.prototype._processAnalyzedGraphics=function(e,t){for(var i=this._meshFactory,r=i.createMeshData(t.length),n=this._attributeStore,a=0,o=t;a<o.length;a++){var s=o[a];s.insertAfter=-1===s.insertAfter?-1:n.getLocalId(s.insertAfter),s.localId=n.getLocalId(s.attributes[this.uid]),i.write(r,s,null,null,e.level,null)}return w.TileData.fromMeshData(r)},t.prototype._abortProcessingGraphic=function(e){this._graphicIdToAbortController.has(e)&&this._graphicIdToAbortController.get(e).abort()},t.prototype._getNullSymbol=function(e){var t=e.geometry;return y.isPolyline(t)?b.errorPolylineSymbol2D:y.isPolygon(t)||y.isExtent(t)?b.errorPolygonSymbol2D:b.errorPointSymbol2D},t.prototype._flipUpdatingGraphics=function(){var e=this;this._updatingGraphicsTimer&&clearTimeout(this._updatingGraphicsTimer),this._updatingGraphicsTimer=setTimeout((function(){e._updatingGraphicsTimer=null,e.notifyChange("updating")}),160),this.notifyChange("updating")},i.__decorate([p.property()],t.prototype,"_graphicProcessingQueue",void 0),i.__decorate([p.property({constructOnly:!0})],t.prototype,"requestUpdateCallback",void 0),i.__decorate([p.property({constructOnly:!0})],t.prototype,"graphics",void 0),i.__decorate([p.property({dependsOn:["_graphicProcessingQueue.updating"]})],t.prototype,"updating",null),i.__decorate([p.property()],t.prototype,"view",void 0),i.__decorate([p.property()],t.prototype,"updateRequested",void 0),i.__decorate([p.subclass("esri.views.2d.layers.support.GraphicsView2D")],t)}(O.GraphicsView(n.HandleOwnerMixin(a.IdentifiableMixin(r))));t.default=C}).apply(null,r))||(e.exports=n)},fUL3:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("QVms"),i("N7S/"),i("lRq4"),i("lAK8"),i("f3JK")],void 0===(n=(function(e,t,i,r,n,a,o){function s(e,t){var i=e.bounds,r=t.bounds;return e.key.id!==t.key.id&&e.key.world===t.key.world&&i[0]<=r[0]&&i[1]<=r[1]&&i[2]>=r[2]&&i[3]>=r[3]}Object.defineProperty(t,"__esModule",{value:!0}),t.isParentOf=s,t.isChildOf=function(e,t){return s(t,e)};var h=function(){function e(e,t){this.bounds=n.create(),this.key=new o(0,0,0,0),this.objectIds=new Set,this.key.set(t);var i=e.getLODInfoAt(this.key);this.tileInfoView=e,this.tileInfoView.getTileBounds(this.bounds,this.key,!0),this.resolution=i.resolution,this.scale=i.scale,this.level=i.level,this.needsClear=!0}return Object.defineProperty(e.prototype,"id",{get:function(){return this.key.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extent",{get:function(){return r.fromBounds(this.bounds,this.tileInfoView.tileInfo.spatialReference)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"transform",{get:function(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],translate:[this.bounds[0],this.bounds[3]]}},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this.tileInfoView,this.id)},e.prototype.createChildTiles=function(){for(var t=this.key.getChildKeys(),r=i.acquire(),n=0;n<t.length;n++)r[n]=new e(this.tileInfoView,t[n]);return r},e.prototype.getQuantizationParameters=function(){return a.default.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})},e}();t.Tile=h,t.default=h}).apply(null,r))||(e.exports=n)},jEml:function(e,t,i){var r,n;r=[i("FT4I")],void 0===(n=(function(e){"use strict";function t(e,i){if(!(this instanceof t))return new t(e,i);this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),i&&("function"==typeof i?this.toBBox=i:this._initFormat(i)),this.clear()}function i(e,t,i){if(!i)return t.indexOf(e);for(var r=0;r<t.length;r++)if(i(e,t[r]))return r;return-1}function r(e,t){n(e,0,e.children.length,t,e)}function n(e,t,i,r,n){n||(n=p(null)),n.minX=1/0,n.minY=1/0,n.maxX=-1/0,n.maxY=-1/0;for(var o,s=t;s<i;s++)o=e.children[s],a(n,e.leaf?r(o):o);return n}function a(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function o(e,t){return e.minX-t.minX}function s(e,t){return e.minY-t.minY}function h(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function l(e){return e.maxX-e.minX+(e.maxY-e.minY)}function u(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function c(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function p(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function d(t,i,r,n,a){for(var o,s=[i,r];s.length;)(r=s.pop())-(i=s.pop())<=n||(o=i+Math.ceil((r-i)/n/2)*n,e(t,o,i,r,a),s.push(i,o,o,r))}return t.prototype={all:function(){return this._all(this.data,[])},search:function(e){var t=this.data,i=[],r=this.toBBox;if(!c(e,t))return i;for(var n,a,o,s,h=[];t;){for(n=0,a=t.children.length;n<a;n++)o=t.children[n],c(e,s=t.leaf?r(o):o)&&(t.leaf?i.push(o):u(e,s)?this._all(o,i):h.push(o));t=h.pop()}return i},collides:function(e){var t=this.data,i=this.toBBox;if(!c(e,t))return!1;for(var r,n,a,o,s=[];t;){for(r=0,n=t.children.length;r<n;r++)if(a=t.children[r],c(e,o=t.leaf?i(a):a)){if(t.leaf||u(e,o))return!0;s.push(a)}t=s.pop()}return!1},load:function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var t=0,i=e.length;t<i;t++)this.insert(e[t]);return this}var r=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var n=this.data;this.data=r,r=n}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},insert:function(e){return e&&this._insert(e,this.data.height-1),this},clear:function(){return this.data=p([]),this},remove:function(e,t){if(!e)return this;for(var r,n,a,o,s=this.data,h=this.toBBox(e),l=[],c=[];s||l.length;){if(s||(s=l.pop(),n=l[l.length-1],r=c.pop(),o=!0),s.leaf&&-1!==(a=i(e,s.children,t)))return s.children.splice(a,1),l.push(s),this._condense(l),this;o||s.leaf||!u(s,h)?n?(r++,s=n.children[r],o=!1):s=null:(l.push(s),c.push(r),r=0,n=s,s=s.children[0])}return this},toBBox:function(e){return e},compareMinX:o,compareMinY:s,toJSON:function(){return this.data},fromJSON:function(e){return this.data=e,this},_all:function(e,t){for(var i=[];e;)e.leaf?t.push.apply(t,e.children):i.push.apply(i,e.children),e=i.pop();return t},_build:function(e,t,i,n){var a,o=i-t+1,s=this._maxEntries;if(o<=s)return r(a=p(e.slice(t,i+1)),this.toBBox),a;n||(n=Math.ceil(Math.log(o)/Math.log(s)),s=Math.ceil(o/Math.pow(s,n-1))),(a=p([])).leaf=!1,a.height=n;var h,l,u,c,f=Math.ceil(o/s),g=f*Math.ceil(Math.sqrt(s));for(d(e,t,i,g,this.compareMinX),h=t;h<=i;h+=g)for(d(e,h,u=Math.min(h+g-1,i),f,this.compareMinY),l=h;l<=u;l+=f)c=Math.min(l+f-1,u),a.children.push(this._build(e,l,c,n-1));return r(a,this.toBBox),a},_chooseSubtree:function(e,t,i,r){for(var n,a,o,s,l,u,c,p,d,f;r.push(t),!t.leaf&&r.length-1!==i;){for(c=p=1/0,n=0,a=t.children.length;n<a;n++)l=h(o=t.children[n]),d=e,f=o,(u=(Math.max(f.maxX,d.maxX)-Math.min(f.minX,d.minX))*(Math.max(f.maxY,d.maxY)-Math.min(f.minY,d.minY))-l)<p?(p=u,c=l<c?l:c,s=o):u===p&&l<c&&(c=l,s=o);t=s||t.children[0]}return t},_insert:function(e,t,i){var r=i?e:(0,this.toBBox)(e),n=[],o=this._chooseSubtree(r,this.data,t,n);for(o.children.push(e),a(o,r);t>=0&&n[t].children.length>this._maxEntries;)this._split(n,t),t--;this._adjustParentBBoxes(r,n,t)},_split:function(e,t){var i=e[t],n=i.children.length,a=this._minEntries;this._chooseSplitAxis(i,a,n);var o=this._chooseSplitIndex(i,a,n),s=p(i.children.splice(o,i.children.length-o));s.height=i.height,s.leaf=i.leaf,r(i,this.toBBox),r(s,this.toBBox),t?e[t-1].children.push(s):this._splitRoot(i,s)},_splitRoot:function(e,t){this.data=p([e,t]),this.data.height=e.height+1,this.data.leaf=!1,r(this.data,this.toBBox)},_chooseSplitIndex:function(e,t,i){var r,a,o,s,l,u,c,p,d,f,g,m,y,v;for(u=c=1/0,r=t;r<=i-t;r++)d=a=n(e,0,r,this.toBBox),f=o=n(e,r,i,this.toBBox),g=Math.max(d.minX,f.minX),m=Math.max(d.minY,f.minY),y=Math.min(d.maxX,f.maxX),v=Math.min(d.maxY,f.maxY),s=Math.max(0,y-g)*Math.max(0,v-m),l=h(a)+h(o),s<u?(u=s,p=r,c=l<c?l:c):s===u&&l<c&&(c=l,p=r);return p},_chooseSplitAxis:function(e,t,i){var r=e.leaf?this.compareMinX:o,n=e.leaf?this.compareMinY:s;this._allDistMargin(e,t,i,r)<this._allDistMargin(e,t,i,n)&&e.children.sort(r)},_allDistMargin:function(e,t,i,r){e.children.sort(r);var o,s,h=this.toBBox,u=n(e,0,t,h),c=n(e,i-t,i,h),p=l(u)+l(c);for(o=t;o<i-t;o++)s=e.children[o],a(u,e.leaf?h(s):s),p+=l(u);for(o=i-t-1;o>=t;o--)s=e.children[o],a(c,e.leaf?h(s):s),p+=l(c);return p},_adjustParentBBoxes:function(e,t,i){for(var r=i;r>=0;r--)a(t[r],e)},_condense:function(e){for(var t,i=e.length-1;i>=0;i--)0===e[i].children.length?i>0?(t=e[i-1].children).splice(t.indexOf(e[i]),1):this.clear():r(e[i],this.toBBox)},_initFormat:function(e){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(e[0])),this.compareMinY=new Function("a","b",t.join(e[1])),this.toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}},t}).apply(null,r))||(e.exports=n)},loiZ:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("SyoC")],void 0===(n=(function(e,t,i){var r=function(){function e(e,t){void 0===e&&(e=50),void 0===t&&(t=50),this._pool=new i(Map,null,(function(e){return e.clear()}),t,e)}return e.prototype.acquire=function(){return this._pool.acquire()},e.prototype.release=function(e){this._pool.release(e)},e.acquire=function(){return n.acquire()},e.release=function(e){return n.release(e)},e}(),n=new r(100);return r}).apply(null,r))||(e.exports=n)},vhZU:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("zOht"),i("Gtr7"),i("qMld"),i("afW+"),i("Vx27")],void 0===(n=(function(e,t,i,r,n,a,o){Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(t){var i=e.call(this,t)||this;return i._queue=new Map,i._queueArray=[],i._onGoingGraphic=null,i._onGoingPromise=null,i._scheduledNextHandle=null,i._next=i._next.bind(i),i._finalize=i._finalize.bind(i),i}return i.__extends(t,e),Object.defineProperty(t.prototype,"length",{get:function(){return this._queueArray.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updating",{get:function(){return this._queueArray.length>0||null!==this._onGoingPromise},enumerable:!0,configurable:!0}),t.prototype.cancel=function(e){if(this._onGoingGraphic&&this._onGoingGraphic.graphic===e&&(this._ongoingAbortController.abort(),this._onGoingGraphic=this._onGoingPromise=null),this._queue.has(e)){var t=this._queue.get(e);this._queue.delete(e);var i=this._queueArray.indexOf(t);this._queueArray.slice(i,1)}this._scheduleNext(),this.notifyChange("updating")},t.prototype.clear=function(){this._queue.clear(),this._queueArray.length=0,this._onGoingPromise&&(this._ongoingAbortController.abort(),this._onGoingGraphic=this._onGoingPromise=null),this._cancelNext(),this.notifyChange("updating")},t.prototype.has=function(e){return this._queue.has(e)},t.prototype.isOngoing=function(e){return this._onGoingGraphic&&this._onGoingGraphic.graphic===e},t.prototype.push=function(e,t){if(!this._queue.has(e)){var i={graphic:e,addOrUpdate:t};this._queueArray.push(i),this._queue.set(e,i),this._scheduleNext(),this.notifyChange("updating")}},t.prototype.refresh=function(){this.reset()},t.prototype.reset=function(){var e=this._onGoingGraphic;e&&this.push(e.graphic,e.addOrUpdate)},t.prototype._finalize=function(){this._onGoingGraphic=null,this._ongoingAbortController=null,this._onGoingPromise=null,this.notifyChange("updating"),this._scheduleNext()},t.prototype._cancelNext=function(){this._scheduledNextHandle&&(this._scheduledNextHandle.remove(),this._scheduledNextHandle=null)},t.prototype._scheduleNext=function(){this._scheduledNextHandle||0===this._queue.size||null!=this._onGoingGraphic||(this._scheduledNextHandle=a.schedule(this._next))},t.prototype._next=function(){if(null==this._scheduledNextHandle||0===this._queue.size||this._onGoingGraphic)this._scheduledNextHandle=null;else{this._scheduledNextHandle=null;var e=this._peek(),t=e.graphic,i=e.addOrUpdate,r=n.createAbortController();this._queue.delete(t),this._onGoingGraphic=e,this._onGoingPromise=this.process(t,i,{signal:r.signal}),this._ongoingAbortController=r,this._onGoingPromise.then(this._finalize,this._finalize),this.notifyChange("updating")}},t.prototype._peek=function(){return 0===this._queueArray.length?null:this._queueArray.pop()},i.__decorate([o.property({readOnly:!0})],t.prototype,"length",null),i.__decorate([o.property({readOnly:!0})],t.prototype,"updating",null),i.__decorate([o.property({constructOnly:!0})],t.prototype,"process",void 0),i.__decorate([o.subclass("esri.views.2d.layers.graphics.GraphicProcessingQueue")],t)}(r);t.default=s}).apply(null,r))||(e.exports=n)},wjMf:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("LxLY"),i("jBNx"),i("aMdW"),i("Zx0K"),i("W9tT"),i("ab6c"),i("Z4y+"),i("lRq4"),i("hBh5"),i("Thzy"),i("Lzvl"),i("fw2w"),i("nrlZ"),i("nrlZ"),i("YaB4"),i("YaB4")],void 0===(n=(function(e,t,i,r,n,a,o,s,h,l,u,c,p,d,f,g,m,y){Object.defineProperty(t,"__esModule",{value:!0});var v=Math.PI/180,_=a.mat2df32.create(),x=s.vec2f32.create(),b=l.create();t.getBounds=function(e,t,i,r,n,a,o){if(!r||!i.symbol)return e[0]=e[1]=e[2]=e[3]=0,t[0]=t[1]=t[2]=t[3]=0,e;var s=r;if(!p.isPoint(s)){u.getBoundsXY(e,s);var h=t[0];0===h&&(h=function(e){var t=0;switch(e.symbol.type){case"simple-fill":case"picture-fill":var i=e.symbol.outline;if(!i)return 0;t=i.width;break;case"simple-line":t=e.symbol.width;break;case"simple-marker":t=e.symbol.size;break;case"picture-marker":t=Math.max(e.symbol.width,e.symbol.height);break;case"text":var r=[0,0,0,0];C(r,e.symbol,e.mosaicItem);var n=Math.max(Math.abs(r[0]),Math.abs(r[1]));t=Math.max(r[2],r[3])+n;break;case"cim":case"expanded-cim":var a=m.CIMSymbolHelper.getEnvelope(e.symbol.data);t=Math.sqrt(a.width*a.width+a.height*a.height)}return t}(i),t[0]=h);var l=n*h/2;return e[0]-=l,e[1]-=l,e[2]+=l,e[3]+=l,e}var c=s.x,f=s.y;return"text"===i.symbol.type&&0===t[2]&&0===t[3]&&C(t,i.symbol,i.mosaicItem),function(e,t,i,r,n,a,o,s){var h;switch(r.type){case"simple-marker":case"picture-marker":h=B(t,i,r,a,o,0);break;case"text":h=z(t,i,r,n,a,0);break;case"cim":case"expanded-cim":h=O(t,i,r,a,o,0)}for(var l,u=0,c=0;c<h.rings[0].length-1;c++)l=h.rings[0][c],u=Math.max(u,(t-l[0])*(t-l[0])+(i-l[1])*(i-l[1]));u=Math.sqrt(u);var p=d.normalizeMapX(t-u,s),f=d.normalizeMapX(t+u,s);if(p>f){var m=g.getInfo(s);if(m){var y=m.valid;p=y[0],f=y[1]}}e[0]=p,e[1]=i-u,e[2]=f,e[3]=i+u}(e,c,f,i.symbol,t,n,a,o),e},t.isMarkerSymbol=function(e){return"simple-marker"===e||"picture-marker"===e||"text"===e},t.graphicGeometryToNumber=function(e){switch(i.unwrap(e.geometry).type){case"point":case"multipoint":return 0;case"polyline":return 1;case"polygon":case"extent":return 2}return 0};var w=s.vec2f32.create(),M=s.vec2f32.create(),G=s.vec2f32.create(),S=s.vec2f32.create(),I=s.vec2f32.create(),P=s.vec2f32.create(),T=s.vec2f32.create();function B(e,t,i,a,s,h){var l,u,c=r.pt2px(i.xoffset),p=r.pt2px(i.yoffset),d=v*i.angle,f=v*h;switch(i.type){case"simple-marker":l=u=r.pt2px(i.size);break;case"picture-marker":var g=i;l=r.pt2px(g.width),u=r.pt2px(g.height)}s<.04&&(a=.04*a/s);var m=n.mat2d.identity(_);n.mat2d.translate(m,m,o.vec2.set(x,e,t)),n.mat2d.rotate(m,m,f-d),n.mat2d.scale(m,m,o.vec2.set(x,a,-a)),n.mat2d.translate(m,m,o.vec2.set(x,c,-p));var y=[0,0];o.vec2.transformMat2d(y,o.vec2.set(x,-.5*l,-.5*u),m);var b=[0,0];o.vec2.transformMat2d(b,o.vec2.set(x,-.5*l,.5*u),m);var w=[0,0];o.vec2.transformMat2d(w,o.vec2.set(x,.5*l,-.5*u),m);var M=[0,0];return o.vec2.transformMat2d(M,o.vec2.set(x,.5*l,.5*u),m),{rings:[[y,w,M,b,y]]}}function O(e,t,i,a,s,h){var l=m.CIMSymbolHelper.getEnvelope(i.data);if(!l)return null;s<.04&&(a=.04*a/s);var u=r.pt2px(l.width),c=r.pt2px(l.height),p=r.pt2px(l.x),d=r.pt2px(l.y),f=0*v,g=v*h,y=n.mat2d.identity(_);n.mat2d.translate(y,y,o.vec2.set(x,e,t)),n.mat2d.rotate(y,y,g-f),n.mat2d.scale(y,y,o.vec2.set(x,a,a));var b=[0,0];o.vec2.transformMat2d(b,o.vec2.set(x,p,d+c),y);var w=[0,0];o.vec2.transformMat2d(w,o.vec2.set(x,p,d),y);var M=[0,0];o.vec2.transformMat2d(M,o.vec2.set(x,p+u,d+c),y);var G=[0,0];return o.vec2.transformMat2d(G,o.vec2.set(x,p+u,d),y),{rings:[[b,M,G,w,b]]}}function z(e,t,i,a,s,h){var l=r.pt2px(i.xoffset),u=r.pt2px(i.yoffset),c=v*i.angle,p=v*h,d=n.mat2d.identity(_);n.mat2d.translate(d,d,o.vec2.set(x,e,t)),n.mat2d.rotate(d,d,p),n.mat2d.scale(d,d,o.vec2.set(x,s,-s));var f=a[0]+a[2]/2,g=a[1]+a[3]/2;n.mat2d.translate(d,d,o.vec2.set(x,l,-u)),n.mat2d.translate(d,d,o.vec2.set(x,f,g)),n.mat2d.rotate(d,d,c),n.mat2d.translate(d,d,o.vec2.set(x,-f,-g));var m=[0,0];o.vec2.transformMat2d(m,o.vec2.set(x,a[0],a[1]),d);var y=[0,0];o.vec2.transformMat2d(y,o.vec2.set(x,a[0],a[1]+a[3]),d);var b=[0,0];o.vec2.transformMat2d(b,o.vec2.set(x,a[0]+a[2],a[1]),d);var w=[0,0];return o.vec2.transformMat2d(w,o.vec2.set(x,a[0]+a[2],a[1]+a[3]),d),{rings:[[m,b,w,y,m]]}}function C(e,t,i){if(!i||0===i.glyphMosaicItems.length)return e;var n=m.bidiText(t.text)[1],a=y.shapeGlyphs(i.glyphMosaicItems,n,{scale:r.pt2px(t.font.size)/24,angle:t.angle,xOffset:t.xoffset,yOffset:t.yoffset,hAlign:y.alignmentUtils.getXAnchorDirection(t.horizontalAlignment||"center"),vAlign:y.alignmentUtils.getYAnchorDirection(t.verticalAlignment||"baseline"),maxLineWidth:Math.max(32,Math.min(t.lineWidth||512,512)),lineHeight:30*Math.max(.25,Math.min(t.lineHeight||1,4)),decoration:t.font.decoration||"none",isCIM:!1}).bounds;return e[0]=a.x-a.halfWidth,e[1]=a.y-a.halfHeight,e[2]=a.width,e[3]=a.height,e}t.isPointOnPolyline=function(e,t,i,r){o.vec2.set(G,t,i);for(var n,a,s,h,l,u,c,p,d,f=e.paths,g=1/0,m=0;m<f.length;m++){var y=f[m];if(!(y.length<2))for(var v=1;v<y.length;v++)n=y[v-1][0],s=y[v-1][1],a=y[v][0],h=y[v][1],l=Math.min(n,a)-r,u=Math.min(s,h)-r,c=Math.max(n,a)+r,p=Math.max(s,h)+r,t<l||t>c||i<u||i>p||(o.vec2.set(w,n,s),o.vec2.set(M,a,h),o.vec2.subtract(S,M,w),o.vec2.subtract(I,w,G),o.vec2.scale(P,S,o.vec2.dot(S,I)/o.vec2.dot(S,S)),o.vec2.subtract(T,I,P),g>(d=o.vec2.dot(T,T))&&(g=d))}return Math.sqrt(g)<=r},t.getMarkerSymbolBounds=B,t.getCIMMarkerBounds=O,t.getTextSymbolBounds=z,t.normalizeCentralMeridian=function(e){var t,i,r,n,a,o,s,h,l=null;if(!e)return null;if("mesh"===e.type)return e.toJSON();if(!(i=f.getInfo(t=e.spatialReference)))return e.toJSON();r=k[a=t.isWebMercator?102100:4326].maxX,n=k[a].minX,o=k[a].plus180Line,s=k[a].minus180Line;var d=e.toJSON();if(p.isPoint(d))h=A(d,r,n);else if(p.isMultipoint(d))d.points=d.points.map((function(e){return A(e,r,n)})),h=d;else if(p.isExtent(d))h=function(e,t){if(!t)return e;var i=function(e,t){var i,r=[],n=e.ymin,a=e.ymax,o=e.xmax-e.xmin,s=e.xmin,h=e.xmax,l=t.valid,u=l[0],c=l[1],p=(i=U(e.xmin,t)).x,d=i.frameId,f=(i=U(e.xmax,t)).x,g=i.frameId,m=p===f&&o>0;if(o>2*c){var y={xmin:s<h?p:f,ymin:n,xmax:c,ymax:a},v={xmin:u,ymin:n,xmax:s<h?f:p,ymax:a},_={xmin:0,ymin:n,xmax:c,ymax:a},x={xmin:u,ymin:n,xmax:0,ymax:a},b=[],w=[];j(y,_)&&b.push(d),j(y,x)&&w.push(d),j(v,_)&&b.push(g),j(v,x)&&w.push(g);for(var M=d+1;M<g;M++)b.push(M),w.push(M);r.push({extent:y,frameIds:[d]},{extent:v,frameIds:[g]},{extent:_,frameIds:b},{extent:x,frameIds:w})}else p>f||m?r.push({extent:{xmin:p,ymin:n,xmax:c,ymax:a},frameIds:[d]},{extent:{xmin:u,ymin:n,xmax:f,ymax:a},frameIds:[g]}):r.push({extent:{xmin:p,ymin:n,xmax:f,ymax:a},frameIds:[d]});return r}(e,t).map((function(e){return e.extent}));return i.length<2?i[0]||e:i.length>2?(e.xmin=t.valid[0],e.xmax=t.valid[1],e):{rings:i.map((function(e){return[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]}))}}(d,i);else if(p.isPolygon(d)||p.isPolyline(d)){var g=b;u.getBoundsXY(g,d);var m={xmin:g[0],ymin:g[1],xmax:g[2],ymax:g[3]},y=q(m.xmin,n)*(2*r),v=0===y?d:function(e,t){for(var i=0,r=function(e){return p.isPolygon(e)?e.rings:e.paths}(e);i<r.length;i++)for(var n=0,a=r[i];n<a.length;n++)a[n][0]+=t;return e}(d,y);m.xmin+=y,m.xmax+=y,c.extentIntersectsPolyline(m,o)&&m.xmax!==r||c.extentIntersectsPolyline(m,s)&&m.xmin!==n?l=v:h=v}else h=e.clone();return null!==l?(new X).cut(l,r):h},t.getTextSymbolSize=C;var k={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:{paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:h.WebMercator},minus180Line:{paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:h.WebMercator}},4326:{maxX:180,minX:-180,plus180Line:{paths:[[[180,-180],[180,180]]],spatialReference:h.WGS84},minus180Line:{paths:[[[-180,-180],[-180,180]]],spatialReference:h.WGS84}}};function q(e,t){return Math.ceil((e-t)/(2*t))}function U(e,t){var i,r=t.valid,n=r[0],a=r[1],o=2*a,s=0;return e>a?(e-=(i=Math.ceil(Math.abs(e-a)/o))*o,s=i):e<n&&(e+=(i=Math.ceil(Math.abs(e-n)/o))*o,s=-i),{x:e,frameId:s}}function j(e,t){var i=t.xmin,r=t.ymin,n=t.xmax,a=t.ymax;return R(e,i,r)&&R(e,i,a)&&R(e,n,a)&&R(e,n,r)}function R(e,t,i){return t>=e.xmin&&t<=e.xmax&&i>=e.ymin&&i<=e.ymax}function A(e,t,i){var r;if(Array.isArray(e))if((r=e[0])>t){var n=q(r,t);e[0]=r+n*(-2*t)}else r<i&&(n=q(r,i),e[0]=r+n*(-2*i));else(r=e.x)>t?(n=q(r,t),e.x+=n*(-2*t)):r<i&&(n=q(r,i),e.x+=n*(-2*i));return e}var X=function(){function e(){}return e.prototype.cut=function(e,t){var i;if(e.rings)this.closed=!0,i=e.rings,this.minPts=4;else{if(!e.paths)return null;this.closed=!1,i=e.paths,this.minPts=2}for(var r=i.length,n=-2*t,a=0;a<r;a++){var o=i[a];if(o&&o.length>=this.minPts){for(var s=[],h=0,l=o;h<l.length;h++){var u=l[h];s.push([u[0]+n,u[1]])}i.push(s)}}return this.closed?e.rings=i:e.paths=i,e},e}()}).apply(null,r))||(e.exports=n)},zRH3:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i("zOht"),i("Vx27")],void 0===(n=(function(e,t,i,r){Object.defineProperty(t,"__esModule",{value:!0}),t.GraphicsView=function(e){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.graphics=null,t.renderer=null,t.view=null,t}return i.__extends(t,e),i.__decorate([r.property()],t.prototype,"graphics",void 0),i.__decorate([r.property()],t.prototype,"renderer",void 0),i.__decorate([r.property()],t.prototype,"updating",void 0),i.__decorate([r.property()],t.prototype,"view",void 0),i.__decorate([r.subclass("esri.views.layers.GraphicsView")],t)}(e)}}).apply(null,r))||(e.exports=n)}}]);