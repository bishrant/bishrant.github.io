(function(){var e={"arcgis-js-api/arcade/featureset/sources/Empty":"20W2","arcgis-js-api/arcade/featureset/support/FeatureSet":"88sq","arcgis-js-api/arcade/featureset/support/stats":"PMeB","arcgis-js-api/arcade/featureset/support/IdSet":"Q4uJ","arcgis-js-api/arcade/featureset/support/sqlUtils":"SqzB","arcgis-js-api/arcade/featureset/actions/SpatialFilter":"VM5u","arcgis-js-api/geometry/geometryEngineAsync":"wfTL","arcgis-js-api/arcade/featureset/support/cache":"x/o6","arcgis-js-api/arcade/featureset/support/FeatureSetIterator":"ydXo"},t=this||window,r=t.webpackJsonp=t.webpackJsonp||[];r.registerAbsMids?r.registerAbsMids(e):(r.absMidsWaiting=r.absMidsWaiting||[]).push(e)})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{"20W2":function(e,t,r){var n,a;n=[r.dj.c(e.i),t,r("zOht"),r("88sq"),r("Q4uJ"),r("tq6K"),r("qMld")],void 0===(a=(function(e,t,r,n,a,i,s){"use strict";return function(e){function t(t){var r=e.call(this,t)||this;return r.declaredClass="esri.layers.featureset.sources.Empty",r._maxProcessing=1e3,r._wset=new a([],[],!1,null),r._parent=t.parentfeatureset,r._databaseType=i.FeatureServiceDatabaseType.Standardised,r}return r.__extends(t,e),t.prototype._getSet=function(){return s.resolve(this._wset)},t.prototype.optimisePagingFeatureQueries=function(){},t.prototype._isInFeatureSet=function(){return i.IdState.NotInFeatureSet},t.prototype._getFeature=function(){return s.reject(new Error("No Feature Found in EmptySet"))},t.prototype.queryAttachments=function(){return s.resolve([])},t.prototype._getFeatures=function(){return s.resolve("success")},t.prototype._featureFromCache=function(){return null},t.prototype._fetchAndRefineFeatures=function(){return s.reject(new Error("Fetch and Refine should not be called in this featureset"))},t.prototype._getFilteredSet=function(){return s.resolve(new a([],[],!1,null))},t.prototype._stat=function(e,t,r,n,a,i,s){return this._manualStat(e,t,i,s)},t.prototype._canDoAggregates=function(){return s.resolve(!1)},t}(n)}).apply(null,n))||(e.exports=a)},"88sq":function(e,t,r){var n,a;n=[r.dj.c(e.i),t,r("ydXo"),r("Q4uJ"),r("tq6K"),r("x/o6"),r("PMeB"),r("qMld"),r("1eyA"),r("wfTL"),r("Z4y+"),r("I90O")],void 0===(a=(function(e,t,r,n,a,i,s,o,u,c,l,p){"use strict";return function(){function e(e){this.recentlyUsedQueries=null,this._idstates=[],this._parent=null,this._wset=null,this._mainSetInUse=null,this._maxProcessing=200,this._maxQuery=500,this._totalCount=-1,this._databaseType=a.FeatureServiceDatabaseType.NotEvaluated,this._databaseTypeProbed=null,this.declaredRootClass="esri.arcade.featureset.support.FeatureSet",this._featureCache=[],this.types=null,this.fields=null,this.geometryType="",this.objectIdField="",this.spatialReference=null,this.hasM=!1,this.hasZ=!1,this._transparent=!1,this.loaded=!1,this._loadPromise=null,this._fieldsIndex=null,e&&e.lrucache&&(this.recentlyUsedQueries=e.lrucache)}return e.prototype.optimisePagingFeatureQueries=function(e){this._parent&&this._parent.optimisePagingFeatureQueries(e)},e.prototype._hasMemorySource=function(){return!0},e.prototype.prop=function(e,t){return void 0===t?this[e]:(void 0!==this[e]&&(this[e]=t),this)},e.prototype.end=function(){return null!==this._parent&&!0===this._parent._transparent?this._parent.end():this._parent},e.prototype._ensureLoaded=function(){return this.load()},e.prototype.load=function(){var e=this;return null===this._loadPromise&&(this._loadPromise=o.create((function(t,r){if(!0===e._parent.loaded)return e._initialiseFeatureSet(),void t(e);e._parent.load().then((function(){try{e._initialiseFeatureSet(),t(e)}catch(e){r(e)}}),r)}))),this._loadPromise},e.prototype._initialiseFeatureSet=function(){null!==this._parent?(this.fields=this._parent.fields.slice(0),this.geometryType=this._parent.geometryType,this.objectIdField=this._parent.objectIdField,this.spatialReference=this._parent.spatialReference,this.hasM=this._parent.hasM,this.hasZ=this._parent.hasZ,this.typeIdField=this._parent.typeIdField,this.types=this._parent.types):(this.fields=[],this.typeIdField="",this.objectIdField="",this.spatialReference=new l({wkid:4326}),this.geometryType=a.layerGeometryEsriConstants.point)},e.prototype.getField=function(e,t){var r;return(t=t||this.fields)&&(e=e.toLowerCase(),t.some((function(t){return t&&t.name.toLowerCase()===e&&(r=t),!!r}))),r},e.prototype.getFieldsIndex=function(){return null===this._fieldsIndex&&(this._fieldsIndex=new p(this.fields)),this._fieldsIndex},e.prototype._maxProcessingRate=function(){return null!==this._parent?Math.min(this._maxProcessing,this._parent._maxProcessingRate()):Math.min(this._maxProcessing,this._maxQueryRate())},e.prototype._maxQueryRate=function(){return null!==this._parent?Math.max(this._maxQuery,this._parent._maxQueryRate()):this._maxQuery},e.prototype._checkCancelled=function(e){if(null!==e&&e.aborted)throw new Error("Operation has been cancelled.")},e.prototype.nativeCapabilities=function(){return this._parent.nativeCapabilities()},e.prototype._canDoAggregates=function(e,t,r,n,a){return null===this._parent?o.resolve(!1):this._parent._canDoAggregates(e,t,r,n,a)},e.prototype._getAggregatePagesDataSourceDefinition=function(e,t,r,n,a,i,s){return null===this._parent?o.reject(new Error("Should never be called")):this._parent._getAggregatePagesDataSourceDefinition(e,t,r,n,a,i,s)},e.prototype._getAgregagtePhysicalPage=function(e,t,r){return null===this._parent?o.reject(new Error("Should never be called")):this._parent._getAgregagtePhysicalPage(e,t,r)},e.prototype.databaseType=function(){var e=this;if(this._databaseType===a.FeatureServiceDatabaseType.NotEvaluated){if(null!==i.applicationCache){var t=i.applicationCache.getDatabaseType(this._cacheableFeatureSetSourceKey());if(null!==t)return t}if(null!==this._databaseTypeProbed)return this._databaseTypeProbed;var r=[{thetype:a.FeatureServiceDatabaseType.SqlServer,testwhere:"(CAST( '2015-01-01' as DATETIME) = CAST( '2015-01-01' as DATETIME)) AND OBJECTID<0"},{thetype:a.FeatureServiceDatabaseType.Oracle,testwhere:"(TO_DATE('2003-11-18','YYYY-MM-DD') = TO_DATE('2003-11-18','YYYY-MM-DD')) AND OBJECTID<0"},{thetype:a.FeatureServiceDatabaseType.StandardisedNoInterval,testwhere:"(date '2015-01-01 10:10:10' = date '2015-01-01 10:10:10') AND OBJECTID<0"}],n=o.create((function(t,n){e._getDatabaseTypeImpl(r,0).then((function(r){e._databaseType=r,t(e._databaseType)}),(function(e){n(e)}))}));return null!==i.applicationCache&&(i.applicationCache.setDatabaseType(this._cacheableFeatureSetSourceKey(),n),n=n.catch((function(t){throw i.applicationCache.clearDatabaseType(e._cacheableFeatureSetSourceKey()),t}))),this._databaseTypeProbed=n,this._databaseTypeProbed}return o.resolve(this._databaseType)},e.prototype._cacheableFeatureSetSourceKey=function(){return"MUSTBESET"},e.prototype._getDatabaseTypeImpl=function(e,t){var r=this;return t>=e.length?o.resolve(a.FeatureServiceDatabaseType.StandardisedNoInterval):this._runDatabaseProbe(e[t].testwhere).then((function(n){return!0===n?e[t].thetype:r._getDatabaseTypeImpl(e,t+1)}))},e.prototype._runDatabaseProbe=function(e){return null!==this._parent?this._parent._runDatabaseProbe(e):o.reject(new Error("Not Implemented"))},e.prototype.isTable=function(){return this._parent.isTable()},e.prototype._featureFromCache=function(e){if(void 0!==this._featureCache[e])return this._featureCache[e]},e.prototype._isInFeatureSet=function(e){return a.IdState.Unknown},e.prototype._getSet=function(e){throw new Error("Not implemented in abstract class")},e.prototype._getFeature=function(e,t,r){var n=this;try{return this._checkCancelled(r),void 0!==this._featureFromCache(t)?o.resolve(this._featureFromCache(t)):this._getFeatures(e,t,this._maxProcessingRate(),r).then((function(){return n._checkCancelled(r),void 0!==n._featureFromCache(t)?n._featureFromCache(t):o.reject(new Error("Feature Not Found"))}))}catch(e){return o.reject(e)}},e.prototype._getFeatureBatch=function(e,t){var r=this;try{this._checkCancelled(t);var a=new n([],e,!1,null),i=[];return this._getFeatures(a,-1,e.length,t).then((function(){r._checkCancelled(t);for(var n=0,a=e;n<a.length;n++){var s=a[n];void 0!==r._featureFromCache(s)&&i.push(r._featureFromCache(s))}return i}))}catch(e){return o.reject(e)}},e.prototype._getFeatures=function(e,t,r,n){return o.resolve("success")},e.prototype._getFilteredSet=function(e,t,r,n,a){throw new Error("Not implemented in abstract class")},e.prototype._refineSetBlock=function(e,t,r){var n=this;try{if(!0===this._checkIfNeedToExpandCandidatePage(e,this._maxQueryRate()))return this._expandPagedSet(e,this._maxQueryRate(),0,0,r).then((function(){return n._refineSetBlock(e,t,r)}));this._checkCancelled(r);var a=e._candidates.length;this._refineKnowns(e,t);var i=a-e._candidates.length;return 0===e._candidates.length||i>=t?o.resolve(e):this._refineIfParentKnown(e,t-i,r).then((function(){if(n._checkCancelled(r),n._refineKnowns(e,t-i),(i=a-e._candidates.length)<t&&e._candidates.length>0){var s=t-i,o=n._prepareFetchAndRefineSet(e._candidates);return n._fetchAndRefineFeatures(o,o.length>s?s:e._candidates.length,r).then((function(){return n._checkCancelled(r),n._refineKnowns(e,t-i),e}))}return e}))}catch(e){return o.reject(e)}},e.prototype._fetchAndRefineFeatures=function(e,t,r){return null},e.prototype._prepareFetchAndRefineSet=function(e){for(var t=[],r=0;r<e.length;r++)this._isPhysicalFeature(e[r])&&t.push(e[r]);return t},e.prototype._isPhysicalFeature=function(e){return null===this._parent||this._parent._isPhysicalFeature(e)},e.prototype._refineKnowns=function(e,t){var r=0,n=null,i=[];t=this._maxQueryRate();for(var s=0;s<e._candidates.length&&"GETPAGES"!==e._candidates[s];s++){var o=!1,u=this._candidateIdTransform(e._candidates[s]);u!==e._candidates[s]&&(o=!0);var c=this._isInFeatureSet(u);if(c===a.IdState.InFeatureSet)!0===o?e._known.indexOf(u)<0&&(e._known.push(u),r+=1):(e._known.push(e._candidates[s]),r+=1),null===n?n={start:s,end:s}:n.end===s-1?n.end=s:(i.push(n),n={start:s,end:s});else if(c===a.IdState.NotInFeatureSet)null===n?n={start:s,end:s}:n.end===s-1?n.end=s:(i.push(n),n={start:s,end:s}),r+=1;else if(c===a.IdState.Unknown&&(r+=1,!0===e._ordered))break;if(r>=t)break}null!==n&&i.push(n);for(var l=i.length-1;l>=0;l--)e._candidates.splice(i[l].start,i[l].end-i[l].start+1)},e.prototype._refineIfParentKnown=function(e,t,r){var a=new n([],[],e._ordered,null);return a._candidates=e._candidates.slice(0),this._parent._refineSetBlock(a,t,r)},e.prototype._candidateIdTransform=function(e){return this._parent._candidateIdTransform(e)},e.prototype._checkIfNeedToExpandKnownPage=function(e,t){if(null===e.pagesDefinition)return!1;for(var r=0,n=e._lastFetchedIndex;n<e._known.length;n++){if("GETPAGES"===e._known[n])return!0;if(void 0===this._featureCache[e._known[n]]&&(r+=1)>=t)break}return!1},e.prototype._checkIfNeedToExpandCandidatePage=function(e,t){if(null===e.pagesDefinition)return!1;for(var r=0,n=0;n<e._candidates.length;n++){if("GETPAGES"===e._candidates[n])return!0;if((r+=1)>=t)break}return!1},e.prototype._expandPagedSet=function(e,t,r,n,a){return null===this._parent?o.reject(new Error("Parent Paging not implemented")):this._parent._expandPagedSet(e,t,r,n,a)},e.prototype._expandPagedSetFeatureSet=function(e,t,r,n,a){var i=this;return e._known.length>0&&"GETPAGES"===e._known[e._known.length-1]&&(n=1),0===n&&e._candidates.length>0&&"GETPAGES"===e._candidates[e._candidates.length-1]&&(n=2),0===n?o.resolve("finished"):this._getPage(e,n,a).then((function(n){return r+n<t?i._expandPagedSet(e,t,r+n,0,a):"success"}))},e.prototype._getPage=function(e,t,r){var n=this,a=1===t?e._known:e._candidates;if(e.pagesDefinition.internal.set.length>e.pagesDefinition.resultOffset||!0===e.pagesDefinition.internal.fullyResolved){a.length=a.length-1;for(var i=0,s=0;s<e.pagesDefinition.resultRecordCount&&!(e.pagesDefinition.resultOffset+s>=e.pagesDefinition.internal.set.length);s++)a[a.length]=e.pagesDefinition.internal.set[e.pagesDefinition.resultOffset+s],i++;e.pagesDefinition.resultOffset+=i;var u=!1;return!0===e.pagesDefinition.internal.fullyResolved&&e.pagesDefinition.internal.set.length<=e.pagesDefinition.resultOffset&&(u=!0),!1===u&&a.push("GETPAGES"),o.resolve(i)}return this._getPhysicalPage(e,t,r).then((function(){return n._getPage(e,t,r)}))},e.prototype._getPhysicalPage=function(e,t,r){return null},e.prototype._clonePageDefinition=function(e){return null===this._parent?null:this._parent._clonePageDefinition(e)},e.prototype._first=function(e){return this.iterator(e).next()},e.prototype.first=function(e){return this._first(e)},e.prototype.calculateStatistic=function(e,t,r,n){var a=this;return this._ensureLoaded().then((function(){return a._stat(e,t,"",null,null,r,n).then((function(i){return!1===i.calculated?a._manualStat(e,t,r,n).then((function(e){return e.result})):i.result}))}))},e.prototype._manualStat=function(e,t,r,n){switch(e.toLowerCase()){case"count":return s.count(this,n).then((function(e){return{calculated:!0,result:e}}));case"distinct":return s.distinct(this,t,r).then((function(e){return{calculated:!0,result:e}}));case"avg":case"mean":return s.mean(this,t,n).then((function(e){return{calculated:!0,result:e}}));case"stdev":return s.stdev(this,t,n).then((function(e){return{calculated:!0,result:e}}));case"variance":return s.variance(this,t,n).then((function(e){return{calculated:!0,result:e}}));case"sum":return s.sum(this,t,n).then((function(e){return{calculated:!0,result:e}}));case"min":return s.min(this,t,n).then((function(e){return{calculated:!0,result:e}}));case"max":return s.max(this,t,n).then((function(e){return{calculated:!0,result:e}}));default:return o.resolve({calculated:!0,result:0})}},e.prototype._stat=function(e,t,r,n,a,i,s){var o=this;return this._parent._stat(e,t,r,n,a,i,s).then((function(u){return!1===u.calculated?null===a&&""===r&&null===n?o._manualStat(e,t,i,s):{calculated:!1}:u}))},e.prototype._unionAllGeomSelf=function(e){var t=this,r=this.iterator(this._defaultTracker(e)),n=[];return o.create((function(e,a){t._unionShapeInBatches(n,r,e,a)}))},e.prototype._unionAllGeom=function(e){var t=this;return o.create((function(r,n){var a=t.iterator(t._defaultTracker(e));t._unionShapeInBatches([],a,r,n)}))},e.prototype._unionShapeInBatches=function(e,t,r,n){var a=this;t.next().then((function(i){try{null!==i&&null!==i.geometry&&e.push(i.geometry),e.length>30||null===i&&e.length>1?c.union(e).then((function(s){try{null===i?r(s):a._unionShapeInBatches(e=[s],t,r,n)}catch(e){n(e)}}),n):null===i?r(1===e.length?e[0]:null):a._unionShapeInBatches(e,t,r,n)}catch(e){n(e)}}),n)},e.prototype.iterator=function(e){return new r(this,e)},e.prototype.intersection=function(t,r){return void 0===r&&(r=!1),e._featuresetFunctions.intersection.bind(this)(t,r)},e.prototype.difference=function(t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=!0),e._featuresetFunctions.difference.bind(this)(t,r,n)},e.prototype.symmetricDifference=function(t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=!0),e._featuresetFunctions.symmetricDifference.bind(this)(t,r,n)},e.prototype.morphShape=function(t,r,n,a){return void 0===n&&(n="unknown"),void 0===a&&(a=null),e._featuresetFunctions.morphShape.bind(this)(t,r,n,a)},e.prototype.morphShapeAndAttributes=function(t,r,n){return void 0===n&&(n="unknown"),e._featuresetFunctions.morphShapeAndAttributes.bind(this)(t,r,n)},e.prototype.union=function(t,r){return void 0===r&&(r=!1),e._featuresetFunctions.union.bind(this)(t,r)},e.prototype.intersects=function(t){return e._featuresetFunctions.intersects.bind(this)(t)},e.prototype.envelopeIntersects=function(t){return e._featuresetFunctions.envelopeIntersects.bind(this)(t)},e.prototype.contains=function(t){return e._featuresetFunctions.contains.bind(this)(t)},e.prototype.overlaps=function(t){return e._featuresetFunctions.overlaps.bind(this)(t)},e.prototype.relate=function(t,r){return e._featuresetFunctions.relate.bind(this)(t,r)},e.prototype.within=function(t){return e._featuresetFunctions.within.bind(this)(t)},e.prototype.touches=function(t){return e._featuresetFunctions.touches.bind(this)(t)},e.prototype.top=function(t){return e._featuresetFunctions.top.bind(this)(t)},e.prototype.crosses=function(t){return e._featuresetFunctions.crosses.bind(this)(t)},e.prototype.buffer=function(t,r,n,a){return void 0===a&&(a=!0),e._featuresetFunctions.buffer.bind(this)(t,r,n,a)},e.prototype.filter=function(t,r){return void 0===r&&(r=null),e._featuresetFunctions.filter.bind(this)(t,r)},e.prototype.orderBy=function(t){return e._featuresetFunctions.orderBy.bind(this)(t)},e.prototype.dissolve=function(t,r){return e._featuresetFunctions.dissolve.bind(this)(t,r)},e.prototype.groupby=function(t,r){return e._featuresetFunctions.groupby.bind(this)(t,r)},e.prototype.reduce=function(e,t,r){var n=this;return void 0===t&&(t=null),o.create((function(a,i){n._reduceImpl(n.iterator(n._defaultTracker(r)),e,t,0,a,i,0)}))},e.prototype._reduceImpl=function(e,t,r,n,a,i,s){var u=this;try{if(++s>1e3)return void setTimeout((function(){u._reduceImpl(e,t,r,n,a,i,s=0)}));e.next().then((function(c){try{if(null===c)a(r);else{var l=t(r,c,n,u);o.isPromiseLike(l)?l.then((function(r){u._reduceImpl(e,t,r,n+1,a,i,s)}),i):u._reduceImpl(e,t,l,n+1,a,i,s)}}catch(e){i(e)}}),i)}catch(e){i(e)}},e.prototype.removeField=function(t){return e._featuresetFunctions.removeField.bind(this)(t)},e.prototype.addField=function(t,r,n){return void 0===n&&(n=null),e._featuresetFunctions.addField.bind(this)(t,r,n)},e.prototype.sumArea=function(e,t,r){void 0===t&&(t=!1);var n=a.convertSquareUnitsToCode(e);return this.reduce((function(e,r){return null===r.geometry?0:t?c.geodesicArea(r.geometry,n).then((function(t){return e+t})):c.planarArea(r.geometry,n).then((function(t){return e+t}))}),0,r)},e.prototype.sumLength=function(e,t,r){void 0===t&&(t=!1);var n=a.convertLinearUnitsToCode(e);return this.reduce((function(e,r){return null===r.geometry?0:t?c.geodesicLength(r.geometry,n).then((function(t){return e+t})):c.planarLength(r.geometry,n).then((function(t){return e+t}))}),0,r)},e.prototype._substituteVars=function(e,t){if(null!==t){var r={};for(var n in t)r[n.toLowerCase()]=t[n];e.parameters=r}},e.prototype.distinct=function(e,t,r,n){var a=this;return void 0===t&&(t=1e3),void 0===r&&(r=null),this.load().then((function(){var i=u.WhereClause.create(e,a.getFieldsIndex());return a._substituteVars(i,r),a.calculateStatistic("distinct",i,t,a._defaultTracker(n))}))},e.prototype.min=function(e,t,r){var n=this;return void 0===t&&(t=null),this.load().then((function(){var a=u.WhereClause.create(e,n.getFieldsIndex());return n._substituteVars(a,t),n.calculateStatistic("min",a,-1,n._defaultTracker(r))}))},e.prototype.max=function(e,t,r){var n=this;return void 0===t&&(t=null),this.load().then((function(){var a=u.WhereClause.create(e,n.getFieldsIndex());return n._substituteVars(a,t),n.calculateStatistic("max",a,-1,n._defaultTracker(r))}))},e.prototype.avg=function(e,t,r){var n=this;return void 0===t&&(t=null),this.load().then((function(){var a=u.WhereClause.create(e,n.getFieldsIndex());return n._substituteVars(a,t),n.calculateStatistic("avg",a,-1,n._defaultTracker(r))}))},e.prototype.sum=function(e,t,r){var n=this;return void 0===t&&(t=null),this.load().then((function(){var a=u.WhereClause.create(e,n.getFieldsIndex());return n._substituteVars(a,t),n.calculateStatistic("sum",a,-1,n._defaultTracker(r))}))},e.prototype.stdev=function(e,t,r){var n=this;return void 0===t&&(t=null),this.load().then((function(){var a=u.WhereClause.create(e,n.getFieldsIndex());return n._substituteVars(a,t),n.calculateStatistic("stdev",a,-1,n._defaultTracker(r))}))},e.prototype.variance=function(e,t,r){var n=this;return void 0===t&&(t=null),this.load().then((function(){var a=u.WhereClause.create(e,n.getFieldsIndex());return n._substituteVars(a,t),n.calculateStatistic("variance",a,-1,n._defaultTracker(r))}))},e.prototype.count=function(e){var t=this;return this.load().then((function(){return t.calculateStatistic("count",u.WhereClause.create("1",t.getFieldsIndex()),-1,t._defaultTracker(e))}))},e.prototype._defaultTracker=function(e){return e||{aborted:!1}},e.prototype.forEach=function(e,t){var r=this;return o.create((function(n,a){r._forEachImpl(r.iterator(r._defaultTracker(t)),e,r,n,a,0)}))},e.prototype._forEachImpl=function(e,t,r,n,a,i){var s=this;try{if(++i>1e3)return void setTimeout((function(){s._forEachImpl(e,t,r,n,a,i=0)}),0);e.next().then((function(u){try{if(null===u)n(r);else{var c=t(u);null==c?s._forEachImpl(e,t,r,n,a,i):o.isPromiseLike(c)?c.then((function(){try{s._forEachImpl(e,t,r,n,a,i)}catch(e){a(e)}}),a):s._forEachImpl(e,t,r,n,a,i)}}catch(e){a(e)}}),a)}catch(e){a(e)}},e.prototype.convertToJSON=function(e){for(var t={layerDefinition:{geometryType:this.geometryType,fields:[]},featureSet:{features:[],geometryType:this.geometryType}},r=0;r<this.fields.length;r++)t.layerDefinition.fields.push(a.esriFieldToJson(this.fields[r]));return this.reduce((function(e,r){var n={geometry:r.geometry&&r.geometry.toJSON(),attributes:{}};for(var a in r.attributes)n.attributes[a]=r.attributes[a];return t.featureSet.features.push(n),1}),0,e).then((function(){return t}))},e.prototype.castToText=function(){return"object, FeatureSet"},e.prototype.queryAttachments=function(e,t,r,n){return this._parent.queryAttachments(e,t,r,n)},e.prototype.serviceUrl=function(){return this._parent.serviceUrl()},e.prototype.subtypes=function(){return this.typeIdField?{subtypeField:this.typeIdField,subtypes:this.types?this.types.map((function(e){return{name:e.name,code:e.id}})):[]}:null},e.prototype.relationshipMetaData=function(){return this._parent.relationshipMetaData()},e.prototype.schema=function(){for(var e=[],t=0,r=this.fields;t<r.length;t++)e.push(a.esriFieldToJson(r[t]));return{objectIdField:this.objectIdField,typeIdField:this.typeIdField,geometryType:void 0===a.layerGeometryEsriRestConstants[this.geometryType]?"":a.layerGeometryEsriRestConstants[this.geometryType],hasZ:!0===this.hasZ,hasM:!0===this.hasM,fields:e}},e.prototype.convertToText=function(e,t){var r=this;return"schema"===e?this._ensureLoaded().then((function(){return JSON.stringify(r.schema())})):"featureset"===e?this._ensureLoaded().then((function(){var e=[];return r.reduce((function(t,r){var n={geometry:r.geometry?r.geometry.toJSON():null,attributes:r.attributes};return null!==n.geometry&&n.geometry.spatialReference&&delete n.geometry.spatialReference,e.push(n),1}),0,t).then((function(){var t=r.schema();return t.features=e,t.spatialReference=r.spatialReference.toJSON(),JSON.stringify(t)}))})):o.resolve(this.castToText())},e.prototype.getFeatureByObjectId=function(e,t){return this._parent.getFeatureByObjectId(e,t)},e._featuresetFunctions={},e}()}).apply(null,n))||(e.exports=a)},PMeB:function(e,t,r){var n,a;n=[r.dj.c(e.i),t,r("gfOZ"),r("tq6K"),r("SqzB"),r("qMld")],void 0===(a=(function(e,t,r,n,a,i){"use strict";function s(e){for(var t=0,r=0;r<e.length;r++)t+=e[r];return t/e.length}function o(e){for(var t=s(e),r=0,n=0;n<e.length;n++)r+=Math.pow(t-e[n],2);return r/e.length}function u(e){for(var t=s(e),r=0,n=0;n<e.length;n++)r+=Math.pow(t-e[n],2);return r/(e.length-1)}function c(e){for(var t=0,r=0;r<e.length;r++)t+=e[r];return t}function l(e,t,n,a){void 0===a&&(a=!1);try{var s=e.iterator(n);return i.create((function(e,n){!function e(t,n,a,i,s,o){r.tick(t.next().then((function(r){try{if(null!==r){var u=a.calculateValue(r);return null===u?!1===i&&(n[n.length]=u):n[n.length]=u,e(t,n,a,i,s,o)}s(n)}catch(e){o(e)}}),o))}(s,[],t,a,e,n)}))}catch(e){return i.reject(e)}}Object.defineProperty(t,"__esModule",{value:!0}),t.distinct=t.count=t.sum=t.stdev=t.variance=t.mean=t.max=t.min=t.calculateStat=t.decodeStatType=void 0,t.decodeStatType=function(e){switch(e.toLowerCase()){case"distinct":return"distinct";case"avg":case"mean":return"avg";case"min":return"min";case"sum":return"sum";case"max":return"max";case"stdev":case"stddev":return"stddev";case"var":case"variance":return"var";case"count":return"count"}return""},t.calculateStat=function(e,t,r){switch(void 0===r&&(r=1e3),e.toLowerCase()){case"distinct":return function(e,t){for(var r=[],a={},i=[],s=0;s<e.length;s++){if(null!=e[s]){var o=e[s];if(n.isNumber(o)||n.isString(o))void 0===a[o]&&(r.push(o),a[o]=1);else{for(var u=!1,c=0;c<i.length;c++)!0===n.equalityTest(i[c],o)&&(u=!0);!1===u&&(i.push(o),r.push(o))}}if(r.length>=t&&-1!==t)return r}return r}(t,r);case"avg":case"mean":return s(t);case"min":return Math.min.apply(Math,t);case"sum":return c(t);case"max":return Math.max.apply(Math,t);case"stdev":case"stddev":return Math.sqrt(o(t));case"var":case"variance":return o(t);case"count":return t.length}return 0},t.min=function(e,t,r){return l(e,t,r,!0).then((function(e){return 0===e.length?null:Math.min.apply(Math,e)}))},t.max=function(e,t,r){return l(e,t,r,!0).then((function(e){return 0===e.length?null:Math.max.apply(Math,e)}))},t.mean=function(e,t,r){var n="";return!1===a.isSingleField(t)&&(n=a.predictType(t,e.fields,null)),l(e,t,r,!0).then((function(e){if(0===e.length)return null;var t,r=s(e);return null===r?r:"integer"===n?(t=+(t=r),isFinite(t)?t-t%1||(t<0?-0:0===t?t:0):t):r}))},t.variance=function(e,t,r){return l(e,t,r,!0).then((function(e){return 0===e.length?null:u(e)}))},t.stdev=function(e,t,r){return l(e,t,r,!0).then((function(e){return 0===e.length?null:Math.sqrt(u(e))}))},t.sum=function(e,t,r){return l(e,t,r,!0).then((function(e){return 0===e.length?null:c(e)}))},t.count=function(e,t){try{return e.iterator(t).count()}catch(e){return i.reject(e)}},t.distinct=function(e,t,r,n){return void 0===r&&(r=1e3),void 0===n&&(n=null),function(e,t,r,n){try{return function e(t,r,n,a,i){return t.next().then((function(s){if(null!==s){var o=a.calculateValue(s);return null!=o&&void 0===r[o]&&(n.push(o),r[o]=1),n.length>=i&&-1!==i?n:e(t,r,n,a,i)}return n}))}(e.iterator(n),{},[],t,r)}catch(e){return i.reject(e)}}(e,t,r,n)}}).apply(null,n))||(e.exports=a)},Q4uJ:function(e,t,r){var n,a;n=[r.dj.c(e.i),t],void 0===(a=(function(e,t){"use strict";return function(e,t,r,n){this._candidates=null,this._known=null,this._lastFetchedIndex=0,this._ordered=!1,this.pagesDefinition=null,this._candidates=e,this._known=t,this._ordered=r,this.pagesDefinition=n}}).apply(null,n))||(e.exports=a)},SqzB:function(e,t,r){var n,a;n=[r.dj.c(e.i),t,r("gfOZ"),r("tq6K"),r("1eyA")],void 0===(a=(function(e,t,r,n,a){"use strict";function i(e,t){return s(e.parseTree,t,e.parameters)}function s(e,t,r,n,a){var i,l,p,h;switch(void 0===n&&(n=null),void 0===a&&(a=null),e.type){case"interval":return f(s(e.value,t,r,n,a),e.qualifier,e.op);case"case_expression":var d=" CASE ";"simple"===e.format&&(d+=s(e.operand,t,r,n,a));for(var _=0;_<e.clauses.length;_++)d+=" WHEN "+s(e.clauses[_].operand,t,r,n,a)+" THEN "+s(e.clauses[_].value,t,r,n,a);return null!==e.else&&(d+=" ELSE "+s(e.else,t,r,n,a)),d+" END ";case"param":var g=r[e.value.toLowerCase()];if("string"==typeof g)return"'"+r[e.value.toLowerCase()].toString().replace(/'/g,"''")+"'";if(g instanceof Date)return u(g,t);if(g instanceof Array){var v=[];for(_=0;_<g.length;_++)"string"==typeof g[_]?v.push("'"+g[_].toString().replace(/'/g,"''")+"'"):g[_]instanceof Date?v.push(u(g[_],t)):v.push(g[_].toString());return v}return g.toString();case"expr_list":l=[];for(var y=0,m=e.value;y<m.length;y++)l.push(s(m[y],t,r,n,a));return l;case"unary_expr":return" ( NOT "+s(e.expr,t,r,n,a)+" ) ";case"binary_expr":switch(e.operator){case"AND":return" ("+s(e.left,t,r,n,a)+" AND "+s(e.right,t,r,n,a)+") ";case"OR":return" ("+s(e.left,t,r,n,a)+" OR "+s(e.right,t,r,n,a)+") ";case"IS":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return" ("+s(e.left,t,r,n,a)+" IS NULL )";case"ISNOT":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return" ("+s(e.left,t,r,n,a)+" IS NOT NULL )";case"IN":return i=[],"expr_list"===e.right.type?(i=s(e.right,t,r,n,a)," ("+s(e.left,t,r,n,a)+" IN ("+i.join(",")+")) "):(h=s(e.right,t,r,n,a))instanceof Array?" ("+s(e.left,t,r,n,a)+" IN ("+h.join(",")+")) ":" ("+s(e.left,t,r,n,a)+" IN ("+h+")) ";case"NOT IN":return i=[],"expr_list"===e.right.type?(i=s(e.right,t,r,n,a)," ("+s(e.left,t,r,n,a)+" NOT IN ("+i.join(",")+")) "):(h=s(e.right,t,r,n,a))instanceof Array?" ("+s(e.left,t,r,n,a)+" NOT IN ("+h.join(",")+")) ":" ("+s(e.left,t,r,n,a)+" NOT IN ("+h+")) ";case"BETWEEN":return p=s(e.right,t,r,n,a)," ("+s(e.left,t,r,n,a)+" BETWEEN "+p[0]+" AND "+p[1]+" ) ";case"NOTBETWEEN":return p=s(e.right,t,r,n,a)," ("+s(e.left,t,r,n,a)+" NOT BETWEEN "+p[0]+" AND "+p[1]+" ) ";case"LIKE":return""!==e.escape?" ("+s(e.left,t,r,n,a)+" LIKE "+s(e.right,t,r,n,a)+" ESCAPE '"+e.escape+"') ":" ("+s(e.left,t,r,n,a)+" LIKE "+s(e.right,t,r,n,a)+") ";case"NOT LIKE":return""!==e.escape?" ("+s(e.left,t,r,n,a)+" NOT LIKE "+s(e.right,t,r,n,a)+" ESCAPE '"+e.escape+"') ":" ("+s(e.left,t,r,n,a)+" NOT LIKE "+s(e.right,t,r,n,a)+") ";case"<>":case"<":case">":case">=":case"<=":case"=":case"*":case"-":case"+":case"/":return" ("+s(e.left,t,r,n,a)+" "+e.operator+" "+s(e.right,t,r,n,a)+") "}throw new Error("Not Supported Operator "+e.operator);case"null":return"null";case"bool":return!0===e.value?"1":"0";case"string":return"'"+e.value.toString().replace(/'/g,"''")+"'";case"timestamp":case"date":return u(e.value,t);case"number":return e.value.toString();case"current_time":return c("date"===e.mode,t);case"column_ref":return n&&n.toLowerCase()===e.column.toLowerCase()?"("+a+")":e.column;case"function":var S=s(e.args,t,r,n,a);return o(e.name,S,t)}throw new Error("Unsupported sql syntax "+e.type)}function o(e,t,r){switch(e.toLowerCase().trim()){case"abs":if(1!==t.length)throw new Error("Invalid Parameter for call to ABS");return"abs("+t[0]+")";case"ceiling":case"ceil":if(1!==t.length)throw new Error("Invalid Parameter for call to CEILING");switch(r){case n.FeatureServiceDatabaseType.Standardised:case n.FeatureServiceDatabaseType.StandardisedNoInterval:default:return"CEILING("+t[0]+")"}case"floor":if(1!==t.length)throw new Error("Invalid Parameter for call to Floor");return"FLOOR("+t[0]+")";case"log":if(1!==t.length)throw new Error("Invalid Parameter for call to LOG");return"LOG("+t[0]+")";case"log10":if(1!==t.length)throw new Error("Invalid Parameter for call to LOG10");return"LOG10("+t[0]+")";case"power":if(2!==t.length)throw new Error("Invalid Parameter for call to POWER");return"POWER("+t[0]+","+t[1]+")";case"round":if(2===t.length)return"ROUND("+t[0]+","+t[1]+")";if(1===t.length)return"ROUND("+t[0]+")";throw new Error("Invalid Parameter for call to ROUND");case"truncate":if(t.length<1||t.length>2)throw new Error("Invalid Parameter for TRUNCATE function");switch(r){case n.FeatureServiceDatabaseType.SqlServer:return"ROUND("+t[0]+(1===t.length?"0":","+t[1])+",1)";default:return"TRUNCATE("+t[0]+(1===t.length?")":","+t[1]+")")}case"char_length":case"len":if(1!==t.length)throw new Error("Invalid Parameter for CHAR_LENGTH function");switch(r){case n.FeatureServiceDatabaseType.SqlServer:return"LEN("+t[0]+")";case n.FeatureServiceDatabaseType.Oracle:return"LENGTH("+t[0]+")";default:return"CHAR_LENGTH("+t[0]+")"}case"concat":if(t.length<1)throw new Error("Invalid Parameter for CONCAT function");for(var a="CONCAT(",i=0;i<t.length;i++)0!==i&&(a+=","),a+=t[i];return a+")";case"lower":case"lcase":if(1!==t.length)throw new Error("Invalid Parameter for Lower function");return"LOWER("+t[0]+")";case"upper":case"ucase":if(1!==t.length)throw new Error("Invalid Parameter for Upper function");return"UPPER("+t[0]+")";case"substring":var s="";switch(r){case n.FeatureServiceDatabaseType.Oracle:return s="SUBSTR("+t[0]+","+t[1],3===t.length&&(s+=","+t[2]),s+")";case n.FeatureServiceDatabaseType.SqlServer:return 3===t.length?"SUBSTRING("+t[0]+","+t[1]+","+t[2]+")":"SUBSTRING("+t[0]+",  "+t[1]+", LEN("+t[0]+") - "+t[1]+")";default:return s="SUBSTRING("+t[0]+" FROM "+t[1],3===t.length&&(s+=" FOR "+t[2]),s+")"}case"extract":return"EXTRACT("+t[0].replace(/\'/g,"")+" FROM "+t[1]+")"}throw new Error("Function Not Recognised")}function u(e,t){var a=r.MomentLibrary.Moment(e),i=0===a.minute()&&0===a.hour()&&0===a.second()&&0===a.millisecond();switch(t){case n.FeatureServiceDatabaseType.FILEGDB:case n.FeatureServiceDatabaseType.Standardised:case n.FeatureServiceDatabaseType.StandardisedNoInterval:return i?"date '"+a.format("YYYY-MM-DD")+"'":"date '"+a.format("YYYY-MM-DD HH:mm:ss")+"'";case n.FeatureServiceDatabaseType.Oracle:return i?"TO_DATE('"+a.format("YYYY-MM-DD")+"','YYYY-MM-DD')":"TO_DATE('"+a.format("YYYY-MM-DD HH:mm:ss")+"','YYYY-MM-DD HH24:MI:SS')";case n.FeatureServiceDatabaseType.SqlServer:return"'"+a.format(i?"YYYY-MM-DD":"YYYY-MM-DD HH:mm:ss")+"'";case n.FeatureServiceDatabaseType.PGDB:return"#"+a.format(i?"MM-DD-YYYY":"MM-DD-YYYY HH:mm:ss")+"#";case n.FeatureServiceDatabaseType.Postgres:return"TIMESTAMP '"+a.format(i?"YYYY-MM-DD":"YYYY-MM-DD HH:mm:ss")+"'";default:return"date '"+a.format("YYYY-MM-DD HH:mm:ss")+"'"}}function c(e,t){switch(t){case n.FeatureServiceDatabaseType.FILEGDB:case n.FeatureServiceDatabaseType.Standardised:case n.FeatureServiceDatabaseType.StandardisedNoInterval:case n.FeatureServiceDatabaseType.Oracle:return e?"CURRENT_DATE":"CURRENT_TIMESTAMP";case n.FeatureServiceDatabaseType.SqlServer:return e?"CAST(GETDATE() AS DATE)":"GETDATE()";case n.FeatureServiceDatabaseType.PGDB:case n.FeatureServiceDatabaseType.Postgres:default:return e?"CURRENT_DATE":"CURRENT_TIMESTAMP"}}Object.defineProperty(t,"__esModule",{value:!0}),t.convertIntervalToSql=t.isSingleField=t.scanForField=t.predictType=t.makeToday=t.makeDateString=t.translateFunctionToDatabaseSpecific=t.combine=t.reformulateWithoutField=t.toWhereClauseFromTree=t.toWhereClause=void 0,t.toWhereClause=i,t.toWhereClauseFromTree=function(e,t,r){return s(e,t,r)},t.reformulateWithoutField=function(e,t,r,i){return a.WhereClause.create(s(e.parseTree,n.FeatureServiceDatabaseType.Standardised,e.parameters,t,r),i)},t.combine=function(e,t,r){return void 0===r&&(r="AND"),a.WhereClause.create("(("+i(e,n.FeatureServiceDatabaseType.Standardised)+")"+r+"("+i(t,n.FeatureServiceDatabaseType.Standardised)+"))",e.fieldsIndex)},t.translateFunctionToDatabaseSpecific=o,t.makeDateString=u,t.makeToday=c,t.predictType=function(e,t,r){void 0===r&&(r={});for(var n={},a={},i={esriFieldTypeSmallInteger:"integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"double",esriFieldTypeDouble:"double",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"integer",oid:"integer",long:"integer","small-integer":"integer",integer:"integer",single:"double",double:"double",date:"date",string:"string"},s=0,o=t;s<o.length;s++){var u=i[(c=o[s]).type];n[c.name.toLowerCase()]=void 0===u?"":u}for(var c in r)u=i[r[c]],a[c.toLowerCase()]=void 0===u?"":u;switch(function e(t,r,n,a){var i;switch(r.type){case"interval":return"integer";case"case_expression":var s=[];if("simple"===r.format){for(var o=0;o<r.clauses.length;o++)s.push(e(t,r.clauses[o].value,n,a));null!==r.else&&s.push(e(t,r.else,n,a))}else{for(o=0;o<r.clauses.length;o++)s.push(e(t,r.else,n,a));null!==r.else&&s.push(e(t,r.else,n,a))}return p(s);case"param":var u=a[r.value.toLowerCase()];if(void 0===u&&n){var c=n[r.value.toLowerCase()];if(void 0===c)return"";if(null===c)return"";if("string"==typeof c||c instanceof String)return"string";if("boolean"==typeof c)return"boolean";if(c instanceof Date)return"date";if("number"==typeof c)return c%1==0?"integer":"double"}return void 0===u?"":u;case"expr_list":for(var l=[],h=0,f=r.value;h<f.length;h++)l.push(e(t,f[h],n,a));return l;case"unary_expr":return"boolean";case"binary_expr":switch(r.operator){case"AND":case"OR":return"boolean";case"IS":case"ISNOT":if("null"!==r.right.type)throw new Error("Unsupported RHS for IS");return"boolean";case"IN":case"NOT IN":case"BETWEEN":case"NOTBETWEEN":case"LIKE":case"NOT LIKE":return"boolean";case"<>":case"<":case">":case">=":case"<=":case"=":return"boolean";case"*":case"-":case"+":case"/":return p([e(t,r.left,n,a),e(t,r.right,n,a)]);default:throw new Error("Not Supported Operator "+r.operator)}case"null":return"";case"bool":return"boolean";case"string":return"string";case"number":return null===r.value?"":r.value%1==0?"integer":"double";case"date":case"timestamp":case"current_time":return"date";case"column_ref":var d=t[r.column.toLowerCase()];return void 0===d?"":d;case"function":switch(r.name.toLowerCase()){case"position":case"extract":case"char_length":return"integer";case"round":return(i=e(t,r.args,n,a))instanceof Array?i.length>0?i[0]:"":i;case"sign":return(i=e(t,r.args,n,a))instanceof Array&&(i=p(i)),"integer"===i||"double"===i?i:"double";case"ceiling":case"floor":case"abs":var _=e(t,r.args,n,a);return _ instanceof Array?p(_):_;case"area":case"length":case"log":case"log10":case"sin":case"cos":case"tan":case"asin":case"acos":case"atan":case"power":return"double";case"substring":case"trim":case"concat":case"lower":case"upper":return"string";case"truncate":return"double";case"round":return(i=e(t,r.args,n,a))instanceof Array?i.length>0?i[0]:"":i}return""}throw new Error("Unsupported sql syntax "+r.type)}(n,e.parseTree,e.parameters,a)){case"double":return"double";case"integer":return"integer";case"double":return"double";case"date":return"date";case"string":return"string"}return""};var l={boolean:1,string:2,integer:3,double:4,date:5};function p(e){if(e){for(var t="",r=0,n=e;r<n.length;r++){var a=n[r];""!==a&&(t=""===t||l[t]<l[a]?a:t)}return t}return""}function h(e){return""+e.period.toUpperCase()}function f(e,t,r){return"INTERVAL "+r+" "+e+" "+("interval-period"===t.type?h(t):h(t.start)+" TO "+h(t.end))}t.scanForField=function(e,t){return function e(t,r){if(null==t)return!1;switch(t.type){case"when_clause":return e(t.operand,r)||e(t.value,r);case"case_expression":for(var n=0,a=t.clauses;n<a.length;n++){var i=a[n];if(e(i,r))return!0}return!("simple"!==t.format||!e(t.operand,r))||!(null===t.else||!e(t.else,r));case"param":return!1;case"expr_list":for(var s=0,o=t.value;s<o.length;s++)if(e(i=o[s],r))return!0;return!1;case"unary_expr":return e(t.expr,r);case"binary_expr":return e(t.left,r)||e(t.right,r);case"null":case"bool":case"date":case"timestamp":case"string":case"number":return!1;case"column_ref":return r.toLowerCase()===t.column.toLowerCase();case"function":return e(t.args,r)}return!1}(e.parseTree,t)},t.isSingleField=function(e){return"column_ref"===e.parseTree.type},t.convertIntervalToSql=f}).apply(null,n))||(e.exports=a)},VM5u:function(e,t,r){var n,a;n=[r.dj.c(e.i),t,r("zOht"),r("20W2"),r("88sq"),r("Q4uJ"),r("tq6K"),r("qMld"),r("wfTL")],void 0===(a=(function(e,t,r,n,a,i,s,o,u){"use strict";return function(e){function t(t){var r=e.call(this,t)||this;return r._relation="",r._relationGeom=null,r._relationString="",r.declaredClass="esri.arcade.featureset.actions.SpatialFilter",r._relationString=t.relationString,r._parent=t.parentfeatureset,r._maxProcessing=40,r._relation=t.relation,r._relationGeom=t.relationGeom,r}return r.__extends(t,e),t.prototype._getSet=function(e){var t=this;return null===this._wset?this._ensureLoaded().then((function(){return t._parent._getFilteredSet("esriSpatialRelRelation"!==t._relation?t._relation:t._relation+":"+t._relationString,t._relationGeom,null,null,e)})).then((function(r){return t._checkCancelled(e),t._wset=new i(r._candidates.slice(0),r._known.slice(0),r._ordered,t._clonePageDefinition(r.pagesDefinition)),t._wset})):o.resolve(this._wset)},t.prototype._isInFeatureSet=function(e){var t=this._parent._isInFeatureSet(e);return t===s.IdState.NotInFeatureSet?t:void 0===(t=this._idstates[e])?s.IdState.Unknown:t},t.prototype._getFeature=function(e,t,r){return this._parent._getFeature(e,t,r)},t.prototype._getFeatures=function(e,t,r,n){return this._parent._getFeatures(e,t,r,n)},t.prototype._featureFromCache=function(e){return this._parent._featureFromCache(e)},t.prototype.executeSpatialRelationTest=function(e){if(null===e.geometry)return o.resolve(!1);switch(this._relation){case"esriSpatialRelEnvelopeIntersects":var t=s.shapeExtent(this._relationGeom),r=s.shapeExtent(e.geometry);return u.intersects(t,r);case"esriSpatialRelIntersects":return u.intersects(this._relationGeom,e.geometry);case"esriSpatialRelContains":return u.contains(this._relationGeom,e.geometry);case"esriSpatialRelOverlaps":return u.overlaps(this._relationGeom,e.geometry);case"esriSpatialRelWithin":return u.within(this._relationGeom,e.geometry);case"esriSpatialRelTouches":return u.touches(this._relationGeom,e.geometry);case"esriSpatialRelCrosses":return u.crosses(this._relationGeom,e.geometry);case"esriSpatialRelRelation":return u.relate(this._relationGeom,e.geometry,this._relationString)}},t.prototype._fetchAndRefineFeatures=function(e,t,r){var n=this,a=new i([],e,!1,null),u=Math.min(t,e.length);return this._parent._getFeatures(a,-1,u,r).then((function(){n._checkCancelled(r);for(var t=[],a=0;a<u;a++){var i=n._parent._featureFromCache(e[a]);t.push(n.executeSpatialRelationTest(i))}return o.all(t)})).then((function(r){for(var a=0;a<t;a++)n._idstates[e[a]]=!0===r[a]?s.IdState.InFeatureSet:s.IdState.NotInFeatureSet;return"success"}))},t.prototype._getFilteredSet=function(e,t,r,n,a){var s=this;return this._ensureLoaded().then((function(){return s._parent._getFilteredSet("esriSpatialRelRelation"!==s._relation?s._relation:s._relation+":"+s._relationString,s._relationGeom,r,n,a)})).then((function(e){return s._checkCancelled(a),null!==t?new i(e._candidates.slice(0).concat(e._known.slice(0)),[],e._ordered,s._clonePageDefinition(e.pagesDefinition)):new i(e._candidates.slice(0),e._known.slice(0),e._ordered,s._clonePageDefinition(e.pagesDefinition))}))},t.prototype._stat=function(e,t,r,n,a,i,s){var u=this;return""!==r?o.resolve({calculated:!1}):this._parent._stat(e,t,"esriSpatialRelRelation"!==this._relation?this._relation:this._relation+":"+this._relationString,this._relationGeom,a,i,s).then((function(o){return!1===o.calculated?null===a&&""===r&&null===n?u._manualStat(e,t,i,s):{calculated:!1}:o}))},t.prototype._canDoAggregates=function(e,t,r,n,a){return""!==r||null!==n||null===this._parent?o.resolve(!1):this._parent._canDoAggregates(e,t,"esriSpatialRelRelation"!==this._relation?this._relation:this._relation+":"+this._relationString,this._relationGeom,a)},t.prototype._getAggregatePagesDataSourceDefinition=function(e,t,r,n,a,i,s){return null===this._parent?o.reject(new Error("Should never be called")):this._parent._getAggregatePagesDataSourceDefinition(e,t,"esriSpatialRelRelation"!==this._relation?this._relation:this._relation+":"+this._relationString,this._relationGeom,a,i,s)},t.registerAction=function(){a._featuresetFunctions.intersects=function(e){return null==e?new n({parentfeatureset:this}):new t({parentfeatureset:this,relation:"esriSpatialRelIntersects",relationGeom:e})},a._featuresetFunctions.envelopeIntersects=function(e){return null==e?new n({parentfeatureset:this}):new t({parentfeatureset:this,relation:"esriSpatialRelEnvelopeIntersects",relationGeom:e})},a._featuresetFunctions.contains=function(e){return null==e?new n({parentfeatureset:this}):new t({parentfeatureset:this,relation:"esriSpatialRelContains",relationGeom:e})},a._featuresetFunctions.overlaps=function(e){return null==e?new n({parentfeatureset:this}):new t({parentfeatureset:this,relation:"esriSpatialRelOverlaps",relationGeom:e})},a._featuresetFunctions.within=function(e){return null==e?new n({parentfeatureset:this}):new t({parentfeatureset:this,relation:"esriSpatialRelWithin",relationGeom:e})},a._featuresetFunctions.touches=function(e){return null==e?new n({parentfeatureset:this}):new t({parentfeatureset:this,relation:"esriSpatialRelTouches",relationGeom:e})},a._featuresetFunctions.crosses=function(e){return null==e?new n({parentfeatureset:this}):new t({parentfeatureset:this,relation:"esriSpatialRelCrosses",relationGeom:e})},a._featuresetFunctions.relate=function(e,r){return null==e?new n({parentfeatureset:this}):new t({parentfeatureset:this,relation:"esriSpatialRelRelation",relationGeom:e,relationString:r})}},t}(a)}).apply(null,n))||(e.exports=a)},wfTL:function(e,t,r){var n,a;n=[r.dj.c(e.i),t,r("zOht"),r("TMur"),r("8V7H")],void 0===(a=(function(e,t,r,n,a){"use strict";function i(e){var t;return Array.isArray(e)?null===(t=e[0])||void 0===t?void 0:t.spatialReference:null==e?void 0:e.spatialReference}function s(e){return e?Array.isArray(e)?e.map(s):e.toJSON?e.toJSON():e:e}function o(e){return Array.isArray(e)?e.map((function(e){return n.fromJSON(e)})):n.fromJSON(e)}var u;function c(){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(e){return u||(u=a.open("geometryEngineWorker",{strategy:"distributed"})),[2,u]}))}))}function l(e,t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(r){switch(r.label){case 0:return[4,c()];case 1:return[2,r.sent().invoke("executeGEOperation",{operation:e,parameters:s(t)})]}}))}))}function p(e){return"xmin"in e?e.center:"x"in e?e:e.extent.center}Object.defineProperty(t,"__esModule",{value:!0}),t.geodesicLength=t.geodesicArea=t.planarLength=t.planarArea=t.geodesicDensify=t.densify=t.generalize=t.flipVertical=t.flipHorizontal=t.rotate=t.nearestVertices=t.nearestVertex=t.nearestCoordinate=t.geodesicBuffer=t.buffer=t.offset=t.union=t.intersect=t.symmetricDifference=t.difference=t.convexHull=t.simplify=t.isSimple=t.relate=t.overlaps=t.disjoint=t.within=t.touches=t.intersects=t.equals=t.distance=t.crosses=t.contains=t.cut=t.clip=t.extendedSpatialReferenceInfo=void 0,t.extendedSpatialReferenceInfo=function(e){return l("extendedSpatialReferenceInfo",[e])},t.clip=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(r){switch(r.label){case 0:return[4,l("clip",[i(e),e,t])];case 1:return[2,o(r.sent())]}}))}))},t.cut=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(r){switch(r.label){case 0:return[4,l("cut",[i(e),e,t])];case 1:return[2,o(r.sent())]}}))}))},t.contains=function(e,t){return l("contains",[i(e),e,t])},t.crosses=function(e,t){return l("crosses",[i(e),e,t])},t.distance=function(e,t,r){return l("distance",[i(e),e,t,r])},t.equals=function(e,t){return l("equals",[i(e),e,t])},t.intersects=function(e,t){return l("intersects",[i(e),e,t])},t.touches=function(e,t){return l("touches",[i(e),e,t])},t.within=function(e,t){return l("within",[i(e),e,t])},t.disjoint=function(e,t){return l("disjoint",[i(e),e,t])},t.overlaps=function(e,t){return l("overlaps",[i(e),e,t])},t.relate=function(e,t,r){return l("relate",[i(e),e,t,r])},t.isSimple=function(e){return l("isSimple",[i(e),e])},t.simplify=function(e){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,l("simplify",[i(e),e])];case 1:return[2,o(t.sent())]}}))}))},t.convexHull=function(e,t){return void 0===t&&(t=!1),r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(r){switch(r.label){case 0:return[4,l("convexHull",[i(e),e,t])];case 1:return[2,o(r.sent())]}}))}))},t.difference=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(r){switch(r.label){case 0:return[4,l("difference",[i(e),e,t])];case 1:return[2,o(r.sent())]}}))}))},t.symmetricDifference=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(r){switch(r.label){case 0:return[4,l("symmetricDifference",[i(e),e,t])];case 1:return[2,o(r.sent())]}}))}))},t.intersect=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(r){switch(r.label){case 0:return[4,l("intersect",[i(e),e,t])];case 1:return[2,o(r.sent())]}}))}))},t.union=function(e,t){return void 0===t&&(t=null),r.__awaiter(this,void 0,void 0,(function(){var n;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,l("union",[i(n=function(e,t){var r;return Array.isArray(e)?r=e:((r=[]).push(e),null!=t&&r.push(t)),r}(e,t)),n])];case 1:return[2,o(r.sent())]}}))}))},t.offset=function(e,t,n,a,s,u){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(r){switch(r.label){case 0:return[4,l("offset",[i(e),e,t,n,a,s,u])];case 1:return[2,o(r.sent())]}}))}))},t.buffer=function(e,t,n,a){return void 0===a&&(a=!1),r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(r){switch(r.label){case 0:return[4,l("buffer",[i(e),e,t,n,a])];case 1:return[2,o(r.sent())]}}))}))},t.geodesicBuffer=function(e,t,n,a,s,u){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(r){switch(r.label){case 0:return[4,l("geodesicBuffer",[i(e),e,t,n,a,s,u])];case 1:return[2,o(r.sent())]}}))}))},t.nearestCoordinate=function(e,t,a){return void 0===a&&(a=!0),r.__awaiter(this,void 0,void 0,(function(){var s;return r.__generator(this,(function(o){switch(o.label){case 0:return[4,l("nearestCoordinate",[i(e),e,t,a])];case 1:return s=o.sent(),[2,r.__assign(r.__assign({},s),{coordinate:n.Point.fromJSON(s.coordinate)})]}}))}))},t.nearestVertex=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var a;return r.__generator(this,(function(s){switch(s.label){case 0:return[4,l("nearestVertex",[i(e),e,t])];case 1:return a=s.sent(),[2,r.__assign(r.__assign({},a),{coordinate:n.Point.fromJSON(a.coordinate)})]}}))}))},t.nearestVertices=function(e,t,a,s){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(o){switch(o.label){case 0:return[4,l("nearestVertices",[i(e),e,t,a,s])];case 1:return[2,o.sent().map((function(e){return r.__assign(r.__assign({},e),{coordinate:n.Point.fromJSON(e.coordinate)})}))]}}))}))},t.rotate=function(e,t,n){return r.__awaiter(this,void 0,void 0,(function(){var a,i,s,o;return r.__generator(this,(function(r){switch(r.label){case 0:if(null==e)throw new Error("Illegal Argument Exception");return a=e.spatialReference,n=null!=n?n:p(e),o=(s=e.constructor).fromJSON,[4,l("rotate",[a,e,t,n])];case 1:return(i=o.apply(s,[r.sent()])).spatialReference=a,[2,i]}}))}))},t.flipHorizontal=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n,a,i,s;return r.__generator(this,(function(r){switch(r.label){case 0:if(null==e)throw new Error("Illegal Argument Exception");return n=e.spatialReference,t=null!=t?t:p(e),s=(i=e.constructor).fromJSON,[4,l("flipHorizontal",[n,e,t])];case 1:return(a=s.apply(i,[r.sent()])).spatialReference=n,[2,a]}}))}))},t.flipVertical=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n,a,i,s;return r.__generator(this,(function(r){switch(r.label){case 0:if(null==e)throw new Error("Illegal Argument Exception");return n=e.spatialReference,t=null!=t?t:p(e),s=(i=e.constructor).fromJSON,[4,l("flipVertical",[n,e,t])];case 1:return(a=s.apply(i,[r.sent()])).spatialReference=n,[2,a]}}))}))},t.generalize=function(e,t,n,a){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(r){switch(r.label){case 0:return[4,l("generalize",[i(e),e,t,n,a])];case 1:return[2,o(r.sent())]}}))}))},t.densify=function(e,t,n){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(r){switch(r.label){case 0:return[4,l("densify",[i(e),e,t,n])];case 1:return[2,o(r.sent())]}}))}))},t.geodesicDensify=function(e,t,n,a){return void 0===a&&(a=0),r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(r){switch(r.label){case 0:return[4,l("geodesicDensify",[i(e),e,t,n,a])];case 1:return[2,o(r.sent())]}}))}))},t.planarArea=function(e,t){return l("planarArea",[i(e),e,t])},t.planarLength=function(e,t){return l("planarLength",[i(e),e,t])},t.geodesicArea=function(e,t,r){return l("geodesicArea",[i(e),e,t,r])},t.geodesicLength=function(e,t,r){return l("geodesicLength",[i(e),e,t,r])}}).apply(null,n))||(e.exports=a)},"x/o6":function(e,t,r){var n,a;n=[r.dj.c(e.i),t],void 0===(a=(function(e,t){"use strict";return function(){function e(){this._databaseTypeMetaData={},this._layerInfo={}}return e.prototype.clearDatabaseType=function(e){void 0===this._databaseTypeMetaData[e]&&delete this._databaseTypeMetaData[e]},e.prototype.getDatabaseType=function(e){return"MUSTBESET"===e||void 0===this._databaseTypeMetaData[e]?null:this._databaseTypeMetaData[e]},e.prototype.setDatabaseType=function(e,t){this._databaseTypeMetaData[e]=t},e.prototype.getLayerInfo=function(e){return void 0===this._layerInfo[e]?null:this._layerInfo[e]},e.prototype.setLayerInfo=function(e,t){this._layerInfo[e]=t},e.prototype.clearLayerInfo=function(e){void 0!==this._layerInfo[e]&&delete this._layerInfo[e]},e.applicationCache=null,e}()}).apply(null,n))||(e.exports=a)},ydXo:function(e,t,r){var n,a;n=[r.dj.c(e.i),t,r("qMld")],void 0===(a=(function(e,t,r){"use strict";return function(){function e(e,t){this._lastId=-1,this._progress=t,this._parent=e}return e.prototype.reset=function(){this._lastId=-1},e.prototype.nextBatch=function(e){var t=this;if(null!==this._parent._mainSetInUse)return this._parent._mainSetInUse.then((function(r){return t.nextBatch(e)}),(function(r){return t.nextBatch(e)}));var n={returnpromise:null,hasset:!1},a=[];return n.returnpromise=r.create((function(r,i){t._parent._getSet(t._progress).then((function(s){var o=s._known.length-1;if("GETPAGES"===s._known[s._known.length-1]&&(o-=1),t._lastId+e>o&&s._known.length>0&&"GETPAGES"===s._known[s._known.length-1])t._parent._expandPagedSet(s,t._parent._maxQueryRate(),0,0,t._progress).then((function(a){n.hasset=!0,t._parent._mainSetInUse=null,t.nextBatch(e).then(r,i)}),(function(e){n.hasset=!0,t._parent._mainSetInUse=null,i(e)}));else{if(o>=t._lastId+e||0===s._candidates.length){for(var u=0;u<e;u++){var c=u+t._lastId+1;if(c>=s._known.length)break;a[u]=s._known[c]}return t._lastId+=a.length,0===a.length&&(n.hasset=!0,t._parent._mainSetInUse=null,r([])),void t._parent._getFeatureBatch(a,t._progress).then((function(e){n.hasset=!0,t._parent._mainSetInUse=null,r(e)}),(function(e){n.hasset=!0,t._parent._mainSetInUse=null,i(e)}))}t._parent._refineSetBlock(s,t._parent._maxProcessingRate(),t._progress).then((function(){n.hasset=!0,t._parent._mainSetInUse=null,t.nextBatch(e).then(r,i)}),(function(e){n.hasset=!0,t._parent._mainSetInUse=null,i(e)}))}}),(function(e){n.hasset=!0,t._parent._mainSetInUse=null,i(e)}))})),!1===n.hasset&&(this._parent._mainSetInUse=n.returnpromise,n.hasset=!0),n.returnpromise},e.prototype.next=function(){var e=this;if(null!==this._parent._mainSetInUse)return this._parent._mainSetInUse.then((function(t){return e.next()}),(function(t){return e.next()}));var t={returnpromise:null,hasset:!1};return t.returnpromise=r.create((function(r,n){e._parent._getSet(e._progress).then((function(a){e._lastId<a._known.length-1?"GETPAGES"===a._known[e._lastId+1]?e._parent._expandPagedSet(a,e._parent._maxQueryRate(),0,0,e._progress).then((function(r){return t.hasset=!0,e._parent._mainSetInUse=null,e.next()})).then(r,n):(e._lastId+=1,e._parent._getFeature(a,a._known[e._lastId],e._progress).then((function(n){t.hasset=!0,e._parent._mainSetInUse=null,r(n)}),(function(r){t.hasset=!0,e._parent._mainSetInUse=null,n(r)}))):a._candidates.length>0?e._parent._refineSetBlock(a,e._parent._maxProcessingRate(),e._progress).then((function(){t.hasset=!0,e._parent._mainSetInUse=null,e.next().then(r,n)}),(function(r){t.hasset=!0,e._parent._mainSetInUse=null,n(r)})):(t.hasset=!0,e._parent._mainSetInUse=null,r(null))}),(function(r){t.hasset=!0,e._parent._mainSetInUse=null,n(r)}))})),!1===t.hasset&&(this._parent._mainSetInUse=t.returnpromise,t.hasset=!0),t.returnpromise},e.prototype.count=function(){var e=this;return-1!==this._parent._totalCount?r.resolve(this._parent._totalCount):this._parent._getSet(this._progress).then((function(t){return e._refineAllSets(t)})).then((function(t){return e._parent._totalCount=t._known.length,r.resolve(e._parent._totalCount)}))},e.prototype._refineAllSets=function(e){var t=this;return e._known.length>0&&"GETPAGES"===e._known[e._known.length-1]?this._parent._expandPagedSet(e,this._parent._maxQueryRate(),0,1,this._progress).then((function(r){return t._refineAllSets(e)})).then((function(e){return r.resolve(e)})):e._candidates.length>0?"GETPAGES"===e._known[e._candidates.length-1]?this._parent._expandPagedSet(e,this._parent._maxQueryRate(),0,2,this._progress).then((function(r){return t._refineAllSets(e)})).then((function(e){return r.resolve(e)})):this._parent._refineSetBlock(e,this._parent._maxProcessingRate(),this._progress).then((function(e){return e._candidates.length>0?t._refineAllSets(e):r.resolve(e)})):r.resolve(e)},e}()}).apply(null,n))||(e.exports=a)}}]);